"use strict";(self.webpackChunke_shop=self.webpackChunke_shop||[]).push([[179],{217:(Ss,Wn,xe)=>{xe.d(Wn,{$:()=>BT,A:()=>ie,G:()=>yt,K:()=>xT,L:()=>gl,N:()=>Fi,P:()=>rC,R:()=>eC,U:()=>Ue,V:()=>Ao,W:()=>Y,X:()=>oy,Y:()=>he,Z:()=>Il,_:()=>rd,a:()=>up,a0:()=>Ps,a1:()=>Cl,a2:()=>cy,a3:()=>dy,a4:()=>$T,a5:()=>at,a6:()=>lr,a7:()=>wr,a8:()=>ip,a9:()=>HT,aA:()=>st,aB:()=>Rt,aC:()=>se,aD:()=>Vy,aE:()=>U,aF:()=>oe,aG:()=>hu,aH:()=>Oy,aI:()=>Tp,aJ:()=>Ne,aN:()=>Ml,aQ:()=>bo,aa:()=>In,ab:()=>Re,ac:()=>un,ad:()=>Tr,ae:()=>is,af:()=>eo,ag:()=>Al,ah:()=>eu,ak:()=>Ms,al:()=>hy,am:()=>No,ap:()=>uy,aq:()=>ru,as:()=>OM,at:()=>BM,au:()=>on,av:()=>me,aw:()=>q,ax:()=>lt,ay:()=>Rp,az:()=>Cd,b:()=>WT,c:()=>xy,d:()=>Ip,e:()=>sC,f:()=>tn,g:()=>Ly,h:()=>uC,i:()=>pp,j:()=>cC,k:()=>Bn,l:()=>nC,m:()=>Pp,p:()=>Wt,r:()=>Vt,s:()=>K,u:()=>vp,w:()=>Pl});var A=xe(861),$=xe(58),k=xe(534),Te=xe(879),sn=xe(582),We=xe(537);const Wt={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},ie={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const yt=function Se(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},Dn=function qe(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},mt=new $.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Ge=new Te.Yd("@firebase/auth");function An(p,...c){Ge.logLevel<=Te.in.ERROR&&Ge.error(`Auth (${k.SDK_VERSION}): ${p}`,...c)}function lt(p,...c){throw ct(p,...c)}function Rt(p,...c){return ct(p,...c)}function or(p,c,h){const g=Object.assign(Object.assign({},Dn()),{[c]:h});return new $.LL("auth","Firebase",g).create(c,{appName:p.name})}function bn(p,c,h){if(!(c instanceof h))throw h.name!==c.constructor.name&&lt(p,"argument-error"),or(p,"argument-error",`Type of ${c.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ct(p,...c){if("string"!=typeof p){const h=c[0],g=[...c.slice(1)];return g[0]&&(g[0].appName=p.name),p._errorFactory.create(h,...g)}return mt.create(p,...c)}function se(p,c,...h){if(!p)throw ct(c,...h)}function Tt(p){const c="INTERNAL ASSERTION FAILED: "+p;throw An(c),new Error(c)}function on(p,c){p||Tt(c)}function Vn(){var p;return typeof self<"u"&&(null===(p=self.location)||void 0===p?void 0:p.href)||""}function Qr(){return"http:"===Ds()||"https:"===Ds()}function Ds(){var p;return typeof self<"u"&&(null===(p=self.location)||void 0===p?void 0:p.protocol)||null}class hi{constructor(c,h){this.shortDelay=c,this.longDelay=h,on(h>c,"Short delay should be less than long delay!"),this.isMobile=(0,$.uI)()||(0,$.b$)()}get(){return function Qi(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Qr()||(0,$.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Mi(p,c){on(p.emulator,"Emulator should always be set here");const{url:h}=p.emulator;return c?`${h}${c.startsWith("/")?c.slice(1):c}`:h}class H{static initialize(c,h,g){this.fetchImpl=c,h&&(this.headersImpl=h),g&&(this.responseImpl=g)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void Tt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void Tt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void Tt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const W={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Q=new hi(3e4,6e4);function B(p,c){return p.tenantId&&!c.tenantId?Object.assign(Object.assign({},c),{tenantId:p.tenantId}):c}function J(p,c,h,g){return ue.apply(this,arguments)}function ue(){return(ue=(0,A.Z)(function*(p,c,h,g,y={}){return Ae(p,y,(0,A.Z)(function*(){let w={},N={};g&&("GET"===c?N=g:w={body:JSON.stringify(g)});const j=(0,$.xO)(Object.assign({key:p.config.apiKey},N)).slice(1),ee=yield p._getAdditionalHeaders();return ee["Content-Type"]="application/json",p.languageCode&&(ee["X-Firebase-Locale"]=p.languageCode),H.fetch()(wt(p,p.config.apiHost,h,j),Object.assign({method:c,headers:ee,referrerPolicy:"no-referrer"},w))}))})).apply(this,arguments)}function Ae(p,c,h){return it.apply(this,arguments)}function it(){return(it=(0,A.Z)(function*(p,c,h){p._canInitEmulator=!1;const g=Object.assign(Object.assign({},W),c);try{const y=new ke(p),w=yield Promise.race([h(),y.promise]);y.clearNetworkTimeout();const N=yield w.json();if("needConfirmation"in N)throw Yt(p,"account-exists-with-different-credential",N);if(w.ok&&!("errorMessage"in N))return N;{const j=w.ok?N.errorMessage:N.error.message,[ee,Ie]=j.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===ee)throw Yt(p,"credential-already-in-use",N);if("EMAIL_EXISTS"===ee)throw Yt(p,"email-already-in-use",N);if("USER_DISABLED"===ee)throw Yt(p,"user-disabled",N);const _e=g[ee]||ee.toLowerCase().replace(/[_\s]+/g,"-");if(Ie)throw or(p,_e,Ie);lt(p,_e)}}catch(y){if(y instanceof $.ZR)throw y;lt(p,"network-request-failed",{message:String(y)})}})).apply(this,arguments)}function Pt(p,c,h,g){return Pe.apply(this,arguments)}function Pe(){return(Pe=(0,A.Z)(function*(p,c,h,g,y={}){const w=yield J(p,c,h,g,y);return"mfaPendingCredential"in w&&lt(p,"multi-factor-auth-required",{_serverResponse:w}),w})).apply(this,arguments)}function wt(p,c,h,g){const y=`${c}${h}?${g}`;return p.config.emulator?Mi(p.config,y):`${p.config.apiScheme}://${y}`}function vn(p){switch(p){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ke{constructor(c){this.auth=c,this.timer=null,this.promise=new Promise((h,g)=>{this.timer=setTimeout(()=>g(Rt(this.auth,"network-request-failed")),Q.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Yt(p,c,h){const g={appName:p.name};h.email&&(g.email=h.email),h.phoneNumber&&(g.phoneNumber=h.phoneNumber);const y=Rt(p,c,g);return y.customData._tokenResponse=h,y}function Rn(p){return void 0!==p&&void 0!==p.getResponse}function En(p){return void 0!==p&&void 0!==p.enterprise}class At{constructor(c){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===c.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=c.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=c.recaptchaEnforcementState}getProviderEnforcementState(c){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const h of this.recaptchaEnforcementState)if(h.provider&&h.provider===c)return vn(h.enforcementState);return null}isProviderEnabled(c){return"ENFORCE"===this.getProviderEnforcementState(c)||"AUDIT"===this.getProviderEnforcementState(c)}}function xi(){return(xi=(0,A.Z)(function*(p){return(yield J(p,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function As(p,c){return Lt.apply(this,arguments)}function Lt(){return(Lt=(0,A.Z)(function*(p,c){return J(p,"GET","/v2/recaptchaConfig",B(p,c))})).apply(this,arguments)}function Yi(){return(Yi=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:delete",c)})).apply(this,arguments)}function Xi(){return(Xi=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function pi(){return(pi=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:lookup",c)})).apply(this,arguments)}function xr(p){if(p)try{const c=new Date(Number(p));if(!isNaN(c.getTime()))return c.toUTCString()}catch{}}function gi(){return(gi=(0,A.Z)(function*(p,c=!1){const h=(0,$.m9)(p),g=yield h.getIdToken(c),y=mi(g);se(y&&y.exp&&y.auth_time&&y.iat,h.auth,"internal-error");const w="object"==typeof y.firebase?y.firebase:void 0,N=w?.sign_in_provider;return{claims:y,token:g,authTime:xr(es(y.auth_time)),issuedAtTime:xr(es(y.iat)),expirationTime:xr(es(y.exp)),signInProvider:N||null,signInSecondFactor:w?.sign_in_second_factor||null}})).apply(this,arguments)}function es(p){return 1e3*Number(p)}function mi(p){const[c,h,g]=p.split(".");if(void 0===c||void 0===h||void 0===g)return An("JWT malformed, contained fewer than 3 sections"),null;try{const y=(0,$.tV)(h);return y?JSON.parse(y):(An("Failed to decode base64 JWT payload"),null)}catch(y){return An("Caught error parsing JWT payload as JSON",y?.toString()),null}}function an(p,c){return qt.apply(this,arguments)}function qt(){return(qt=(0,A.Z)(function*(p,c,h=!1){if(h)return c;try{return yield c}catch(g){throw g instanceof $.ZR&&function ki({code:p}){return"auth/user-disabled"===p||"auth/user-token-expired"===p}(g)&&p.auth.currentUser===p&&(yield p.auth.signOut()),g}})).apply(this,arguments)}class bs{constructor(c){this.user=c,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(c){var h;if(c){const g=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),g}{this.errorBackoff=3e4;const y=(null!==(h=this.user.stsTokenManager.expirationTime)&&void 0!==h?h:0)-Date.now()-3e5;return Math.max(0,y)}}schedule(c=!1){var h=this;if(!this.isRunning)return;const g=this.getInterval(c);this.timerId=setTimeout((0,A.Z)(function*(){yield h.iteration()}),g)}iteration(){var c=this;return(0,A.Z)(function*(){try{yield c.user.getIdToken(!0)}catch(h){return void("auth/network-request-failed"===h?.code&&c.schedule(!0))}c.schedule()})()}}class Ys{constructor(c,h){this.createdAt=c,this.lastLoginAt=h,this._initializeTime()}_initializeTime(){this.lastSignInTime=xr(this.lastLoginAt),this.creationTime=xr(this.createdAt)}_copy(c){this.createdAt=c.createdAt,this.lastLoginAt=c.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Kn(p){return kr.apply(this,arguments)}function kr(){return kr=(0,A.Z)(function*(p){var c;const h=p.auth,g=yield p.getIdToken(),y=yield an(p,function yr(p,c){return pi.apply(this,arguments)}(h,{idToken:g}));se(y?.users.length,h,"internal-error");const w=y.users[0];p._notifyReloadListener(w);const N=null!==(c=w.providerUserInfo)&&void 0!==c&&c.length?function Ct(p){return p.map(c=>{var{providerId:h}=c,g=(0,sn._T)(c,["providerId"]);return{providerId:h,uid:g.rawId||"",displayName:g.displayName||null,email:g.email||null,phoneNumber:g.phoneNumber||null,photoURL:g.photoUrl||null}})}(w.providerUserInfo):[],j=function ca(p,c){return[...p.filter(g=>!c.some(y=>y.providerId===g.providerId)),...c]}(p.providerData,N),_e=!!p.isAnonymous&&!(p.email&&w.passwordHash||j?.length),nt={uid:w.localId,displayName:w.displayName||null,photoURL:w.photoUrl||null,email:w.email||null,emailVerified:w.emailVerified||!1,phoneNumber:w.phoneNumber||null,tenantId:w.tenantId||null,providerData:j,metadata:new Ys(w.createdAt,w.lastLoginAt),isAnonymous:_e};Object.assign(p,nt)}),kr.apply(this,arguments)}function Jr(){return(Jr=(0,A.Z)(function*(p){const c=(0,$.m9)(p);yield Kn(c),yield c.auth._persistUserIfCurrent(c),c.auth._notifyListenersIfCurrent(c)})).apply(this,arguments)}function Xs(){return(Xs=(0,A.Z)(function*(p,c){const h=yield Ae(p,{},(0,A.Z)(function*(){const g=(0,$.xO)({grant_type:"refresh_token",refresh_token:c}).slice(1),{tokenApiHost:y,apiKey:w}=p.config,N=wt(p,y,"/v1/token",`key=${w}`),j=yield p._getAdditionalHeaders();return j["Content-Type"]="application/x-www-form-urlencoded",H.fetch()(N,{method:"POST",headers:j,body:g})}));return{accessToken:h.access_token,expiresIn:h.expires_in,refreshToken:h.refresh_token}})).apply(this,arguments)}function b(){return(b=(0,A.Z)(function*(p,c){return J(p,"POST","/v2/accounts:revokeToken",B(p,c))})).apply(this,arguments)}class I{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(c){se(c.idToken,"internal-error"),se(typeof c.idToken<"u","internal-error"),se(typeof c.refreshToken<"u","internal-error");const h="expiresIn"in c&&typeof c.expiresIn<"u"?Number(c.expiresIn):function So(p){const c=mi(p);return se(c,"internal-error"),se(typeof c.exp<"u","internal-error"),se(typeof c.iat<"u","internal-error"),Number(c.exp)-Number(c.iat)}(c.idToken);this.updateTokensAndExpiration(c.idToken,c.refreshToken,h)}getToken(c,h=!1){var g=this;return(0,A.Z)(function*(){return se(!g.accessToken||g.refreshToken,c,"user-token-expired"),h||!g.accessToken||g.isExpired?g.refreshToken?(yield g.refresh(c,g.refreshToken),g.accessToken):null:g.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(c,h){var g=this;return(0,A.Z)(function*(){const{accessToken:y,refreshToken:w,expiresIn:N}=yield function Do(p,c){return Xs.apply(this,arguments)}(c,h);g.updateTokensAndExpiration(y,w,Number(N))})()}updateTokensAndExpiration(c,h,g){this.refreshToken=h||null,this.accessToken=c||null,this.expirationTime=Date.now()+1e3*g}static fromJSON(c,h){const{refreshToken:g,accessToken:y,expirationTime:w}=h,N=new I;return g&&(se("string"==typeof g,"internal-error",{appName:c}),N.refreshToken=g),y&&(se("string"==typeof y,"internal-error",{appName:c}),N.accessToken=y),w&&(se("number"==typeof w,"internal-error",{appName:c}),N.expirationTime=w),N}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(c){this.accessToken=c.accessToken,this.refreshToken=c.refreshToken,this.expirationTime=c.expirationTime}_clone(){return Object.assign(new I,this.toJSON())}_performRefresh(){return Tt("not implemented")}}function C(p,c){se("string"==typeof p||typeof p>"u","internal-error",{appName:c})}class E{constructor(c){var{uid:h,auth:g,stsTokenManager:y}=c,w=(0,sn._T)(c,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new bs(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=h,this.auth=g,this.stsTokenManager=y,this.accessToken=y.accessToken,this.displayName=w.displayName||null,this.email=w.email||null,this.emailVerified=w.emailVerified||!1,this.phoneNumber=w.phoneNumber||null,this.photoURL=w.photoURL||null,this.isAnonymous=w.isAnonymous||!1,this.tenantId=w.tenantId||null,this.providerData=w.providerData?[...w.providerData]:[],this.metadata=new Ys(w.createdAt||void 0,w.lastLoginAt||void 0)}getIdToken(c){var h=this;return(0,A.Z)(function*(){const g=yield an(h,h.stsTokenManager.getToken(h.auth,c));return se(g,h.auth,"internal-error"),h.accessToken!==g&&(h.accessToken=g,yield h.auth._persistUserIfCurrent(h),h.auth._notifyListenersIfCurrent(h)),g})()}getIdTokenResult(c){return function Un(p){return gi.apply(this,arguments)}(this,c)}reload(){return function tr(p){return Jr.apply(this,arguments)}(this)}_assign(c){this!==c&&(se(this.uid===c.uid,this.auth,"internal-error"),this.displayName=c.displayName,this.photoURL=c.photoURL,this.email=c.email,this.emailVerified=c.emailVerified,this.phoneNumber=c.phoneNumber,this.isAnonymous=c.isAnonymous,this.tenantId=c.tenantId,this.providerData=c.providerData.map(h=>Object.assign({},h)),this.metadata._copy(c.metadata),this.stsTokenManager._assign(c.stsTokenManager))}_clone(c){const h=new E(Object.assign(Object.assign({},this),{auth:c,stsTokenManager:this.stsTokenManager._clone()}));return h.metadata._copy(this.metadata),h}_onReload(c){se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=c,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(c){this.reloadListener?this.reloadListener(c):this.reloadUserInfo=c}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(c,h=!1){var g=this;return(0,A.Z)(function*(){let y=!1;c.idToken&&c.idToken!==g.stsTokenManager.accessToken&&(g.stsTokenManager.updateFromServerResponse(c),y=!0),h&&(yield Kn(g)),yield g.auth._persistUserIfCurrent(g),y&&g.auth._notifyListenersIfCurrent(g)})()}delete(){var c=this;return(0,A.Z)(function*(){const h=yield c.getIdToken();return yield an(c,function fi(p,c){return Yi.apply(this,arguments)}(c.auth,{idToken:h})),c.stsTokenManager.clearRefreshToken(),c.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(c=>Object.assign({},c)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(c,h){var g,y,w,N,j,ee,Ie,_e;const nt=null!==(g=h.displayName)&&void 0!==g?g:void 0,Br=null!==(y=h.email)&&void 0!==y?y:void 0,os=null!==(w=h.phoneNumber)&&void 0!==w?w:void 0,Lo=null!==(N=h.photoURL)&&void 0!==N?N:void 0,Nd=null!==(j=h.tenantId)&&void 0!==j?j:void 0,Zy=null!==(ee=h._redirectEventId)&&void 0!==ee?ee:void 0,Mp=null!==(Ie=h.createdAt)&&void 0!==Ie?Ie:void 0,IC=null!==(_e=h.lastLoginAt)&&void 0!==_e?_e:void 0,{uid:jr,emailVerified:Md,isAnonymous:Ta,providerData:Qy,stsTokenManager:xp}=h;se(jr&&xp,c,"internal-error");const wC=I.fromJSON(this.name,xp);se("string"==typeof jr,c,"internal-error"),C(nt,c.name),C(Br,c.name),se("boolean"==typeof Md,c,"internal-error"),se("boolean"==typeof Ta,c,"internal-error"),C(os,c.name),C(Lo,c.name),C(Nd,c.name),C(Zy,c.name),C(Mp,c.name),C(IC,c.name);const kp=new E({uid:jr,auth:c,email:Br,emailVerified:Md,displayName:nt,isAnonymous:Ta,photoURL:Lo,phoneNumber:os,tenantId:Nd,stsTokenManager:wC,createdAt:Mp,lastLoginAt:IC});return Qy&&Array.isArray(Qy)&&(kp.providerData=Qy.map(TC=>Object.assign({},TC))),Zy&&(kp._redirectEventId=Zy),kp}static _fromIdTokenResponse(c,h,g=!1){return(0,A.Z)(function*(){const y=new I;y.updateFromServerResponse(h);const w=new E({uid:h.localId,auth:c,stsTokenManager:y,isAnonymous:g});return yield Kn(w),w})()}}const O=new Map;function U(p){on(p instanceof Function,"Expected a class definition");let c=O.get(p);return c?(on(c instanceof p,"Instance stored in cache mismatched with class"),c):(c=new p,O.set(p,c),c)}const Ue=(()=>{class p{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,A.Z)(function*(){return!0})()}_set(h,g){var y=this;return(0,A.Z)(function*(){y.storage[h]=g})()}_get(h){var g=this;return(0,A.Z)(function*(){const y=g.storage[h];return void 0===y?null:y})()}_remove(h){var g=this;return(0,A.Z)(function*(){delete g.storage[h]})()}_addListener(h,g){}_removeListener(h,g){}}return p.type="NONE",p})();function oe(p,c,h){return`firebase:${p}:${c}:${h}`}class we{constructor(c,h,g){this.persistence=c,this.auth=h,this.userKey=g;const{config:y,name:w}=this.auth;this.fullUserKey=oe(this.userKey,y.apiKey,w),this.fullPersistenceKey=oe("persistence",y.apiKey,w),this.boundEventHandler=h._onStorageEvent.bind(h),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(c){return this.persistence._set(this.fullUserKey,c.toJSON())}getCurrentUser(){var c=this;return(0,A.Z)(function*(){const h=yield c.persistence._get(c.fullUserKey);return h?E._fromJSON(c.auth,h):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(c){var h=this;return(0,A.Z)(function*(){if(h.persistence===c)return;const g=yield h.getCurrentUser();return yield h.removeCurrentUser(),h.persistence=c,g?h.setCurrentUser(g):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(c,h,g="authUser"){return(0,A.Z)(function*(){if(!h.length)return new we(U(Ue),c,g);const y=(yield Promise.all(h.map(function(){var Ie=(0,A.Z)(function*(_e){if(yield _e._isAvailable())return _e});return function(_e){return Ie.apply(this,arguments)}}()))).filter(Ie=>Ie);let w=y[0]||U(Ue);const N=oe(g,c.config.apiKey,c.name);let j=null;for(const Ie of h)try{const _e=yield Ie._get(N);if(_e){const nt=E._fromJSON(c,_e);Ie!==w&&(j=nt),w=Ie;break}}catch{}const ee=y.filter(Ie=>Ie._shouldAllowMigration);return w._shouldAllowMigration&&ee.length?(w=ee[0],j&&(yield w._set(N,j.toJSON())),yield Promise.all(h.map(function(){var Ie=(0,A.Z)(function*(_e){if(_e!==w)try{yield _e._remove(N)}catch{}});return function(_e){return Ie.apply(this,arguments)}}())),new we(w,c,g)):new we(w,c,g)})()}}function Le(p){const c=p.toLowerCase();if(c.includes("opera/")||c.includes("opr/")||c.includes("opios/"))return"Opera";if(da(c))return"IEMobile";if(c.includes("msie")||c.includes("trident/"))return"IE";if(c.includes("edge/"))return"Edge";if(Ke(c))return"Firefox";if(c.includes("silk/"))return"Silk";if(M(c))return"Blackberry";if(ne(c))return"Webos";if(Ye(c))return"Safari";if((c.includes("chrome/")||Or(c))&&!c.includes("edge/"))return"Chrome";if(q(c))return"Android";{const g=p.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===g?.length)return g[1]}return"Other"}function Ke(p=(0,$.z$)()){return/firefox\//i.test(p)}function Ye(p=(0,$.z$)()){const c=p.toLowerCase();return c.includes("safari/")&&!c.includes("chrome/")&&!c.includes("crios/")&&!c.includes("android")}function Or(p=(0,$.z$)()){return/crios\//i.test(p)}function da(p=(0,$.z$)()){return/iemobile/i.test(p)}function q(p=(0,$.z$)()){return/android/i.test(p)}function M(p=(0,$.z$)()){return/blackberry/i.test(p)}function ne(p=(0,$.z$)()){return/webos/i.test(p)}function me(p=(0,$.z$)()){return/iphone|ipad|ipod/i.test(p)||/macintosh/i.test(p)&&/mobile/i.test(p)}function st(p=(0,$.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(p)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(p)}function Xt(p=(0,$.z$)()){return me(p)||q(p)||ne(p)||M(p)||/windows phone/i.test(p)||da(p)}function Oi(p,c=[]){let h;switch(p){case"Browser":h=Le((0,$.z$)());break;case"Worker":h=`${Le((0,$.z$)())}-${p}`;break;default:h=p}const g=c.length?c.join(","):"FirebaseCore-web";return`${h}/JsCore/${k.SDK_VERSION}/${g}`}class ha{constructor(c){this.auth=c,this.queue=[]}pushCallback(c,h){const g=w=>new Promise((N,j)=>{try{N(c(w))}catch(ee){j(ee)}});g.onAbort=h,this.queue.push(g);const y=this.queue.length-1;return()=>{this.queue[y]=()=>Promise.resolve()}}runMiddleware(c){var h=this;return(0,A.Z)(function*(){if(h.auth.currentUser===c)return;const g=[];try{for(const y of h.queue)yield y(c),y.onAbort&&g.push(y.onAbort)}catch(y){g.reverse();for(const w of g)try{w()}catch{}throw h.auth._errorFactory.create("login-blocked",{originalMessage:y?.message})}})()}}function ts(){return(ts=(0,A.Z)(function*(p,c={}){return J(p,"GET","/v2/passwordPolicy",B(p,c))})).apply(this,arguments)}class K_{constructor(c){var h,g,y,w;const N=c.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(h=N.minPasswordLength)&&void 0!==h?h:6,N.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=N.maxPasswordLength),void 0!==N.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=N.containsLowercaseCharacter),void 0!==N.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=N.containsUppercaseCharacter),void 0!==N.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=N.containsNumericCharacter),void 0!==N.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=N.containsNonAlphanumericCharacter),this.enforcementState=c.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(y=null===(g=c.allowedNonAlphanumericCharacters)||void 0===g?void 0:g.join(""))&&void 0!==y?y:"",this.forceUpgradeOnSignin=null!==(w=c.forceUpgradeOnSignin)&&void 0!==w&&w,this.schemaVersion=c.schemaVersion}validatePassword(c){var h,g,y,w,N,j;const ee={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(c,ee),this.validatePasswordCharacterOptions(c,ee),ee.isValid&&(ee.isValid=null===(h=ee.meetsMinPasswordLength)||void 0===h||h),ee.isValid&&(ee.isValid=null===(g=ee.meetsMaxPasswordLength)||void 0===g||g),ee.isValid&&(ee.isValid=null===(y=ee.containsLowercaseLetter)||void 0===y||y),ee.isValid&&(ee.isValid=null===(w=ee.containsUppercaseLetter)||void 0===w||w),ee.isValid&&(ee.isValid=null===(N=ee.containsNumericCharacter)||void 0===N||N),ee.isValid&&(ee.isValid=null===(j=ee.containsNonAlphanumericCharacter)||void 0===j||j),ee}validatePasswordLengthOptions(c,h){const g=this.customStrengthOptions.minPasswordLength,y=this.customStrengthOptions.maxPasswordLength;g&&(h.meetsMinPasswordLength=c.length>=g),y&&(h.meetsMaxPasswordLength=c.length<=y)}validatePasswordCharacterOptions(c,h){let g;this.updatePasswordCharacterOptionsStatuses(h,!1,!1,!1,!1);for(let y=0;y<c.length;y++)g=c.charAt(y),this.updatePasswordCharacterOptionsStatuses(h,g>="a"&&g<="z",g>="A"&&g<="Z",g>="0"&&g<="9",this.allowedNonAlphanumericCharacters.includes(g))}updatePasswordCharacterOptionsStatuses(c,h,g,y,w){this.customStrengthOptions.containsLowercaseLetter&&(c.containsLowercaseLetter||(c.containsLowercaseLetter=h)),this.customStrengthOptions.containsUppercaseLetter&&(c.containsUppercaseLetter||(c.containsUppercaseLetter=g)),this.customStrengthOptions.containsNumericCharacter&&(c.containsNumericCharacter||(c.containsNumericCharacter=y)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(c.containsNonAlphanumericCharacter||(c.containsNonAlphanumericCharacter=w))}}class He{constructor(c,h,g,y){this.app=c,this.heartbeatServiceProvider=h,this.appCheckServiceProvider=g,this.config=y,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new AT(this),this.idTokenSubscription=new AT(this),this.beforeStateQueue=new ha(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mt,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=c.name,this.clientVersion=y.sdkClientVersion}_initializeWithPersistence(c,h){var g=this;return h&&(this._popupRedirectResolver=U(h)),this._initializationPromise=this.queue((0,A.Z)(function*(){var y,w;if(!g._deleted&&(g.persistenceManager=yield we.create(g,c),!g._deleted)){if(null!==(y=g._popupRedirectResolver)&&void 0!==y&&y._shouldInitProactively)try{yield g._popupRedirectResolver._initialize(g)}catch{}yield g.initializeCurrentUser(h),g.lastNotifiedUid=(null===(w=g.currentUser)||void 0===w?void 0:w.uid)||null,!g._deleted&&(g._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var c=this;return(0,A.Z)(function*(){if(c._deleted)return;const h=yield c.assertedPersistence.getCurrentUser();if(c.currentUser||h){if(c.currentUser&&h&&c.currentUser.uid===h.uid)return c._currentUser._assign(h),void(yield c.currentUser.getIdToken());yield c._updateCurrentUser(h,!0)}})()}initializeCurrentUser(c){var h=this;return(0,A.Z)(function*(){var g;const y=yield h.assertedPersistence.getCurrentUser();let w=y,N=!1;if(c&&h.config.authDomain){yield h.getOrInitRedirectPersistenceManager();const j=null===(g=h.redirectUser)||void 0===g?void 0:g._redirectEventId,ee=w?._redirectEventId,Ie=yield h.tryRedirectSignIn(c);(!j||j===ee)&&Ie?.user&&(w=Ie.user,N=!0)}if(!w)return h.directlySetCurrentUser(null);if(!w._redirectEventId){if(N)try{yield h.beforeStateQueue.runMiddleware(w)}catch(j){w=y,h._popupRedirectResolver._overrideRedirectResult(h,()=>Promise.reject(j))}return w?h.reloadAndSetCurrentUserOrClear(w):h.directlySetCurrentUser(null)}return se(h._popupRedirectResolver,h,"argument-error"),yield h.getOrInitRedirectPersistenceManager(),h.redirectUser&&h.redirectUser._redirectEventId===w._redirectEventId?h.directlySetCurrentUser(w):h.reloadAndSetCurrentUserOrClear(w)})()}tryRedirectSignIn(c){var h=this;return(0,A.Z)(function*(){let g=null;try{g=yield h._popupRedirectResolver._completeRedirectFn(h,c,!0)}catch{yield h._setRedirectUser(null)}return g})()}reloadAndSetCurrentUserOrClear(c){var h=this;return(0,A.Z)(function*(){try{yield Kn(c)}catch(g){if("auth/network-request-failed"!==g?.code)return h.directlySetCurrentUser(null)}return h.directlySetCurrentUser(c)})()}useDeviceLanguage(){this.languageCode=function Gn(){if(typeof navigator>"u")return null;const p=navigator;return p.languages&&p.languages[0]||p.language||null}()}_delete(){var c=this;return(0,A.Z)(function*(){c._deleted=!0})()}updateCurrentUser(c){var h=this;return(0,A.Z)(function*(){const g=c?(0,$.m9)(c):null;return g&&se(g.auth.config.apiKey===h.config.apiKey,h,"invalid-user-token"),h._updateCurrentUser(g&&g._clone(h))})()}_updateCurrentUser(c,h=!1){var g=this;return(0,A.Z)(function*(){if(!g._deleted)return c&&se(g.tenantId===c.tenantId,g,"tenant-id-mismatch"),h||(yield g.beforeStateQueue.runMiddleware(c)),g.queue((0,A.Z)(function*(){yield g.directlySetCurrentUser(c),g.notifyAuthListeners()}))})()}signOut(){var c=this;return(0,A.Z)(function*(){return yield c.beforeStateQueue.runMiddleware(null),(c.redirectPersistenceManager||c._popupRedirectResolver)&&(yield c._setRedirectUser(null)),c._updateCurrentUser(null,!0)})()}setPersistence(c){var h=this;return this.queue((0,A.Z)(function*(){yield h.assertedPersistence.setPersistence(U(c))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(c){var h=this;return(0,A.Z)(function*(){h._getPasswordPolicyInternal()||(yield h._updatePasswordPolicy());const g=h._getPasswordPolicyInternal();return g.schemaVersion!==h.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(h._errorFactory.create("unsupported-password-policy-schema-version",{})):g.validatePassword(c)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var c=this;return(0,A.Z)(function*(){const h=yield function G_(p){return ts.apply(this,arguments)}(c),g=new K_(h);null===c.tenantId?c._projectPasswordPolicy=g:c._tenantPasswordPolicies[c.tenantId]=g})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(c){this._errorFactory=new $.LL("auth","Firebase",c())}onAuthStateChanged(c,h,g){return this.registerStateListener(this.authStateSubscription,c,h,g)}beforeAuthStateChanged(c,h){return this.beforeStateQueue.pushCallback(c,h)}onIdTokenChanged(c,h,g){return this.registerStateListener(this.idTokenSubscription,c,h,g)}authStateReady(){return new Promise((c,h)=>{if(this.currentUser)c();else{const g=this.onAuthStateChanged(()=>{g(),c()},h)}})}revokeAccessToken(c){var h=this;return(0,A.Z)(function*(){if(h.currentUser){const g=yield h.currentUser.getIdToken(),y={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:c,idToken:g};null!=h.tenantId&&(y.tenantId=h.tenantId),yield function P(p,c){return b.apply(this,arguments)}(h,y)}})()}toJSON(){var c;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(c=this._currentUser)||void 0===c?void 0:c.toJSON()}}_setRedirectUser(c,h){var g=this;return(0,A.Z)(function*(){const y=yield g.getOrInitRedirectPersistenceManager(h);return null===c?y.removeCurrentUser():y.setCurrentUser(c)})()}getOrInitRedirectPersistenceManager(c){var h=this;return(0,A.Z)(function*(){if(!h.redirectPersistenceManager){const g=c&&U(c)||h._popupRedirectResolver;se(g,h,"argument-error"),h.redirectPersistenceManager=yield we.create(h,[U(g._redirectPersistence)],"redirectUser"),h.redirectUser=yield h.redirectPersistenceManager.getCurrentUser()}return h.redirectPersistenceManager})()}_redirectUserForId(c){var h=this;return(0,A.Z)(function*(){var g,y;return h._isInitialized&&(yield h.queue((0,A.Z)(function*(){}))),(null===(g=h._currentUser)||void 0===g?void 0:g._redirectEventId)===c?h._currentUser:(null===(y=h.redirectUser)||void 0===y?void 0:y._redirectEventId)===c?h.redirectUser:null})()}_persistUserIfCurrent(c){var h=this;return(0,A.Z)(function*(){if(c===h.currentUser)return h.queue((0,A.Z)(function*(){return h.directlySetCurrentUser(c)}))})()}_notifyListenersIfCurrent(c){c===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var c,h;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const g=null!==(h=null===(c=this.currentUser)||void 0===c?void 0:c.uid)&&void 0!==h?h:null;this.lastNotifiedUid!==g&&(this.lastNotifiedUid=g,this.authStateSubscription.next(this.currentUser))}registerStateListener(c,h,g,y){if(this._deleted)return()=>{};const w="function"==typeof h?h:h.next.bind(h);let N=!1;const j=this._isInitialized?Promise.resolve():this._initializationPromise;if(se(j,this,"internal-error"),j.then(()=>{N||w(this.currentUser)}),"function"==typeof h){const ee=c.addObserver(h,g,y);return()=>{N=!0,ee()}}{const ee=c.addObserver(h);return()=>{N=!0,ee()}}}directlySetCurrentUser(c){var h=this;return(0,A.Z)(function*(){h.currentUser&&h.currentUser!==c&&h._currentUser._stopProactiveRefresh(),c&&h.isProactiveRefreshEnabled&&c._startProactiveRefresh(),h.currentUser=c,c?yield h.assertedPersistence.setCurrentUser(c):yield h.assertedPersistence.removeCurrentUser()})()}queue(c){return this.operations=this.operations.then(c,c),this.operations}get assertedPersistence(){return se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(c){!c||this.frameworks.includes(c)||(this.frameworks.push(c),this.frameworks.sort(),this.clientVersion=Oi(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var c=this;return(0,A.Z)(function*(){var h;const g={"X-Client-Version":c.clientVersion};c.app.options.appId&&(g["X-Firebase-gmpid"]=c.app.options.appId);const y=yield null===(h=c.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===h?void 0:h.getHeartbeatsHeader();y&&(g["X-Firebase-Client"]=y);const w=yield c._getAppCheckToken();return w&&(g["X-Firebase-AppCheck"]=w),g})()}_getAppCheckToken(){var c=this;return(0,A.Z)(function*(){var h;const g=yield null===(h=c.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===h?void 0:h.getToken();return g?.error&&function Fn(p,...c){Ge.logLevel<=Te.in.WARN&&Ge.warn(`Auth (${k.SDK_VERSION}): ${p}`,...c)}(`Error while retrieving App Check token: ${g.error}`),g?.token})()}}function Ne(p){return(0,$.m9)(p)}class AT{constructor(c){this.auth=c,this.observer=null,this.addObserver=(0,$.ne)(h=>this.observer=h)}get next(){return se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Wf(p){return new Promise((c,h)=>{const g=document.createElement("script");g.setAttribute("src",p),g.onload=c,g.onerror=y=>{const w=Rt("internal-error");w.customData=y,h(w)},g.type="text/javascript",g.charset="UTF-8",function bT(){var p,c;return null!==(c=null===(p=document.getElementsByTagName("head"))||void 0===p?void 0:p[0])&&void 0!==c?c:document}().appendChild(g)})}function RT(p){return`__${p}${Math.floor(1e6*Math.random())}`}class NT{constructor(c){this.type="recaptcha-enterprise",this.auth=Ne(c)}verify(c="verify",h=!1){var g=this;return(0,A.Z)(function*(){function w(){return w=(0,A.Z)(function*(j){if(!h){if(null==j.tenantId&&null!=j._agentRecaptchaConfig)return j._agentRecaptchaConfig.siteKey;if(null!=j.tenantId&&void 0!==j._tenantRecaptchaConfigs[j.tenantId])return j._tenantRecaptchaConfigs[j.tenantId].siteKey}return new Promise(function(){var ee=(0,A.Z)(function*(Ie,_e){As(j,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(nt=>{if(void 0!==nt.recaptchaKey){const Br=new At(nt);return null==j.tenantId?j._agentRecaptchaConfig=Br:j._tenantRecaptchaConfigs[j.tenantId]=Br,Ie(Br.siteKey)}_e(new Error("recaptcha Enterprise site key undefined"))}).catch(nt=>{_e(nt)})});return function(Ie,_e){return ee.apply(this,arguments)}}())}),w.apply(this,arguments)}function N(j,ee,Ie){const _e=window.grecaptcha;En(_e)?_e.enterprise.ready(()=>{_e.enterprise.execute(j,{action:c}).then(nt=>{ee(nt)}).catch(()=>{ee("NO_RECAPTCHA")})}):Ie(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((j,ee)=>{(function y(j){return w.apply(this,arguments)})(g.auth).then(Ie=>{if(!h&&En(window.grecaptcha))N(Ie,j,ee);else{if(typeof window>"u")return void ee(new Error("RecaptchaVerifier is only supported in browser"));Wf("https://www.google.com/recaptcha/enterprise.js?render="+Ie).then(()=>{N(Ie,j,ee)}).catch(_e=>{ee(_e)})}}).catch(Ie=>{ee(Ie)})})})()}}function Z_(p,c,h){return Q_.apply(this,arguments)}function Q_(){return(Q_=(0,A.Z)(function*(p,c,h,g=!1){const y=new NT(p);let w;try{w=yield y.verify(h)}catch{w=yield y.verify(h,!0)}const N=Object.assign({},c);return Object.assign(N,g?{captchaResp:w}:{captchaResponse:w}),Object.assign(N,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(N,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),N})).apply(this,arguments)}function Li(p,c,h,g){return Y_.apply(this,arguments)}function Y_(){return Y_=(0,A.Z)(function*(p,c,h,g){var y;if(null!==(y=p._getRecaptchaConfig())&&void 0!==y&&y.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const w=yield Z_(p,c,h,"getOobCode"===h);return g(p,w)}return g(p,c).catch(function(){var w=(0,A.Z)(function*(N){if("auth/missing-recaptcha-token"===N.code){console.log(`${h} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const j=yield Z_(p,c,h,"getOobCode"===h);return g(p,j)}return Promise.reject(N)});return function(N){return w.apply(this,arguments)}}())}),Y_.apply(this,arguments)}function xT(p,c,h){const g=Ne(p);se(g._canInitEmulator,g,"emulator-config-failed"),se(/^https?:\/\//.test(c),g,"invalid-emulator-scheme");const y=!!h?.disableWarnings,w=J_(c),{host:N,port:j}=function CM(p){const c=J_(p),h=/(\/\/)?([^?#/]+)/.exec(p.substr(c.length));if(!h)return{host:"",port:null};const g=h[2].split("@").pop()||"",y=/^(\[[^\]]+\])(:|$)/.exec(g);if(y){const w=y[1];return{host:w,port:Lr(g.substr(w.length+1))}}{const[w,N]=g.split(":");return{host:w,port:Lr(N)}}}(c);g.config.emulator={url:`${w}//${N}${null===j?"":`:${j}`}/`},g.settings.appVerificationDisabledForTesting=!0,g.emulatorConfig=Object.freeze({host:N,port:j,protocol:w.replace(":",""),options:Object.freeze({disableWarnings:y})}),y||function Fe(){function p(){const c=document.createElement("p"),h=c.style;c.innerText="Running in emulator mode. Do not use with production credentials.",h.position="fixed",h.width="100%",h.backgroundColor="#ffffff",h.border=".1em solid #000000",h.color="#b50000",h.bottom="0px",h.left="0px",h.margin="0px",h.zIndex="10000",h.textAlign="center",c.classList.add("firebase-emulator-warning"),document.body.appendChild(c)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",p):p())}()}function J_(p){const c=p.indexOf(":");return c<0?"":p.substr(0,c+1)}function Lr(p){if(!p)return null;const c=Number(p);return isNaN(c)?null:c}class gl{constructor(c,h){this.providerId=c,this.signInMethod=h}toJSON(){return Tt("not implemented")}_getIdTokenResponse(c){return Tt("not implemented")}_linkToIdToken(c,h){return Tt("not implemented")}_getReauthenticationResolver(c){return Tt("not implemented")}}function kT(p,c){return ey.apply(this,arguments)}function ey(){return(ey=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:resetPassword",B(p,c))})).apply(this,arguments)}function ve(){return(ve=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function DM(p,c){return ar.apply(this,arguments)}function ar(){return(ar=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:signUp",c)})).apply(this,arguments)}function Gf(){return(Gf=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:update",B(p,c))})).apply(this,arguments)}function ty(p,c){return Kf.apply(this,arguments)}function Kf(){return(Kf=(0,A.Z)(function*(p,c){return Pt(p,"POST","/v1/accounts:signInWithPassword",B(p,c))})).apply(this,arguments)}function fa(p,c){return Xa.apply(this,arguments)}function Xa(){return(Xa=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:sendOobCode",B(p,c))})).apply(this,arguments)}function Jc(){return(Jc=(0,A.Z)(function*(p,c){return fa(p,c)})).apply(this,arguments)}function OT(p,c){return ot.apply(this,arguments)}function ot(){return(ot=(0,A.Z)(function*(p,c){return fa(p,c)})).apply(this,arguments)}function Qf(p,c){return ed.apply(this,arguments)}function ed(){return(ed=(0,A.Z)(function*(p,c){return fa(p,c)})).apply(this,arguments)}function td(){return(td=(0,A.Z)(function*(p,c){return fa(p,c)})).apply(this,arguments)}function Ft(){return(Ft=(0,A.Z)(function*(p,c){return Pt(p,"POST","/v1/accounts:signInWithEmailLink",B(p,c))})).apply(this,arguments)}function ny(){return(ny=(0,A.Z)(function*(p,c){return Pt(p,"POST","/v1/accounts:signInWithEmailLink",B(p,c))})).apply(this,arguments)}class de extends gl{constructor(c,h,g,y=null){super("password",g),this._email=c,this._password=h,this._tenantId=y}static _fromEmailAndPassword(c,h){return new de(c,h,"password")}static _fromEmailAndCode(c,h,g=null){return new de(c,h,"emailLink",g)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(c){const h="string"==typeof c?JSON.parse(c):c;if(h?.email&&h?.password){if("password"===h.signInMethod)return this._fromEmailAndPassword(h.email,h.password);if("emailLink"===h.signInMethod)return this._fromEmailAndCode(h.email,h.password,h.tenantId)}return null}_getIdTokenResponse(c){var h=this;return(0,A.Z)(function*(){switch(h.signInMethod){case"password":return Li(c,{returnSecureToken:!0,email:h._email,password:h._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",ty);case"emailLink":return function AM(p,c){return Ft.apply(this,arguments)}(c,{email:h._email,oobCode:h._password});default:lt(c,"internal-error")}})()}_linkToIdToken(c,h){var g=this;return(0,A.Z)(function*(){switch(g.signInMethod){case"password":return Li(c,{idToken:h,returnSecureToken:!0,email:g._email,password:g._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",DM);case"emailLink":return function bM(p,c){return ny.apply(this,arguments)}(c,{idToken:h,email:g._email,oobCode:g._password});default:lt(c,"internal-error")}})()}_getReauthenticationResolver(c){return this._getIdTokenResponse(c)}}function ns(p,c){return ml.apply(this,arguments)}function ml(){return(ml=(0,A.Z)(function*(p,c){return Pt(p,"POST","/v1/accounts:signInWithIdp",B(p,c))})).apply(this,arguments)}class Fi extends gl{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(c){const h=new Fi(c.providerId,c.signInMethod);return c.idToken||c.accessToken?(c.idToken&&(h.idToken=c.idToken),c.accessToken&&(h.accessToken=c.accessToken),c.nonce&&!c.pendingToken&&(h.nonce=c.nonce),c.pendingToken&&(h.pendingToken=c.pendingToken)):c.oauthToken&&c.oauthTokenSecret?(h.accessToken=c.oauthToken,h.secret=c.oauthTokenSecret):lt("argument-error"),h}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(c){const h="string"==typeof c?JSON.parse(c):c,{providerId:g,signInMethod:y}=h,w=(0,sn._T)(h,["providerId","signInMethod"]);if(!g||!y)return null;const N=new Fi(g,y);return N.idToken=w.idToken||void 0,N.accessToken=w.accessToken||void 0,N.secret=w.secret,N.nonce=w.nonce,N.pendingToken=w.pendingToken||null,N}_getIdTokenResponse(c){return ns(c,this.buildRequest())}_linkToIdToken(c,h){const g=this.buildRequest();return g.idToken=h,ns(c,g)}_getReauthenticationResolver(c){const h=this.buildRequest();return h.autoCreate=!1,ns(c,h)}buildRequest(){const c={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)c.pendingToken=this.pendingToken;else{const h={};this.idToken&&(h.id_token=this.idToken),this.accessToken&&(h.access_token=this.accessToken),this.secret&&(h.oauth_token_secret=this.secret),h.providerId=this.providerId,this.nonce&&!this.pendingToken&&(h.nonce=this.nonce),c.postBody=(0,$.xO)(h)}return c}}function _l(){return(_l=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:sendVerificationCode",B(p,c))})).apply(this,arguments)}function iy(){return(iy=(0,A.Z)(function*(p,c){return Pt(p,"POST","/v1/accounts:signInWithPhoneNumber",B(p,c))})).apply(this,arguments)}function sy(){return(sy=(0,A.Z)(function*(p,c){const h=yield Pt(p,"POST","/v1/accounts:signInWithPhoneNumber",B(p,c));if(h.temporaryProof)throw Yt(p,"account-exists-with-different-credential",h);return h})).apply(this,arguments)}const NM={USER_NOT_FOUND:"user-not-found"};function vl(){return(vl=(0,A.Z)(function*(p,c){return Pt(p,"POST","/v1/accounts:signInWithPhoneNumber",B(p,Object.assign(Object.assign({},c),{operation:"REAUTH"})),NM)})).apply(this,arguments)}class Rs extends gl{constructor(c){super("phone","phone"),this.params=c}static _fromVerification(c,h){return new Rs({verificationId:c,verificationCode:h})}static _fromTokenResponse(c,h){return new Rs({phoneNumber:c,temporaryProof:h})}_getIdTokenResponse(c){return function RM(p,c){return iy.apply(this,arguments)}(c,this._makeVerificationRequest())}_linkToIdToken(c,h){return function PM(p,c){return sy.apply(this,arguments)}(c,Object.assign({idToken:h},this._makeVerificationRequest()))}_getReauthenticationResolver(c){return function yl(p,c){return vl.apply(this,arguments)}(c,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:c,phoneNumber:h,verificationId:g,verificationCode:y}=this.params;return c&&h?{temporaryProof:c,phoneNumber:h}:{sessionInfo:g,code:y}}toJSON(){const c={providerId:this.providerId};return this.params.phoneNumber&&(c.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(c.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(c.verificationCode=this.params.verificationCode),this.params.verificationId&&(c.verificationId=this.params.verificationId),c}static fromJSON(c){"string"==typeof c&&(c=JSON.parse(c));const{verificationId:h,verificationCode:g,phoneNumber:y,temporaryProof:w}=c;return g||h||y||w?new Rs({verificationId:h,verificationCode:g,phoneNumber:y,temporaryProof:w}):null}}class El{constructor(c){var h,g,y,w,N,j;const ee=(0,$.zd)((0,$.pd)(c)),Ie=null!==(h=ee.apiKey)&&void 0!==h?h:null,_e=null!==(g=ee.oobCode)&&void 0!==g?g:null,nt=function FT(p){switch(p){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(y=ee.mode)&&void 0!==y?y:null);se(Ie&&_e&&nt,"argument-error"),this.apiKey=Ie,this.operation=nt,this.code=_e,this.continueUrl=null!==(w=ee.continueUrl)&&void 0!==w?w:null,this.languageCode=null!==(N=ee.languageCode)&&void 0!==N?N:null,this.tenantId=null!==(j=ee.tenantId)&&void 0!==j?j:null}static parseLink(c){const h=function VT(p){const c=(0,$.zd)((0,$.pd)(p)).link,h=c?(0,$.zd)((0,$.pd)(c)).deep_link_id:null,g=(0,$.zd)((0,$.pd)(p)).deep_link_id;return(g?(0,$.zd)((0,$.pd)(g)).link:null)||g||h||c||p}(c);try{return new El(h)}catch{return null}}}let Ao=(()=>{class p{constructor(){this.providerId=p.PROVIDER_ID}static credential(h,g){return de._fromEmailAndPassword(h,g)}static credentialWithLink(h,g){const y=El.parseLink(g);return se(y,"argument-error"),de._fromEmailAndCode(h,y.code,y.tenantId)}}return p.PROVIDER_ID="password",p.EMAIL_PASSWORD_SIGN_IN_METHOD="password",p.EMAIL_LINK_SIGN_IN_METHOD="emailLink",p})();class Js{constructor(c){this.providerId=c,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(c){this.defaultLanguageCode=c}setCustomParameters(c){return this.customParameters=c,this}getCustomParameters(){return this.customParameters}}class yi extends Js{constructor(){super(...arguments),this.scopes=[]}addScope(c){return this.scopes.includes(c)||this.scopes.push(c),this}getScopes(){return[...this.scopes]}}class Il extends yi{static credentialFromJSON(c){const h="string"==typeof c?JSON.parse(c):c;return se("providerId"in h&&"signInMethod"in h,"argument-error"),Fi._fromParams(h)}credential(c){return this._credential(Object.assign(Object.assign({},c),{nonce:c.rawNonce}))}_credential(c){return se(c.idToken||c.accessToken,"argument-error"),Fi._fromParams(Object.assign(Object.assign({},c),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(c){return Il.oauthCredentialFromTaggedObject(c)}static credentialFromError(c){return Il.oauthCredentialFromTaggedObject(c.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{oauthIdToken:h,oauthAccessToken:g,oauthTokenSecret:y,pendingToken:w,nonce:N,providerId:j}=c;if(!g&&!y&&!h&&!w||!j)return null;try{return new Il(j)._credential({idToken:h,accessToken:g,nonce:N,pendingToken:w})}catch{return null}}}let Y=(()=>{class p extends yi{constructor(){super("facebook.com")}static credential(h){return Fi._fromParams({providerId:p.PROVIDER_ID,signInMethod:p.FACEBOOK_SIGN_IN_METHOD,accessToken:h})}static credentialFromResult(h){return p.credentialFromTaggedObject(h)}static credentialFromError(h){return p.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h||!("oauthAccessToken"in h)||!h.oauthAccessToken)return null;try{return p.credential(h.oauthAccessToken)}catch{return null}}}return p.FACEBOOK_SIGN_IN_METHOD="facebook.com",p.PROVIDER_ID="facebook.com",p})(),oy=(()=>{class p extends yi{constructor(){super("google.com"),this.addScope("profile")}static credential(h,g){return Fi._fromParams({providerId:p.PROVIDER_ID,signInMethod:p.GOOGLE_SIGN_IN_METHOD,idToken:h,accessToken:g})}static credentialFromResult(h){return p.credentialFromTaggedObject(h)}static credentialFromError(h){return p.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h)return null;const{oauthIdToken:g,oauthAccessToken:y}=h;if(!g&&!y)return null;try{return p.credential(g,y)}catch{return null}}}return p.GOOGLE_SIGN_IN_METHOD="google.com",p.PROVIDER_ID="google.com",p})(),he=(()=>{class p extends yi{constructor(){super("github.com")}static credential(h){return Fi._fromParams({providerId:p.PROVIDER_ID,signInMethod:p.GITHUB_SIGN_IN_METHOD,accessToken:h})}static credentialFromResult(h){return p.credentialFromTaggedObject(h)}static credentialFromError(h){return p.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h||!("oauthAccessToken"in h)||!h.oauthAccessToken)return null;try{return p.credential(h.oauthAccessToken)}catch{return null}}}return p.GITHUB_SIGN_IN_METHOD="github.com",p.PROVIDER_ID="github.com",p})();class bo extends gl{constructor(c,h){super(c,c),this.pendingToken=h}_getIdTokenResponse(c){return ns(c,this.buildRequest())}_linkToIdToken(c,h){const g=this.buildRequest();return g.idToken=h,ns(c,g)}_getReauthenticationResolver(c){const h=this.buildRequest();return h.autoCreate=!1,ns(c,h)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(c){const h="string"==typeof c?JSON.parse(c):c,{providerId:g,signInMethod:y,pendingToken:w}=h;return g&&y&&w&&g===y?new bo(g,w):null}static _create(c,h){return new bo(c,h)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class rd extends Js{constructor(c){se(c.startsWith("saml."),"argument-error"),super(c)}static credentialFromResult(c){return rd.samlCredentialFromTaggedObject(c)}static credentialFromError(c){return rd.samlCredentialFromTaggedObject(c.customData||{})}static credentialFromJSON(c){const h=bo.fromJSON(c);return se(h,"argument-error"),h}static samlCredentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{pendingToken:h,providerId:g}=c;if(!h||!g)return null;try{return bo._create(g,h)}catch{return null}}}let BT=(()=>{class p extends yi{constructor(){super("twitter.com")}static credential(h,g){return Fi._fromParams({providerId:p.PROVIDER_ID,signInMethod:p.TWITTER_SIGN_IN_METHOD,oauthToken:h,oauthTokenSecret:g})}static credentialFromResult(h){return p.credentialFromTaggedObject(h)}static credentialFromError(h){return p.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h)return null;const{oauthAccessToken:g,oauthTokenSecret:y}=h;if(!g||!y)return null;try{return p.credential(g,y)}catch{return null}}}return p.TWITTER_SIGN_IN_METHOD="twitter.com",p.PROVIDER_ID="twitter.com",p})();function ay(p,c){return rs.apply(this,arguments)}function rs(){return(rs=(0,A.Z)(function*(p,c){return Pt(p,"POST","/v1/accounts:signUp",B(p,c))})).apply(this,arguments)}class Fr{constructor(c){this.user=c.user,this.providerId=c.providerId,this._tokenResponse=c._tokenResponse,this.operationType=c.operationType}static _fromIdTokenResponse(c,h,g,y=!1){return(0,A.Z)(function*(){const w=yield E._fromIdTokenResponse(c,g,y),N=Vi(g);return new Fr({user:w,providerId:N,_tokenResponse:g,operationType:h})})()}static _forOperation(c,h,g){return(0,A.Z)(function*(){yield c._updateTokensIfNecessary(g,!0);const y=Vi(g);return new Fr({user:c,providerId:y,_tokenResponse:g,operationType:h})})()}}function Vi(p){return p.providerId?p.providerId:"phoneNumber"in p?"phone":null}function Ps(p){return vt.apply(this,arguments)}function vt(){return(vt=(0,A.Z)(function*(p){var c;const h=Ne(p);if(yield h._initializationPromise,null!==(c=h.currentUser)&&void 0!==c&&c.isAnonymous)return new Fr({user:h.currentUser,providerId:null,operationType:"signIn"});const g=yield ay(h,{returnSecureToken:!0}),y=yield Fr._fromIdTokenResponse(h,"signIn",g,!0);return yield h._updateCurrentUser(y.user),y})).apply(this,arguments)}class Tl extends $.ZR{constructor(c,h,g,y){var w;super(h.code,h.message),this.operationType=g,this.user=y,Object.setPrototypeOf(this,Tl.prototype),this.customData={appName:c.name,tenantId:null!==(w=c.tenantId)&&void 0!==w?w:void 0,_serverResponse:h.customData._serverResponse,operationType:g}}static _fromErrorAndOperation(c,h,g,y){return new Tl(c,h,g,y)}}function id(p,c,h,g){return("reauthenticate"===c?h._getReauthenticationResolver(p):h._getIdTokenResponse(p)).catch(w=>{throw"auth/multi-factor-auth-required"===w.code?Tl._fromErrorAndOperation(p,w,c,g):w})}function Yf(p){return new Set(p.map(({providerId:c})=>c).filter(c=>!!c))}function uy(p,c){return pa.apply(this,arguments)}function pa(){return pa=(0,A.Z)(function*(p,c){const h=(0,$.m9)(p);yield ad(!0,h,c);const{providerUserInfo:g}=yield function Xr(p,c){return Xi.apply(this,arguments)}(h.auth,{idToken:yield h.getIdToken(),deleteProvider:[c]}),y=Yf(g||[]);return h.providerData=h.providerData.filter(w=>y.has(w.providerId)),y.has("phone")||(h.phoneNumber=null),yield h.auth._persistUserIfCurrent(h),h}),pa.apply(this,arguments)}function sd(p,c){return od.apply(this,arguments)}function od(){return(od=(0,A.Z)(function*(p,c,h=!1){const g=yield an(p,c._linkToIdToken(p.auth,yield p.getIdToken()),h);return Fr._forOperation(p,"link",g)})).apply(this,arguments)}function ad(p,c,h){return ud.apply(this,arguments)}function ud(){return(ud=(0,A.Z)(function*(p,c,h){yield Kn(c);const y=!1===p?"provider-already-linked":"no-such-provider";se(Yf(c.providerData).has(h)===p,c.auth,y)})).apply(this,arguments)}function ly(p,c){return Xf.apply(this,arguments)}function Xf(){return(Xf=(0,A.Z)(function*(p,c,h=!1){const{auth:g}=p,y="reauthenticate";try{const w=yield an(p,id(g,y,c,p),h);se(w.idToken,g,"internal-error");const N=mi(w.idToken);se(N,g,"internal-error");const{sub:j}=N;return se(p.uid===j,g,"user-mismatch"),Fr._forOperation(p,y,w)}catch(w){throw"auth/user-not-found"===w?.code&&lt(g,"user-mismatch"),w}})).apply(this,arguments)}function Ui(p,c){return Jf.apply(this,arguments)}function Jf(){return(Jf=(0,A.Z)(function*(p,c,h=!1){const g="signIn",y=yield id(p,g,c),w=yield Fr._fromIdTokenResponse(p,g,y);return h||(yield p._updateCurrentUser(w.user)),w})).apply(this,arguments)}function Cl(p,c){return ep.apply(this,arguments)}function ep(){return(ep=(0,A.Z)(function*(p,c){return Ui(Ne(p),c)})).apply(this,arguments)}function cy(p,c){return tp.apply(this,arguments)}function tp(){return(tp=(0,A.Z)(function*(p,c){const h=(0,$.m9)(p);return yield ad(!1,h,c.providerId),sd(h,c)})).apply(this,arguments)}function dy(p,c){return ld.apply(this,arguments)}function ld(){return(ld=(0,A.Z)(function*(p,c){return ly((0,$.m9)(p),c)})).apply(this,arguments)}function np(){return(np=(0,A.Z)(function*(p,c){return Pt(p,"POST","/v1/accounts:signInWithCustomToken",B(p,c))})).apply(this,arguments)}function $T(p,c){return vr.apply(this,arguments)}function vr(){return vr=(0,A.Z)(function*(p,c){const h=Ne(p),g=yield function jT(p,c){return np.apply(this,arguments)}(h,{token:c,returnSecureToken:!0}),y=yield Fr._fromIdTokenResponse(h,"signIn",g);return yield h._updateCurrentUser(y.user),y}),vr.apply(this,arguments)}class Sl{constructor(c,h){this.factorId=c,this.uid=h.mfaEnrollmentId,this.enrollmentTime=new Date(h.enrolledAt).toUTCString(),this.displayName=h.displayName}static _fromServerResponse(c,h){return"phoneInfo"in h?rp._fromServerResponse(c,h):"totpInfo"in h?Er._fromServerResponse(c,h):lt(c,"internal-error")}}class rp extends Sl{constructor(c){super("phone",c),this.phoneNumber=c.phoneInfo}static _fromServerResponse(c,h){return new rp(h)}}class Er extends Sl{constructor(c){super("totp",c)}static _fromServerResponse(c,h){return new Er(h)}}function Dl(p,c,h){var g;se((null===(g=h.url)||void 0===g?void 0:g.length)>0,p,"invalid-continue-uri"),se(typeof h.dynamicLinkDomain>"u"||h.dynamicLinkDomain.length>0,p,"invalid-dynamic-link-domain"),c.continueUrl=h.url,c.dynamicLinkDomain=h.dynamicLinkDomain,c.canHandleCodeInApp=h.handleCodeInApp,h.iOS&&(se(h.iOS.bundleId.length>0,p,"missing-ios-bundle-id"),c.iOSBundleId=h.iOS.bundleId),h.android&&(se(h.android.packageName.length>0,p,"missing-android-pkg-name"),c.androidInstallApp=h.android.installApp,c.androidMinimumVersionCode=h.android.minimumVersion,c.androidPackageName=h.android.packageName)}function ur(p){return Ir.apply(this,arguments)}function Ir(){return(Ir=(0,A.Z)(function*(p){const c=Ne(p);c._getPasswordPolicyInternal()&&(yield c._updatePasswordPolicy())})).apply(this,arguments)}function at(p,c,h){return Pn.apply(this,arguments)}function Pn(){return(Pn=(0,A.Z)(function*(p,c,h){const g=Ne(p),y={requestType:"PASSWORD_RESET",email:c,clientType:"CLIENT_TYPE_WEB"};h&&Dl(g,y,h),yield Li(g,y,"getOobCode",OT)})).apply(this,arguments)}function lr(p,c,h){return Ns.apply(this,arguments)}function Ns(){return Ns=(0,A.Z)(function*(p,c,h){yield kT((0,$.m9)(p),{oobCode:c,newPassword:h}).catch(function(){var g=(0,A.Z)(function*(y){throw"auth/password-does-not-meet-requirements"===y.code&&ur(p),y});return function(y){return g.apply(this,arguments)}}())}),Ns.apply(this,arguments)}function wr(p,c){return cd.apply(this,arguments)}function cd(){return cd=(0,A.Z)(function*(p,c){yield function Xc(p,c){return Gf.apply(this,arguments)}((0,$.m9)(p),{oobCode:c})}),cd.apply(this,arguments)}function ip(p,c){return Ja.apply(this,arguments)}function Ja(){return(Ja=(0,A.Z)(function*(p,c){const h=(0,$.m9)(p),g=yield kT(h,{oobCode:c}),y=g.requestType;switch(se(y,h,"internal-error"),y){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":se(g.newEmail,h,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":se(g.mfaInfo,h,"internal-error");default:se(g.email,h,"internal-error")}let w=null;return g.mfaInfo&&(w=Sl._fromServerResponse(Ne(h),g.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===g.requestType?g.newEmail:g.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===g.requestType?g.email:g.newEmail)||null,multiFactorInfo:w},operation:y}})).apply(this,arguments)}function HT(p,c){return sp.apply(this,arguments)}function sp(){return(sp=(0,A.Z)(function*(p,c){const{data:h}=yield ip((0,$.m9)(p),c);return h.email})).apply(this,arguments)}function In(p,c,h){return le.apply(this,arguments)}function le(){return(le=(0,A.Z)(function*(p,c,h){const g=Ne(p),N=yield Li(g,{returnSecureToken:!0,email:c,password:h,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ay).catch(ee=>{throw"auth/password-does-not-meet-requirements"===ee.code&&ur(p),ee}),j=yield Fr._fromIdTokenResponse(g,"signIn",N);return yield g._updateCurrentUser(j.user),j})).apply(this,arguments)}function Re(p,c,h){return Cl((0,$.m9)(p),Ao.credential(c,h)).catch(function(){var g=(0,A.Z)(function*(y){throw"auth/password-does-not-meet-requirements"===y.code&&ur(p),y});return function(y){return g.apply(this,arguments)}}())}function un(p,c,h){return vi.apply(this,arguments)}function vi(){return(vi=(0,A.Z)(function*(p,c,h){const g=Ne(p),y={requestType:"EMAIL_SIGNIN",email:c,clientType:"CLIENT_TYPE_WEB"};(function w(N,j){se(j.handleCodeInApp,g,"argument-error"),j&&Dl(g,N,j)})(y,h),yield Li(g,y,"getOobCode",Qf)})).apply(this,arguments)}function Tr(p,c){const h=El.parseLink(c);return"EMAIL_SIGNIN"===h?.operation}function is(p,c,h){return Ro.apply(this,arguments)}function Ro(){return(Ro=(0,A.Z)(function*(p,c,h){const g=(0,$.m9)(p),y=Ao.credentialWithLink(c,h||Vn());return se(y._tenantId===(g.tenantId||null),g,"tenant-id-mismatch"),Cl(g,y)})).apply(this,arguments)}function cr(){return(cr=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:createAuthUri",B(p,c))})).apply(this,arguments)}function eo(p,c){return je.apply(this,arguments)}function je(){return je=(0,A.Z)(function*(p,c){const g={identifier:c,continueUri:Qr()?Vn():"http://localhost"},{signinMethods:y}=yield function Gt(p,c){return cr.apply(this,arguments)}((0,$.m9)(p),g);return y||[]}),je.apply(this,arguments)}function Al(p,c){return dd.apply(this,arguments)}function dd(){return dd=(0,A.Z)(function*(p,c){const h=(0,$.m9)(p),y={requestType:"VERIFY_EMAIL",idToken:yield p.getIdToken()};c&&Dl(h.auth,y,c);const{email:w}=yield function Zf(p,c){return Jc.apply(this,arguments)}(h.auth,y);w!==p.email&&(yield p.reload())}),dd.apply(this,arguments)}function eu(p,c,h){return en.apply(this,arguments)}function en(){return en=(0,A.Z)(function*(p,c,h){const g=(0,$.m9)(p),w={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield p.getIdToken(),newEmail:c};h&&Dl(g.auth,w,h);const{email:N}=yield function ei(p,c){return td.apply(this,arguments)}(g.auth,w);N!==p.email&&(yield p.reload())}),en.apply(this,arguments)}function Po(){return(Po=(0,A.Z)(function*(p,c){return J(p,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function Ms(p,c){return ga.apply(this,arguments)}function ga(){return ga=(0,A.Z)(function*(p,{displayName:c,photoURL:h}){if(void 0===c&&void 0===h)return;const g=(0,$.m9)(p),w={idToken:yield g.getIdToken(),displayName:c,photoUrl:h,returnSecureToken:!0},N=yield an(g,function bl(p,c){return Po.apply(this,arguments)}(g.auth,w));g.displayName=N.displayName||null,g.photoURL=N.photoUrl||null;const j=g.providerData.find(({providerId:ee})=>"password"===ee);j&&(j.displayName=g.displayName,j.photoURL=g.photoURL),yield g._updateTokensIfNecessary(N)}),ga.apply(this,arguments)}function hy(p,c){return Rl((0,$.m9)(p),c,null)}function No(p,c){return Rl((0,$.m9)(p),null,c)}function Rl(p,c,h){return to.apply(this,arguments)}function to(){return to=(0,A.Z)(function*(p,c,h){const{auth:g}=p,w={idToken:yield p.getIdToken(),returnSecureToken:!0};c&&(w.email=c),h&&(w.password=h);const N=yield an(p,function SM(p,c){return ve.apply(this,arguments)}(g,w));yield p._updateTokensIfNecessary(N,!0)}),to.apply(this,arguments)}class Mo{constructor(c,h,g={}){this.isNewUser=c,this.providerId=h,this.profile=g}}class tu extends Mo{constructor(c,h,g,y){super(c,h,g),this.username=y}}class xs extends Mo{constructor(c,h){super(c,"facebook.com",h)}}class hd extends tu{constructor(c,h){super(c,"github.com",h,"string"==typeof h?.login?h?.login:null)}}class nu extends Mo{constructor(c,h){super(c,"google.com",h)}}class Nn extends tu{constructor(c,h,g){super(c,"twitter.com",h,g)}}function ru(p){const{user:c,_tokenResponse:h}=p;return c.isAnonymous&&!h?{providerId:null,isNewUser:!1,profile:null}:function ze(p){var c,h;if(!p)return null;const{providerId:g}=p,y=p.rawUserInfo?JSON.parse(p.rawUserInfo):{},w=p.isNewUser||"identitytoolkit#SignupNewUserResponse"===p.kind;if(!g&&p?.idToken){const N=null===(h=null===(c=mi(p.idToken))||void 0===c?void 0:c.firebase)||void 0===h?void 0:h.sign_in_provider;if(N)return new Mo(w,"anonymous"!==N&&"custom"!==N?N:null)}if(!g)return null;switch(g){case"facebook.com":return new xs(w,y);case"github.com":return new hd(w,y);case"google.com":return new nu(w,y);case"twitter.com":return new Nn(w,y,p.screenName||null);case"custom":case"anonymous":return new Mo(w,null);default:return new Mo(w,g,y)}}(h)}function Pl(p,c,h,g){return(0,$.m9)(p).onIdTokenChanged(c,h,g)}class iu{constructor(c,h,g){this.type=c,this.credential=h,this.user=g}static _fromIdtoken(c,h){return new iu("enroll",c,h)}static _fromMfaPendingCredential(c){return new iu("signin",c)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(c){var h,g;if(c?.multiFactorSession){if(null!==(h=c.multiFactorSession)&&void 0!==h&&h.pendingCredential)return iu._fromMfaPendingCredential(c.multiFactorSession.pendingCredential);if(null!==(g=c.multiFactorSession)&&void 0!==g&&g.idToken)return iu._fromIdtoken(c.multiFactorSession.idToken)}return null}}class my{constructor(c,h,g){this.session=c,this.hints=h,this.signInResolver=g}static _fromError(c,h){const g=Ne(c),y=h.customData._serverResponse,w=(y.mfaInfo||[]).map(j=>Sl._fromServerResponse(g,j));se(y.mfaPendingCredential,g,"internal-error");const N=iu._fromMfaPendingCredential(y.mfaPendingCredential);return new my(N,w,function(){var j=(0,A.Z)(function*(ee){const Ie=yield ee._process(g,N);delete y.mfaInfo,delete y.mfaPendingCredential;const _e=Object.assign(Object.assign({},y),{idToken:Ie.idToken,refreshToken:Ie.refreshToken});switch(h.operationType){case"signIn":const nt=yield Fr._fromIdTokenResponse(g,h.operationType,_e);return yield g._updateCurrentUser(nt.user),nt;case"reauthenticate":return se(h.user,g,"internal-error"),Fr._forOperation(h.user,h.operationType,_e);default:lt(g,"internal-error")}});return function(ee){return j.apply(this,arguments)}}())}resolveSignIn(c){var h=this;return(0,A.Z)(function*(){return h.signInResolver(c)})()}}function OM(p,c){var h;const g=(0,$.m9)(p),y=c;return se(c.customData.operationType,g,"argument-error"),se(null===(h=y.customData._serverResponse)||void 0===h?void 0:h.mfaPendingCredential,g,"argument-error"),my._fromError(g,y)}class _y{constructor(c){this.user=c,this.enrolledFactors=[],c._onReload(h=>{h.mfaInfo&&(this.enrolledFactors=h.mfaInfo.map(g=>Sl._fromServerResponse(c.auth,g)))})}static _fromUser(c){return new _y(c)}getSession(){var c=this;return(0,A.Z)(function*(){return iu._fromIdtoken(yield c.user.getIdToken(),c.user)})()}enroll(c,h){var g=this;return(0,A.Z)(function*(){const y=c,w=yield g.getSession(),N=yield an(g.user,y._process(g.user.auth,w,h));return yield g.user._updateTokensIfNecessary(N),g.user.reload()})()}unenroll(c){var h=this;return(0,A.Z)(function*(){const g="string"==typeof c?c:c.uid,y=yield h.user.getIdToken();try{const w=yield an(h.user,function UM(p,c){return J(p,"POST","/v2/accounts/mfaEnrollment:withdraw",B(p,c))}(h.user.auth,{idToken:y,mfaEnrollmentId:g}));h.enrolledFactors=h.enrolledFactors.filter(({uid:N})=>N!==g),yield h.user._updateTokensIfNecessary(w),yield h.user.reload()}catch(w){throw w}})()}}const yy=new WeakMap;function BM(p){const c=(0,$.m9)(p);return yy.has(c)||yy.set(c,_y._fromUser(c)),yy.get(c)}const op="__sak";class ap{constructor(c,h){this.storageRetriever=c,this.type=h}_isAvailable(){try{return this.storage?(this.storage.setItem(op,"1"),this.storage.removeItem(op),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(c,h){return this.storage.setItem(c,JSON.stringify(h)),Promise.resolve()}_get(c){const h=this.storage.getItem(c);return Promise.resolve(h?JSON.parse(h):null)}_remove(c){return this.storage.removeItem(c),Promise.resolve()}get storage(){return this.storageRetriever()}}const WT=(()=>{class p extends ap{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(h,g)=>this.onStorageEvent(h,g),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function vy(){const p=(0,$.z$)();return Ye(p)||me(p)}()&&function Jt(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=Xt(),this._shouldAllowMigration=!0}forAllChangedKeys(h){for(const g of Object.keys(this.listeners)){const y=this.storage.getItem(g),w=this.localCache[g];y!==w&&h(g,w,y)}}onStorageEvent(h,g=!1){if(!h.key)return void this.forAllChangedKeys((j,ee,Ie)=>{this.notifyListeners(j,Ie)});const y=h.key;if(g?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const j=this.storage.getItem(y);if(h.newValue!==j)null!==h.newValue?this.storage.setItem(y,h.newValue):this.storage.removeItem(y);else if(this.localCache[y]===h.newValue&&!g)return}const w=()=>{const j=this.storage.getItem(y);!g&&this.localCache[y]===j||this.notifyListeners(y,j)},N=this.storage.getItem(y);!function V(){return(0,$.w1)()&&10===document.documentMode}()||N===h.newValue||h.newValue===h.oldValue?w():setTimeout(w,10)}notifyListeners(h,g){this.localCache[h]=g;const y=this.listeners[h];if(y)for(const w of Array.from(y))w(g&&JSON.parse(g))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((h,g,y)=>{this.onStorageEvent(new StorageEvent("storage",{key:h,oldValue:g,newValue:y}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(h,g){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[h]||(this.listeners[h]=new Set,this.localCache[h]=this.storage.getItem(h)),this.listeners[h].add(g)}_removeListener(h,g){this.listeners[h]&&(this.listeners[h].delete(g),0===this.listeners[h].size&&delete this.listeners[h]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(h,g){var y=()=>super._set,w=this;return(0,A.Z)(function*(){yield y().call(w,h,g),w.localCache[h]=JSON.stringify(g)})()}_get(h){var g=()=>super._get,y=this;return(0,A.Z)(function*(){const w=yield g().call(y,h);return y.localCache[h]=JSON.stringify(w),w})()}_remove(h){var g=()=>super._remove,y=this;return(0,A.Z)(function*(){yield g().call(y,h),delete y.localCache[h]})()}}return p.type="LOCAL",p})(),up=(()=>{class p extends ap{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(h,g){}_removeListener(h,g){}}return p.type="SESSION",p})();let Ey=(()=>{class p{constructor(h){this.eventTarget=h,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(h){const g=this.receivers.find(w=>w.isListeningto(h));if(g)return g;const y=new p(h);return this.receivers.push(y),y}isListeningto(h){return this.eventTarget===h}handleEvent(h){var g=this;return(0,A.Z)(function*(){const y=h,{eventId:w,eventType:N,data:j}=y.data,ee=g.handlersMap[N];if(!ee?.size)return;y.ports[0].postMessage({status:"ack",eventId:w,eventType:N});const Ie=Array.from(ee).map(function(){var nt=(0,A.Z)(function*(Br){return Br(y.origin,j)});return function(Br){return nt.apply(this,arguments)}}()),_e=yield function ma(p){return Promise.all(p.map(function(){var c=(0,A.Z)(function*(h){try{return{fulfilled:!0,value:yield h}}catch(g){return{fulfilled:!1,reason:g}}});return function(h){return c.apply(this,arguments)}}()))}(Ie);y.ports[0].postMessage({status:"done",eventId:w,eventType:N,response:_e})})()}_subscribe(h,g){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[h]||(this.handlersMap[h]=new Set),this.handlersMap[h].add(g)}_unsubscribe(h,g){this.handlersMap[h]&&g&&this.handlersMap[h].delete(g),(!g||0===this.handlersMap[h].size)&&delete this.handlersMap[h],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return p.receivers=[],p})();function Ml(p="",c=10){let h="";for(let g=0;g<c;g++)h+=Math.floor(10*Math.random());return p+h}class qT{constructor(c){this.target=c,this.handlers=new Set}removeMessageHandler(c){c.messageChannel&&(c.messageChannel.port1.removeEventListener("message",c.onMessage),c.messageChannel.port1.close()),this.handlers.delete(c)}_send(c,h,g=50){var y=this;return(0,A.Z)(function*(){const w=typeof MessageChannel<"u"?new MessageChannel:null;if(!w)throw new Error("connection_unavailable");let N,j;return new Promise((ee,Ie)=>{const _e=Ml("",20);w.port1.start();const nt=setTimeout(()=>{Ie(new Error("unsupported_event"))},g);j={messageChannel:w,onMessage(Br){const os=Br;if(os.data.eventId===_e)switch(os.data.status){case"ack":clearTimeout(nt),N=setTimeout(()=>{Ie(new Error("timeout"))},3e3);break;case"done":clearTimeout(N),ee(os.data.response);break;default:clearTimeout(nt),clearTimeout(N),Ie(new Error("invalid_response"))}}},y.handlers.add(j),w.port1.addEventListener("message",j.onMessage),y.target.postMessage({eventType:c,eventId:_e,data:h},[w.port2])}).finally(()=>{j&&y.removeMessageHandler(j)})})()}}function Mn(){return window}function lp(){return typeof Mn().WorkerGlobalScope<"u"&&"function"==typeof Mn().importScripts}function dp(){return(dp=(0,A.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const hp="firebaseLocalStorageDb",fd="firebaseLocalStorage",GT="fbase_key";class Nt{constructor(c){this.request=c}toPromise(){return new Promise((c,h)=>{this.request.addEventListener("success",()=>{c(this.request.result)}),this.request.addEventListener("error",()=>{h(this.request.error)})})}}function ou(p,c){return p.transaction([fd],c?"readwrite":"readonly").objectStore(fd)}function hr(){const p=indexedDB.open(hp,1);return new Promise((c,h)=>{p.addEventListener("error",()=>{h(p.error)}),p.addEventListener("upgradeneeded",()=>{const g=p.result;try{g.createObjectStore(fd,{keyPath:GT})}catch(y){h(y)}}),p.addEventListener("success",(0,A.Z)(function*(){const g=p.result;g.objectStoreNames.contains(fd)?c(g):(g.close(),yield function xl(){const p=indexedDB.deleteDatabase(hp);return new Nt(p).toPromise()}(),c(yield hr()))}))})}function Cy(p,c,h){return _a.apply(this,arguments)}function _a(){return(_a=(0,A.Z)(function*(p,c,h){const g=ou(p,!0).put({[GT]:c,value:h});return new Nt(g).toPromise()})).apply(this,arguments)}function Vr(){return(Vr=(0,A.Z)(function*(p,c){const h=ou(p,!1).get(c),g=yield new Nt(h).toPromise();return void 0===g?null:g.value})).apply(this,arguments)}function Sy(p,c){const h=ou(p,!0).delete(c);return new Nt(h).toPromise()}const pp=(()=>{class p{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var h=this;return(0,A.Z)(function*(){return h.db||(h.db=yield hr()),h.db})()}_withRetries(h){var g=this;return(0,A.Z)(function*(){let y=0;for(;;)try{const w=yield g._openDb();return yield h(w)}catch(w){if(y++>3)throw w;g.db&&(g.db.close(),g.db=void 0)}})()}initializeServiceWorkerMessaging(){var h=this;return(0,A.Z)(function*(){return lp()?h.initializeReceiver():h.initializeSender()})()}initializeReceiver(){var h=this;return(0,A.Z)(function*(){h.receiver=Ey._getInstance(function wy(){return lp()?self:null}()),h.receiver._subscribe("keyChanged",function(){var g=(0,A.Z)(function*(y,w){return{keyProcessed:(yield h._poll()).includes(w.key)}});return function(y,w){return g.apply(this,arguments)}}()),h.receiver._subscribe("ping",function(){var g=(0,A.Z)(function*(y,w){return["keyChanged"]});return function(y,w){return g.apply(this,arguments)}}())})()}initializeSender(){var h=this;return(0,A.Z)(function*(){var g,y;if(h.activeServiceWorker=yield function cp(){return dp.apply(this,arguments)}(),!h.activeServiceWorker)return;h.sender=new qT(h.activeServiceWorker);const w=yield h.sender._send("ping",{},800);w&&null!==(g=w[0])&&void 0!==g&&g.fulfilled&&null!==(y=w[0])&&void 0!==y&&y.value.includes("keyChanged")&&(h.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(h){var g=this;return(0,A.Z)(function*(){if(g.sender&&g.activeServiceWorker&&function ks(){var p;return(null===(p=navigator?.serviceWorker)||void 0===p?void 0:p.controller)||null}()===g.activeServiceWorker)try{yield g.sender._send("keyChanged",{key:h},g.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,A.Z)(function*(){try{if(!indexedDB)return!1;const h=yield hr();return yield Cy(h,op,"1"),yield Sy(h,op),!0}catch{}return!1})()}_withPendingWrite(h){var g=this;return(0,A.Z)(function*(){g.pendingWrites++;try{yield h()}finally{g.pendingWrites--}})()}_set(h,g){var y=this;return(0,A.Z)(function*(){return y._withPendingWrite((0,A.Z)(function*(){return yield y._withRetries(w=>Cy(w,h,g)),y.localCache[h]=g,y.notifyServiceWorker(h)}))})()}_get(h){var g=this;return(0,A.Z)(function*(){const y=yield g._withRetries(w=>function au(p,c){return Vr.apply(this,arguments)}(w,h));return g.localCache[h]=y,y})()}_remove(h){var g=this;return(0,A.Z)(function*(){return g._withPendingWrite((0,A.Z)(function*(){return yield g._withRetries(y=>Sy(y,h)),delete g.localCache[h],g.notifyServiceWorker(h)}))})()}_poll(){var h=this;return(0,A.Z)(function*(){const g=yield h._withRetries(N=>{const j=ou(N,!1).getAll();return new Nt(j).toPromise()});if(!g)return[];if(0!==h.pendingWrites)return[];const y=[],w=new Set;if(0!==g.length)for(const{fbase_key:N,value:j}of g)w.add(N),JSON.stringify(h.localCache[N])!==JSON.stringify(j)&&(h.notifyListeners(N,j),y.push(N));for(const N of Object.keys(h.localCache))h.localCache[N]&&!w.has(N)&&(h.notifyListeners(N,null),y.push(N));return y})()}notifyListeners(h,g){this.localCache[h]=g;const y=this.listeners[h];if(y)for(const w of Array.from(y))w(g)}startPolling(){var h=this;this.stopPolling(),this.pollTimer=setInterval((0,A.Z)(function*(){return h._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(h,g){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[h]||(this.listeners[h]=new Set,this._get(h)),this.listeners[h].add(g)}_removeListener(h,g){this.listeners[h]&&(this.listeners[h].delete(g),0===this.listeners[h].size&&delete this.listeners[h]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return p.type="LOCAL",p})(),ya=1e12;class mp{constructor(c){this.auth=c,this.counter=ya,this._widgets=new Map}render(c,h){const g=this.counter;return this._widgets.set(g,new Be(c,this.auth.name,h||{})),this.counter++,g}reset(c){var h;const g=c||ya;null===(h=this._widgets.get(g))||void 0===h||h.delete(),this._widgets.delete(g)}getResponse(c){var h;return(null===(h=this._widgets.get(c||ya))||void 0===h?void 0:h.getResponse())||""}execute(c){var h=this;return(0,A.Z)(function*(){var g;return null===(g=h._widgets.get(c||ya))||void 0===g||g.execute(),""})()}}class Be{constructor(c,h,g){this.params=g,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const y="string"==typeof c?document.getElementById(c):c;se(y,"argument-error",{appName:h}),this.container=y,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function by(p){const c=[],h="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let g=0;g<p;g++)c.push(h.charAt(Math.floor(62*Math.random())));return c.join("")}(50);const{callback:c,"expired-callback":h}=this.params;if(c)try{c(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,h)try{h()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Ry=RT("rcb"),QT=new hi(3e4,6e4);class XT{constructor(){var c;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(c=Mn().grecaptcha)||void 0===c||!c.render)}load(c,h=""){return se(function Py(p){return p.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(p)}(h),c,"argument-error"),this.shouldResolveImmediately(h)&&Rn(Mn().grecaptcha)?Promise.resolve(Mn().grecaptcha):new Promise((g,y)=>{const w=Mn().setTimeout(()=>{y(Rt(c,"network-request-failed"))},QT.get());Mn()[Ry]=()=>{Mn().clearTimeout(w),delete Mn()[Ry];const j=Mn().grecaptcha;if(!j||!Rn(j))return void y(Rt(c,"internal-error"));const ee=j.render;j.render=(Ie,_e)=>{const nt=ee(Ie,_e);return this.counter++,nt},this.hostLanguage=h,g(j)},Wf(`https://www.google.com/recaptcha/api.js??${(0,$.xO)({onload:Ry,render:"explicit",hl:h})}`).catch(()=>{clearTimeout(w),y(Rt(c,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(c){var h;return!(null===(h=Mn().grecaptcha)||void 0===h||!h.render)&&(c===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class uu{load(c){return(0,A.Z)(function*(){return new mp(c)})()}clearedOneInstance(){}}const Ny="recaptcha",JT={theme:"light",type:"image"};class eC{constructor(c,h,g=Object.assign({},JT)){this.parameters=g,this.type=Ny,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ne(c),this.isInvisible="invisible"===this.parameters.size,se(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const y="string"==typeof h?document.getElementById(h):h;se(y,this.auth,"argument-error"),this.container=y,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new uu:new XT,this.validateStartingState()}verify(){var c=this;return(0,A.Z)(function*(){c.assertNotDestroyed();const h=yield c.render(),g=c.getAssertedRecaptcha();return g.getResponse(h)||new Promise(w=>{const N=j=>{j&&(c.tokenChangeListeners.delete(N),w(j))};c.tokenChangeListeners.add(N),c.isInvisible&&g.execute(h)})})()}render(){try{this.assertNotDestroyed()}catch(c){return Promise.reject(c)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(c=>{throw this.renderPromise=null,c})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(c=>{this.container.removeChild(c)})}validateStartingState(){se(!this.parameters.sitekey,this.auth,"argument-error"),se(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),se(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(c){return h=>{if(this.tokenChangeListeners.forEach(g=>g(h)),"function"==typeof c)c(h);else if("string"==typeof c){const g=Mn()[c];"function"==typeof g&&g(h)}}}assertNotDestroyed(){se(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var c=this;return(0,A.Z)(function*(){if(yield c.init(),!c.widgetId){let h=c.container;if(!c.isInvisible){const g=document.createElement("div");h.appendChild(g),h=g}c.widgetId=c.getAssertedRecaptcha().render(h,c.parameters)}return c.widgetId})()}init(){var c=this;return(0,A.Z)(function*(){se(Qr()&&!lp(),c.auth,"internal-error"),yield function tC(){let p=null;return new Promise(c=>{"complete"!==document.readyState?(p=()=>c(),window.addEventListener("load",p)):c()}).catch(c=>{throw p&&window.removeEventListener("load",p),c})}(),c.recaptcha=yield c._recaptchaLoader.load(c.auth,c.auth.languageCode||void 0);const h=yield function Yr(p){return xi.apply(this,arguments)}(c.auth);se(h,c.auth,"internal-error"),c.parameters.sitekey=h})()}getAssertedRecaptcha(){return se(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class _p{constructor(c,h){this.verificationId=c,this.onConfirmation=h}confirm(c){const h=Rs._fromVerification(this.verificationId,c);return this.onConfirmation(h)}}function K(p,c,h){return ht.apply(this,arguments)}function ht(){return(ht=(0,A.Z)(function*(p,c,h){const g=Ne(p),y=yield xo(g,c,(0,$.m9)(h));return new _p(y,w=>Cl(g,w))})).apply(this,arguments)}function nC(p,c,h){return yp.apply(this,arguments)}function yp(){return(yp=(0,A.Z)(function*(p,c,h){const g=(0,$.m9)(p);yield ad(!1,g,"phone");const y=yield xo(g.auth,c,(0,$.m9)(h));return new _p(y,w=>cy(g,w))})).apply(this,arguments)}function Vt(p,c,h){return pd.apply(this,arguments)}function pd(){return(pd=(0,A.Z)(function*(p,c,h){const g=(0,$.m9)(p),y=yield xo(g.auth,c,(0,$.m9)(h));return new _p(y,w=>dy(g,w))})).apply(this,arguments)}function xo(p,c,h){return Bi.apply(this,arguments)}function Bi(){return Bi=(0,A.Z)(function*(p,c,h){var g;const y=yield h.verify();try{let w;if(se("string"==typeof y,p,"argument-error"),se(h.type===Ny,p,"argument-error"),w="string"==typeof c?{phoneNumber:c}:c,"session"in w){const N=w.session;if("phoneNumber"in w)return se("enroll"===N.type,p,"internal-error"),(yield function LM(p,c){return J(p,"POST","/v2/accounts/mfaEnrollment:start",B(p,c))}(p,{idToken:N.credential,phoneEnrollmentInfo:{phoneNumber:w.phoneNumber,recaptchaToken:y}})).phoneSessionInfo.sessionInfo;{se("signin"===N.type,p,"internal-error");const j=(null===(g=w.multiFactorHint)||void 0===g?void 0:g.uid)||w.multiFactorUid;return se(j,p,"missing-multi-factor-info"),(yield function ZT(p,c){return J(p,"POST","/v2/accounts/mfaSignIn:start",B(p,c))}(p,{mfaPendingCredential:N.credential,mfaEnrollmentId:j,phoneSignInInfo:{recaptchaToken:y}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:N}=yield function LT(p,c){return _l.apply(this,arguments)}(p,{phoneNumber:w.phoneNumber,recaptchaToken:y});return N}}finally{h._reset()}}),Bi.apply(this,arguments)}function vp(p,c){return Ol.apply(this,arguments)}function Ol(){return(Ol=(0,A.Z)(function*(p,c){yield sd((0,$.m9)(p),c)})).apply(this,arguments)}let rC=(()=>{class p{constructor(h){this.providerId=p.PROVIDER_ID,this.auth=Ne(h)}verifyPhoneNumber(h,g){return xo(this.auth,h,(0,$.m9)(g))}static credential(h,g){return Rs._fromVerification(h,g)}static credentialFromResult(h){return p.credentialFromTaggedObject(h)}static credentialFromError(h){return p.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h)return null;const{phoneNumber:g,temporaryProof:y}=h;return g&&y?Rs._fromTokenResponse(g,y):null}}return p.PROVIDER_ID="phone",p.PHONE_SIGN_IN_METHOD="phone",p})();function lu(p,c){return c?U(c):(se(p._popupRedirectResolver,p,"argument-error"),p._popupRedirectResolver)}class gd extends gl{constructor(c){super("custom","custom"),this.params=c}_getIdTokenResponse(c){return ns(c,this._buildIdpRequest())}_linkToIdToken(c,h){return ns(c,this._buildIdpRequest(h))}_getReauthenticationResolver(c){return ns(c,this._buildIdpRequest())}_buildIdpRequest(c){const h={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return c&&(h.idToken=c),h}}function Ur(p){return Ui(p.auth,new gd(p),p.bypassAuthState)}function io(p){const{auth:c,user:h}=p;return se(h,c,"internal-error"),ly(h,new gd(p),p.bypassAuthState)}function My(p){return ji.apply(this,arguments)}function ji(){return(ji=(0,A.Z)(function*(p){const{auth:c,user:h}=p;return se(h,c,"internal-error"),sd(h,new gd(p),p.bypassAuthState)})).apply(this,arguments)}class Os{constructor(c,h,g,y,w=!1){this.auth=c,this.resolver=g,this.user=y,this.bypassAuthState=w,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(h)?h:[h]}execute(){var c=this;return new Promise(function(){var h=(0,A.Z)(function*(g,y){c.pendingPromise={resolve:g,reject:y};try{c.eventManager=yield c.resolver._initialize(c.auth),yield c.onExecution(),c.eventManager.registerConsumer(c)}catch(w){c.reject(w)}});return function(g,y){return h.apply(this,arguments)}}())}onAuthEvent(c){var h=this;return(0,A.Z)(function*(){const{urlResponse:g,sessionId:y,postBody:w,tenantId:N,error:j,type:ee}=c;if(j)return void h.reject(j);const Ie={auth:h.auth,requestUri:g,sessionId:y,tenantId:N||void 0,postBody:w||void 0,user:h.user,bypassAuthState:h.bypassAuthState};try{h.resolve(yield h.getIdpTask(ee)(Ie))}catch(_e){h.reject(_e)}})()}onError(c){this.reject(c)}getIdpTask(c){switch(c){case"signInViaPopup":case"signInViaRedirect":return Ur;case"linkViaPopup":case"linkViaRedirect":return My;case"reauthViaPopup":case"reauthViaRedirect":return io;default:lt(this.auth,"internal-error")}}resolve(c){on(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(c),this.unregisterAndCleanUp()}reject(c){on(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(c),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const iC=new hi(2e3,1e4);function xy(p,c,h){return Ep.apply(this,arguments)}function Ep(){return(Ep=(0,A.Z)(function*(p,c,h){const g=Ne(p);bn(p,c,Js);const y=lu(g,h);return new Fl(g,"signInViaPopup",c,y).executeNotNull()})).apply(this,arguments)}function sC(p,c,h){return Ll.apply(this,arguments)}function Ll(){return(Ll=(0,A.Z)(function*(p,c,h){const g=(0,$.m9)(p);bn(g.auth,c,Js);const y=lu(g.auth,h);return new Fl(g.auth,"reauthViaPopup",c,y,g).executeNotNull()})).apply(this,arguments)}function Ip(p,c,h){return md.apply(this,arguments)}function md(){return(md=(0,A.Z)(function*(p,c,h){const g=(0,$.m9)(p);bn(g.auth,c,Js);const y=lu(g.auth,h);return new Fl(g.auth,"linkViaPopup",c,y,g).executeNotNull()})).apply(this,arguments)}let Fl=(()=>{class p extends Os{constructor(h,g,y,w,N){super(h,g,w,N),this.provider=y,this.authWindow=null,this.pollId=null,p.currentPopupAction&&p.currentPopupAction.cancel(),p.currentPopupAction=this}executeNotNull(){var h=this;return(0,A.Z)(function*(){const g=yield h.execute();return se(g,h.auth,"internal-error"),g})()}onExecution(){var h=this;return(0,A.Z)(function*(){on(1===h.filter.length,"Popup operations only handle one event");const g=Ml();h.authWindow=yield h.resolver._openPopup(h.auth,h.provider,h.filter[0],g),h.authWindow.associatedEvent=g,h.resolver._originValidation(h.auth).catch(y=>{h.reject(y)}),h.resolver._isIframeWebStorageSupported(h.auth,y=>{y||h.reject(Rt(h.auth,"web-storage-unsupported"))}),h.pollUserCancellation()})()}get eventId(){var h;return(null===(h=this.authWindow)||void 0===h?void 0:h.associatedEvent)||null}cancel(){this.reject(Rt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,p.currentPopupAction=null}pollUserCancellation(){const h=()=>{var g,y;this.pollId=null!==(y=null===(g=this.authWindow)||void 0===g?void 0:g.window)&&void 0!==y&&y.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Rt(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(h,iC.get())};h()}}return p.currentPopupAction=null,p})();const oC="pendingRedirect",cu=new Map;class wp extends Os{constructor(c,h,g=!1){super(c,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],h,void 0,g),this.eventId=null}execute(){var c=()=>super.execute,h=this;return(0,A.Z)(function*(){let g=cu.get(h.auth._key());if(!g){try{const w=(yield function ky(p,c){return _d.apply(this,arguments)}(h.resolver,h.auth))?yield c().call(h):null;g=()=>Promise.resolve(w)}catch(y){g=()=>Promise.reject(y)}cu.set(h.auth._key(),g)}return h.bypassAuthState||cu.set(h.auth._key(),()=>Promise.resolve(null)),g()})()}onAuthEvent(c){var h=()=>super.onAuthEvent,g=this;return(0,A.Z)(function*(){if("signInViaRedirect"===c.type)return h().call(g,c);if("unknown"!==c.type){if(c.eventId){const y=yield g.auth._redirectUserForId(c.eventId);if(y)return g.user=y,h().call(g,c);g.resolve(null)}}else g.resolve(null)})()}onExecution(){return(0,A.Z)(function*(){})()}cleanUp(){}}function _d(){return(_d=(0,A.Z)(function*(p,c){const h=ko(c),g=fr(p);if(!(yield g._isAvailable()))return!1;const y="true"===(yield g._get(h));return yield g._remove(h),y})).apply(this,arguments)}function yd(p,c){return vd.apply(this,arguments)}function vd(){return(vd=(0,A.Z)(function*(p,c){return fr(p)._set(ko(c),"true")})).apply(this,arguments)}function Tp(){cu.clear()}function Oy(p,c){cu.set(p._key(),c)}function fr(p){return U(p._redirectPersistence)}function ko(p){return oe(oC,p.config.apiKey,p.name)}function tn(p,c,h){return function aC(p,c,h){return Cp.apply(this,arguments)}(p,c,h)}function Cp(){return(Cp=(0,A.Z)(function*(p,c,h){const g=Ne(p);bn(p,c,Js),yield g._initializationPromise;const y=lu(g,h);return yield yd(y,g),y._openRedirect(g,c,"signInViaRedirect")})).apply(this,arguments)}function uC(p,c,h){return function lC(p,c,h){return Ed.apply(this,arguments)}(p,c,h)}function Ed(){return(Ed=(0,A.Z)(function*(p,c,h){const g=(0,$.m9)(p);bn(g.auth,c,Js),yield g.auth._initializationPromise;const y=lu(g.auth,h);yield yd(y,g.auth);const w=yield wd(g);return y._openRedirect(g.auth,c,"reauthViaRedirect",w)})).apply(this,arguments)}function Ly(p,c,h){return function Id(p,c,h){return Ls.apply(this,arguments)}(p,c,h)}function Ls(){return(Ls=(0,A.Z)(function*(p,c,h){const g=(0,$.m9)(p);bn(g.auth,c,Js),yield g.auth._initializationPromise;const y=lu(g.auth,h);yield ad(!1,g,c.providerId),yield yd(y,g.auth);const w=yield wd(g);return y._openRedirect(g.auth,c,"linkViaRedirect",w)})).apply(this,arguments)}function cC(p,c){return du.apply(this,arguments)}function du(){return(du=(0,A.Z)(function*(p,c){return yield Ne(p)._initializationPromise,hu(p,c,!1)})).apply(this,arguments)}function hu(p,c){return fu.apply(this,arguments)}function fu(){return(fu=(0,A.Z)(function*(p,c,h=!1){const g=Ne(p),y=lu(g,c),N=yield new wp(g,y,h).execute();return N&&!h&&(delete N.user._redirectEventId,yield g._persistUserIfCurrent(N.user),yield g._setRedirectUser(null,c)),N})).apply(this,arguments)}function wd(p){return Td.apply(this,arguments)}function Td(){return(Td=(0,A.Z)(function*(p){const c=Ml(`${p.uid}:::`);return p._redirectEventId=c,yield p.auth._setRedirectUser(p),yield p.auth._persistUserIfCurrent(p),c})).apply(this,arguments)}class Vy{constructor(c){this.auth=c,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(c){this.consumers.add(c),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,c)&&(this.sendToConsumer(this.queuedRedirectEvent,c),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(c){this.consumers.delete(c)}onEvent(c){if(this.hasEventBeenHandled(c))return!1;let h=!1;return this.consumers.forEach(g=>{this.isEventForConsumer(c,g)&&(h=!0,this.sendToConsumer(c,g),this.saveEventToCache(c))}),this.hasHandledPotentialRedirect||!function dC(p){switch(p.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return pu(p);default:return!1}}(c)||(this.hasHandledPotentialRedirect=!0,h||(this.queuedRedirectEvent=c,h=!0)),h}sendToConsumer(c,h){var g;if(c.error&&!pu(c)){const y=(null===(g=c.error.code)||void 0===g?void 0:g.split("auth/")[1])||"internal-error";h.onError(Rt(this.auth,y))}else h.onAuthEvent(c)}isEventForConsumer(c,h){const g=null===h.eventId||!!c.eventId&&c.eventId===h.eventId;return h.filter.includes(c.type)&&g}hasEventBeenHandled(c){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(va(c))}saveEventToCache(c){this.cachedEventUids.add(va(c)),this.lastProcessedEventTime=Date.now()}}function va(p){return[p.type,p.eventId,p.sessionId,p.tenantId].filter(c=>c).join("-")}function pu({type:p,error:c}){return"unknown"===p&&"auth/no-auth-event"===c?.code}function Cd(p){return Sp.apply(this,arguments)}function Sp(){return(Sp=(0,A.Z)(function*(p,c={}){return J(p,"GET","/v1/projects",c)})).apply(this,arguments)}const hC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fC=/^https?/;function Uy(){return(Uy=(0,A.Z)(function*(p){if(p.config.emulator)return;const{authorizedDomains:c}=yield Cd(p);for(const h of c)try{if(Dp(h))return}catch{}lt(p,"unauthorized-domain")})).apply(this,arguments)}function Dp(p){const c=Vn(),{protocol:h,hostname:g}=new URL(c);if(p.startsWith("chrome-extension://")){const N=new URL(p);return""===N.hostname&&""===g?"chrome-extension:"===h&&p.replace("chrome-extension://","")===c.replace("chrome-extension://",""):"chrome-extension:"===h&&N.hostname===g}if(!fC.test(h))return!1;if(hC.test(p))return g===p;const y=p.replace(/\./g,"\\.");return new RegExp("^(.+\\."+y+"|"+y+")$","i").test(g)}const Vl=new hi(3e4,6e4);function By(){const p=Mn().___jsl;if(p?.H)for(const c of Object.keys(p.H))if(p.H[c].r=p.H[c].r||[],p.H[c].L=p.H[c].L||[],p.H[c].r=[...p.H[c].L],p.CP)for(let h=0;h<p.CP.length;h++)p.CP[h]=null}let gu=null;const zM=new hi(5e3,15e3),jy="__/auth/iframe",$y="emulator/auth/iframe",pC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Fs=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gC(p){const c=p.config;se(c.authDomain,p,"auth-domain-config-required");const h=c.emulator?Mi(c,$y):`https://${p.config.authDomain}/${jy}`,g={apiKey:c.apiKey,appName:p.name,v:k.SDK_VERSION},y=Fs.get(p.config.apiHost);y&&(g.eid=y);const w=p._getFrameworks();return w.length&&(g.fw=w.join(",")),`${h}?${(0,$.xO)(g).slice(1)}`}function Bl(){return Bl=(0,A.Z)(function*(p){const c=yield function Sd(p){return gu=gu||function Ul(p){return new Promise((c,h)=>{var g,y,w;function N(){By(),gapi.load("gapi.iframes",{callback:()=>{c(gapi.iframes.getContext())},ontimeout:()=>{By(),h(Rt(p,"network-request-failed"))},timeout:Vl.get()})}if(null!==(y=null===(g=Mn().gapi)||void 0===g?void 0:g.iframes)&&void 0!==y&&y.Iframe)c(gapi.iframes.getContext());else{if(null===(w=Mn().gapi)||void 0===w||!w.load){const j=RT("iframefcb");return Mn()[j]=()=>{gapi.load?N():h(Rt(p,"network-request-failed"))},Wf(`https://apis.google.com/js/api.js?onload=${j}`).catch(ee=>h(ee))}N()}}).catch(c=>{throw gu=null,c})}(p),gu}(p),h=Mn().gapi;return se(h,p,"internal-error"),c.open({where:document.body,url:gC(p),messageHandlersFilter:h.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pC,dontclear:!0},g=>new Promise(function(){var y=(0,A.Z)(function*(w,N){yield g.restyle({setHideOnLeave:!1});const j=Rt(p,"network-request-failed"),ee=Mn().setTimeout(()=>{N(j)},zM.get());function Ie(){Mn().clearTimeout(ee),w(g)}g.ping(Ie).then(Ie,()=>{N(j)})});return function(w,N){return y.apply(this,arguments)}}()))}),Bl.apply(this,arguments)}const Hy={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class bp{constructor(c){this.window=c,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const _C="__/auth/handler",bd="emulator/auth/handler",Ea=encodeURIComponent("fac");function Rp(p,c,h,g,y,w){return Rd.apply(this,arguments)}function Rd(){return(Rd=(0,A.Z)(function*(p,c,h,g,y,w){se(p.config.authDomain,p,"auth-domain-config-required"),se(p.config.apiKey,p,"invalid-api-key");const N={apiKey:p.config.apiKey,appName:p.name,authType:h,redirectUrl:g,v:k.SDK_VERSION,eventId:y};if(c instanceof Js){c.setDefaultLanguage(p.languageCode),N.providerId=c.providerId||"",(0,$.xb)(c.getCustomParameters())||(N.customParameters=JSON.stringify(c.getCustomParameters()));for(const[_e,nt]of Object.entries(w||{}))N[_e]=nt}if(c instanceof yi){const _e=c.getScopes().filter(nt=>""!==nt);_e.length>0&&(N.scopes=_e.join(","))}p.tenantId&&(N.tid=p.tenantId);const j=N;for(const _e of Object.keys(j))void 0===j[_e]&&delete j[_e];const ee=yield p._getAppCheckToken(),Ie=ee?`#${Ea}=${encodeURIComponent(ee)}`:"";return`${function Gy({config:p}){return p.emulator?Mi(p,bd):`https://${p.authDomain}/${_C}`}(p)}?${(0,$.xO)(j).slice(1)}${Ie}`})).apply(this,arguments)}const Oo="webStorageSupport",Bn=class mu{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=up,this._completeRedirectFn=hu,this._overrideRedirectResult=Oy}_openPopup(c,h,g,y){var w=this;return(0,A.Z)(function*(){var N;on(null===(N=w.eventManagers[c._key()])||void 0===N?void 0:N.manager,"_initialize() not called before _openPopup()");const j=yield Rp(c,h,g,Vn(),y);return function Wy(p,c,h,g=500,y=600){const w=Math.max((window.screen.availHeight-y)/2,0).toString(),N=Math.max((window.screen.availWidth-g)/2,0).toString();let j="";const ee=Object.assign(Object.assign({},Hy),{width:g.toString(),height:y.toString(),top:w,left:N}),Ie=(0,$.z$)().toLowerCase();h&&(j=Or(Ie)?"_blank":h),Ke(Ie)&&(c=c||"http://localhost",ee.scrollbars="yes");const _e=Object.entries(ee).reduce((Br,[os,Lo])=>`${Br}${os}=${Lo},`,"");if(function dt(p=(0,$.z$)()){var c;return me(p)&&!(null===(c=window.navigator)||void 0===c||!c.standalone)}(Ie)&&"_self"!==j)return function qy(p,c){const h=document.createElement("a");h.href=p,h.target=c;const g=document.createEvent("MouseEvent");g.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),h.dispatchEvent(g)}(c||"",j),new bp(null);const nt=window.open(c||"",j,_e);se(nt,p,"popup-blocked");try{nt.focus()}catch{}return new bp(nt)}(c,j,Ml())})()}_openRedirect(c,h,g,y){var w=this;return(0,A.Z)(function*(){return yield w._originValidation(c),function Iy(p){Mn().location.href=p}(yield Rp(c,h,g,Vn(),y)),new Promise(()=>{})})()}_initialize(c){const h=c._key();if(this.eventManagers[h]){const{manager:y,promise:w}=this.eventManagers[h];return y?Promise.resolve(y):(on(w,"If manager is not set, promise should be"),w)}const g=this.initAndGetManager(c);return this.eventManagers[h]={promise:g},g.catch(()=>{delete this.eventManagers[h]}),g}initAndGetManager(c){var h=this;return(0,A.Z)(function*(){const g=yield function Dd(p){return Bl.apply(this,arguments)}(c),y=new Vy(c);return g.register("authEvent",w=>(se(w?.authEvent,c,"invalid-auth-event"),{status:y.onEvent(w.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),h.eventManagers[c._key()]={manager:y},h.iframes[c._key()]=g,y})()}_isIframeWebStorageSupported(c,h){this.iframes[c._key()].send(Oo,{type:Oo},y=>{var w;const N=null===(w=y?.[0])||void 0===w?void 0:w[Oo];void 0!==N&&h(!!N),lt(c,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(c){const h=c._key();return this.originValidationPromises[h]||(this.originValidationPromises[h]=function HM(p){return Uy.apply(this,arguments)}(c)),this.originValidationPromises[h]}get _shouldInitProactively(){return Xt()||Ye()||me()}};class yC{constructor(c){this.factorId=c}_process(c,h,g){switch(h.type){case"enroll":return this._finalizeEnroll(c,h.credential,g);case"signin":return this._finalizeSignIn(c,h.credential);default:return Tt("unexpected MultiFactorSessionType")}}}class jl extends yC{constructor(c){super("phone"),this.credential=c}static _fromCredential(c){return new jl(c)}_finalizeEnroll(c,h,g){return function FM(p,c){return J(p,"POST","/v2/accounts/mfaEnrollment:finalize",B(p,c))}(c,{idToken:h,displayName:g,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(c,h){return function Dy(p,c){return J(p,"POST","/v2/accounts/mfaSignIn:finalize",B(p,c))}(c,{mfaPendingCredential:h,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Pp=(()=>{class p{constructor(){}static assertion(h){return jl._fromCredential(h)}}return p.FACTOR_ID="phone",p})();var Ia="@firebase/auth";class Ky{constructor(c){this.auth=c,this.internalListeners=new Map}getUid(){var c;return this.assertAuthConfigured(),(null===(c=this.auth.currentUser)||void 0===c?void 0:c.uid)||null}getToken(c){var h=this;return(0,A.Z)(function*(){return h.assertAuthConfigured(),yield h.auth._initializationPromise,h.auth.currentUser?{accessToken:yield h.auth.currentUser.getIdToken(c)}:null})()}addAuthTokenListener(c){if(this.assertAuthConfigured(),this.internalListeners.has(c))return;const h=this.auth.onIdTokenChanged(g=>{c(g?.stsTokenManager.accessToken||null)});this.internalListeners.set(c,h),this.updateProactiveRefresh()}removeAuthTokenListener(c){this.assertAuthConfigured();const h=this.internalListeners.get(c);h&&(this.internalListeners.delete(c),h(),this.updateProactiveRefresh())}assertAuthConfigured(){se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}(0,$.Pz)("authIdTokenMaxAge"),function _u(p){(0,k._registerComponent)(new We.wA("auth",(c,{options:h})=>{const g=c.getProvider("app").getImmediate(),y=c.getProvider("heartbeat"),w=c.getProvider("app-check-internal"),{apiKey:N,authDomain:j}=g.options;se(N&&!N.includes(":"),"invalid-api-key",{appName:g.name});const ee={apiKey:N,authDomain:j,clientPlatform:p,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Oi(p)},Ie=new He(g,y,w,ee);return function MT(p,c){const h=c?.persistence||[],g=(Array.isArray(h)?h:[h]).map(U);c?.errorMap&&p._updateErrorMap(c.errorMap),p._initializeWithPersistence(g,c?.popupRedirectResolver)}(Ie,h),Ie},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((c,h,g)=>{c.getProvider("auth-internal").initialize()})),(0,k._registerComponent)(new We.wA("auth-internal",c=>{const h=Ne(c.getProvider("auth").getImmediate());return new Ky(h)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,k.registerVersion)(Ia,"1.5.1",function Np(p){switch(p){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(p)),(0,k.registerVersion)(Ia,"1.5.1","esm2017")}("Browser")},58:(Ss,Wn,xe)=>{xe.d(Wn,{BH:()=>or,DV:()=>At,Dv:()=>es,G6:()=>Mi,GJ:()=>Rn,L:()=>jt,LL:()=>ue,Pz:()=>Rt,Sg:()=>bn,UG:()=>Tt,UI:()=>xi,US:()=>We,Wj:()=>an,Wl:()=>Pe,Yr:()=>hi,ZB:()=>Se,ZR:()=>J,aH:()=>lt,b$:()=>Qr,cI:()=>Pt,dS:()=>ki,eu:()=>W,g5:()=>k,gK:()=>mi,gQ:()=>yr,h$:()=>Wt,hl:()=>H,hu:()=>$,jU:()=>on,lb:()=>qt,m9:()=>Xs,ne:()=>pi,p$:()=>ie,pd:()=>Xi,r3:()=>En,ru:()=>Vn,tV:()=>X,uI:()=>se,ug:()=>bs,vZ:()=>As,w1:()=>Qi,w9:()=>Yt,xO:()=>Yi,xb:()=>Yr,z$:()=>ct,zd:()=>Xr});const A={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},$=function(P,b){if(!P)throw k(b)},k=function(P){return new Error("Firebase Database ("+A.SDK_VERSION+") INTERNAL ASSERT FAILED: "+P)},Te=function(P){const b=[];let I=0;for(let C=0;C<P.length;C++){let E=P.charCodeAt(C);E<128?b[I++]=E:E<2048?(b[I++]=E>>6|192,b[I++]=63&E|128):55296==(64512&E)&&C+1<P.length&&56320==(64512&P.charCodeAt(C+1))?(E=65536+((1023&E)<<10)+(1023&P.charCodeAt(++C)),b[I++]=E>>18|240,b[I++]=E>>12&63|128,b[I++]=E>>6&63|128,b[I++]=63&E|128):(b[I++]=E>>12|224,b[I++]=E>>6&63|128,b[I++]=63&E|128)}return b},We={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(P,b){if(!Array.isArray(P))throw Error("encodeByteArray takes an array as a parameter");this.init_();const I=b?this.byteToCharMapWebSafe_:this.byteToCharMap_,C=[];for(let E=0;E<P.length;E+=3){const O=P[E],U=E+1<P.length,ce=U?P[E+1]:0,Ue=E+2<P.length,oe=Ue?P[E+2]:0;let Ke=(15&ce)<<2|oe>>6,Ye=63&oe;Ue||(Ye=64,U||(Ke=64)),C.push(I[O>>2],I[(3&O)<<4|ce>>4],I[Ke],I[Ye])}return C.join("")},encodeString(P,b){return this.HAS_NATIVE_SUPPORT&&!b?btoa(P):this.encodeByteArray(Te(P),b)},decodeString(P,b){return this.HAS_NATIVE_SUPPORT&&!b?atob(P):function(P){const b=[];let I=0,C=0;for(;I<P.length;){const E=P[I++];if(E<128)b[C++]=String.fromCharCode(E);else if(E>191&&E<224){const O=P[I++];b[C++]=String.fromCharCode((31&E)<<6|63&O)}else if(E>239&&E<365){const Ue=((7&E)<<18|(63&P[I++])<<12|(63&P[I++])<<6|63&P[I++])-65536;b[C++]=String.fromCharCode(55296+(Ue>>10)),b[C++]=String.fromCharCode(56320+(1023&Ue))}else{const O=P[I++],U=P[I++];b[C++]=String.fromCharCode((15&E)<<12|(63&O)<<6|63&U)}}return b.join("")}(this.decodeStringToByteArray(P,b))},decodeStringToByteArray(P,b){this.init_();const I=b?this.charToByteMapWebSafe_:this.charToByteMap_,C=[];for(let E=0;E<P.length;){const O=I[P.charAt(E++)],ce=E<P.length?I[P.charAt(E)]:0;++E;const oe=E<P.length?I[P.charAt(E)]:64;++E;const Le=E<P.length?I[P.charAt(E)]:64;if(++E,null==O||null==ce||null==oe||null==Le)throw new qn;C.push(O<<2|ce>>4),64!==oe&&(C.push(ce<<4&240|oe>>2),64!==Le&&C.push(oe<<6&192|Le))}return C},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let P=0;P<this.ENCODED_VALS.length;P++)this.byteToCharMap_[P]=this.ENCODED_VALS.charAt(P),this.charToByteMap_[this.byteToCharMap_[P]]=P,this.byteToCharMapWebSafe_[P]=this.ENCODED_VALS_WEBSAFE.charAt(P),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[P]]=P,P>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(P)]=P,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(P)]=P)}}};class qn extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Wt=function(P){const b=Te(P);return We.encodeByteArray(b,!0)},jt=function(P){return Wt(P).replace(/\./g,"")},X=function(P){try{return We.decodeString(P,!0)}catch(b){console.error("base64Decode failed: ",b)}return null};function ie(P){return Se(void 0,P)}function Se(P,b){if(!(b instanceof Object))return b;switch(b.constructor){case Date:return new Date(b.getTime());case Object:void 0===P&&(P={});break;case Array:P=[];break;default:return b}for(const I in b)!b.hasOwnProperty(I)||!qe(I)||(P[I]=Se(P[I],b[I]));return P}function qe(P){return"__proto__"!==P}const Ge=()=>{try{return function yt(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const P=process.env.__FIREBASE_DEFAULTS__;return P?JSON.parse(P):void 0})()||(()=>{if(typeof document>"u")return;let P;try{P=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const b=P&&X(P[1]);return b&&JSON.parse(b)})()}catch(P){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${P}`)}},lt=()=>{var P;return null===(P=Ge())||void 0===P?void 0:P.config},Rt=P=>{var b;return null===(b=Ge())||void 0===b?void 0:b[`_${P}`]};class or{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((b,I)=>{this.resolve=b,this.reject=I})}wrapCallback(b){return(I,C)=>{I?this.reject(I):this.resolve(C),"function"==typeof b&&(this.promise.catch(()=>{}),1===b.length?b(I):b(I,C))}}}function bn(P,b){if(P.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const C=b||"demo-project",E=P.iat||0,O=P.sub||P.user_id;if(!O)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const U=Object.assign({iss:`https://securetoken.google.com/${C}`,aud:C,iat:E,exp:E+3600,auth_time:E,sub:O,user_id:O,firebase:{sign_in_provider:"custom",identities:{}}},P);return[jt(JSON.stringify({alg:"none",type:"JWT"})),jt(JSON.stringify(U)),""].join(".")}function ct(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function se(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ct())}function Tt(){var P;const b=null===(P=Ge())||void 0===P?void 0:P.forceEnvironment;if("node"===b)return!0;if("browser"===b)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function on(){return"object"==typeof self&&self.self===self}function Vn(){const P="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof P&&void 0!==P.id}function Qr(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Qi(){const P=ct();return P.indexOf("MSIE ")>=0||P.indexOf("Trident/")>=0}function hi(){return!0===A.NODE_CLIENT||!0===A.NODE_ADMIN}function Mi(){return!Tt()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function H(){try{return"object"==typeof indexedDB}catch{return!1}}function W(){return new Promise((P,b)=>{try{let I=!0;const C="validate-browser-context-for-indexeddb-analytics-module",E=self.indexedDB.open(C);E.onsuccess=()=>{E.result.close(),I||self.indexedDB.deleteDatabase(C),P(!0)},E.onupgradeneeded=()=>{I=!1},E.onerror=()=>{var O;b((null===(O=E.error)||void 0===O?void 0:O.message)||"")}}catch(I){b(I)}})}class J extends Error{constructor(b,I,C){super(I),this.code=b,this.customData=C,this.name="FirebaseError",Object.setPrototypeOf(this,J.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ue.prototype.create)}}class ue{constructor(b,I,C){this.service=b,this.serviceName=I,this.errors=C}create(b,...I){const C=I[0]||{},E=`${this.service}/${b}`,O=this.errors[b],U=O?function Ae(P,b){return P.replace(it,(I,C)=>{const E=b[C];return null!=E?String(E):`<${C}?>`})}(O,C):"Error";return new J(E,`${this.serviceName}: ${U} (${E}).`,C)}}const it=/\{\$([^}]+)}/g;function Pt(P){return JSON.parse(P)}function Pe(P){return JSON.stringify(P)}const wt=function(P){let b={},I={},C={},E="";try{const O=P.split(".");b=Pt(X(O[0])||""),I=Pt(X(O[1])||""),E=O[2],C=I.d||{},delete I.d}catch{}return{header:b,claims:I,data:C,signature:E}},Yt=function(P){const I=wt(P).claims;return!!I&&"object"==typeof I&&I.hasOwnProperty("iat")},Rn=function(P){const b=wt(P).claims;return"object"==typeof b&&!0===b.admin};function En(P,b){return Object.prototype.hasOwnProperty.call(P,b)}function At(P,b){if(Object.prototype.hasOwnProperty.call(P,b))return P[b]}function Yr(P){for(const b in P)if(Object.prototype.hasOwnProperty.call(P,b))return!1;return!0}function xi(P,b,I){const C={};for(const E in P)Object.prototype.hasOwnProperty.call(P,E)&&(C[E]=b.call(I,P[E],E,P));return C}function As(P,b){if(P===b)return!0;const I=Object.keys(P),C=Object.keys(b);for(const E of I){if(!C.includes(E))return!1;const O=P[E],U=b[E];if(Lt(O)&&Lt(U)){if(!As(O,U))return!1}else if(O!==U)return!1}for(const E of C)if(!I.includes(E))return!1;return!0}function Lt(P){return null!==P&&"object"==typeof P}function Yi(P){const b=[];for(const[I,C]of Object.entries(P))Array.isArray(C)?C.forEach(E=>{b.push(encodeURIComponent(I)+"="+encodeURIComponent(E))}):b.push(encodeURIComponent(I)+"="+encodeURIComponent(C));return b.length?"&"+b.join("&"):""}function Xr(P){const b={};return P.replace(/^\?/,"").split("&").forEach(C=>{if(C){const[E,O]=C.split("=");b[decodeURIComponent(E)]=decodeURIComponent(O)}}),b}function Xi(P){const b=P.indexOf("?");if(!b)return"";const I=P.indexOf("#",b);return P.substring(b,I>0?I:void 0)}class yr{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let b=1;b<this.blockSize;++b)this.pad_[b]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(b,I){I||(I=0);const C=this.W_;if("string"==typeof b)for(let Le=0;Le<16;Le++)C[Le]=b.charCodeAt(I)<<24|b.charCodeAt(I+1)<<16|b.charCodeAt(I+2)<<8|b.charCodeAt(I+3),I+=4;else for(let Le=0;Le<16;Le++)C[Le]=b[I]<<24|b[I+1]<<16|b[I+2]<<8|b[I+3],I+=4;for(let Le=16;Le<80;Le++){const Ke=C[Le-3]^C[Le-8]^C[Le-14]^C[Le-16];C[Le]=4294967295&(Ke<<1|Ke>>>31)}let oe,we,E=this.chain_[0],O=this.chain_[1],U=this.chain_[2],ce=this.chain_[3],Ue=this.chain_[4];for(let Le=0;Le<80;Le++){Le<40?Le<20?(oe=ce^O&(U^ce),we=1518500249):(oe=O^U^ce,we=1859775393):Le<60?(oe=O&U|ce&(O|U),we=2400959708):(oe=O^U^ce,we=3395469782);const Ke=(E<<5|E>>>27)+oe+Ue+we+C[Le]&4294967295;Ue=ce,ce=U,U=4294967295&(O<<30|O>>>2),O=E,E=Ke}this.chain_[0]=this.chain_[0]+E&4294967295,this.chain_[1]=this.chain_[1]+O&4294967295,this.chain_[2]=this.chain_[2]+U&4294967295,this.chain_[3]=this.chain_[3]+ce&4294967295,this.chain_[4]=this.chain_[4]+Ue&4294967295}update(b,I){if(null==b)return;void 0===I&&(I=b.length);const C=I-this.blockSize;let E=0;const O=this.buf_;let U=this.inbuf_;for(;E<I;){if(0===U)for(;E<=C;)this.compress_(b,E),E+=this.blockSize;if("string"==typeof b){for(;E<I;)if(O[U]=b.charCodeAt(E),++U,++E,U===this.blockSize){this.compress_(O),U=0;break}}else for(;E<I;)if(O[U]=b[E],++U,++E,U===this.blockSize){this.compress_(O),U=0;break}}this.inbuf_=U,this.total_+=I}digest(){const b=[];let I=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let E=this.blockSize-1;E>=56;E--)this.buf_[E]=255&I,I/=256;this.compress_(this.buf_);let C=0;for(let E=0;E<5;E++)for(let O=24;O>=0;O-=8)b[C]=this.chain_[E]>>O&255,++C;return b}}function pi(P,b){const I=new xr(P,b);return I.subscribe.bind(I)}class xr{constructor(b,I){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=I,this.task.then(()=>{b(this)}).catch(C=>{this.error(C)})}next(b){this.forEachObserver(I=>{I.next(b)})}error(b){this.forEachObserver(I=>{I.error(b)}),this.close(b)}complete(){this.forEachObserver(b=>{b.complete()}),this.close()}subscribe(b,I,C){let E;if(void 0===b&&void 0===I&&void 0===C)throw new Error("Missing Observer.");E=function Un(P,b){if("object"!=typeof P||null===P)return!1;for(const I of b)if(I in P&&"function"==typeof P[I])return!0;return!1}(b,["next","error","complete"])?b:{next:b,error:I,complete:C},void 0===E.next&&(E.next=gi),void 0===E.error&&(E.error=gi),void 0===E.complete&&(E.complete=gi);const O=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?E.error(this.finalError):E.complete()}catch{}}),this.observers.push(E),O}unsubscribeOne(b){void 0===this.observers||void 0===this.observers[b]||(delete this.observers[b],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(b){if(!this.finalized)for(let I=0;I<this.observers.length;I++)this.sendOne(I,b)}sendOne(b,I){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[b])try{I(this.observers[b])}catch(C){typeof console<"u"&&console.error&&console.error(C)}})}close(b){this.finalized||(this.finalized=!0,void 0!==b&&(this.finalError=b),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function gi(){}const es=function(P,b,I,C){let E;if(C<b?E="at least "+b:C>I&&(E=0===I?"none":"no more than "+I),E)throw new Error(P+" failed: Was called with "+C+(1===C?" argument.":" arguments.")+" Expects "+E+".")};function mi(P,b){return`${P} failed: ${b} argument `}function an(P,b,I,C){if((!C||I)&&"function"!=typeof I)throw new Error(mi(P,b)+"must be a valid function.")}function qt(P,b,I,C){if((!C||I)&&("object"!=typeof I||null===I))throw new Error(mi(P,b)+"must be a valid context object.")}const ki=function(P){const b=[];let I=0;for(let C=0;C<P.length;C++){let E=P.charCodeAt(C);if(E>=55296&&E<=56319){const O=E-55296;C++,$(C<P.length,"Surrogate pair missing trail surrogate."),E=65536+(O<<10)+(P.charCodeAt(C)-56320)}E<128?b[I++]=E:E<2048?(b[I++]=E>>6|192,b[I++]=63&E|128):E<65536?(b[I++]=E>>12|224,b[I++]=E>>6&63|128,b[I++]=63&E|128):(b[I++]=E>>18|240,b[I++]=E>>12&63|128,b[I++]=E>>6&63|128,b[I++]=63&E|128)}return b},bs=function(P){let b=0;for(let I=0;I<P.length;I++){const C=P.charCodeAt(I);C<128?b++:C<2048?b+=2:C>=55296&&C<=56319?(b+=4,I++):b+=3}return b};function Xs(P){return P&&P._delegate?P._delegate:P}},621:(Ss,Wn,xe)=>{let $=null,Te=1;function We(t){const e=$;return $=t,e}function qe(t){if((!or(t)||t.dirty)&&(t.dirty||t.lastCleanEpoch!==Te)){if(!t.producerMustRecompute(t)&&!Fn(t))return t.dirty=!1,void(t.lastCleanEpoch=Te);t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=Te}}function Fn(t){bn(t);for(let e=0;e<t.producerNode.length;e++){const n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(qe(n),r!==n.version))return!0}return!1}function Rt(t,e){if(function ct(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}(t),bn(t),1===t.liveConsumerNode.length)for(let r=0;r<t.producerNode.length;r++)Rt(t.producerNode[r],t.producerIndexOfThis[r]);const n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){const r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];bn(i),i.producerIndexOfThis[r]=e}}function or(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function bn(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}let Qi=null;function ke(t){return"function"==typeof t}function Yt(t){const n=t(r=>{Error.call(r),r.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const Rn=Yt(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function En(t,e){if(t){const n=t.indexOf(e);0<=n&&t.splice(n,1)}}class At{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const s of n)s.remove(this);else n.remove(this);const{initialTeardown:r}=this;if(ke(r))try{r()}catch(s){e=s instanceof Rn?s.errors:[s]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const s of i)try{As(s)}catch(o){e=e??[],o instanceof Rn?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Rn(e)}}add(e){var n;if(e&&e!==this)if(this.closed)As(e);else{if(e instanceof At){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(e)}}_hasParent(e){const{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){const{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&En(n,e)}remove(e){const{_finalizers:n}=this;n&&En(n,e),e instanceof At&&e._removeParent(this)}}At.EMPTY=(()=>{const t=new At;return t.closed=!0,t})();const Yr=At.EMPTY;function xi(t){return t instanceof At||t&&"closed"in t&&ke(t.remove)&&ke(t.add)&&ke(t.unsubscribe)}function As(t){ke(t)?t():t.unsubscribe()}const Lt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},fi={setTimeout(t,e,...n){const{delegate:r}=fi;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){const{delegate:e}=fi;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Yi(t){fi.setTimeout(()=>{const{onUnhandledError:e}=Lt;if(!e)throw t;e(t)})}function Xr(){}const Xi=xr("C",void 0,void 0);function xr(t,e,n){return{kind:t,value:e,error:n}}let Ji=null;function Un(t){if(Lt.useDeprecatedSynchronousErrorHandling){const e=!Ji;if(e&&(Ji={errorThrown:!1,error:null}),t(),e){const{errorThrown:n,error:r}=Ji;if(Ji=null,n)throw r}}else t()}class es extends At{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,xi(e)&&e.add(this)):this.destination=Kn}static create(e,n,r){return new qt(e,n,r)}next(e){this.isStopped?Ys(function pi(t){return xr("N",t,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Ys(function yr(t){return xr("E",void 0,t)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Ys(Xi,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const mi=Function.prototype.bind;function So(t,e){return mi.call(t,e)}class an{constructor(e){this.partialObserver=e}next(e){const{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){ki(r)}}error(e){const{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){ki(r)}else ki(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){ki(n)}}}class qt extends es{constructor(e,n,r){let i;if(super(),ke(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Lt.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&So(e.next,s),error:e.error&&So(e.error,s),complete:e.complete&&So(e.complete,s)}):i=e}this.destination=new an(i)}}function ki(t){Lt.useDeprecatedSynchronousErrorHandling?function gi(t){Lt.useDeprecatedSynchronousErrorHandling&&Ji&&(Ji.errorThrown=!0,Ji.error=t)}(t):Yi(t)}function Ys(t,e){const{onStoppedNotification:n}=Lt;n&&fi.setTimeout(()=>n(t,e))}const Kn={closed:!0,next:Xr,error:function bs(t){throw t},complete:Xr},kr="function"==typeof Symbol&&Symbol.observable||"@@observable";function tr(t){return t}function Jr(...t){return ca(t)}function ca(t){return 0===t.length?tr:1===t.length?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}let Ct=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){const r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){const s=function P(t){return t&&t instanceof es||function Xs(t){return t&&ke(t.next)&&ke(t.error)&&ke(t.complete)}(t)&&xi(t)}(n)?n:new qt(n,r,i);return Un(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return new(r=Do(r))((i,s)=>{const o=new qt({next:a=>{try{n(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(n)}[kr](){return this}pipe(...n){return ca(n)(this)}toPromise(n){return new(n=Do(n))((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function Do(t){var e;return null!==(e=t??Lt.Promise)&&void 0!==e?e:Promise}const b=Yt(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let I=(()=>{class t extends Ct{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const r=new C(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new b}next(n){Un(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(n)}})}error(n){Un(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Un(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:r,isStopped:i,observers:s}=this;return r||i?Yr:(this.currentObservers=null,s.push(n),new At(()=>{this.currentObservers=null,En(s,n)}))}_checkFinalizedStatuses(n){const{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){const n=new Ct;return n.source=this,n}}return t.create=(e,n)=>new C(e,n),t})();class C extends I{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===r||r.call(n,e)}error(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===r||r.call(n,e)}complete(){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===n||n.call(e)}_subscribe(e){var n,r;return null!==(r=null===(n=this.source)||void 0===n?void 0:n.subscribe(e))&&void 0!==r?r:Yr}}class E extends I{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){const{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}function O(t){return ke(t?.lift)}function U(t){return e=>{if(O(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ce(t,e,n,r,i){return new Ue(t,e,n,r,i)}class Ue extends es{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function oe(t,e){return U((n,r)=>{let i=0;n.subscribe(ce(r,s=>{r.next(t.call(e,s,i++))}))})}function we(t){for(let e in t)if(t[e]===we)return e;throw Error("Could not find renamed property on target object.")}function Ke(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Ke).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function Ye(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const da=we({__forward_ref__:we});function q(t){return t.__forward_ref__=q,t.toString=function(){return Ke(this())},t}function M(t){return ne(t)?t():t}function ne(t){return"function"==typeof t&&t.hasOwnProperty(da)&&t.__forward_ref__===q}function me(t){return t&&!!t.\u0275providers}const dt="https://g.co/ng/security#xss";class V extends Error{constructor(e,n){super(function Xt(t,e){return`NG0${Math.abs(t)}${e?": "+e:""}`}(e,n)),this.code=e}}const Jt=we({\u0275cmp:we}),Oi=we({\u0275dir:we}),ha=we({\u0275pipe:we}),G_=we({\u0275mod:we}),ts=we({\u0275fac:we}),pl=we({__NG_ELEMENT_ID__:we}),K_=we({__NG_ENV_ID__:we});function He(t){return"string"==typeof t?t:null==t?"":String(t)}function qf(t,e){throw new V(-201,!1)}function Lr(t,e){null==t&&function Fe(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(null==r?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}(e,t,null,"!=")}function ve(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function ar(t){return{providers:t.providers||[],imports:t.imports||[]}}function Xc(t){return ty(t,Xa)||ty(t,Jc)}function ty(t,e){return t.hasOwnProperty(e)?t[e]:null}function fa(t){return t&&(t.hasOwnProperty(Zf)||t.hasOwnProperty(OT))?t[Zf]:null}const Xa=we({\u0275prov:we}),Zf=we({\u0275inj:we}),Jc=we({ngInjectableDef:we}),OT=we({ngInjectorDef:we});var ot=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(ot||{});let Qf;function ed(){return Qf}function ei(t){const e=Qf;return Qf=t,e}function td(t,e,n){const r=Xc(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&ot.Optional?null:void 0!==e?e:void qf(Ke(t))}const Ft=globalThis;class de{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=ve({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const yl={},vl="__NG_DI_FLAG__",Rs="ngTempTokenPath",VT=/\n/gm,UT="__source";let Ao;function yi(t){const e=Ao;return Ao=t,e}function Il(t,e=ot.Default){if(void 0===Ao)throw new V(-203,!1);return null===Ao?td(t,void 0,e):Ao.get(t,e&ot.Optional?null:void 0,e)}function Y(t,e=ot.Default){return(ed()||Il)(M(t),e)}function he(t,e=ot.Default){return Y(t,nd(e))}function nd(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function bo(t){const e=[];for(let n=0;n<t.length;n++){const r=M(t[n]);if(Array.isArray(r)){if(0===r.length)throw new V(900,!1);let i,s=ot.Default;for(let o=0;o<r.length;o++){const a=r[o],u=rd(a);"number"==typeof u?-1===u?i=a.token:s|=u:i=a}e.push(Y(i,s))}else e.push(Y(r))}return e}function wl(t,e){return t[vl]=e,t.prototype[vl]=e,t}function rd(t){return t[vl]}function rs(t){return{toString:t}.toString()}var Fr=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(Fr||{}),Vi=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(Vi||{});const Ps={},vt=[];function Tl(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function id(t,e,n){let r=0;for(;r<n.length;){const i=n[r];if("number"==typeof i){if(0!==i)break;r++;const s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{const s=i,o=n[++r];uy(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function Yf(t){return 3===t||4===t||6===t}function uy(t){return 64===t.charCodeAt(0)}function pa(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||sd(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function sd(t,e,n,r,i){let s=0,o=t.length;if(-1===e)o=-1;else for(;s<t.length;){const a=t[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<t.length;){const a=t[s];if("number"==typeof a)break;if(a===n){if(null===r)return void(null!==i&&(t[s+1]=i));if(r===t[s+1])return void(t[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),null!==r&&t.splice(s++,0,r),null!==i&&t.splice(s++,0,i)}const od="ng-template";function ad(t,e,n){let r=0,i=!0;for(;r<t.length;){let s=t[r++];if("string"==typeof s&&i){const o=t[r++];if(n&&"class"===s&&-1!==Tl(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;r<t.length&&"string"==typeof(s=t[r++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(i=!1)}}return!1}function ud(t){return 4===t.type&&t.value!==od}function ly(t,e,n){return e===(4!==t.type||n?t.value:od)}function Xf(t,e,n){let r=4;const i=t.attrs||[],s=function cy(t){for(let e=0;e<t.length;e++)if(Yf(t[e]))return e;return t.length}(i);let o=!1;for(let a=0;a<e.length;a++){const u=e[a];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!ly(t,u,n)||""===u&&1===e.length){if(Ui(r))return!1;o=!0}}else{const l=8&r?u:e[++a];if(8&r&&null!==t.attrs){if(!ad(t.attrs,l,n)){if(Ui(r))return!1;o=!0}continue}const f=Jf(8&r?"class":u,i,ud(t),n);if(-1===f){if(Ui(r))return!1;o=!0;continue}if(""!==l){let m;m=f>s?"":i[f+1].toLowerCase();const _=8&r?m:null;if(_&&-1!==Tl(_,l,0)||2&r&&l!==m){if(Ui(r))return!1;o=!0}}}}else{if(!o&&!Ui(r)&&!Ui(u))return!1;if(o&&Ui(u))continue;o=!1,r=u|1&r}}return Ui(r)||o}function Ui(t){return 0==(1&t)}function Jf(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){const o=e[i];if(o===t)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function tp(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function Cl(t,e,n=!1){for(let r=0;r<e.length;r++)if(Xf(t,e[r],n))return!0;return!1}function ld(t,e){return t?":not("+e.trim()+")":e}function jT(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if("string"==typeof o)if(2&r){const a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!Ui(o)&&(e+=ld(s,i),i=""),r=o,s=s||!Ui(r);n++}return""!==i&&(e+=ld(s,i)),e}function vr(t){return rs(()=>{const e=cd(t),n={...e,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Fr.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Vi.Emulated,styles:t.styles||vt,_:null,schemas:t.schemas||null,tView:null,id:""};ip(n);const r=t.dependencies;return n.directiveDefs=Ja(r,!1),n.pipeDefs=Ja(r,!0),n.id=function sp(t){let e=0;const n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(const i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(n),n})}function Sl(t){return at(t)||Pn(t)}function rp(t){return null!==t}function Er(t){return rs(()=>({type:t.type,bootstrap:t.bootstrap||vt,declarations:t.declarations||vt,imports:t.imports||vt,exports:t.exports||vt,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function Dl(t,e){if(null==t)return Ps;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),n[i]=r,e&&(e[i]=s)}return n}function ur(t){return rs(()=>{const e=cd(t);return ip(e),e})}function Ir(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function at(t){return t[Jt]||null}function Pn(t){return t[Oi]||null}function lr(t){return t[ha]||null}function wr(t,e){const n=t[G_]||null;if(!n&&!0===e)throw new Error(`Type ${Ke(t)} does not have '\u0275mod' property.`);return n}function cd(t){const e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Ps,exportAs:t.exportAs||null,standalone:!0===t.standalone,signals:!0===t.signals,selectors:t.selectors||vt,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Dl(t.inputs,e),outputs:Dl(t.outputs),debugInfo:null}}function ip(t){t.features?.forEach(e=>e(t))}function Ja(t,e){if(!t)return null;const n=e?lr:Sl;return()=>("function"==typeof t?t():t).map(r=>n(r)).filter(rp)}const In=0,le=1,Re=2,un=3,vi=4,Tr=5,is=6,Ro=7,Gt=8,cr=9,eo=10,je=11,Al=12,dd=13,eu=14,en=15,bl=16,Po=17,Ms=18,ga=19,hy=20,No=21,Rl=22,to=23,ze=25,Mo=1,xs=7,nu=9,Nn=10;var ru=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t[t.HasChildViewsToRefresh=4]="HasChildViewsToRefresh",t}(ru||{});function Cr(t){return Array.isArray(t)&&"object"==typeof t[Mo]}function dr(t){return Array.isArray(t)&&!0===t[Mo]}function fy(t){return 0!=(4&t.flags)}function no(t){return t.componentOffset>-1}function Pl(t){return 1==(1&t.flags)}function ss(t){return!!t.template}function py(t){return 0!=(512&t[Re])}function su(t,e){return t.hasOwnProperty(ts)?t[ts]:null}class up{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function ma(){return Ey}function Ey(t){return t.type.prototype.ngOnChanges&&(t.setInput=qT),Ml}function Ml(){const t=Iy(this),e=t?.current;if(e){const n=t.previous;if(n===Ps)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function qT(t,e,n,r){const i=this.declaredInputs[n],s=Iy(t)||function lp(t,e){return t[Mn]=e}(t,{previous:Ps,current:null}),o=s.current||(s.current={}),a=s.previous,u=a[i];o[i]=new up(u&&u.currentValue,e,a===Ps),t[r]=e}ma.ngInherit=!0;const Mn="__ngSimpleChanges__";function Iy(t){return t[Mn]||null}const ks=function(t,e,n){};let Ty=!1;function Nt(t){for(;Array.isArray(t);)t=t[In];return t}function hr(t,e){return Nt(e[t.index])}function _a(t,e){return t.data[e]}function au(t,e){return t[e]}function Vr(t,e){const n=e[t];return Cr(n)?n:n[In]}function fp(t){return 128==(128&t[Re])}function ro(t,e){return null==e?null:t[e]}function pp(t){t[Po]=0}function ZT(t){1024&t[Re]||(t[Re]|=1024,fp(t)&&kl(t))}function Ay(t){return 9216&t[Re]||t[to]?.dirty}function gp(t){Ay(t)?kl(t):64&t[Re]&&(function fd(){return Ty}()?(t[Re]|=1024,kl(t)):t[eo].changeDetectionScheduler?.notify())}function kl(t){t[eo].changeDetectionScheduler?.notify();let e=t[un];for(;null!==e&&!(dr(e)&&e[Re]&ru.HasChildViewsToRefresh||Cr(e)&&8192&e[Re]);){if(dr(e))e[Re]|=ru.HasChildViewsToRefresh;else if(e[Re]|=8192,!fp(e))break;e=e[un]}}function ya(t,e){if(256==(256&t[Re]))throw new V(911,!1);null===t[No]&&(t[No]=[]),t[No].push(e)}const Be={lFrame:_d(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Py(){return Be.bindingsEnabled}function K(){return Be.lFrame.lView}function ht(){return Be.lFrame.tView}function Vt(){let t=pd();for(;null!==t&&64===t.type;)t=t.parent;return t}function pd(){return Be.lFrame.currentTNode}function Bi(t,e){const n=Be.lFrame;n.currentTNode=t,n.isParent=e}function vp(){return Be.lFrame.isParent}function Ur(){const t=Be.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function ji(){return Be.lFrame.bindingIndex++}function Ep(t,e){const n=Be.lFrame;n.bindingIndex=n.bindingRootIndex=t,Ll(e)}function Ll(t){Be.lFrame.currentDirectiveIndex=t}function md(){return Be.lFrame.currentQueryIndex}function Fl(t){Be.lFrame.currentQueryIndex=t}function oC(t){const e=t[le];return 2===e.type?e.declTNode:1===e.type?t[Tr]:null}function cu(t,e,n){if(n&ot.SkipSelf){let i=e,s=t;for(;!(i=i.parent,null!==i||n&ot.Host||(i=oC(s),null===i||(s=s[eu],10&i.type))););if(null===i)return!1;e=i,t=s}const r=Be.lFrame=ky();return r.currentTNode=e,r.lView=t,!0}function wp(t){const e=ky(),n=t[le];Be.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function ky(){const t=Be.lFrame,e=null===t?null:t.child;return null===e?_d(t):e}function _d(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function yd(){const t=Be.lFrame;return Be.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const vd=yd;function Tp(){const t=yd();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function fr(){return Be.lFrame.selectedIndex}function ko(t){Be.lFrame.selectedIndex=t}function tn(){const t=Be.lFrame;return _a(t.tView,t.selectedIndex)}let Ly=!0;function Id(){return Ly}function Ls(t){Ly=t}function du(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),u&&(t.viewHooks??=[]).push(-n,u),l&&((t.viewHooks??=[]).push(n,l),(t.viewCheckHooks??=[]).push(n,l)),null!=d&&(t.destroyHooks??=[]).push(n,d)}}function hu(t,e,n){Td(t,e,3,n)}function fu(t,e,n,r){(3&t[Re])===n&&Td(t,e,n,r)}function wd(t,e){let n=t[Re];(3&n)===e&&(n&=16383,n+=1,t[Re]=n)}function Td(t,e,n,r){const s=r??-1,o=e.length-1;let a=0;for(let u=void 0!==r?65535&t[Po]:0;u<o;u++)if("number"==typeof e[u+1]){if(a=e[u],null!=r&&a>=r)break}else e[u]<0&&(t[Po]+=65536),(a<s||-1==s)&&(Vy(t,n,e,u),t[Po]=(4294901760&t[Po])+u+2),u++}function Fy(t,e){ks(4,t,e);const n=We(null);try{e.call(t)}finally{We(n),ks(5,t,e)}}function Vy(t,e,n,r){const i=n[r]<0,s=n[r+1],a=t[i?-n[r]:n[r]];i?t[Re]>>14<t[Po]>>16&&(3&t[Re])===e&&(t[Re]+=16384,Fy(a,s)):Fy(a,s)}const va=-1;class pu{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function Dp(t){return t!==va}function Vl(t){return 32767&t}function Ul(t,e){let n=function By(t){return t>>16}(t),r=e;for(;n>0;)r=r[eu],n--;return r}let gu=!0;function Sd(t){const e=gu;return gu=t,e}const jy=255,$y=5;let pC=0;const Fs={};function Dd(t,e){const n=Hy(t,e);if(-1!==n)return n;const r=e[le];r.firstCreatePass&&(t.injectorIndex=e.length,Bl(r.data,t),Bl(e,null),Bl(r.blueprint,null));const i=Ad(t,e),s=t.injectorIndex;if(Dp(i)){const o=Vl(i),a=Ul(i,e),u=a[le].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|u[o+l]}return e[s+8]=i,s}function Bl(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Hy(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function Ad(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;null!==i;){if(r=Pd(i),null===r)return va;if(n++,i=i[eu],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return va}function Ap(t,e,n){!function gC(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(pl)&&(r=n[pl]),null==r&&(r=n[pl]=pC++);const i=r&jy;e.data[t+(i>>$y)]|=1<<i}(t,e,n)}function zy(t,e,n){if(n&ot.Optional||void 0!==t)return t;qf()}function bp(t,e,n,r){if(n&ot.Optional&&void 0===r&&(r=null),!(n&(ot.Self|ot.Host))){const i=t[cr],s=ei(void 0);try{return i?i.get(e,r,n&ot.Optional):td(e,r,n&ot.Optional)}finally{ei(s)}}return zy(r,0,n)}function Wy(t,e,n,r=ot.Default,i){if(null!==t){if(2048&e[Re]&&!(r&ot.Self)){const o=function WM(t,e,n,r,i){let s=t,o=e;for(;null!==s&&null!==o&&2048&o[Re]&&!(512&o[Re]);){const a=qy(s,o,n,r|ot.Self,Fs);if(a!==Fs)return a;let u=s.parent;if(!u){const l=o[hy];if(l){const d=l.get(n,Fs,r);if(d!==Fs)return d}u=Pd(o),o=o[eu]}s=u}return i}(t,e,n,r,Fs);if(o!==Fs)return o}const s=qy(t,e,n,r,Fs);if(s!==Fs)return s}return bp(e,n,r,i)}function qy(t,e,n,r,i){const s=function Rp(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(pl)?t[pl]:void 0;return"number"==typeof e?e>=0?e&jy:yC:e}(n);if("function"==typeof s){if(!cu(e,t,r))return r&ot.Host?zy(i,0,r):bp(e,n,r,i);try{let o;if(o=s(r),null!=o||r&ot.Optional)return o;qf()}finally{vd()}}else if("number"==typeof s){let o=null,a=Hy(t,e),u=va,l=r&ot.Host?e[en][Tr]:null;for((-1===a||r&ot.SkipSelf)&&(u=-1===a?Ad(t,e):e[a+8],u!==va&&Gy(r,!1)?(o=e[le],a=Vl(u),e=Ul(u,e)):a=-1);-1!==a;){const d=e[le];if(Rd(s,a,d.data)){const f=_C(a,e,n,o,r,l);if(f!==Fs)return f}u=e[a+8],u!==va&&Gy(r,e[le].data[a+8]===l)&&Rd(s,a,e)?(o=d,a=Vl(u),e=Ul(u,e)):a=-1}}return i}function _C(t,e,n,r,i,s){const o=e[le],a=o.data[t+8],d=bd(a,o,n,null==r?no(a)&&gu:r!=o&&0!=(3&a.type),i&ot.Host&&s===a);return null!==d?Ea(e,o,d,a):Fs}function bd(t,e,n,r,i){const s=t.providerIndexes,o=e.data,a=1048575&s,u=t.directiveStart,d=s>>20,m=i?a+d:t.directiveEnd;for(let _=r?a:a+d;_<m;_++){const v=o[_];if(_<u&&n===v||_>=u&&v.type===n)return _}if(i){const _=o[u];if(_&&ss(_)&&_.type===n)return u}return null}function Ea(t,e,n,r){let i=t[n];const s=e.data;if(function dC(t){return t instanceof pu}(i)){const o=i;o.resolving&&function Wf(t,e){const n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new V(-200,`Circular dependency in DI detected for ${t}${n}`)}(function Ne(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():He(t)}(s[n]));const a=Sd(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?ei(o.injectImpl):null;cu(t,r,ot.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&function cC(t,e,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){const o=Ey(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}(n,s[n],e)}finally{null!==l&&ei(l),Sd(a),o.resolving=!1,vd()}}return i}function Rd(t,e,n){return!!(n[e+(t>>$y)]&1<<t)}function Gy(t,e){return!(t&ot.Self||t&ot.Host&&e)}class Bn{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return Wy(this._tNode,this._lView,e,nd(r),n)}}function yC(){return new Bn(Vt(),K())}function jl(t){return rs(()=>{const e=t.prototype.constructor,n=e[ts]||Pp(e),r=Object.prototype;let i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){const s=i[ts]||Pp(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Pp(t){return ne(t)?()=>{const e=Pp(M(t));return e&&e()}:su(t)}function Pd(t){const e=t[le],n=e.type;return 2===n?e.declTNode:1===n?t[Tr]:null}const Ia="__parameters__";function _u(t,e,n){return rs(()=>{const r=function Np(t){return function(...n){if(t){const r=t(...n);for(const i in r)this[i]=r[i]}}}(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(u,l,d){const f=u.hasOwnProperty(Ia)?u[Ia]:Object.defineProperty(u,Ia,{value:[]})[Ia];for(;f.length<=d;)f.push(null);return(f[d]=f[d]||[]).push(o),u}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}function nt(t,e){t.forEach(n=>Array.isArray(n)?nt(n,e):e(n))}function Br(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function os(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}const Ca=wl(_u("Optional"),8),Xy=wl(_u("SkipSelf"),4),Hl=new de("ENVIRONMENT_INITIALIZER"),YM=new de("INJECTOR",-1),DC=new de("INJECTOR_DEF_TYPES");class ev{get(e,n=yl){if(n===yl){const r=new Error(`NullInjectorError: No provider for ${Ke(e)}!`);throw r.name="NullInjectorError",r}return n}}function TG(...t){return{\u0275providers:JM(0,t),\u0275fromNgModule:!0}}function JM(t,...e){const n=[],r=new Set;let i;const s=o=>{n.push(o)};return nt(e,o=>{const a=o;tv(a,s,[],r)&&(i||=[],i.push(a))}),void 0!==i&&ex(i,s),n}function ex(t,e){for(let n=0;n<t.length;n++){const{ngModule:r,providers:i}=t[n];AC(i,s=>{e(s,r)})}}function tv(t,e,n,r){if(!(t=M(t)))return!1;let i=null,s=fa(t);const o=!s&&at(t);if(s||o){if(o&&!o.standalone)return!1;i=t}else{const u=t.ngModule;if(s=fa(u),!s)return!1;i=u}const a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){const u="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of u)tv(l,e,n,r)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;r.add(i);try{nt(s.imports,d=>{tv(d,e,n,r)&&(l||=[],l.push(d))})}finally{}void 0!==l&&ex(l,e)}if(!a){const l=su(i)||(()=>new i);e({provide:i,useFactory:l,deps:vt},i),e({provide:DC,useValue:i,multi:!0},i),e({provide:Hl,useValue:()=>Y(i),multi:!0},i)}const u=s.providers;if(null!=u&&!a){const l=t;AC(u,d=>{e(d,l)})}}}return i!==t&&void 0!==t.providers}function AC(t,e){for(let n of t)me(n)&&(n=n.\u0275providers),Array.isArray(n)?AC(n,e):e(n)}const CG=we({provide:String,useValue:we});function bC(t){return null!==t&&"object"==typeof t&&CG in t}function zl(t){return"function"==typeof t}const RC=new de("Set Injector scope."),nv={},DG={};let PC;function rv(){return void 0===PC&&(PC=new ev),PC}class Vs{}class kd extends Vs{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,MC(e,o=>this.processProvider(o)),this.records.set(YM,Od(void 0,this)),i.has("environment")&&this.records.set(Vs,Od(void 0,this));const s=this.records.get(RC);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(DC,vt,ot.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const n=yi(this),r=ei(void 0);try{return e()}finally{yi(n),ei(r)}}get(e,n=yl,r=ot.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(K_))return e[K_](this);r=nd(r);const s=yi(this),o=ei(void 0);try{if(!(r&ot.SkipSelf)){let u=this.records.get(e);if(void 0===u){const l=function NG(t){return"function"==typeof t||"object"==typeof t&&t instanceof de}(e)&&Xc(e);u=l&&this.injectableDefInScope(l)?Od(NC(e),nv):null,this.records.set(e,u)}if(null!=u)return this.hydrate(e,u)}return(r&ot.Self?rv():this.parent).get(e,n=r&ot.Optional&&n===yl?null:n)}catch(a){if("NullInjectorError"===a.name){if((a[Rs]=a[Rs]||[]).unshift(Ke(e)),s)throw a;return function BT(t,e,n,r){const i=t[Rs];throw e[UT]&&i.unshift(e[UT]),t.message=function ay(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let i=Ke(e);if(Array.isArray(e))i=e.map(Ke).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Ke(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(VT,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t[Rs]=null,t}(a,e,"R3InjectorError",this.source)}throw a}finally{ei(o),yi(s)}}resolveInjectorInitializers(){const e=yi(this),n=ei(void 0);try{const i=this.get(Hl,vt,ot.Self);for(const s of i)s()}finally{yi(e),ei(n)}}toString(){const e=[],n=this.records;for(const r of n.keys())e.push(Ke(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new V(205,!1)}processProvider(e){let n=zl(e=M(e))?e:M(e&&e.provide);const r=function bG(t){return bC(t)?Od(void 0,t.useValue):Od(function rx(t,e,n){let r;if(zl(t)){const i=M(t);return su(i)||NC(i)}if(bC(t))r=()=>M(t.useValue);else if(function nx(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...bo(t.deps||[]));else if(function tx(t){return!(!t||!t.useExisting)}(t))r=()=>Y(M(t.useExisting));else{const i=M(t&&(t.useClass||t.provide));if(!function RG(t){return!!t.deps}(t))return su(i)||NC(i);r=()=>new i(...bo(t.deps))}return r}(t),nv)}(e);if(zl(e)||!0!==e.multi)this.records.get(n);else{let i=this.records.get(n);i||(i=Od(void 0,nv,!0),i.factory=()=>bo(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){return n.value===nv&&(n.value=DG,n.value=n.factory()),"object"==typeof n.value&&n.value&&function PG(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;const n=M(e.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){const n=this._onDestroyHooks.indexOf(e);-1!==n&&this._onDestroyHooks.splice(n,1)}}function NC(t){const e=Xc(t),n=null!==e?e.factory:su(t);if(null!==n)return n;if(t instanceof de)throw new V(204,!1);if(t instanceof Function)return function AG(t){const e=t.length;if(e>0)throw function Lo(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}(e,"?"),new V(204,!1);const n=function Kf(t){return t&&(t[Xa]||t[Jc])||null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new V(204,!1)}function Od(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function MC(t,e){for(const n of t)Array.isArray(n)?MC(n,e):n&&me(n)?MC(n.\u0275providers,e):e(n)}function Wl(t,e){t instanceof kd&&t.assertNotDestroyed();const r=yi(t),i=ei(void 0);try{return e()}finally{yi(r),ei(i)}}function ax(t,e=null,n=null,r){const i=ux(t,e,n,r);return i.resolveInjectorInitializers(),i}function ux(t,e=null,n=null,r,i=new Set){const s=[n||vt,TG(t)];return r=r||("object"==typeof t?void 0:Ke(t)),new kd(s,e||rv(),r||null,i)}let OC,as=(()=>{class t{static#e=this.THROW_IF_NOT_FOUND=yl;static#t=this.NULL=new ev;static create(n,r){if(Array.isArray(n))return ax({name:""},r,n,"");{const i=n.name??"";return ax({name:i},n.parent,n.providers,i)}}static#n=this.\u0275prov=ve({token:t,providedIn:"any",factory:()=>Y(YM)});static#r=this.__NG_ELEMENT_ID__=-1}return t})();const sv=new de("AppId",{providedIn:"root",factory:()=>BG}),BG="ng",cx=new de("Platform Initializer"),oo=new de("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),dx=new de("AnimationModuleType"),hx=new de("CSP nonce",{providedIn:"root",factory:()=>function vu(){if(void 0!==OC)return OC;if(typeof document<"u")return document;throw new V(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function us(t){return t instanceof Function?t():t}function lv(t){return 128==(128&t.flags)}var wu=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(wu||{});const BC=new Map;let JG=0;const $C="__ngContext__";function ti(t,e){Cr(e)?(t[$C]=e[ga],function t3(t){BC.set(t[ga],t)}(e)):t[$C]=e}let HC;function zC(t,e){return HC(t,e)}function Bp(t){const e=t[un];return dr(e)?e[un]:e}function Px(t){return Mx(t[Al])}function Nx(t){return Mx(t[vi])}function Mx(t){for(;null!==t&&!dr(t);)t=t[vi];return t}function Fd(t,e,n,r,i){if(null!=r){let s,o=!1;dr(r)?s=r:Cr(r)&&(o=!0,r=r[In]);const a=Nt(r);0===t&&null!==n?null==i?Lx(e,n,a):ql(e,n,a,i||null,!0):1===t&&null!==n?ql(e,n,a,i||null,!0):2===t?function mv(t,e,n){const r=pv(t,e);r&&function E3(t,e,n,r){t.removeChild(e,n,r)}(t,r,e,n)}(e,a,o):3===t&&e.destroyNode(a),null!=s&&function T3(t,e,n,r,i){const s=n[xs];s!==Nt(n)&&Fd(e,t,r,s,i);for(let a=Nn;a<n.length;a++){const u=n[a];Hp(u[le],u,t,e,r,s)}}(e,t,s,n,i)}}function hv(t,e,n){return t.createElement(e,n)}function kx(t,e){const n=t[nu],r=n.indexOf(e);n.splice(r,1)}function jp(t,e){if(t.length<=Nn)return;const n=Nn+e,r=t[n];if(r){const i=r[bl];null!==i&&i!==t&&kx(i,r),e>0&&(t[n-1][vi]=r[vi]);const s=os(t,Nn+e);!function h3(t,e){Hp(t,e,e[je],2,null,null),e[In]=null,e[Tr]=null}(r[le],r);const o=s[Ms];null!==o&&o.detachView(s[le]),r[un]=null,r[vi]=null,r[Re]&=-129}return r}function fv(t,e){if(!(256&e[Re])){const n=e[je];n.destroyNode&&Hp(t,e,n,3,null,null),function g3(t){let e=t[Al];if(!e)return qC(t[le],t);for(;e;){let n=null;if(Cr(e))n=e[Al];else{const r=e[Nn];r&&(n=r)}if(!n){for(;e&&!e[vi]&&e!==t;)Cr(e)&&qC(e[le],e),e=e[un];null===e&&(e=t),Cr(e)&&qC(e[le],e),n=e&&e[vi]}e=n}}(e)}}function qC(t,e){if(!(256&e[Re])){e[Re]&=-129,e[Re]|=256,e[to]&&function An(t){if(bn(t),or(t))for(let e=0;e<t.producerNode.length;e++)Rt(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}(e[to]),function v3(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const i=e[n[r]];if(!(i instanceof pu)){const s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],u=s[o+1];ks(4,a,u);try{u.call(a)}finally{ks(5,a,u)}}else{ks(4,i,s);try{s.call(i)}finally{ks(5,i,s)}}}}}(t,e),function y3(t,e){const n=t.cleanup,r=e[Ro];if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else n[s].call(r[n[s+1]]);null!==r&&(e[Ro]=null);const i=e[No];if(null!==i){e[No]=null;for(let s=0;s<i.length;s++)(0,i[s])()}}(t,e),1===e[le].type&&e[je].destroy();const n=e[bl];if(null!==n&&dr(e[un])){n!==e[un]&&kx(n,e);const r=e[Ms];null!==r&&r.detachView(t)}!function n3(t){BC.delete(t[ga])}(e)}}function GC(t,e,n){return function Ox(t,e,n){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return n[In];{const{componentOffset:i}=r;if(i>-1){const{encapsulation:s}=t.data[r.directiveStart+i];if(s===Vi.None||s===Vi.Emulated)return null}return hr(r,n)}}(t,e.parent,n)}function ql(t,e,n,r,i){t.insertBefore(e,n,r,i)}function Lx(t,e,n){t.appendChild(e,n)}function Fx(t,e,n,r,i){null!==r?ql(t,e,n,r,i):Lx(t,e,n)}function pv(t,e){return t.parentNode(e)}let KC,yv,Bx=function Ux(t,e,n){return 40&t.type?hr(t,n):null};function gv(t,e,n,r){const i=GC(t,r,e),s=e[je],a=function Vx(t,e,n){return Bx(t,e,n)}(r.parent||e[Tr],r,e);if(null!=i)if(Array.isArray(n))for(let u=0;u<n.length;u++)Fx(s,i,n[u],a,!1);else Fx(s,i,n,a,!1);void 0!==KC&&KC(s,r,e,n,i)}function $p(t,e){if(null!==e){const n=e.type;if(3&n)return hr(e,t);if(4&n)return ZC(-1,t[e.index]);if(8&n){const r=e.child;if(null!==r)return $p(t,r);{const i=t[e.index];return dr(i)?ZC(-1,i):Nt(i)}}if(32&n)return zC(e,t)()||Nt(t[e.index]);{const r=$x(t,e);return null!==r?Array.isArray(r)?r[0]:$p(Bp(t[en]),r):$p(t,e.next)}}return null}function $x(t,e){return null!==e?t[en][Tr].projection[e.projection]:null}function ZC(t,e){const n=Nn+t+1;if(n<e.length){const r=e[n],i=r[le].firstChild;if(null!==i)return $p(r,i)}return e[xs]}function QC(t,e,n,r,i,s,o){for(;null!=n;){const a=r[n.index],u=n.type;if(o&&0===e&&(a&&ti(Nt(a),r),n.flags|=2),32!=(32&n.flags))if(8&u)QC(t,e,n.child,r,i,s,!1),Fd(e,t,i,a,s);else if(32&u){const l=zC(n,r);let d;for(;d=l();)Fd(e,t,i,d,s);Fd(e,t,i,a,s)}else 16&u?zx(t,e,r,n,i,s):Fd(e,t,i,a,s);n=o?n.projectionNext:n.next}}function Hp(t,e,n,r,i,s){QC(n,r,t.firstChild,e,i,s,!1)}function zx(t,e,n,r,i,s){const o=n[en],u=o[Tr].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++)Fd(e,t,i,u[l],s);else{let l=u;const d=o[un];lv(r)&&(l.flags|=128),QC(t,e,l,d,i,s,!0)}}function Wx(t,e,n){""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function qx(t,e,n){const{mergedAttrs:r,classes:i,styles:s}=n;null!==r&&id(t,e,r),null!==i&&Wx(t,e,i),null!==s&&function S3(t,e,n){t.setAttribute(e,"style",n)}(t,e,s)}function Zx(t){return function XC(){if(void 0===yv&&(yv=null,Ft.trustedTypes))try{yv=Ft.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return yv}()?.createScriptURL(t)||t}class Qx{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${dt})`}}function Tu(t){return t instanceof Qx?t.changingThisBreaksApplicationSecurity:t}function zp(t,e){const n=function k3(t){return t instanceof Qx&&t.getTypeName()||null}(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${dt})`)}return n===e}const V3=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var Ud=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(Ud||{});function r0(t){const e=qp();return e?e.sanitize(Ud.URL,t)||"":zp(t,"URL")?Tu(t):function JC(t){return(t=String(t)).match(V3)?t:"unsafe:"+t}(He(t))}function rk(t){const e=qp();if(e)return Zx(e.sanitize(Ud.RESOURCE_URL,t)||"");if(zp(t,"ResourceURL"))return Zx(Tu(t));throw new V(904,!1)}function qp(){const t=K();return t&&t[eo].sanitizer}class Y3{}let sk=(t,e,n)=>null;function h0(t,e,n=!1){return sk(t,e,n)}class o9{}class uk{}class u9{resolveComponentFactory(e){throw function a9(t){const e=Error(`No component factory found for ${Ke(t)}.`);return e.ngComponent=t,e}(e)}}let Sv=(()=>{class t{static#e=this.NULL=new u9}return t})();function l9(){return $d(Vt(),K())}function $d(t,e){return new Cu(hr(t,e))}let Cu=(()=>{class t{constructor(n){this.nativeElement=n}static#e=this.__NG_ELEMENT_ID__=l9}return t})();function c9(t){return t instanceof Cu?t.nativeElement:t}class g0{}let Dv=(()=>{class t{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function d9(){const t=K(),n=Vr(Vt().index,t);return(Cr(n)?n:t)[je]}()}return t})(),h9=(()=>{class t{static#e=this.\u0275prov=ve({token:t,providedIn:"root",factory:()=>null})}return t})();const m0={};function ck(t){const e=We(null);try{return t()}finally{We(e)}}function Qp(t,e,n,r,i=!1){for(;null!==n;){const s=e[n.index];null!==s&&r.push(Nt(s)),dr(s)&&_k(s,r);const o=n.type;if(8&o)Qp(t,e,n.child,r);else if(32&o){const a=zC(n,e);let u;for(;u=a();)r.push(u)}else if(16&o){const a=$x(e,n);if(Array.isArray(a))r.push(...a);else{const u=Bp(e[en]);Qp(u[le],u,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function _k(t,e){for(let n=Nn;n<t.length;n++){const r=t[n],i=r[le].firstChild;null!==i&&Qp(r[le],r,i,e)}t[xs]!==t[In]&&e.push(t[xs])}let yk=[];const D9={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{},consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{kl(t.lView)},consumerOnSignalRead(){this.lView[to]=this}};function y0(t){return t.ngOriginalError}class Da{constructor(){this._console=console}handleError(e){const n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&y0(e);for(;n&&y0(n);)n=y0(n);return n||null}}const Ek=new de("",{providedIn:"root",factory:()=>he(Da).handleError.bind(void 0)}),wk=new de("",{providedIn:"root",factory:()=>!1}),Je={};function Gl(t){Dk(ht(),K(),fr()+t,!1)}function Dk(t,e,n,r){if(!r)if(3==(3&e[Re])){const s=t.preOrderCheckHooks;null!==s&&hu(e,s,n)}else{const s=t.preOrderHooks;null!==s&&fu(e,s,0,n)}ko(n)}function Ve(t,e=ot.Default){const n=K();return null===n?Y(t,e):Wy(Vt(),n,M(t),e)}function Pv(t,e,n,r,i,s,o,a,u,l,d){const f=e.blueprint.slice();return f[In]=i,f[Re]=204|r,(null!==l||t&&2048&t[Re])&&(f[Re]|=2048),pp(f),f[un]=f[eu]=t,f[Gt]=n,f[eo]=o||t&&t[eo],f[je]=a||t&&t[je],f[cr]=u||t&&t[cr]||null,f[Tr]=s,f[ga]=function e3(){return JG++}(),f[is]=d,f[hy]=l,f[en]=2==e.type?t[en]:f,f}function Hd(t,e,n,r,i){let s=t.data[e];if(null===s)s=function v0(t,e,n,r,i){const s=pd(),o=vp(),u=t.data[e]=function U9(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return function uu(){return null!==Be.skipHydrationRootTNode}()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,e,r,i);return null===t.firstChild&&(t.firstChild=u),null!==s&&(o?null==s.child&&null!==u.parent&&(s.child=u):null===s.next&&(s.next=u,u.prev=s)),u}(t,e,n,r,i),function iC(){return Be.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=n,s.value=r,s.attrs=i;const o=function xo(){const t=Be.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Bi(s,!0),s}function Yp(t,e,n,r){if(0===n)return-1;const i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function bk(t,e,n,r,i){const s=fr(),o=2&r;try{ko(-1),o&&e.length>ze&&Dk(t,e,ze,!1),ks(o?2:0,i),n(r,i)}finally{ko(s),ks(o?3:1,i)}}function E0(t,e,n){if(fy(e)){const r=We(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=t.data[o];a.contentQueries&&a.contentQueries(1,n[o],o)}}finally{We(r)}}}function I0(t,e,n){Py()&&(function q9(t,e,n,r){const i=n.directiveStart,s=n.directiveEnd;no(n)&&function J9(t,e,n){const r=hr(e,t),i=Rk(n);let o=16;n.signals?o=4096:n.onPush&&(o=64);const a=Nv(t,Pv(t,i,null,o,r,e,null,t[eo].rendererFactory.createRenderer(r,n),null,null,null));t[e.index]=a}(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||Dd(n,e),ti(r,e);const o=n.initialInputs;for(let a=i;a<s;a++){const u=t.data[a],l=Ea(e,t,a,n);ti(l,e),null!==o&&e6(0,a-i,l,u,0,o),ss(u)&&(Vr(n.index,e)[Gt]=Ea(e,t,a,n))}}(t,e,n,hr(n,e)),64==(64&n.flags)&&kk(t,e,n))}function w0(t,e,n=hr){const r=e.localNames;if(null!==r){let i=e.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?n(e,t):t[o];t[i++]=a}}}function Rk(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=T0(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function T0(t,e,n,r,i,s,o,a,u,l,d){const f=ze+r,m=f+i,_=function x9(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:Je);return n}(f,m),v="function"==typeof l?l():l;return _[le]={type:t,blueprint:_,template:n,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:v,incompleteFirstPass:!1,ssrId:d}}let Pk=t=>null;function Nk(t,e,n,r){for(let i in t)if(t.hasOwnProperty(i)){n=null===n?{}:n;const s=t[i];null===r?Mk(n,e,i,s):r.hasOwnProperty(i)&&Mk(n,e,r[i],s)}return n}function Mk(t,e,n,r){t.hasOwnProperty(n)?t[n].push(e,r):t[n]=[e,r]}function ls(t,e,n,r,i,s,o,a){const u=hr(e,n);let d,l=e.inputs;!a&&null!=l&&(d=l[r])?(b0(t,n,d,r,i),no(e)&&function $9(t,e){const n=Vr(e,t);16&n[Re]||(n[Re]|=64)}(n,e.index)):3&e.type&&(r=function j9(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),i=null!=o?o(i,e.value||"",r):i,s.setProperty(u,r,i))}function C0(t,e,n,r){if(Py()){const i=null===r?null:{"":-1},s=function K9(t,e){const n=t.directiveRegistry;let r=null,i=null;if(n)for(let s=0;s<n.length;s++){const o=n[s];if(Cl(e,o.selectors,!1))if(r||(r=[]),ss(o))if(null!==o.findHostDirectiveDefs){const a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o),S0(t,e,a.length)}else r.unshift(o),S0(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return null===r?null:[r,i]}(t,n);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&xk(t,e,n,o,i,a),i&&function Z9(t,e,n){if(e){const r=t.localNames=[];for(let i=0;i<e.length;i+=2){const s=n[e[i+1]];if(null==s)throw new V(-301,!1);r.push(e[i],s)}}}(n,r,i)}n.mergedAttrs=pa(n.mergedAttrs,n.attrs)}function xk(t,e,n,r,i,s){for(let l=0;l<r.length;l++)Ap(Dd(n,e),t,r[l].type);!function Y9(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}(n,t.data.length,r.length);for(let l=0;l<r.length;l++){const d=r[l];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,u=Yp(t,e,r.length,null);for(let l=0;l<r.length;l++){const d=r[l];n.mergedAttrs=pa(n.mergedAttrs,d.hostAttrs),X9(t,n,e,u,d),Q9(u,d,i),null!==d.contentQueries&&(n.flags|=4),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(n.flags|=64);const f=d.type.prototype;!o&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(f.ngOnChanges||f.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),u++}!function B9(t,e,n){const i=e.directiveEnd,s=t.data,o=e.attrs,a=[];let u=null,l=null;for(let d=e.directiveStart;d<i;d++){const f=s[d],m=n?n.get(f):null,v=m?m.outputs:null;u=Nk(f.inputs,d,u,m?m.inputs:null),l=Nk(f.outputs,d,l,v);const T=null===u||null===o||ud(e)?null:t6(u,d,o);a.push(T)}null!==u&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=l}(t,n,s)}function kk(t,e,n){const r=n.directiveStart,i=n.directiveEnd,s=n.index,o=function sC(){return Be.lFrame.currentDirectiveIndex}();try{ko(s);for(let a=r;a<i;a++){const u=t.data[a],l=e[a];Ll(a),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&G9(u,l)}}finally{ko(-1),Ll(o)}}function G9(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function S0(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function Q9(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;ss(e)&&(n[""]=t)}}function X9(t,e,n,r,i){t.data[r]=i;const s=i.factory||(i.factory=su(i.type)),o=new pu(s,ss(i),Ve);t.blueprint[r]=o,n[r]=o,function z9(t,e,n,r,i){const s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;null===o&&(o=t.hostBindingOpCodes=[]);const a=~e.index;(function W9(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(o)!=a&&o.push(a),o.push(n,r,s)}}(t,e,r,Yp(t,n,i.hostVars,Je),i)}function Fo(t,e,n,r,i,s){const o=hr(t,e);!function D0(t,e,n,r,i,s,o){if(null==s)t.removeAttribute(e,i,n);else{const a=null==o?He(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}(e[je],o,s,t.value,n,r,i)}function e6(t,e,n,r,i,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)Ok(r,n,o[a++],o[a++],o[a++])}function Ok(t,e,n,r,i){const s=We(null);try{const o=t.inputTransforms;null!==o&&o.hasOwnProperty(r)&&(i=o[r].call(e,i)),null!==t.setInput?t.setInput(e,i,n,r):e[r]=i}finally{We(s)}}function t6(t,e,n){let r=null,i=0;for(;i<n.length;){const s=n[i];if(0!==s)if(5!==s){if("number"==typeof s)break;if(t.hasOwnProperty(s)){null===r&&(r=[]);const o=t[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){r.push(s,o[a+1],n[i+1]);break}}i+=2}else i+=2;else i+=4}return r}function Lk(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function Fk(t,e){const n=t.contentQueries;if(null!==n){const r=We(null);try{for(let i=0;i<n.length;i+=2){const o=n[i+1];if(-1!==o){const a=t.data[o];Fl(n[i]),a.contentQueries(2,e[o],o)}}}finally{We(r)}}}function Nv(t,e){return t[Al]?t[dd][vi]=e:t[Al]=e,t[dd]=e,e}function A0(t,e,n){Fl(0);const r=We(null);try{e(t,n)}finally{We(r)}}function Vk(t){return t[Ro]||(t[Ro]=[])}function Uk(t){return t.cleanup||(t.cleanup=[])}function Mv(t,e){const n=t[cr],r=n?n.get(Da,null):null;r&&r.handleError(e)}function b0(t,e,n,r,i){for(let s=0;s<n.length;){const o=n[s++],a=n[s++];Ok(t.data[o],e[o],r,a,i)}}function Aa(t,e,n){const r=function xl(t,e){return Nt(e[t])}(e,t);!function xx(t,e,n){t.setValue(e,n)}(t[je],r,n)}function i6(t,e,n,r){const i=e[Re];if(256==(256&i))return;e[eo].inlineEffectRunner?.flush(),wp(e);let o=null,a=null;(function s6(t){return 2!==t.type})(t)&&(a=function T9(t){return t[to]??function C9(t){const e=yk.pop()??Object.create(D9);return e.lView=t,e}(t)}(e),o=function et(t){return t&&(t.nextProducerIndex=0),We(t)}(a));try{pp(e),function My(t){return Be.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&bk(t,e,n,2,r);const u=3==(3&i);if(u){const f=t.preOrderCheckHooks;null!==f&&hu(e,f,null)}else{const f=t.preOrderHooks;null!==f&&fu(e,f,0,null),wd(e,0)}if(function o6(t){for(let e=Px(t);null!==e;e=Nx(e)){if(!(e[Re]&ru.HasTransplantedViews))continue;const n=e[nu];for(let r=0;r<n.length;r++){ZT(n[r])}}}(e),jk(e,0),null!==t.contentQueries&&Fk(t,e),u){const f=t.contentCheckHooks;null!==f&&hu(e,f)}else{const f=t.contentHooks;null!==f&&fu(e,f,1),wd(e,1)}!function M9(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let r=0;r<n.length;r++){const i=n[r];if(i<0)ko(~i);else{const s=i,o=n[++r],a=n[++r];Ep(o,s),a(2,e[s])}}}finally{ko(-1)}}(t,e);const l=t.components;null!==l&&Hk(e,l,0);const d=t.viewQuery;if(null!==d&&A0(2,d,r),u){const f=t.viewCheckHooks;null!==f&&hu(e,f)}else{const f=t.viewHooks;null!==f&&fu(e,f,2),wd(e,2)}if(!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),e[Rl]){for(const f of e[Rl])f();e[Rl]=null}e[Re]&=-73}catch(u){throw kl(e),u}finally{null!==a&&(function Ge(t,e){if(We(e),t&&void 0!==t.producerNode&&void 0!==t.producerIndexOfThis&&void 0!==t.producerLastReadVersion){if(or(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Rt(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}(a,o),function S9(t){t.lView[to]!==t&&(t.lView=null,yk.push(t))}(a)),Tp()}}function jk(t,e){for(let n=Px(t);null!==n;n=Nx(n)){n[Re]&=~ru.HasChildViewsToRefresh;for(let r=Nn;r<n.length;r++)$k(n[r],e)}}function a6(t,e,n){$k(Vr(e,t),n)}function $k(t,e){fp(t)&&P0(t,e)}function P0(t,e){const r=t[le],i=t[Re],s=t[to];let o=!!(0===e&&16&i);if(o||=!!(64&i&&0===e),o||=!!(1024&i),o||=!(!s?.dirty||!Fn(s)),s&&(s.dirty=!1),t[Re]&=-9217,o)i6(r,t,r.template,t[Gt]);else if(8192&i){jk(t,1);const a=r.components;null!==a&&Hk(t,a,1)}}function Hk(t,e,n){for(let r=0;r<e.length;r++)a6(t,e[r],n)}function Xp(t){for(t[eo].changeDetectionScheduler?.notify();t;){t[Re]|=64;const e=Bp(t);if(py(t)&&!e)return t;t=e}return null}class Jp{get rootNodes(){const e=this._lView,n=e[le];return Qp(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Gt]}set context(e){this._lView[Gt]=e}get destroyed(){return 256==(256&this._lView[Re])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[un];if(dr(e)){const n=e[8],r=n?n.indexOf(this):-1;r>-1&&(jp(e,r),os(n,r))}this._attachedToViewContainer=!1}fv(this._lView[le],this._lView)}onDestroy(e){ya(this._lView,e)}markForCheck(){Xp(this._cdRefInjectingView||this._lView)}detach(){this._lView[Re]&=-129}reattach(){gp(this._lView),this._lView[Re]|=128}detectChanges(){this._lView[Re]|=1024,function R0(t,e=!0){const n=t[eo],r=n.rendererFactory,i=n.afterRenderEventManager;r.begin?.(),i?.begin();try{!function r6(t){P0(t,0);let e=0;for(;Ay(t);){if(100===e)throw new V(103,!1);e++,P0(t,1)}}(t)}catch(o){throw e&&Mv(t,o),o}finally{r.end?.(),n.inlineEffectRunner?.flush(),i?.end()}}(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new V(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function p3(t,e){Hp(t,e,e[je],2,null,null)}(this._lView[le],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new V(902,!1);this._appRef=e,gp(this._lView)}}let xv=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=u6}return t})();function u6(t){return function l6(t,e,n){if(no(t)&&!n){const r=Vr(t.index,e);return new Jp(r,r)}return 47&t.type?new Jp(e[en],e):null}(Vt(),K(),16==(16&t))}let kv=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=f6;static#t=this.__NG_ENV_ID__=n=>n}return t})();class h6 extends kv{constructor(e){super(),this._lView=e}onDestroy(e){return ya(this._lView,e),()=>function mp(t,e){if(null===t[No])return;const n=t[No].indexOf(e);-1!==n&&t[No].splice(n,1)}(this._lView,e)}}function f6(){return new h6(K())}const zk=new Set;function Kl(t){zk.has(t)||(zk.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function N0(t){return e=>{setTimeout(t,void 0,e)}}const Ei=class E6 extends I{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&"object"==typeof e){const u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=N0(s),i&&(i=N0(i)),o&&(o=N0(o)));const a=super.subscribe({next:i,error:s,complete:o});return e instanceof At&&e.add(a),a}};function Wk(...t){}class Et{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ei(!1),this.onMicrotaskEmpty=new Ei(!1),this.onStable=new Ei(!1),this.onError=new Ei(!1),typeof Zone>"u")throw new V(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function I6(){const t="function"==typeof Ft.requestAnimationFrame;let e=Ft[t?"requestAnimationFrame":"setTimeout"],n=Ft[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function C6(t){const e=()=>{!function T6(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Ft,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,x0(t),t.isCheckStableRunning=!0,M0(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),x0(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(function D6(t){return!(!Array.isArray(t)||1!==t.length)&&!0===t[0].data?.__ignore_ng_zone__}(a))return n.invokeTask(i,s,o,a);try{return qk(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&e(),Gk(t)}},onInvoke:(n,r,i,s,o,a,u)=>{try{return qk(t),n.invoke(i,s,o,a,u)}finally{t.shouldCoalesceRunChangeDetection&&e(),Gk(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,x0(t),M0(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Et.isInAngularZone())throw new V(909,!1)}static assertNotInAngularZone(){if(Et.isInAngularZone())throw new V(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,w6,Wk,Wk);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}}const w6={};function M0(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function x0(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function qk(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Gk(t){t._nesting--,M0(t)}class S6{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ei,this.onMicrotaskEmpty=new Ei,this.onStable=new Ei,this.onError=new Ei}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}}var Zl=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(Zl||{});const Kk={destroy(){}};function Qk(t,e){!e&&function xC(t){if(!ed()&&!function Js(){return Ao}())throw new V(-203,!1)}();const n=e?.injector??he(as);if(!function Eu(t){return"browser"===(t??he(as)).get(oo)}(n))return Kk;Kl("NgAfterNextRender");const r=n.get(Ov),i=r.handler??=new Xk,s=e?.phase??Zl.MixedReadWrite,o=()=>{i.unregister(u),a()},a=n.get(kv).onDestroy(o),u=new Yk(n,s,()=>{o(),t()});return i.register(u),{destroy:o}}class Yk{constructor(e,n,r){this.phase=n,this.callbackFn=r,this.zone=e.get(Et),this.errorHandler=e.get(Da,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}}class Xk{constructor(){this.executingCallbacks=!1,this.buckets={[Zl.EarlyRead]:new Set,[Zl.Write]:new Set,[Zl.MixedReadWrite]:new Set,[Zl.Read]:new Set},this.deferredCallbacks=new Set}validateBegin(){if(this.executingCallbacks)throw new V(102,!1)}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(const e of Object.values(this.buckets))for(const n of e)n.invoke();this.executingCallbacks=!1;for(const e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(const e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}}let Ov=(()=>{class t{constructor(){this.renderDepth=0,this.handler=null,this.internalCallbacks=[]}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth){for(const n of this.internalCallbacks)n();this.internalCallbacks.length=0,this.handler?.execute()}}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static#e=this.\u0275prov=ve({token:t,providedIn:"root",factory:()=>new t})}return t})();function R6(t,e){const n=Vr(e,t),r=n[le];!function P6(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(r,n);const i=n[In];null!==i&&null===n[is]&&(n[is]=h0(i,n[cr])),k0(r,n,n[Gt])}function k0(t,e,n){wp(e);try{const r=t.viewQuery;null!==r&&A0(1,r,n);const i=t.template;null!==i&&bk(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&Fk(t,e),t.staticViewQueries&&A0(2,t.viewQuery,n);const s=t.components;null!==s&&function N6(t,e){for(let n=0;n<e.length;n++)R6(t,e[n])}(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[Re]&=-5,Tp()}}function Lv(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=Ye(i,a):2==s&&(r=Ye(r,a+": "+e[++o]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}class Jk extends Sv{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=at(e);return new eg(n,this.ngModule)}}function eO(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}class x6{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=nd(r);const i=this.injector.get(e,m0,r);return i!==m0||n===m0?i:this.parentInjector.get(e,n,r)}}class eg extends uk{get inputs(){const e=this.componentDef,n=e.inputTransforms,r=eO(e.inputs);if(null!==n)for(const i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return eO(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function np(t){return t.map(jT).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=(i=i||this.ngModule)instanceof Vs?i:i?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new x6(e,s):e,a=o.get(g0,null);if(null===a)throw new V(407,!1);const f={rendererFactory:a,sanitizer:o.get(h9,null),inlineEffectRunner:null,afterRenderEventManager:o.get(Ov,null),changeDetectionScheduler:o.get(Y3,null)},m=a.createRenderer(null,this.componentDef),_=this.componentDef.selectors[0][0]||"div",v=r?function k9(t,e,n,r){const s=r.get(wk,!1)||n===Vi.ShadowDom,o=t.selectRootElement(e,s);return function O9(t){Pk(t)}(o),o}(m,r,this.componentDef.encapsulation,o):hv(m,_,function M6(t){const e=t.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(_));let T=512;this.componentDef.signals?T|=4096:this.componentDef.onPush||(T|=16);let D=null;null!==v&&(D=h0(v,o,!0));const x=T0(0,null,null,1,0,null,null,null,null,null,null),R=Pv(null,x,null,T,null,null,f,m,o,null,D);let L,G;wp(R);try{const ae=this.componentDef;let ye,Qe=null;ae.findHostDirectiveDefs?(ye=[],Qe=new Map,ae.findHostDirectiveDefs(ae,ye,Qe),ye.push(ae)):ye=[ae];const Bt=function O6(t,e){const n=t[le],r=ze;return t[r]=e,Hd(n,r,2,"#host",null)}(R,v),Zr=function L6(t,e,n,r,i,s,o){const a=i[le];!function F6(t,e,n,r){for(const i of t)e.mergedAttrs=pa(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&(Lv(e,e.mergedAttrs,!0),null!==n&&qx(r,n,e))}(r,t,e,o);let u=null;null!==e&&(u=h0(e,i[cr]));const l=s.rendererFactory.createRenderer(e,n);let d=16;n.signals?d=4096:n.onPush&&(d=64);const f=Pv(i,Rk(n),null,d,i[t.index],t,s,l,null,null,u);return a.firstCreatePass&&S0(a,t,r.length-1),Nv(i,f),i[t.index]=f}(Bt,v,ae,ye,R,f,m);G=_a(x,ze),v&&function U6(t,e,n,r){if(r)id(t,n,["ng-version","17.0.8"]);else{const{attrs:i,classes:s}=function $T(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let s=t[r];if("string"==typeof s)2===i?""!==s&&e.push(s,t[++r]):8===i&&n.push(s);else{if(!Ui(i))break;i=s}r++}return{attrs:e,classes:n}}(e.selectors[0]);i&&id(t,n,i),s&&s.length>0&&Wx(t,n,s.join(" "))}}(m,ae,v,r),void 0!==n&&function B6(t,e,n){const r=t.projection=[];for(let i=0;i<e.length;i++){const s=n[i];r.push(null!=s?Array.from(s):null)}}(G,this.ngContentSelectors,n),L=function V6(t,e,n,r,i,s){const o=Vt(),a=i[le],u=hr(o,i);xk(a,i,o,n,null,r);for(let d=0;d<n.length;d++)ti(Ea(i,a,o.directiveStart+d,o),i);kk(a,i,o),u&&ti(u,i);const l=Ea(i,a,o.directiveStart+o.componentOffset,o);if(t[Gt]=i[Gt]=l,null!==s)for(const d of s)d(l,e);return E0(a,o,t),l}(Zr,ae,ye,Qe,R,[j6]),k0(x,R,null)}finally{Tp()}return new k6(this.componentType,L,$d(G,R),R,G)}}class k6 extends o9{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Jp(i,void 0,!1),this.componentType=e}setInput(e,n){const r=this._tNode.inputs;let i;if(null!==r&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;const s=this._rootLView;b0(s[le],s,i,e,n),this.previousInputValues.set(e,n),Xp(Vr(this._tNode.index,s))}}get injector(){return new Bn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function j6(){const t=Vt();du(K()[le],t)}function oO(t){const e=t.inputConfig,n={};for(const r in e)if(e.hasOwnProperty(r)){const i=e[r];Array.isArray(i)&&i[2]&&(n[r]=i[2])}t.inputTransforms=n}function Vo(t,e,n){return t[e]=n}function nr(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function O0(t,e,n,r){const i=K();return nr(i,ji(),e)&&(ht(),Fo(tn(),i,t,e,n,r)),O0}function Wd(t,e,n,r){return nr(t,ji(),n)?e+He(n)+r:Je}function Xl(t,e,n){const r=K();return nr(r,ji(),e)&&ls(ht(),tn(),r,t,e,r[je],n,!1),Xl}function U0(t,e,n,r,i){const o=i?"class":"style";b0(t,n,e.inputs[o],o,r)}function th(t,e){return!e||null===e.firstChild||lv(t)}function ug(t,e,n,r=!0){const i=e[le];if(function m3(t,e,n,r){const i=Nn+r,s=n.length;r>0&&(n[i-1][vi]=e),r<s-Nn?(e[vi]=n[i],Br(n,Nn+r,e)):(n.push(e),e[vi]=null),e[un]=n;const o=e[bl];null!==o&&n!==o&&function _3(t,e){const n=t[nu];e[en]!==e[un][un][en]&&(t[Re]|=ru.HasTransplantedViews),null===n?t[nu]=[e]:n.push(e)}(o,e);const a=e[Ms];null!==a&&a.insertView(t),gp(e),e[Re]|=128}(i,e,t,n),r){const o=ZC(n,t),a=e[je],u=pv(a,t[xs]);null!==u&&function f3(t,e,n,r,i,s){r[In]=i,r[Tr]=e,Hp(t,r,n,1,i,s)}(i,t[Tr],a,e,u,o)}const s=e[is];null!==s&&null!==s.firstChild&&(s.firstChild=null)}let lo=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=X5}return t})();function X5(){return HO(Vt(),K())}const J5=lo,jO=class extends J5{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return $d(this._hostTNode,this._hostLView)}get injector(){return new Bn(this._hostTNode,this._hostLView)}get parentInjector(){const e=Ad(this._hostTNode,this._hostLView);if(Dp(e)){const n=Ul(e,this._hostLView),r=Vl(e);return new Bn(n[le].data[r+8],n)}return new Bn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const n=$O(this._lContainer);return null!==n&&n[e]||null}get length(){return this._lContainer.length-Nn}createEmbeddedView(e,n,r){let i,s;"number"==typeof r?i=r:null!=r&&(i=r.index,s=r.injector);const a=e.createEmbeddedViewImpl(n||{},s,null);return this.insertImpl(a,i,th(this._hostTNode,null)),a}createComponent(e,n,r,i,s){const o=e&&!function ee(t){return"function"==typeof t}(e);let a;if(o)a=n;else{const v=n||{};a=v.index,r=v.injector,i=v.projectableNodes,s=v.environmentInjector||v.ngModuleRef}const u=o?e:new eg(at(e)),l=r||this.parentInjector;if(!s&&null==u.ngModule){const T=(o?l:this.parentInjector).get(Vs,null);T&&(s=T)}at(u.componentType??{});const _=u.create(l,i,null,s);return this.insertImpl(_.hostView,a,th(this._hostTNode,null)),_}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){const i=e._lView;if(function KT(t){return dr(t[un])}(i)){const a=this.indexOf(e);if(-1!==a)this.detach(a);else{const u=i[un],l=new jO(u,u[Tr],u[un]);l.detach(l.indexOf(e))}}const s=this._adjustIndex(n),o=this._lContainer;return ug(o,i,s,r),e.attachToViewContainerRef(),Br(Z0(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){const n=$O(this._lContainer);return null!==n?n.indexOf(e):-1}remove(e){const n=this._adjustIndex(e,-1),r=jp(this._lContainer,n);r&&(os(Z0(this._lContainer),n),fv(r[le],r))}detach(e){const n=this._adjustIndex(e,-1),r=jp(this._lContainer,n);return r&&null!=os(Z0(this._lContainer),n)?new Jp(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function $O(t){return t[8]}function Z0(t){return t[8]||(t[8]=[])}function HO(t,e){let n;const r=e[t.index];return dr(r)?n=r:(n=Lk(r,e,null,t),e[t.index]=n,Nv(e,n)),zO(n,e,t,r),new jO(n,t,e)}let zO=function qO(t,e,n,r){if(t[xs])return;let i;i=8&n.type?Nt(r):function e8(t,e){const n=t[je],r=n.createComment(""),i=hr(e,t);return ql(n,pv(n,i),r,function I3(t,e){return t.nextSibling(e)}(n,i),!1),r}(e,n),t[xs]=i},Q0=(t,e,n)=>!1;function Du(t,e,n,r,i,s,o,a){const u=K(),l=ht(),d=t+ze,f=l.firstCreatePass?function i8(t,e,n,r,i,s,o,a,u){const l=e.consts,d=Hd(e,t,4,o||null,ro(l,a));C0(e,n,d,ro(l,u)),du(e,d);const f=d.tView=T0(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,d),f.queries=e.queries.embeddedTView(d)),d}(d,l,u,e,n,r,i,s,o):l.data[d];Bi(f,!1);const m=GO(l,u,f,t);Id()&&gv(l,u,m,f),ti(m,u);const _=Lk(m,u,m,f);return u[d]=_,Nv(u,_),function WO(t,e,n){return Q0(t,e,n)}(_,f,u),Pl(f)&&I0(l,u,f),null!=o&&w0(u,f,a),Du}let GO=function KO(t,e,n,r){return Ls(!0),e[je].createComment("")};function xt(t,e,n,r){const i=K(),s=ht(),o=ze+t,a=i[je],u=s.firstCreatePass?function G8(t,e,n,r,i,s){const o=e.consts,u=Hd(e,t,2,r,ro(o,i));return C0(e,n,u,ro(o,s)),null!==u.attrs&&Lv(u,u.attrs,!1),null!==u.mergedAttrs&&Lv(u,u.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,u),u}(o,s,i,e,n,r):s.data[o],l=y1(s,i,u,a,e,t);i[o]=l;const d=Pl(u);return Bi(u,!0),qx(a,l,u),32!=(32&u.flags)&&Id()&&gv(s,i,l,u),0===function QT(){return Be.lFrame.elementDepthCount}()&&ti(l,i),function YT(){Be.lFrame.elementDepthCount++}(),d&&(I0(s,i,u),E0(s,u,i)),null!==r&&w0(i,u),xt}function $t(){let t=Vt();vp()?function Ol(){Be.lFrame.isParent=!1}():(t=t.parent,Bi(t,!1));const e=t;(function Ny(t){return Be.skipHydrationRootTNode===t})(e)&&function _p(){Be.skipHydrationRootTNode=null}(),function XT(){Be.lFrame.elementDepthCount--}();const n=ht();return n.firstCreatePass&&(du(n,t),fy(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function hC(t){return 0!=(8&t.flags)}(e)&&U0(n,e,K(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function fC(t){return 0!=(16&t.flags)}(e)&&U0(n,e,K(),e.stylesWithoutHost,!1),$t}function cs(t,e,n,r){return xt(t,e,n,r),$t(),cs}let y1=(t,e,n,r,i,s)=>(Ls(!0),hv(r,i,function Ed(){return Be.lFrame.currentNamespace}()));const lh="en-US";let S1=lh;function eE(t){return!!t&&"function"==typeof t.then}function Q1(t){return!!t&&"function"==typeof t.subscribe}function _g(t,e,n,r){const i=K(),s=ht(),o=Vt();return function X1(t,e,n,r,i,s,o){const a=Pl(r),l=t.firstCreatePass&&Uk(t),d=e[Gt],f=Vk(e);let m=!0;if(3&r.type||o){const T=hr(r,e),D=o?o(T):T,x=f.length,R=o?G=>o(Nt(G[r.index])):r.index;let L=null;if(!o&&a&&(L=function QK(t,e,n,r){const i=t.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===n&&i[s+1]===r){const a=e[Ro],u=i[s+2];return a.length>u?a[u]:null}"string"==typeof o&&(s+=2)}return null}(t,e,i,r.index)),null!==L)(L.__ngLastListenerFn__||L).__ngNextListenerFn__=s,L.__ngLastListenerFn__=s,m=!1;else{s=eL(r,e,d,s,!1);const G=n.listen(D,i,s);f.push(s,G),l&&l.push(i,R,x,x+1)}}else s=eL(r,e,d,s,!1);const _=r.outputs;let v;if(m&&null!==_&&(v=_[i])){const T=v.length;if(T)for(let D=0;D<T;D+=2){const ae=e[v[D]][v[D+1]].subscribe(s),ye=f.length;f.push(s,ae),l&&l.push(i,r.index,ye,-(ye+1))}}}(s,i,i[je],o,t,e,r),_g}function J1(t,e,n,r){try{return ks(6,e,n),!1!==n(r)}catch(i){return Mv(t,i),!1}finally{ks(7,e,n)}}function eL(t,e,n,r,i){return function s(o){if(o===Function)return r;Xp(t.componentOffset>-1?Vr(t.index,e):e);let u=J1(e,n,r,o),l=s.__ngNextListenerFn__;for(;l;)u=J1(e,n,l,o)&&u,l=l.__ngNextListenerFn__;return i&&!1===u&&o.preventDefault(),u}}function tE(t,e,n){return dS(t,"",e,"",n),tE}function dS(t,e,n,r,i){const s=K(),o=Wd(s,e,n,r);return o!==Je&&ls(ht(),tn(),s,t,o,s[je],i,!1),dS}function xn(t,e=""){const n=K(),r=ht(),i=t+ze,s=r.firstCreatePass?Hd(r,i,1,e,null):r.data[i],o=vL(r,n,s,e,t);n[i]=o,Id()&&gv(r,n,o,s),Bi(s,!1)}let vL=(t,e,n,r,i)=>(Ls(!0),function dv(t,e){return t.createText(e)}(e[je],r));function hS(t){return fS("",t,""),hS}function fS(t,e,n){const r=K(),i=Wd(r,t,e,n);return i!==Je&&Aa(r,fr(),i),fS}class tc{}class RL{}class yS extends tc{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Jk(this);const i=wr(e);this._bootstrapComponents=us(i.bootstrap),this._r3Injector=ux(e,n,[{provide:tc,useValue:this},{provide:Sv,useValue:this.componentFactoryResolver},...r],Ke(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class vS extends RL{constructor(e){super(),this.moduleType=e}create(e){return new yS(this.moduleType,e,[])}}class PL extends tc{constructor(e){super(),this.componentFactoryResolver=new Jk(this),this.instance=null;const n=new kd([...e.providers,{provide:tc,useValue:this},{provide:Sv,useValue:this.componentFactoryResolver}],e.parent||rv(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function ES(t,e,n=null){return new PL({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}let E7=(()=>{class t{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const r=JM(0,n.type),i=r.length>0?ES([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,i)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=ve({token:t,providedIn:"environment",factory:()=>new t(Y(Vs))})}return t})();function NL(t){Kl("NgStandalone"),t.getStandaloneInjector=e=>e.get(E7).getOrCreateStandaloneInjector(t)}function iE(t,e,n){const r=Ur()+t,i=K();return i[r]===Je?Vo(i,r,n?e.call(n):e()):function tg(t,e){return t[e]}(i,r)}function UL(t,e,n,r,i,s){const o=e+n;return nr(t,o,i)?Vo(t,o+1,s?r.call(s,i):r(i)):function yg(t,e){const n=t[e];return n===Je?void 0:n}(t,o+1)}function wS(t,e){const n=ht();let r;const i=t+ze;n.firstCreatePass?(r=function B7(t,e){if(e)for(let n=e.length-1;n>=0;n--){const r=e[n];if(t===r.name)return r}}(e,n.pipeRegistry),n.data[i]=r,r.onDestroy&&(n.destroyHooks??=[]).push(i,r.onDestroy)):r=n.data[i];const s=r.factory||(r.factory=su(r.type)),a=ei(Ve);try{const u=Sd(!1),l=s();return Sd(u),function t7(t,e,n,r){n>=t.data.length&&(t.data[n]=null,t.blueprint[n]=null),e[n]=r}(n,K(),i,l),l}finally{ei(a)}}function TS(t,e,n){const r=t+ze,i=K(),s=au(i,r);return function vg(t,e){return t[le].data[e].pure}(i,r)?UL(i,Ur(),e,s.transform,n,s):s.transform(n)}function W7(){return this._results[Symbol.iterator]()}class CS{static#e=Symbol.iterator;get changes(){return this._changes??=new Ei}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const n=CS.prototype;n[Symbol.iterator]||(n[Symbol.iterator]=W7)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,n){return this._results.reduce(e,n)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,n){this.dirty=!1;const r=function _e(t){return t.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function Ie(t,e,n){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++){let i=t[r],s=e[r];if(n&&(i=n(i),s=n(s)),s!==i)return!1}return!0}(this._results,r,n))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}let ba=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=K7}return t})();const q7=ba,G7=class extends q7{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){const i=function ag(t,e,n,r){const i=e.tView,a=Pv(t,i,n,4096&t[Re]?4096:16,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null);a[bl]=t[e.index];const l=t[Ms];return null!==l&&(a[Ms]=l.createEmbeddedView(i)),k0(i,a,n),a}(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new Jp(i)}};function K7(){return sE(Vt(),K())}function sE(t,e){return 4&t.type?new G7(e,t,$d(t,e)):null}class SS{constructor(e){this.queryList=e,this.matches=null}clone(){return new SS(this.queryList)}setDirty(){this.queryList.setDirty()}}class DS{constructor(e=[]){this.queries=e}createEmbeddedView(e){const n=e.queries;if(null!==n){const r=null!==e.contentQueries?e.contentQueries[0]:n.length,i=[];for(let s=0;s<r;s++){const o=n.getByIndex(s);i.push(this.queries[o.indexInDeclarationView].clone())}return new DS(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let n=0;n<this.queries.length;n++)null!==YL(e,n).matches&&this.queries[n].setDirty()}}class zL{constructor(e,n,r=null){this.predicate=e,this.flags=n,this.read=r}}class AS{constructor(e=[]){this.queries=e}elementStart(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,n)}elementEnd(e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(e)}embeddedTView(e){let n=null;for(let r=0;r<this.length;r++){const i=null!==n?n.length:0,s=this.getByIndex(r).embeddedTView(e,i);s&&(s.indexInDeclarationView=r,null!==n?n.push(s):n=[s])}return null!==n?new AS(n):null}template(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,n)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class bS{constructor(e,n=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(e,n){this.isApplyingToNode(n)&&this.matchTNode(e,n)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,n){this.elementStart(e,n)}embeddedTView(e,n){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,n),new bS(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let r=e.parent;for(;null!==r&&8&r.type&&r.index!==n;)r=r.parent;return n===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(e,n){const r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){const s=r[i];this.matchTNodeWithReadOption(e,n,Z7(n,s)),this.matchTNodeWithReadOption(e,n,bd(n,e,s,!1,!1))}else r===ba?4&n.type&&this.matchTNodeWithReadOption(e,n,-1):this.matchTNodeWithReadOption(e,n,bd(n,e,r,!1,!1))}matchTNodeWithReadOption(e,n,r){if(null!==r){const i=this.metadata.read;if(null!==i)if(i===Cu||i===lo||i===ba&&4&n.type)this.addMatch(n.index,-2);else{const s=bd(n,e,i,!1,!1);null!==s&&this.addMatch(n.index,s)}else this.addMatch(n.index,r)}}addMatch(e,n){null===this.matches?this.matches=[e,n]:this.matches.push(e,n)}}function Z7(t,e){const n=t.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===e)return n[r+1];return null}function Y7(t,e,n,r){return-1===n?function Q7(t,e){return 11&t.type?$d(t,e):4&t.type?sE(t,e):null}(e,t):-2===n?function X7(t,e,n){return n===Cu?$d(e,t):n===ba?sE(e,t):n===lo?HO(e,t):void 0}(t,e,r):Ea(t,t[le],n,e)}function WL(t,e,n,r){const i=e[Ms].queries[r];if(null===i.matches){const s=t.data,o=n.matches,a=[];for(let u=0;u<o.length;u+=2){const l=o[u];a.push(l<0?null:Y7(e,s[l],o[u+1],n.metadata.read))}i.matches=a}return i.matches}function RS(t,e,n,r){const i=t.queries.getByIndex(n),s=i.matches;if(null!==s){const o=WL(t,e,i,n);for(let a=0;a<s.length;a+=2){const u=s[a];if(u>0)r.push(o[a/2]);else{const l=s[a+1],d=e[-u];for(let f=Nn;f<d.length;f++){const m=d[f];m[bl]===m[un]&&RS(m[le],m,l,r)}if(null!==d[nu]){const f=d[nu];for(let m=0;m<f.length;m++){const _=f[m];RS(_[le],_,l,r)}}}}}return r}function qL(t){const e=K(),n=ht(),r=md();Fl(r+1);const i=YL(n,r);if(t.dirty&&function Sy(t){return 4==(4&t[Re])}(e)===(2==(2&i.metadata.flags))){if(null===i.matches)t.reset([]);else{const s=i.crossesNgTemplate?RS(n,e,r,[]):WL(n,e,i,r);t.reset(s,c9),t.notifyOnChanges()}return!0}return!1}function GL(t,e,n,r){const i=ht();if(i.firstCreatePass){const s=Vt();(function QL(t,e,n){null===t.queries&&(t.queries=new AS),t.queries.track(new bS(e,n))})(i,new zL(e,n,r),s.index),function tZ(t,e){const n=t.contentQueries||(t.contentQueries=[]);e!==(n.length?n[n.length-1]:-1)&&n.push(t.queries.length-1,e)}(i,t),2==(2&n)&&(i.staticContentQueries=!0)}!function ZL(t,e,n){const r=new CS(4==(4&n));(function V9(t,e,n,r){const i=Vk(e);i.push(n),t.firstCreatePass&&Uk(t).push(r,i.length-1)})(t,e,r,r.destroy),null===e[Ms]&&(e[Ms]=new DS),e[Ms].queries.push(new SS(r))}(i,K(),n)}function YL(t,e){return t.queries.getByIndex(e)}function XL(t,e){return sE(t,e)}class Ig{constructor(e){this.full=e;const n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}}const TZ=new Ig("17.0.8");let pF=(()=>{class t{log(n){console.log(n)}warn(n){console.warn(n)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();class CZ{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}}let gF=(()=>{class t{compileModuleSync(n){return new vS(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const r=this.compileModuleSync(n),s=us(wr(n).declarations).reduce((o,a)=>{const u=at(a);return u&&o.push(new eg(u)),o},[]);return new CZ(r,s)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),kS=(()=>{class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new E(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const EF=new de(""),uE=new de("");let VS,LS=(()=>{class t{constructor(n,r,i){this._ngZone=n,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,VS||(function ZZ(t){VS=t}(i),i.addToWindow(r)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Et.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(n)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,i){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),n(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:n,timeoutId:s,updateCb:i})}whenStable(n,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,r,i){return[]}static#e=this.\u0275fac=function(r){return new(r||t)(Y(Et),Y(FS),Y(uE))};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac})}return t})(),FS=(()=>{class t{constructor(){this._applications=new Map}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return VS?.findTestabilityInTree(this,n,r)??null}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();const US=new de("Application Initializer");let BS=(()=>{class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r}),this.appInits=he(US,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const i of this.appInits){const s=i();if(eE(s))n.push(s);else if(Q1(s)){const o=new Promise((a,u)=>{s.subscribe({complete:a,error:u})});n.push(o)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(i=>{this.reject(i)}),0===n.length&&r(),this.initialized=!0}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const jS=new de("appBootstrapListener");function TF(t,e){return Array.isArray(e)?e.reduce(TF,t):{...t,...e}}let nc=(()=>{class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=he(Ek),this.componentTypes=[],this.components=[],this.isStable=he(kS).hasPendingTasks.pipe(oe(n=>!n)),this._injector=he(Vs)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,r){const i=n instanceof uk;if(!this._injector.get(BS).done)throw!i&&function Ns(t){const e=at(t)||Pn(t)||lr(t);return null!==e&&e.standalone}(n),new V(405,!1);let o;o=i?n:this._injector.get(Sv).resolveComponentFactory(n),this.componentTypes.push(o.componentType);const a=function YZ(t){return t.isBoundToModule}(o)?void 0:this._injector.get(tc),l=o.create(as.NULL,[],r||o.selector,a),d=l.location.nativeElement,f=l.injector.get(EF,null);return f?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),lE(this.components,l),f?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new V(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;lE(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const r=this._injector.get(jS,[]);[...this._bootstrapListeners,...r].forEach(i=>i(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>lE(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new V(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function lE(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}let JZ=(()=>{class t{constructor(){this.zone=he(Et),this.applicationRef=he(nc)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function eQ(){const t=he(Et),e=he(Da);return n=>t.runOutsideAngular(()=>e.handleError(n))}let nQ=(()=>{class t{constructor(){this.subscription=new At,this.initialized=!1,this.zone=he(Et),this.pendingTasks=he(kS)}initialize(){if(this.initialized)return;this.initialized=!0;let n=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(n=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Et.assertNotInAngularZone(),queueMicrotask(()=>{null!==n&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(n),n=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Et.assertInAngularZone(),n??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Ra=new de("LocaleId",{providedIn:"root",factory:()=>he(Ra,ot.Optional|ot.SkipSelf)||function rQ(){return typeof $localize<"u"&&$localize.locale||lh}()}),$S=new de("PlatformDestroyListeners");let AF=(()=>{class t{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,r){const i=function A6(t="zone.js",e){return"noop"===t?new S6:"zone.js"===t?new Et(e):t}(r?.ngZone,function DF(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing}));return i.run(()=>{const s=function v7(t,e,n){return new yS(t,e,n)}(n.moduleType,this.injector,function SF(t){return[{provide:Et,useFactory:t},{provide:Hl,multi:!0,useFactory:()=>{const e=he(JZ,{optional:!0});return()=>e.initialize()}},{provide:Hl,multi:!0,useFactory:()=>{const e=he(nQ);return()=>{e.initialize()}}},{provide:Ek,useFactory:eQ}]}(()=>i)),o=s.injector.get(Da,null);return i.runOutsideAngular(()=>{const a=i.onError.subscribe({next:u=>{o.handleError(u)}});s.onDestroy(()=>{lE(this._modules,s),a.unsubscribe()})}),function wF(t,e,n){try{const r=n();return eE(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(o,i,()=>{const a=s.injector.get(BS);return a.runInitializers(),a.donePromise.then(()=>(function D1(t){Lr(t,"Expected localeId to be defined"),"string"==typeof t&&(S1=t.toLowerCase().replace(/_/g,"-"))}(s.injector.get(Ra,lh)||lh),this._moduleDoBootstrap(s),s))})})}bootstrapModule(n,r=[]){const i=TF({},r);return function QZ(t,e,n){const r=new vS(n);return Promise.resolve(r)}(0,0,n).then(s=>this.bootstrapModuleFactory(s,i))}_moduleDoBootstrap(n){const r=n.injector.get(nc);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!n.instance.ngDoBootstrap)throw new V(-403,!1);n.instance.ngDoBootstrap(r)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new V(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const n=this._injector.get($S,null);n&&(n.forEach(r=>r()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(r){return new(r||t)(Y(as))};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})(),bu=null;const bF=new de("AllowMultipleToken");function RF(t,e,n=[]){const r=`Platform: ${e}`,i=new de(r);return(s=[])=>{let o=HS();if(!o||o.injector.get(bF,!1)){const a=[...n,...s,{provide:i,useValue:!0}];t?t(a):function oQ(t){if(bu&&!bu.get(bF,!1))throw new V(400,!1);(function IF(){!function hi(t){Qi=t}(()=>{throw new V(600,!1)})})(),bu=t;const e=t.get(AF);(function NF(t){t.get(cx,null)?.forEach(n=>n())})(t)}(function PF(t=[],e){return as.create({name:e,providers:[{provide:RC,useValue:"platform"},{provide:$S,useValue:new Set([()=>bu=null])},...t]})}(a,r))}return function aQ(t){const e=HS();if(!e)throw new V(401,!1);return e}()}}function HS(){return bu?.get(AF)??null}const fQ=RF(null,"core",[]);let pQ=(()=>{class t{constructor(n){}static#e=this.\u0275fac=function(r){return new(r||t)(Y(nc))};static#t=this.\u0275mod=Er({type:t});static#n=this.\u0275inj=ar({})}return t})();function XS(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}let JS=null;function fh(){return JS}class $Q{}const zi=new de("DocumentToken");let eD=(()=>{class t{historyGo(n){throw new Error("Not implemented")}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:()=>he(zQ),providedIn:"platform"})}return t})();const HQ=new de("Location Initialized");let zQ=(()=>{class t extends eD{constructor(){super(),this._doc=he(zi),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return fh().getBaseHref(this._doc)}onPopState(n){const r=fh().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){const r=fh().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,r,i){this._history.pushState(n,r,i)}replaceState(n,r,i){this._history.replaceState(n,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:()=>new t,providedIn:"platform"})}return t})();function tD(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function tV(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function Pa(t){return t&&"?"!==t[0]?"?"+t:t}let ic=(()=>{class t{historyGo(n){throw new Error("Not implemented")}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:()=>he(rV),providedIn:"root"})}return t})();const nV=new de("appBaseHref");let rV=(()=>{class t extends ic{constructor(n,r){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??he(zi).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return tD(this._baseHref,n)}path(n=!1){const r=this._platformLocation.pathname+Pa(this._platformLocation.search),i=this._platformLocation.hash;return i&&n?`${r}${i}`:r}pushState(n,r,i,s){const o=this.prepareExternalUrl(i+Pa(s));this._platformLocation.pushState(n,r,o)}replaceState(n,r,i,s){const o=this.prepareExternalUrl(i+Pa(s));this._platformLocation.replaceState(n,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static#e=this.\u0275fac=function(r){return new(r||t)(Y(eD),Y(nV,8))};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),WQ=(()=>{class t extends ic{constructor(n,r){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(n){const r=tD(this._baseHref,n);return r.length>0?"#"+r:r}pushState(n,r,i,s){let o=this.prepareExternalUrl(i+Pa(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(n,r,o)}replaceState(n,r,i,s){let o=this.prepareExternalUrl(i+Pa(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(n,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static#e=this.\u0275fac=function(r){return new(r||t)(Y(eD),Y(nV,8))};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac})}return t})(),Sg=(()=>{class t{constructor(n){this._subject=new Ei,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const r=this._locationStrategy.getBaseHref();this._basePath=function KQ(t){if(new RegExp("^(https?:)?//").test(t)){const[,n]=t.split(/\/\/[^\/]+/);return n}return t}(tV(iV(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+Pa(r))}normalize(n){return t.stripTrailingSlash(function GQ(t,e){if(!t||!e.startsWith(t))return e;const n=e.substring(t.length);return""===n||["/",";","?","#"].includes(n[0])?n:e}(this._basePath,iV(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",i=null){this._locationStrategy.pushState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Pa(r)),i)}replaceState(n,r="",i=null){this._locationStrategy.replaceState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Pa(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(i=>i(n,r))}subscribe(n,r,i){return this._subject.subscribe({next:n,error:r,complete:i})}static#e=this.normalizeQueryParams=Pa;static#t=this.joinWithSlash=tD;static#n=this.stripTrailingSlash=tV;static#r=this.\u0275fac=function(r){return new(r||t)(Y(ic))};static#i=this.\u0275prov=ve({token:t,factory:()=>function qQ(){return new Sg(Y(ic))}(),providedIn:"root"})}return t})();function iV(t){return t.replace(/\/index.html$/,"")}let mV=(()=>{class t{constructor(n,r){this._viewContainer=n,this._context=new FY,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){_V("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){_V("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,r){return!0}static#e=this.\u0275fac=function(r){return new(r||t)(Ve(lo),Ve(ba))};static#t=this.\u0275dir=ur({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return t})();class FY{constructor(){this.$implicit=null,this.ngIf=null}}function _V(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Ke(e)}'.`)}class jY{createSubscription(e,n){return ck(()=>e.subscribe({next:n,error:r=>{throw r}}))}dispose(e){ck(()=>e.unsubscribe())}}class $Y{createSubscription(e,n){return e.then(n,r=>{throw r})}dispose(e){}}const HY=new $Y,zY=new jY;let vV=(()=>{class t{constructor(n){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=n}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(n){return this._obj?n!==this._obj?(this._dispose(),this.transform(n)):this._latestValue:(n&&this._subscribe(n),this._latestValue)}_subscribe(n){this._obj=n,this._strategy=this._selectStrategy(n),this._subscription=this._strategy.createSubscription(n,r=>this._updateLatestValue(n,r))}_selectStrategy(n){if(eE(n))return HY;if(Q1(n))return zY;throw function ho(t,e){return new V(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(n,r){n===this._obj&&(this._latestValue=r,this._ref.markForCheck())}static#e=this.\u0275fac=function(r){return new(r||t)(Ve(xv,16))};static#t=this.\u0275pipe=Ir({name:"async",type:t,pure:!1,standalone:!0})}return t})(),uX=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=Er({type:t});static#n=this.\u0275inj=ar({})}return t})();function bE(t){return"server"===t}let hX=(()=>{class t{static#e=this.\u0275prov=ve({token:t,providedIn:"root",factory:()=>new fX(Y(zi),window)})}return t})();class fX{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const n=function pX(t,e){const n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if("function"==typeof t.createTreeWalker&&t.body&&"function"==typeof t.body.attachShadow){const r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const s=i.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class VX extends $Q{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class yD extends VX{static makeCurrent(){!function jQ(t){JS||(JS=t)}(new yD)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=function UX(){return Rg=Rg||document.querySelector("base"),Rg?Rg.getAttribute("href"):null}();return null==n?null:function BX(t){return new URL(t,document.baseURI).pathname}(n)}resetBaseElement(){Rg=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function MY(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const r=n.indexOf("="),[i,s]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let Rg=null,$X=(()=>{class t{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac})}return t})();const vD=new de("EventManagerPlugins");let SV=(()=>{class t{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(i=>{i.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,r,i){return this._findPluginFor(r).addEventListener(n,r,i)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(s=>s.supports(n)),!r)throw new V(5101,!1);return this._eventNameToPlugin.set(n,r),r}static#e=this.\u0275fac=function(r){return new(r||t)(Y(vD),Y(Et))};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac})}return t})();class DV{constructor(e){this._doc=e}}const ED="ng-app-id";let AV=(()=>{class t{constructor(n,r,i,s={}){this.doc=n,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=bE(s),this.resetHostNodes()}addStyles(n){for(const r of n)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(n){for(const r of n)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(r=>r.remove()),n.clear());for(const r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const r of this.getAllStyles())this.addStyleToHost(n,r)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const r of this.hostNodes)this.addStyleToHost(r,n)}onStyleRemoved(n){const r=this.styleRef;r.get(n)?.elements?.forEach(i=>i.remove()),r.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${ED}="${this.appId}"]`);if(n?.length){const r=new Map;return n.forEach(i=>{null!=i.textContent&&r.set(i.textContent,i)}),r}return null}changeUsageCount(n,r){const i=this.styleRef;if(i.has(n)){const s=i.get(n);return s.usage+=r,s.usage}return i.set(n,{usage:r,elements:[]}),r}getStyleElement(n,r){const i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===n)return i.delete(r),s.removeAttribute(ED),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=r,this.platformIsServer&&o.setAttribute(ED,this.appId),n.appendChild(o),o}}addStyleToHost(n,r){const i=this.getStyleElement(n,r),s=this.styleRef,o=s.get(r)?.elements;o?o.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}static#e=this.\u0275fac=function(r){return new(r||t)(Y(zi),Y(sv),Y(hx,8),Y(oo))};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac})}return t})();const ID={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},wD=/%COMP%/g,qX=new de("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!0});function RV(t,e){return e.map(n=>n.replace(wD,t))}let TD=(()=>{class t{constructor(n,r,i,s,o,a,u,l=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=u,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=bE(a),this.defaultRenderer=new CD(n,o,u,this.platformIsServer)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Vi.ShadowDom&&(r={...r,encapsulation:Vi.Emulated});const i=this.getOrCreateRenderer(n,r);return i instanceof NV?i.applyToHost(n):i instanceof SD&&i.applyStyles(),i}getOrCreateRenderer(n,r){const i=this.rendererByCompId;let s=i.get(r.id);if(!s){const o=this.doc,a=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,f=this.platformIsServer;switch(r.encapsulation){case Vi.Emulated:s=new NV(u,l,r,this.appId,d,o,a,f);break;case Vi.ShadowDom:return new QX(u,l,n,r,o,a,this.nonce,f);default:s=new SD(u,l,r,d,o,a,f)}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(r){return new(r||t)(Y(SV),Y(AV),Y(sv),Y(qX),Y(zi),Y(oo),Y(Et),Y(hx))};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac})}return t})();class CD{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(ID[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(PV(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(PV(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r="string"==typeof e?this.doc.querySelector(e):e;if(!r)throw new V(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;const s=ID[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){const i=ID[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(wu.DashCase|wu.Important)?e.style.setProperty(n,r,i&wu.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&wu.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){null!=e&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if("string"==typeof e&&!(e=fh().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if("__ngUnwrap__"===n)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))&&n.preventDefault()}}}function PV(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class QX extends CD{constructor(e,n,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=RV(i.id,i.styles);for(const d of l){const f=document.createElement("style");a&&f.setAttribute("nonce",a),f.textContent=d,this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class SD extends CD{constructor(e,n,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=u?RV(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class NV extends SD{constructor(e,n,r,i,s,o,a,u){const l=i+"-"+r.id;super(e,n,r,s,o,a,u,l),this.contentAttr=function GX(t){return"_ngcontent-%COMP%".replace(wD,t)}(l),this.hostAttr=function KX(t){return"_nghost-%COMP%".replace(wD,t)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){const r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}}let YX=(()=>{class t extends DV{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,i){return n.addEventListener(r,i,!1),()=>this.removeEventListener(n,r,i)}removeEventListener(n,r,i){return n.removeEventListener(r,i)}static#e=this.\u0275fac=function(r){return new(r||t)(Y(zi))};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac})}return t})();const MV=["alt","control","meta","shift"],XX={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},JX={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let eJ=(()=>{class t extends DV{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,r,i){const s=t.parseEventName(r),o=t.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>fh().onAndCancel(n,s.domEventName,o))}static parseEventName(n){const r=n.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const s=t._normalizeKey(r.pop());let o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),MV.forEach(l=>{const d=r.indexOf(l);d>-1&&(r.splice(d,1),o+=l+".")}),o+=s,0!=r.length||0===s.length)return null;const u={};return u.domEventName=i,u.fullKey=o,u}static matchEventFullKeyCode(n,r){let i=XX[n.key]||n.key,s="";return r.indexOf("code.")>-1&&(i=n.code,s="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),MV.forEach(o=>{o!==i&&(0,JX[o])(n)&&(s+=o+".")}),s+=i,s===r)}static eventCallback(n,r,i){return s=>{t.matchEventFullKeyCode(s,n)&&i.runGuarded(()=>r(s))}}static _normalizeKey(n){return"esc"===n?"escape":n}static#e=this.\u0275fac=function(r){return new(r||t)(Y(zi))};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac})}return t})();const kV=[{provide:oo,useValue:"browser"},{provide:cx,useValue:function tJ(){yD.makeCurrent()},multi:!0},{provide:zi,useFactory:function rJ(){return function UG(t){OC=t}(document),document},deps:[]}],iJ=RF(fQ,"browser",kV),sJ=new de(""),OV=[{provide:uE,useClass:class jX{addToWindow(e){Ft.getAngularTestability=(r,i=!0)=>{const s=e.findTestabilityInTree(r,i);if(null==s)throw new V(5103,!1);return s},Ft.getAllAngularTestabilities=()=>e.getAllTestabilities(),Ft.getAllAngularRootElements=()=>e.getAllRootElements(),Ft.frameworkStabilizers||(Ft.frameworkStabilizers=[]),Ft.frameworkStabilizers.push(r=>{const i=Ft.getAllAngularTestabilities();let s=i.length,o=!1;const a=function(u){o=o||u,s--,0==s&&r(o)};i.forEach(u=>{u.whenStable(a)})})}findTestabilityInTree(e,n,r){return null==n?null:e.getTestability(n)??(r?fh().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},deps:[]},{provide:EF,useClass:LS,deps:[Et,FS,uE]},{provide:LS,useClass:LS,deps:[Et,FS,uE]}],LV=[{provide:RC,useValue:"root"},{provide:Da,useFactory:function nJ(){return new Da},deps:[]},{provide:vD,useClass:YX,multi:!0,deps:[zi,Et,oo]},{provide:vD,useClass:eJ,multi:!0,deps:[zi]},TD,AV,SV,{provide:g0,useExisting:TD},{provide:class gX{},useClass:$X,deps:[]},[]];let FV=(()=>{class t{constructor(n){}static withServerTransition(n){return{ngModule:t,providers:[{provide:sv,useValue:n.appId}]}}static#e=this.\u0275fac=function(r){return new(r||t)(Y(sJ,12))};static#t=this.\u0275mod=Er({type:t});static#n=this.\u0275inj=ar({providers:[...LV,...OV],imports:[uX,pQ]})}return t})(),VV=(()=>{class t{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static#e=this.\u0275fac=function(r){return new(r||t)(Y(zi))};static#t=this.\u0275prov=ve({token:t,factory:function(r){let i=null;return i=r?new r:function aJ(){return new VV(Y(zi))}(),i},providedIn:"root"})}return t})();typeof window<"u"&&window;const xa="*";function $V(t){return{type:6,styles:t,offset:null}}class Pg{constructor(e=0,n=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+n}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const n="start"==e?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}}class HV{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let n=0,r=0,i=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++n==s&&this._onFinish()}),o.onDestroy(()=>{++r==s&&this._onDestroy()}),o.onStart(()=>{++i==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const n=e*this.totalTime;this.players.forEach(r=>{const i=r.totalTime?Math.min(1,n/r.totalTime):1;r.setPosition(i)})}getPosition(){const e=this.players.reduce((n,r)=>null===n||r.totalTime>n.totalTime?r:n,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const n="start"==e?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}}function zV(t){return new V(3e3,!1)}function Pu(t){switch(t.length){case 0:return new Pg;case 1:return t[0];default:return new HV(t)}}function WV(t,e,n=new Map,r=new Map){const i=[],s=[];let o=-1,a=null;if(e.forEach(u=>{const l=u.get("offset"),d=l==o,f=d&&a||new Map;u.forEach((m,_)=>{let v=_,T=m;if("offset"!==_)switch(v=t.normalizePropertyName(v,i),T){case"!":T=n.get(_);break;case xa:T=r.get(_);break;default:T=t.normalizeStyleValue(_,v,T,i)}f.set(v,T)}),d||s.push(f),a=f,o=l}),i.length)throw function VJ(t){return new V(3502,!1)}();return s}function bD(t,e,n,r){switch(e){case"start":t.onStart(()=>r(n&&RD(n,"start",t)));break;case"done":t.onDone(()=>r(n&&RD(n,"done",t)));break;case"destroy":t.onDestroy(()=>r(n&&RD(n,"destroy",t)))}}function RD(t,e,n){const s=PD(t.element,t.triggerName,t.fromState,t.toState,e||t.phaseName,n.totalTime??t.totalTime,!!n.disabled),o=t._data;return null!=o&&(s._data=o),s}function PD(t,e,n,r,i="",s=0,o){return{element:t,triggerName:e,fromState:n,toState:r,phaseName:i,totalTime:s,disabled:!!o}}function hs(t,e,n){let r=t.get(e);return r||t.set(e,r=n),r}function qV(t){const e=t.indexOf(":");return[t.substring(1,e),t.slice(e+1)]}const QJ=(()=>typeof document>"u"?null:document.documentElement)();function ND(t){const e=t.parentNode||t.host||null;return e===QJ?null:e}let sc=null,GV=!1;function KV(t,e){for(;e;){if(e===t)return!0;e=ND(e)}return!1}function ZV(t,e,n){if(n)return Array.from(t.querySelectorAll(e));const r=t.querySelector(e);return r?[r]:[]}let MD=(()=>{class t{validateStyleProperty(n){return function XJ(t){sc||(sc=function JJ(){return typeof document<"u"?document.body:null}()||{},GV=!!sc.style&&"WebkitAppearance"in sc.style);let e=!0;return sc.style&&!function YJ(t){return"ebkit"==t.substring(1,6)}(t)&&(e=t in sc.style,!e&&GV&&(e="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in sc.style)),e}(n)}matchesElement(n,r){return!1}containsElement(n,r){return KV(n,r)}getParentElement(n){return ND(n)}query(n,r,i){return ZV(n,r,i)}computeStyle(n,r,i){return i||""}animate(n,r,i,s,o,a=[],u){return new Pg(i,s)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac})}return t})(),xD=(()=>{class t{static#e=this.NOOP=new MD}return t})();class kD{}const tee=1e3,OD="ng-enter",NE="ng-leave",ME="ng-trigger",xE=".ng-trigger",YV="ng-animating",LD=".ng-animating";function ka(t){if("number"==typeof t)return t;const e=t.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:FD(parseFloat(e[1]),e[2])}function FD(t,e){return"s"===e?t*tee:t}function kE(t,e,n){return t.hasOwnProperty("duration")?t:function ree(t,e,n){let i,s=0,o="";if("string"==typeof t){const a=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(zV()),{duration:0,delay:0,easing:""};i=FD(parseFloat(a[1]),a[2]);const u=a[3];null!=u&&(s=FD(parseFloat(u),a[4]));const l=a[5];l&&(o=l)}else i=t;if(!n){let a=!1,u=e.length;i<0&&(e.push(function mJ(){return new V(3100,!1)}()),a=!0),s<0&&(e.push(function _J(){return new V(3101,!1)}()),a=!0),a&&e.splice(u,0,zV())}return{duration:i,delay:s,easing:o}}(t,e,n)}function Ng(t,e={}){return Object.keys(t).forEach(n=>{e[n]=t[n]}),e}function XV(t){const e=new Map;return Object.keys(t).forEach(n=>{e.set(n,t[n])}),e}function Nu(t,e=new Map,n){if(n)for(let[r,i]of n)e.set(r,i);for(let[r,i]of t)e.set(r,i);return e}function jo(t,e,n){e.forEach((r,i)=>{const s=UD(i);n&&!n.has(i)&&n.set(i,t.style[s]),t.style[s]=r})}function oc(t,e){e.forEach((n,r)=>{const i=UD(r);t.style[i]=""})}function Mg(t){return Array.isArray(t)?1==t.length?t[0]:function hJ(t,e=null){return{type:2,steps:t,options:e}}(t):t}const VD=new RegExp("{{\\s*(.+?)\\s*}}","g");function eU(t){let e=[];if("string"==typeof t){let n;for(;n=VD.exec(t);)e.push(n[1]);VD.lastIndex=0}return e}function xg(t,e,n){const r=t.toString(),i=r.replace(VD,(s,o)=>{let a=e[o];return null==a&&(n.push(function vJ(t){return new V(3003,!1)}()),a=""),a.toString()});return i==r?t:i}function OE(t){const e=[];let n=t.next();for(;!n.done;)e.push(n.value),n=t.next();return e}const oee=/-+([a-z0-9])/g;function UD(t){return t.replace(oee,(...e)=>e[1].toUpperCase())}function fs(t,e,n){switch(e.type){case 7:return t.visitTrigger(e,n);case 0:return t.visitState(e,n);case 1:return t.visitTransition(e,n);case 2:return t.visitSequence(e,n);case 3:return t.visitGroup(e,n);case 4:return t.visitAnimate(e,n);case 5:return t.visitKeyframes(e,n);case 6:return t.visitStyle(e,n);case 8:return t.visitReference(e,n);case 9:return t.visitAnimateChild(e,n);case 10:return t.visitAnimateRef(e,n);case 11:return t.visitQuery(e,n);case 12:return t.visitStagger(e,n);default:throw function EJ(t){return new V(3004,!1)}()}}function tU(t,e){return window.getComputedStyle(t)[e]}const lee=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class nU extends kD{normalizePropertyName(e,n){return UD(e)}normalizeStyleValue(e,n,r,i){let s="";const o=r.toString().trim();if(lee.has(n)&&0!==r&&"0"!==r)if("number"==typeof r)s="px";else{const a=r.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&i.push(function IJ(t,e){return new V(3005,!1)}())}return o+s}}const LE="*";function cee(t,e){const n=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(r=>function dee(t,e,n){if(":"==t[0]){const u=function hee(t,e){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(n,r)=>parseFloat(r)>parseFloat(n);case":decrement":return(n,r)=>parseFloat(r)<parseFloat(n);default:return e.push(function kJ(t){return new V(3016,!1)}()),"* => *"}}(t,n);if("function"==typeof u)return void e.push(u);t=u}const r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return n.push(function xJ(t){return new V(3015,!1)}()),e;const i=r[1],s=r[2],o=r[3];e.push(rU(i,o));"<"==s[0]&&!(i==LE&&o==LE)&&e.push(rU(o,i))}(r,n,e)):n.push(t),n}const FE=new Set(["true","1"]),VE=new Set(["false","0"]);function rU(t,e){const n=FE.has(t)||VE.has(t),r=FE.has(e)||VE.has(e);return(i,s)=>{let o=t==LE||t==i,a=e==LE||e==s;return!o&&n&&"boolean"==typeof i&&(o=i?FE.has(t):VE.has(t)),!a&&r&&"boolean"==typeof s&&(a=s?FE.has(e):VE.has(e)),o&&a}}const fee=new RegExp("s*:selfs*,?","g");function BD(t,e,n,r){return new pee(t).build(e,n,r)}class pee{constructor(e){this._driver=e}build(e,n,r){const i=new _ee(n);return this._resetContextStyleTimingState(i),fs(this,Mg(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,n){let r=n.queryCount=0,i=n.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&n.errors.push(function wJ(){return new V(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(n),0==a.type){const u=a,l=u.name;l.toString().split(/\s*,\s*/).forEach(d=>{u.name=d,s.push(this.visitState(u,n))}),u.name=l}else if(1==a.type){const u=this.visitTransition(a,n);r+=u.queryCount,i+=u.depCount,o.push(u)}else n.errors.push(function TJ(){return new V(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:r,depCount:i,options:null}}visitState(e,n){const r=this.visitStyle(e.styles,n),i=e.options&&e.options.params||null;if(r.containsDynamicStyles){const s=new Set,o=i||{};r.styles.forEach(a=>{a instanceof Map&&a.forEach(u=>{eU(u).forEach(l=>{o.hasOwnProperty(l)||s.add(l)})})}),s.size&&(OE(s.values()),n.errors.push(function CJ(t,e){return new V(3008,!1)}()))}return{type:0,name:e.name,style:r,options:i?{params:i}:null}}visitTransition(e,n){n.queryCount=0,n.depCount=0;const r=fs(this,Mg(e.animation),n);return{type:1,matchers:cee(e.expr,n.errors),animation:r,queryCount:n.queryCount,depCount:n.depCount,options:ac(e.options)}}visitSequence(e,n){return{type:2,steps:e.steps.map(r=>fs(this,r,n)),options:ac(e.options)}}visitGroup(e,n){const r=n.currentTime;let i=0;const s=e.steps.map(o=>{n.currentTime=r;const a=fs(this,o,n);return i=Math.max(i,n.currentTime),a});return n.currentTime=i,{type:3,steps:s,options:ac(e.options)}}visitAnimate(e,n){const r=function vee(t,e){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return jD(kE(t,e).duration,0,"");const n=t;if(n.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=jD(0,0,"");return s.dynamic=!0,s.strValue=n,s}const i=kE(n,e);return jD(i.duration,i.delay,i.easing)}(e.timings,n.errors);n.currentAnimateTimings=r;let i,s=e.styles?e.styles:$V({});if(5==s.type)i=this.visitKeyframes(s,n);else{let o=e.styles,a=!1;if(!o){a=!0;const l={};r.easing&&(l.easing=r.easing),o=$V(l)}n.currentTime+=r.duration+r.delay;const u=this.visitStyle(o,n);u.isEmptyStep=a,i=u}return n.currentAnimateTimings=null,{type:4,timings:r,style:i,options:null}}visitStyle(e,n){const r=this._makeStyleAst(e,n);return this._validateStyleAst(r,n),r}_makeStyleAst(e,n){const r=[],i=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of i)"string"==typeof a?a===xa?r.push(a):n.errors.push(new V(3002,!1)):r.push(XV(a));let s=!1,o=null;return r.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let u of a.values())if(u.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:r,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,n){const r=n.currentAnimateTimings;let i=n.currentTime,s=n.currentTime;r&&s>0&&(s-=r.duration+r.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,u)=>{const l=n.collectedStyles.get(n.currentQuerySelector),d=l.get(u);let f=!0;d&&(s!=i&&s>=d.startTime&&i<=d.endTime&&(n.errors.push(function DJ(t,e,n,r,i){return new V(3010,!1)}()),f=!1),s=d.startTime),f&&l.set(u,{startTime:s,endTime:i}),n.options&&function see(t,e,n){const r=e.params||{},i=eU(t);i.length&&i.forEach(s=>{r.hasOwnProperty(s)||n.push(function yJ(t){return new V(3001,!1)}())})}(a,n.options,n.errors)})})}visitKeyframes(e,n){const r={type:5,styles:[],options:null};if(!n.currentAnimateTimings)return n.errors.push(function AJ(){return new V(3011,!1)}()),r;let s=0;const o=[];let a=!1,u=!1,l=0;const d=e.steps.map(x=>{const R=this._makeStyleAst(x,n);let L=null!=R.offset?R.offset:function yee(t){if("string"==typeof t)return null;let e=null;if(Array.isArray(t))t.forEach(n=>{if(n instanceof Map&&n.has("offset")){const r=n;e=parseFloat(r.get("offset")),r.delete("offset")}});else if(t instanceof Map&&t.has("offset")){const n=t;e=parseFloat(n.get("offset")),n.delete("offset")}return e}(R.styles),G=0;return null!=L&&(s++,G=R.offset=L),u=u||G<0||G>1,a=a||G<l,l=G,o.push(G),R});u&&n.errors.push(function bJ(){return new V(3012,!1)}()),a&&n.errors.push(function RJ(){return new V(3200,!1)}());const f=e.steps.length;let m=0;s>0&&s<f?n.errors.push(function PJ(){return new V(3202,!1)}()):0==s&&(m=1/(f-1));const _=f-1,v=n.currentTime,T=n.currentAnimateTimings,D=T.duration;return d.forEach((x,R)=>{const L=m>0?R==_?1:m*R:o[R],G=L*D;n.currentTime=v+T.delay+G,T.duration=G,this._validateStyleAst(x,n),x.offset=L,r.styles.push(x)}),r}visitReference(e,n){return{type:8,animation:fs(this,Mg(e.animation),n),options:ac(e.options)}}visitAnimateChild(e,n){return n.depCount++,{type:9,options:ac(e.options)}}visitAnimateRef(e,n){return{type:10,animation:this.visitReference(e.animation,n),options:ac(e.options)}}visitQuery(e,n){const r=n.currentQuerySelector,i=e.options||{};n.queryCount++,n.currentQuery=e;const[s,o]=function gee(t){const e=!!t.split(/\s*,\s*/).find(n=>":self"==n);return e&&(t=t.replace(fee,"")),t=t.replace(/@\*/g,xE).replace(/@\w+/g,n=>xE+"-"+n.slice(1)).replace(/:animating/g,LD),[t,e]}(e.selector);n.currentQuerySelector=r.length?r+" "+s:s,hs(n.collectedStyles,n.currentQuerySelector,new Map);const a=fs(this,Mg(e.animation),n);return n.currentQuery=null,n.currentQuerySelector=r,{type:11,selector:s,limit:i.limit||0,optional:!!i.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:ac(e.options)}}visitStagger(e,n){n.currentQuery||n.errors.push(function NJ(){return new V(3013,!1)}());const r="full"===e.timings?{duration:0,delay:0,easing:"full"}:kE(e.timings,n.errors,!0);return{type:12,animation:fs(this,Mg(e.animation),n),timings:r,options:null}}}class _ee{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function ac(t){return t?(t=Ng(t)).params&&(t.params=function mee(t){return t?Ng(t):null}(t.params)):t={},t}function jD(t,e,n){return{duration:t,delay:e,easing:n}}function $D(t,e,n,r,i,s,o=null,a=!1){return{type:1,element:t,keyframes:e,preStyleProps:n,postStyleProps:r,duration:i,delay:s,totalTime:i+s,easing:o,subTimeline:a}}class UE{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,n){let r=this._map.get(e);r||this._map.set(e,r=[]),r.push(...n)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const wee=new RegExp(":enter","g"),Cee=new RegExp(":leave","g");function HD(t,e,n,r,i,s=new Map,o=new Map,a,u,l=[]){return(new See).buildKeyframes(t,e,n,r,i,s,o,a,u,l)}class See{buildKeyframes(e,n,r,i,s,o,a,u,l,d=[]){l=l||new UE;const f=new zD(e,n,l,i,s,d,[]);f.options=u;const m=u.delay?ka(u.delay):0;f.currentTimeline.delayNextStep(m),f.currentTimeline.setStyles([o],null,f.errors,u),fs(this,r,f);const _=f.timelines.filter(v=>v.containsAnimation());if(_.length&&a.size){let v;for(let T=_.length-1;T>=0;T--){const D=_[T];if(D.element===n){v=D;break}}v&&!v.allowOnlyTimelineStyles()&&v.setStyles([a],null,f.errors,u)}return _.length?_.map(v=>v.buildKeyframes()):[$D(n,[],[],[],0,m,"",!1)]}visitTrigger(e,n){}visitState(e,n){}visitTransition(e,n){}visitAnimateChild(e,n){const r=n.subInstructions.get(n.element);if(r){const i=n.createSubContext(e.options),s=n.currentTimeline.currentTime,o=this._visitSubInstructions(r,i,i.options);s!=o&&n.transformIntoNewTimeline(o)}n.previousNode=e}visitAnimateRef(e,n){const r=n.createSubContext(e.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],n,r),this.visitReference(e.animation,r),n.transformIntoNewTimeline(r.currentTimeline.currentTime),n.previousNode=e}_applyAnimationRefDelays(e,n,r){for(const i of e){const s=i?.delay;if(s){const o="number"==typeof s?s:ka(xg(s,i?.params??{},n.errors));r.delayNextStep(o)}}}_visitSubInstructions(e,n,r){let s=n.currentTimeline.currentTime;const o=null!=r.duration?ka(r.duration):null,a=null!=r.delay?ka(r.delay):null;return 0!==o&&e.forEach(u=>{const l=n.appendInstructionToTimeline(u,o,a);s=Math.max(s,l.duration+l.delay)}),s}visitReference(e,n){n.updateOptions(e.options,!0),fs(this,e.animation,n),n.previousNode=e}visitSequence(e,n){const r=n.subContextCount;let i=n;const s=e.options;if(s&&(s.params||s.delay)&&(i=n.createSubContext(s),i.transformIntoNewTimeline(),null!=s.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=BE);const o=ka(s.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>fs(this,o,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),n.previousNode=e}visitGroup(e,n){const r=[];let i=n.currentTimeline.currentTime;const s=e.options&&e.options.delay?ka(e.options.delay):0;e.steps.forEach(o=>{const a=n.createSubContext(e.options);s&&a.delayNextStep(s),fs(this,o,a),i=Math.max(i,a.currentTimeline.currentTime),r.push(a.currentTimeline)}),r.forEach(o=>n.currentTimeline.mergeTimelineCollectedStyles(o)),n.transformIntoNewTimeline(i),n.previousNode=e}_visitTiming(e,n){if(e.dynamic){const r=e.strValue;return kE(n.params?xg(r,n.params,n.errors):r,n.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,n){const r=n.currentAnimateTimings=this._visitTiming(e.timings,n),i=n.currentTimeline;r.delay&&(n.incrementTime(r.delay),i.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,n):(n.incrementTime(r.duration),this.visitStyle(s,n),i.applyStylesToKeyframe()),n.currentAnimateTimings=null,n.previousNode=e}visitStyle(e,n){const r=n.currentTimeline,i=n.currentAnimateTimings;!i&&r.hasCurrentStyleProperties()&&r.forwardFrame();const s=i&&i.easing||e.easing;e.isEmptyStep?r.applyEmptyStep(s):r.setStyles(e.styles,s,n.errors,n.options),n.previousNode=e}visitKeyframes(e,n){const r=n.currentAnimateTimings,i=n.currentTimeline.duration,s=r.duration,a=n.createSubContext().currentTimeline;a.easing=r.easing,e.styles.forEach(u=>{a.forwardTime((u.offset||0)*s),a.setStyles(u.styles,u.easing,n.errors,n.options),a.applyStylesToKeyframe()}),n.currentTimeline.mergeTimelineCollectedStyles(a),n.transformIntoNewTimeline(i+s),n.previousNode=e}visitQuery(e,n){const r=n.currentTimeline.currentTime,i=e.options||{},s=i.delay?ka(i.delay):0;s&&(6===n.previousNode.type||0==r&&n.currentTimeline.hasCurrentStyleProperties())&&(n.currentTimeline.snapshotCurrentStyles(),n.previousNode=BE);let o=r;const a=n.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,n.errors);n.currentQueryTotal=a.length;let u=null;a.forEach((l,d)=>{n.currentQueryIndex=d;const f=n.createSubContext(e.options,l);s&&f.delayNextStep(s),l===n.element&&(u=f.currentTimeline),fs(this,e.animation,f),f.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,f.currentTimeline.currentTime)}),n.currentQueryIndex=0,n.currentQueryTotal=0,n.transformIntoNewTimeline(o),u&&(n.currentTimeline.mergeTimelineCollectedStyles(u),n.currentTimeline.snapshotCurrentStyles()),n.previousNode=e}visitStagger(e,n){const r=n.parentContext,i=n.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(n.currentQueryTotal-1);let u=o*n.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":u=a-u;break;case"full":u=r.currentStaggerTime}const d=n.currentTimeline;u&&d.delayNextStep(u);const f=d.currentTime;fs(this,e.animation,n),n.previousNode=e,r.currentStaggerTime=i.currentTime-f+(i.startTime-r.currentTimeline.startTime)}}const BE={};class zD{constructor(e,n,r,i,s,o,a,u){this._driver=e,this.element=n,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=BE,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new jE(this._driver,n,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,n){if(!e)return;const r=e;let i=this.options;null!=r.duration&&(i.duration=ka(r.duration)),null!=r.delay&&(i.delay=ka(r.delay));const s=r.params;if(s){let o=i.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!n||!o.hasOwnProperty(a))&&(o[a]=xg(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const n=this.options.params;if(n){const r=e.params={};Object.keys(n).forEach(i=>{r[i]=n[i]})}}return e}createSubContext(e=null,n,r){const i=n||this.element,s=new zD(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=BE,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,n,r){const i={duration:n??e.duration,delay:this.currentTimeline.currentTime+(r??0)+e.delay,easing:""},s=new Dee(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(s),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,n,r,i,s,o){let a=[];if(i&&a.push(this.element),e.length>0){e=(e=e.replace(wee,"."+this._enterClassName)).replace(Cee,"."+this._leaveClassName);let l=this._driver.query(this.element,e,1!=r);0!==r&&(l=r<0?l.slice(l.length+r,l.length):l.slice(0,r)),a.push(...l)}return!s&&0==a.length&&o.push(function MJ(t){return new V(3014,!1)}()),a}}class jE{constructor(e,n,r,i){this._driver=e,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const n=1===this._keyframes.size&&this._pendingStyles.size;this.duration||n?(this.forwardTime(this.currentTime+e),n&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,n){return this.applyStylesToKeyframe(),new jE(this._driver,e,n||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,n){this._localTimelineStyles.set(e,n),this._globalTimelineStyles.set(e,n),this._styleSummary.set(e,{time:this.currentTime,value:n})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[n,r]of this._globalTimelineStyles)this._backFill.set(n,r||xa),this._currentKeyframe.set(n,xa);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,n,r,i){n&&this._previousKeyframe.set("easing",n);const s=i&&i.params||{},o=function Aee(t,e){const n=new Map;let r;return t.forEach(i=>{if("*"===i){r=r||e.keys();for(let s of r)n.set(s,xa)}else Nu(i,n)}),n}(e,this._globalTimelineStyles);for(let[a,u]of o){const l=xg(u,s,r);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??xa),this._updateStyle(a,l)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,n)=>{this._currentKeyframe.set(n,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,n)=>{this._currentKeyframe.has(n)||this._currentKeyframe.set(n,e)}))}snapshotCurrentStyles(){for(let[e,n]of this._localTimelineStyles)this._pendingStyles.set(e,n),this._updateStyle(e,n)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let n in this._currentKeyframe)e.push(n);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((n,r)=>{const i=this._styleSummary.get(r);(!i||n.time>i.time)&&this._updateStyle(r,n.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,n=new Set,r=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((a,u)=>{const l=Nu(a,new Map,this._backFill);l.forEach((d,f)=>{"!"===d?e.add(f):d===xa&&n.add(f)}),r||l.set("offset",u/this.duration),i.push(l)});const s=e.size?OE(e.values()):[],o=n.size?OE(n.values()):[];if(r){const a=i[0],u=new Map(a);a.set("offset",0),u.set("offset",1),i=[a,u]}return $D(this.element,i,s,o,this.duration,this.startTime,this.easing,!1)}}class Dee extends jE{constructor(e,n,r,i,s,o,a=!1){super(e,n,o.delay),this.keyframes=r,this.preStyleProps=i,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:n,duration:r,easing:i}=this.timings;if(this._stretchStartingKeyframe&&n){const s=[],o=r+n,a=n/o,u=Nu(e[0]);u.set("offset",0),s.push(u);const l=Nu(e[0]);l.set("offset",oU(a)),s.push(l);const d=e.length-1;for(let f=1;f<=d;f++){let m=Nu(e[f]);const _=m.get("offset");m.set("offset",oU((n+_*r)/o)),s.push(m)}r=o,n=0,i="",e=s}return $D(this.element,e,this.preStyleProps,this.postStyleProps,r,n,i,!0)}}function oU(t,e=3){const n=Math.pow(10,e-1);return Math.round(t*n)/n}function aU(t,e,n,r,i,s,o,a,u,l,d,f,m){return{type:0,element:t,triggerName:e,isRemovalTransition:i,fromState:n,fromStyles:s,toState:r,toStyles:o,timelines:a,queriedElements:u,preStyleProps:l,postStyleProps:d,totalTime:f,errors:m}}const WD={};class uU{constructor(e,n,r){this._triggerName=e,this.ast=n,this._stateStyles=r}match(e,n,r,i){return function bee(t,e,n,r,i){return t.some(s=>s(e,n,r,i))}(this.ast.matchers,e,n,r,i)}buildStyles(e,n,r){let i=this._stateStyles.get("*");return void 0!==e&&(i=this._stateStyles.get(e?.toString())||i),i?i.buildStyles(n,r):new Map}build(e,n,r,i,s,o,a,u,l,d){const f=[],m=this.ast.options&&this.ast.options.params||WD,v=this.buildStyles(r,a&&a.params||WD,f),T=u&&u.params||WD,D=this.buildStyles(i,T,f),x=new Set,R=new Map,L=new Map,G="void"===i,ae={params:Ree(T,m),delay:this.ast.options?.delay},ye=d?[]:HD(e,n,this.ast.animation,s,o,v,D,ae,l,f);let Qe=0;if(ye.forEach(Zr=>{Qe=Math.max(Zr.duration+Zr.delay,Qe)}),f.length)return aU(n,this._triggerName,r,i,G,v,D,[],[],R,L,Qe,f);ye.forEach(Zr=>{const Zs=Zr.element,rG=hs(R,Zs,new Set);Zr.preStyleProps.forEach(Qc=>rG.add(Qc));const q_=hs(L,Zs,new Set);Zr.postStyleProps.forEach(Qc=>q_.add(Qc)),Zs!==n&&x.add(Zs)});const Bt=OE(x.values());return aU(n,this._triggerName,r,i,G,v,D,ye,Bt,R,L,Qe)}}function Ree(t,e){const n=Ng(e);for(const r in t)t.hasOwnProperty(r)&&null!=t[r]&&(n[r]=t[r]);return n}class Pee{constructor(e,n,r){this.styles=e,this.defaultParams=n,this.normalizer=r}buildStyles(e,n){const r=new Map,i=Ng(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(i[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=xg(o,i,n));const u=this.normalizer.normalizePropertyName(a,n);o=this.normalizer.normalizeStyleValue(a,u,o,n),r.set(a,o)})}),r}}class Mee{constructor(e,n,r){this.name=e,this.ast=n,this._normalizer=r,this.transitionFactories=[],this.states=new Map,n.states.forEach(i=>{this.states.set(i.name,new Pee(i.style,i.options&&i.options.params||{},r))}),lU(this.states,"true","1"),lU(this.states,"false","0"),n.transitions.forEach(i=>{this.transitionFactories.push(new uU(e,i,this.states))}),this.fallbackTransition=function xee(t,e,n){return new uU(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,n,r,i){return this.transitionFactories.find(o=>o.match(e,n,r,i))||null}matchStyles(e,n,r){return this.fallbackTransition.buildStyles(e,n,r)}}function lU(t,e,n){t.has(e)?t.has(n)||t.set(n,t.get(e)):t.has(n)&&t.set(e,t.get(n))}const kee=new UE;class Oee{constructor(e,n,r){this.bodyNode=e,this._driver=n,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,n){const r=[],s=BD(this._driver,n,r,[]);if(r.length)throw function UJ(t){return new V(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,n,r){const i=e.element,s=WV(this._normalizer,e.keyframes,n,r);return this._driver.animate(i,s,e.duration,e.delay,e.easing,[],!0)}create(e,n,r={}){const i=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=HD(this._driver,n,s,OD,NE,new Map,new Map,r,kee,i),o.forEach(d=>{const f=hs(a,d.element,new Map);d.postStyleProps.forEach(m=>f.set(m,null))})):(i.push(function BJ(){return new V(3300,!1)}()),o=[]),i.length)throw function jJ(t){return new V(3504,!1)}();a.forEach((d,f)=>{d.forEach((m,_)=>{d.set(_,this._driver.computeStyle(f,_,xa))})});const l=Pu(o.map(d=>{const f=a.get(d.element);return this._buildPlayer(d,new Map,f)}));return this._playersById.set(e,l),l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){const n=this._getPlayer(e);n.destroy(),this._playersById.delete(e);const r=this.players.indexOf(n);r>=0&&this.players.splice(r,1)}_getPlayer(e){const n=this._playersById.get(e);if(!n)throw function $J(t){return new V(3301,!1)}();return n}listen(e,n,r,i){const s=PD(n,"","","");return bD(this._getPlayer(e),r,s,i),()=>{}}command(e,n,r,i){if("register"==r)return void this.register(e,i[0]);if("create"==r)return void this.create(e,n,i[0]||{});const s=this._getPlayer(e);switch(r){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e)}}}const cU="ng-animate-queued",qD="ng-animate-disabled",Bee=[],dU={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},jee={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},fo="__ng_removed";class GD{get params(){return this.options.params}constructor(e,n=""){this.namespaceId=n;const r=e&&e.hasOwnProperty("value");if(this.value=function Wee(t){return t??null}(r?e.value:e),r){const s=Ng(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const n=e.params;if(n){const r=this.options.params;Object.keys(n).forEach(i=>{null==r[i]&&(r[i]=n[i])})}}}const kg="void",KD=new GD(kg);class $ee{constructor(e,n,r){this.id=e,this.hostElement=n,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Hs(n,this._hostClassName)}listen(e,n,r,i){if(!this._triggers.has(n))throw function HJ(t,e){return new V(3302,!1)}();if(null==r||0==r.length)throw function zJ(t){return new V(3303,!1)}();if(!function qee(t){return"start"==t||"done"==t}(r))throw function WJ(t,e){return new V(3400,!1)}();const s=hs(this._elementListeners,e,[]),o={name:n,phase:r,callback:i};s.push(o);const a=hs(this._engine.statesByElement,e,new Map);return a.has(n)||(Hs(e,ME),Hs(e,ME+"-"+n),a.set(n,KD)),()=>{this._engine.afterFlush(()=>{const u=s.indexOf(o);u>=0&&s.splice(u,1),this._triggers.has(n)||a.delete(n)})}}register(e,n){return!this._triggers.has(e)&&(this._triggers.set(e,n),!0)}_getTrigger(e){const n=this._triggers.get(e);if(!n)throw function qJ(t){return new V(3401,!1)}();return n}trigger(e,n,r,i=!0){const s=this._getTrigger(n),o=new ZD(this.id,n,e);let a=this._engine.statesByElement.get(e);a||(Hs(e,ME),Hs(e,ME+"-"+n),this._engine.statesByElement.set(e,a=new Map));let u=a.get(n);const l=new GD(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&u&&l.absorbOptions(u.options),a.set(n,l),u||(u=KD),l.value!==kg&&u.value===l.value){if(!function Zee(t,e){const n=Object.keys(t),r=Object.keys(e);if(n.length!=r.length)return!1;for(let i=0;i<n.length;i++){const s=n[i];if(!e.hasOwnProperty(s)||t[s]!==e[s])return!1}return!0}(u.params,l.params)){const T=[],D=s.matchStyles(u.value,u.params,T),x=s.matchStyles(l.value,l.params,T);T.length?this._engine.reportError(T):this._engine.afterFlush(()=>{oc(e,D),jo(e,x)})}return}const m=hs(this._engine.playersByElement,e,[]);m.forEach(T=>{T.namespaceId==this.id&&T.triggerName==n&&T.queued&&T.destroy()});let _=s.matchTransition(u.value,l.value,e,l.params),v=!1;if(!_){if(!i)return;_=s.fallbackTransition,v=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:n,transition:_,fromState:u,toState:l,player:o,isFallbackTransition:v}),v||(Hs(e,cU),o.onStart(()=>{gh(e,cU)})),o.onDone(()=>{let T=this.players.indexOf(o);T>=0&&this.players.splice(T,1);const D=this._engine.playersByElement.get(e);if(D){let x=D.indexOf(o);x>=0&&D.splice(x,1)}}),this.players.push(o),m.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(n=>n.delete(e)),this._elementListeners.forEach((n,r)=>{this._elementListeners.set(r,n.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const n=this._engine.playersByElement.get(e);n&&(n.forEach(r=>r.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,n){const r=this._engine.driver.query(e,xE,!0);r.forEach(i=>{if(i[fo])return;const s=this._engine.fetchNamespacesByElement(i);s.size?s.forEach(o=>o.triggerLeaveAnimation(i,n,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,n,r,i){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((u,l)=>{if(o.set(l,u.value),this._triggers.has(l)){const d=this.trigger(e,l,kg,i);d&&a.push(d)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,n,o),r&&Pu(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const n=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(n&&r){const i=new Set;n.forEach(s=>{const o=s.name;if(i.has(o))return;i.add(o);const u=this._triggers.get(o).fallbackTransition,l=r.get(o)||KD,d=new GD(kg),f=new ZD(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:u,fromState:l,toState:d,player:f,isFallbackTransition:!0})})}}removeNode(e,n){const r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,n),this.triggerLeaveAnimation(e,n,!0))return;let i=!1;if(r.totalAnimations){const s=r.players.length?r.playersByQueriedElement.get(e):[];if(s&&s.length)i=!0;else{let o=e;for(;o=o.parentNode;)if(r.statesByElement.get(o)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,n);else{const s=e[fo];(!s||s===dU)&&(r.afterFlush(()=>this.clearElementCache(e)),r.destroyInnerAnimations(e),r._onRemovalComplete(e,n))}}insertNode(e,n){Hs(e,this._hostClassName)}drainQueuedTransitions(e){const n=[];return this._queue.forEach(r=>{const i=r.player;if(i.destroyed)return;const s=r.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==r.triggerName){const u=PD(s,r.triggerName,r.fromState.value,r.toState.value);u._data=e,bD(r.player,a.phase,u,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):n.push(r)}),this._queue=[],n.sort((r,i)=>{const s=r.transition.ast.depCount,o=i.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(r.element,i.element)?1:-1})}destroy(e){this.players.forEach(n=>n.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class Hee{_onRemovalComplete(e,n){this.onRemovalComplete(e,n)}constructor(e,n,r){this.bodyNode=e,this.driver=n,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(n=>{n.players.forEach(r=>{r.queued&&e.push(r)})}),e}createNamespace(e,n){const r=new $ee(e,n,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,n)?this._balanceNamespaceList(r,n):(this.newHostElements.set(n,r),this.collectEnterElement(n)),this._namespaceLookup[e]=r}_balanceNamespaceList(e,n){const r=this._namespaceList,i=this.namespacesByHostElement;if(r.length-1>=0){let o=!1,a=this.driver.getParentElement(n);for(;a;){const u=i.get(a);if(u){const l=r.indexOf(u);r.splice(l+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||r.unshift(e)}else r.push(e);return i.set(n,e),e}register(e,n){let r=this._namespaceLookup[e];return r||(r=this.createNamespace(e,n)),r}registerTrigger(e,n,r){let i=this._namespaceLookup[e];i&&i.register(n,r)&&this.totalAnimations++}destroy(e,n){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const r=this._fetchNamespace(e);this.namespacesByHostElement.delete(r.hostElement);const i=this._namespaceList.indexOf(r);i>=0&&this._namespaceList.splice(i,1),r.destroy(n),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const n=new Set,r=this.statesByElement.get(e);if(r)for(let i of r.values())if(i.namespaceId){const s=this._fetchNamespace(i.namespaceId);s&&n.add(s)}return n}trigger(e,n,r,i){if($E(n)){const s=this._fetchNamespace(e);if(s)return s.trigger(n,r,i),!0}return!1}insertNode(e,n,r,i){if(!$E(n))return;const s=n[fo];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(n);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(n,r)}i&&this.collectEnterElement(n)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,n){n?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Hs(e,qD)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),gh(e,qD))}removeNode(e,n,r){if($E(n)){const i=e?this._fetchNamespace(e):null;i?i.removeNode(n,r):this.markElementAsRemoved(e,n,!1,r);const s=this.namespacesByHostElement.get(n);s&&s.id!==e&&s.removeNode(n,r)}else this._onRemovalComplete(n,r)}markElementAsRemoved(e,n,r,i,s){this.collectedLeaveElements.push(n),n[fo]={namespaceId:e,setForRemoval:i,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,n,r,i,s){return $E(n)?this._fetchNamespace(e).listen(n,r,i,s):()=>{}}_buildInstruction(e,n,r,i,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,r,i,e.fromState.options,e.toState.options,n,s)}destroyInnerAnimations(e){let n=this.driver.query(e,xE,!0);n.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(n=this.driver.query(e,LD,!0),n.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(e){const n=this.playersByElement.get(e);n&&n.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(e){const n=this.playersByQueriedElement.get(e);n&&n.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Pu(this.players).onDone(()=>e());e()})}processLeaveNode(e){const n=e[fo];if(n&&n.setForRemoval){if(e[fo]=dU,n.namespaceId){this.destroyInnerAnimations(e);const r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}e.classList?.contains(qD)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(e=-1){let n=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,i)=>this._balanceNamespaceList(r,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)Hs(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{n=this._flushAnimations(r,e)}finally{for(let i=0;i<r.length;i++)r[i]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],n.length?Pu(n).onDone(()=>{r.forEach(i=>i())}):r.forEach(i=>i())}}reportError(e){throw function GJ(t){return new V(3402,!1)}()}_flushAnimations(e,n){const r=new UE,i=[],s=new Map,o=[],a=new Map,u=new Map,l=new Map,d=new Set;this.disabledNodes.forEach(Ce=>{d.add(Ce);const Oe=this.driver.query(Ce,".ng-animate-queued",!0);for(let $e=0;$e<Oe.length;$e++)d.add(Oe[$e])});const f=this.bodyNode,m=Array.from(this.statesByElement.keys()),_=pU(m,this.collectedEnterElements),v=new Map;let T=0;_.forEach((Ce,Oe)=>{const $e=OD+T++;v.set(Oe,$e),Ce.forEach(bt=>Hs(bt,$e))});const D=[],x=new Set,R=new Set;for(let Ce=0;Ce<this.collectedLeaveElements.length;Ce++){const Oe=this.collectedLeaveElements[Ce],$e=Oe[fo];$e&&$e.setForRemoval&&(D.push(Oe),x.add(Oe),$e.hasAnimation?this.driver.query(Oe,".ng-star-inserted",!0).forEach(bt=>x.add(bt)):R.add(Oe))}const L=new Map,G=pU(m,Array.from(x));G.forEach((Ce,Oe)=>{const $e=NE+T++;L.set(Oe,$e),Ce.forEach(bt=>Hs(bt,$e))}),e.push(()=>{_.forEach((Ce,Oe)=>{const $e=v.get(Oe);Ce.forEach(bt=>gh(bt,$e))}),G.forEach((Ce,Oe)=>{const $e=L.get(Oe);Ce.forEach(bt=>gh(bt,$e))}),D.forEach(Ce=>{this.processLeaveNode(Ce)})});const ae=[],ye=[];for(let Ce=this._namespaceList.length-1;Ce>=0;Ce--)this._namespaceList[Ce].drainQueuedTransitions(n).forEach($e=>{const bt=$e.player,Mr=$e.element;if(ae.push(bt),this.collectedEnterElements.length){const di=Mr[fo];if(di&&di.setForMove){if(di.previousTriggersValues&&di.previousTriggersValues.has($e.triggerName)){const Yc=di.previousTriggersValues.get($e.triggerName),Qs=this.statesByElement.get($e.element);if(Qs&&Qs.has($e.triggerName)){const DT=Qs.get($e.triggerName);DT.value=Yc,Qs.set($e.triggerName,DT)}}return void bt.destroy()}}const la=!f||!this.driver.containsElement(f,Mr),Cs=L.get(Mr),fl=v.get(Mr),Ln=this._buildInstruction($e,r,fl,Cs,la);if(Ln.errors&&Ln.errors.length)return void ye.push(Ln);if(la)return bt.onStart(()=>oc(Mr,Ln.fromStyles)),bt.onDestroy(()=>jo(Mr,Ln.toStyles)),void i.push(bt);if($e.isFallbackTransition)return bt.onStart(()=>oc(Mr,Ln.fromStyles)),bt.onDestroy(()=>jo(Mr,Ln.toStyles)),void i.push(bt);const oG=[];Ln.timelines.forEach(di=>{di.stretchStartingKeyframe=!0,this.disabledNodes.has(di.element)||oG.push(di)}),Ln.timelines=oG,r.append(Mr,Ln.timelines),o.push({instruction:Ln,player:bt,element:Mr}),Ln.queriedElements.forEach(di=>hs(a,di,[]).push(bt)),Ln.preStyleProps.forEach((di,Yc)=>{if(di.size){let Qs=u.get(Yc);Qs||u.set(Yc,Qs=new Set),di.forEach((DT,IM)=>Qs.add(IM))}}),Ln.postStyleProps.forEach((di,Yc)=>{let Qs=l.get(Yc);Qs||l.set(Yc,Qs=new Set),di.forEach((DT,IM)=>Qs.add(IM))})});if(ye.length){const Ce=[];ye.forEach(Oe=>{Ce.push(function KJ(t,e){return new V(3505,!1)}())}),ae.forEach(Oe=>Oe.destroy()),this.reportError(Ce)}const Qe=new Map,Bt=new Map;o.forEach(Ce=>{const Oe=Ce.element;r.has(Oe)&&(Bt.set(Oe,Oe),this._beforeAnimationBuild(Ce.player.namespaceId,Ce.instruction,Qe))}),i.forEach(Ce=>{const Oe=Ce.element;this._getPreviousPlayers(Oe,!1,Ce.namespaceId,Ce.triggerName,null).forEach(bt=>{hs(Qe,Oe,[]).push(bt),bt.destroy()})});const Zr=D.filter(Ce=>mU(Ce,u,l)),Zs=new Map;fU(Zs,this.driver,R,l,xa).forEach(Ce=>{mU(Ce,u,l)&&Zr.push(Ce)});const q_=new Map;_.forEach((Ce,Oe)=>{fU(q_,this.driver,new Set(Ce),u,"!")}),Zr.forEach(Ce=>{const Oe=Zs.get(Ce),$e=q_.get(Ce);Zs.set(Ce,new Map([...Oe?.entries()??[],...$e?.entries()??[]]))});const Qc=[],iG=[],sG={};o.forEach(Ce=>{const{element:Oe,player:$e,instruction:bt}=Ce;if(r.has(Oe)){if(d.has(Oe))return $e.onDestroy(()=>jo(Oe,bt.toStyles)),$e.disabled=!0,$e.overrideTotalTime(bt.totalTime),void i.push($e);let Mr=sG;if(Bt.size>1){let Cs=Oe;const fl=[];for(;Cs=Cs.parentNode;){const Ln=Bt.get(Cs);if(Ln){Mr=Ln;break}fl.push(Cs)}fl.forEach(Ln=>Bt.set(Ln,Mr))}const la=this._buildAnimation($e.namespaceId,bt,Qe,s,q_,Zs);if($e.setRealPlayer(la),Mr===sG)Qc.push($e);else{const Cs=this.playersByElement.get(Mr);Cs&&Cs.length&&($e.parentPlayer=Pu(Cs)),i.push($e)}}else oc(Oe,bt.fromStyles),$e.onDestroy(()=>jo(Oe,bt.toStyles)),iG.push($e),d.has(Oe)&&i.push($e)}),iG.forEach(Ce=>{const Oe=s.get(Ce.element);if(Oe&&Oe.length){const $e=Pu(Oe);Ce.setRealPlayer($e)}}),i.forEach(Ce=>{Ce.parentPlayer?Ce.syncPlayerEvents(Ce.parentPlayer):Ce.destroy()});for(let Ce=0;Ce<D.length;Ce++){const Oe=D[Ce],$e=Oe[fo];if(gh(Oe,NE),$e&&$e.hasAnimation)continue;let bt=[];if(a.size){let la=a.get(Oe);la&&la.length&&bt.push(...la);let Cs=this.driver.query(Oe,LD,!0);for(let fl=0;fl<Cs.length;fl++){let Ln=a.get(Cs[fl]);Ln&&Ln.length&&bt.push(...Ln)}}const Mr=bt.filter(la=>!la.destroyed);Mr.length?Gee(this,Oe,Mr):this.processLeaveNode(Oe)}return D.length=0,Qc.forEach(Ce=>{this.players.push(Ce),Ce.onDone(()=>{Ce.destroy();const Oe=this.players.indexOf(Ce);this.players.splice(Oe,1)}),Ce.play()}),Qc}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,n,r,i,s){let o=[];if(n){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const u=!s||s==kg;a.forEach(l=>{l.queued||!u&&l.triggerName!=i||o.push(l)})}}return(r||i)&&(o=o.filter(a=>!(r&&r!=a.namespaceId||i&&i!=a.triggerName))),o}_beforeAnimationBuild(e,n,r){const s=n.element,o=n.isRemovalTransition?void 0:e,a=n.isRemovalTransition?void 0:n.triggerName;for(const u of n.timelines){const l=u.element,d=l!==s,f=hs(r,l,[]);this._getPreviousPlayers(l,d,o,a,n.toState).forEach(_=>{const v=_.getRealPlayer();v.beforeDestroy&&v.beforeDestroy(),_.destroy(),f.push(_)})}oc(s,n.fromStyles)}_buildAnimation(e,n,r,i,s,o){const a=n.triggerName,u=n.element,l=[],d=new Set,f=new Set,m=n.timelines.map(v=>{const T=v.element;d.add(T);const D=T[fo];if(D&&D.removedBeforeQueried)return new Pg(v.duration,v.delay);const x=T!==u,R=function Kee(t){const e=[];return gU(t,e),e}((r.get(T)||Bee).map(Qe=>Qe.getRealPlayer())).filter(Qe=>!!Qe.element&&Qe.element===T),L=s.get(T),G=o.get(T),ae=WV(this._normalizer,v.keyframes,L,G),ye=this._buildPlayer(v,ae,R);if(v.subTimeline&&i&&f.add(T),x){const Qe=new ZD(e,a,T);Qe.setRealPlayer(ye),l.push(Qe)}return ye});l.forEach(v=>{hs(this.playersByQueriedElement,v.element,[]).push(v),v.onDone(()=>function zee(t,e,n){let r=t.get(e);if(r){if(r.length){const i=r.indexOf(n);r.splice(i,1)}0==r.length&&t.delete(e)}return r}(this.playersByQueriedElement,v.element,v))}),d.forEach(v=>Hs(v,YV));const _=Pu(m);return _.onDestroy(()=>{d.forEach(v=>gh(v,YV)),jo(u,n.toStyles)}),f.forEach(v=>{hs(i,v,[]).push(_)}),_}_buildPlayer(e,n,r){return n.length>0?this.driver.animate(e.element,n,e.duration,e.delay,e.easing,r):new Pg(e.duration,e.delay)}}class ZD{constructor(e,n,r){this.namespaceId=e,this.triggerName=n,this.element=r,this._player=new Pg,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((n,r)=>{n.forEach(i=>bD(e,r,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const n=this._player;n.triggerCallback&&e.onStart(()=>n.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,n){hs(this._queuedCallbacks,e,[]).push(n)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const n=this._player;n.triggerCallback&&n.triggerCallback(e)}}function $E(t){return t&&1===t.nodeType}function hU(t,e){const n=t.style.display;return t.style.display=e??"none",n}function fU(t,e,n,r,i){const s=[];n.forEach(u=>s.push(hU(u)));const o=[];r.forEach((u,l)=>{const d=new Map;u.forEach(f=>{const m=e.computeStyle(l,f,i);d.set(f,m),(!m||0==m.length)&&(l[fo]=jee,o.push(l))}),t.set(l,d)});let a=0;return n.forEach(u=>hU(u,s[a++])),o}function pU(t,e){const n=new Map;if(t.forEach(a=>n.set(a,[])),0==e.length)return n;const i=new Set(e),s=new Map;function o(a){if(!a)return 1;let u=s.get(a);if(u)return u;const l=a.parentNode;return u=n.has(l)?l:i.has(l)?1:o(l),s.set(a,u),u}return e.forEach(a=>{const u=o(a);1!==u&&n.get(u).push(a)}),n}function Hs(t,e){t.classList?.add(e)}function gh(t,e){t.classList?.remove(e)}function Gee(t,e,n){Pu(n).onDone(()=>t.processLeaveNode(e))}function gU(t,e){for(let n=0;n<t.length;n++){const r=t[n];r instanceof HV?gU(r.players,e):e.push(r)}}function mU(t,e,n){const r=n.get(t);if(!r)return!1;let i=e.get(t);return i?r.forEach(s=>i.add(s)):e.set(t,r),n.delete(t),!0}class Og{constructor(e,n,r){this._driver=n,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(i,s)=>{},this._transitionEngine=new Hee(e.body,n,r),this._timelineEngine=new Oee(e.body,n,r),this._transitionEngine.onRemovalComplete=(i,s)=>this.onRemovalComplete(i,s)}registerTrigger(e,n,r,i,s){const o=e+"-"+i;let a=this._triggerCache[o];if(!a){const u=[],d=BD(this._driver,s,u,[]);if(u.length)throw function FJ(t,e){return new V(3404,!1)}();a=function Nee(t,e,n){return new Mee(t,e,n)}(i,d,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(n,i,a)}register(e,n){this._transitionEngine.register(e,n)}destroy(e,n){this._transitionEngine.destroy(e,n)}onInsert(e,n,r,i){this._transitionEngine.insertNode(e,n,r,i)}onRemove(e,n,r){this._transitionEngine.removeNode(e,n,r)}disableAnimations(e,n){this._transitionEngine.markElementAsDisabled(e,n)}process(e,n,r,i){if("@"==r.charAt(0)){const[s,o]=qV(r);this._timelineEngine.command(s,n,o,i)}else this._transitionEngine.trigger(e,n,r,i)}listen(e,n,r,i,s){if("@"==r.charAt(0)){const[o,a]=qV(r);return this._timelineEngine.listen(o,n,a,s)}return this._transitionEngine.listen(e,n,r,i,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let Yee=(()=>{class t{static#e=this.initialStylesByElement=new WeakMap;constructor(n,r,i){this._element=n,this._startStyles=r,this._endStyles=i,this._state=0;let s=t.initialStylesByElement.get(n);s||t.initialStylesByElement.set(n,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&jo(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(jo(this._element,this._initialStyles),this._endStyles&&(jo(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(oc(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(oc(this._element,this._endStyles),this._endStyles=null),jo(this._element,this._initialStyles),this._state=3)}}return t})();function QD(t){let e=null;return t.forEach((n,r)=>{(function Xee(t){return"display"===t||"position"===t})(r)&&(e=e||new Map,e.set(r,n))}),e}class _U{constructor(e,n,r,i){this.element=e,this.keyframes=n,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;const n=()=>this._onFinish();this.domPlayer.addEventListener("finish",n),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",n)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const n=[];return e.forEach(r=>{n.push(Object.fromEntries(r))}),n}_triggerWebAnimation(e,n,r){return e.animate(this._convertKeyframesToObject(n),r)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,i)=>{"offset"!==i&&e.set(i,this._finished?r:tU(this.element,i))}),this.currentSnapshot=e}triggerCallback(e){const n="start"===e?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}}class yU{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,n){return!1}containsElement(e,n){return KV(e,n)}getParentElement(e){return ND(e)}query(e,n,r){return ZV(e,n,r)}computeStyle(e,n,r){return window.getComputedStyle(e)[n]}animate(e,n,r,i,s,o=[]){const u={duration:r,delay:i,fill:0==i?"both":"forwards"};s&&(u.easing=s);const l=new Map,d=o.filter(_=>_ instanceof _U);(function aee(t,e){return 0===t||0===e})(r,i)&&d.forEach(_=>{_.currentSnapshot.forEach((v,T)=>l.set(T,v))});let f=function iee(t){return t.length?t[0]instanceof Map?t:t.map(e=>XV(e)):[]}(n).map(_=>Nu(_));f=function uee(t,e,n){if(n.size&&e.length){let r=e[0],i=[];if(n.forEach((s,o)=>{r.has(o)||i.push(o),r.set(o,s)}),i.length)for(let s=1;s<e.length;s++){let o=e[s];i.forEach(a=>o.set(a,tU(t,a)))}}return e}(e,f,l);const m=function Qee(t,e){let n=null,r=null;return Array.isArray(e)&&e.length?(n=QD(e[0]),e.length>1&&(r=QD(e[e.length-1]))):e instanceof Map&&(n=QD(e)),n||r?new Yee(t,n,r):null}(e,f);return new _U(e,f,u,m)}}const vU="@.disabled";class EU{constructor(e,n,r,i){this.namespaceId=e,this.delegate=n,this.engine=r,this._onDestroy=i,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,n){return this.delegate.createElement(e,n)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,n){this.delegate.appendChild(e,n),this.engine.onInsert(this.namespaceId,n,e,!1)}insertBefore(e,n,r,i=!0){this.delegate.insertBefore(e,n,r),this.engine.onInsert(this.namespaceId,n,e,i)}removeChild(e,n,r){this.engine.onRemove(this.namespaceId,n,this.delegate)}selectRootElement(e,n){return this.delegate.selectRootElement(e,n)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,n,r,i){this.delegate.setAttribute(e,n,r,i)}removeAttribute(e,n,r){this.delegate.removeAttribute(e,n,r)}addClass(e,n){this.delegate.addClass(e,n)}removeClass(e,n){this.delegate.removeClass(e,n)}setStyle(e,n,r,i){this.delegate.setStyle(e,n,r,i)}removeStyle(e,n,r){this.delegate.removeStyle(e,n,r)}setProperty(e,n,r){"@"==n.charAt(0)&&n==vU?this.disableAnimations(e,!!r):this.delegate.setProperty(e,n,r)}setValue(e,n){this.delegate.setValue(e,n)}listen(e,n,r){return this.delegate.listen(e,n,r)}disableAnimations(e,n){this.engine.disableAnimations(e,n)}}class Jee extends EU{constructor(e,n,r,i,s){super(n,r,i,s),this.factory=e,this.namespaceId=n}setProperty(e,n,r){"@"==n.charAt(0)?"."==n.charAt(1)&&n==vU?this.disableAnimations(e,r=void 0===r||!!r):this.engine.process(this.namespaceId,e,n.slice(1),r):this.delegate.setProperty(e,n,r)}listen(e,n,r){if("@"==n.charAt(0)){const i=function ete(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(e);let s=n.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function tte(t){const e=t.indexOf(".");return[t.substring(0,e),t.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,i,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,r,a)})}return this.delegate.listen(e,n,r)}}class nte{constructor(e,n,r){this.delegate=e,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,n.onRemovalComplete=(i,s)=>{const o=s?.parentNode(i);o&&s.removeChild(o,i)}}createRenderer(e,n){const i=this.delegate.createRenderer(e,n);if(!e||!n?.data?.animation){const l=this._rendererCache;let d=l.get(i);return d||(d=new EU("",i,this.engine,()=>l.delete(i)),l.set(i,d)),d}const s=n.id,o=n.id+"-"+this._currentId;this._currentId++,this.engine.register(o,e);const a=l=>{Array.isArray(l)?l.forEach(a):this.engine.registerTrigger(s,o,e,l.name,l)};return n.data.animation.forEach(a),new Jee(this,o,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,n,r){if(e>=0&&e<this._microtaskId)return void this._zone.run(()=>n(r));const i=this._animationCallbacksBuffer;0==i.length&&queueMicrotask(()=>{this._zone.run(()=>{i.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),i.push([n,r])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}let rte=(()=>{class t extends Og{constructor(n,r,i,s){super(n,r,i)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(r){return new(r||t)(Y(zi),Y(xD),Y(kD),Y(nc))};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac})}return t})();const IU=[{provide:kD,useFactory:function ite(){return new nU}},{provide:Og,useClass:rte},{provide:g0,useFactory:function ste(t,e,n){return new nte(t,e,n)},deps:[TD,Og,Et]}],YD=[{provide:xD,useFactory:()=>new yU},{provide:dx,useValue:"BrowserAnimations"},...IU],wU=[{provide:xD,useClass:MD},{provide:dx,useValue:"NoopAnimations"},...IU];let ote=(()=>{class t{static withConfig(n){return{ngModule:t,providers:n.disableAnimations?wU:YD}}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=Er({type:t});static#n=this.\u0275inj=ar({providers:YD,imports:[FV]})}return t})();var mh=xe(582);const TU=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function CU(t){return ke(t?.then)}function SU(t){return ke(t[kr])}function DU(t){return Symbol.asyncIterator&&ke(t?.[Symbol.asyncIterator])}function AU(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const bU=function ute(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function RU(t){return ke(t?.[bU])}function PU(t){return(0,mh.FC)(this,arguments,function*(){const n=t.getReader();try{for(;;){const{value:r,done:i}=yield(0,mh.qq)(n.read());if(i)return yield(0,mh.qq)(void 0);yield yield(0,mh.qq)(r)}}finally{n.releaseLock()}})}function NU(t){return ke(t?.getReader)}function ps(t){if(t instanceof Ct)return t;if(null!=t){if(SU(t))return function lte(t){return new Ct(e=>{const n=t[kr]();if(ke(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(TU(t))return function cte(t){return new Ct(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}(t);if(CU(t))return function dte(t){return new Ct(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Yi)})}(t);if(DU(t))return MU(t);if(RU(t))return function hte(t){return new Ct(e=>{for(const n of t)if(e.next(n),e.closed)return;e.complete()})}(t);if(NU(t))return function fte(t){return MU(PU(t))}(t)}throw AU(t)}function MU(t){return new Ct(e=>{(function pte(t,e){var n,r,i,s;return(0,mh.mG)(this,void 0,void 0,function*(){try{for(n=(0,mh.KL)(t);!(r=yield n.next()).done;)if(e.next(r.value),e.closed)return}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})})(t,e).catch(n=>e.error(n))})}function Oa(t,e,n,r=0,i=!1){const s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function La(t,e=0){return U((n,r)=>{n.subscribe(ce(r,i=>Oa(r,t,()=>r.next(i),e),()=>Oa(r,t,()=>r.complete(),e),i=>Oa(r,t,()=>r.error(i),e)))})}function uc(t,e=0){return U((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function xU(t,e){if(!t)throw new Error("Iterable cannot be null");return new Ct(n=>{Oa(n,e,()=>{const r=t[Symbol.asyncIterator]();Oa(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function Kt(t,e){return e?function Ete(t,e){if(null!=t){if(SU(t))return function gte(t,e){return ps(t).pipe(uc(e),La(e))}(t,e);if(TU(t))return function _te(t,e){return new Ct(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}(t,e);if(CU(t))return function mte(t,e){return ps(t).pipe(uc(e),La(e))}(t,e);if(DU(t))return xU(t,e);if(RU(t))return function yte(t,e){return new Ct(n=>{let r;return Oa(n,e,()=>{r=t[bU](),Oa(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){return void n.error(o)}s?n.complete():n.next(i)},0,!0)}),()=>ke(r?.return)&&r.return()})}(t,e);if(NU(t))return function vte(t,e){return xU(PU(t),e)}(t,e)}throw AU(t)}(t,e):ps(t)}function XD(t){return t[t.length-1]}function kU(t){return ke(XD(t))?t.pop():void 0}function Lg(t){return function Ite(t){return t&&ke(t.schedule)}(XD(t))?t.pop():void 0}function Me(...t){return Kt(t,Lg(t))}const{isArray:Tte}=Array,{getPrototypeOf:Cte,prototype:Ste,keys:Dte}=Object;const{isArray:Rte}=Array;function JD(...t){const e=Lg(t),n=kU(t),{args:r,keys:i}=function Ate(t){if(1===t.length){const e=t[0];if(Tte(e))return{args:e,keys:null};if(function bte(t){return t&&"object"==typeof t&&Cte(t)===Ste}(e)){const n=Dte(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}(t);if(0===r.length)return Kt([],e);const s=new Ct(function xte(t,e,n=tr){return r=>{OU(e,()=>{const{length:i}=t,s=new Array(i);let o=i,a=i;for(let u=0;u<i;u++)OU(e,()=>{const l=Kt(t[u],e);let d=!1;l.subscribe(ce(r,f=>{s[u]=f,d||(d=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,e,i?o=>function Mte(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}(i,o):tr));return n?s.pipe(function Nte(t){return oe(e=>function Pte(t,e){return Rte(e)?t(...e):t(e)}(t,e))}(n)):s}function OU(t,e,n){t?Oa(n,t,e):e()}const zE=Yt(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function ni(t,e,n=1/0){return ke(e)?ni((r,i)=>oe((s,o)=>e(r,s,i,o))(ps(t(r,i))),n):("number"==typeof e&&(n=e),U((r,i)=>function kte(t,e,n,r,i,s,o,a){const u=[];let l=0,d=0,f=!1;const m=()=>{f&&!u.length&&!l&&e.complete()},_=T=>l<r?v(T):u.push(T),v=T=>{s&&e.next(T),l++;let D=!1;ps(n(T,d++)).subscribe(ce(e,x=>{i?.(x),s?_(x):e.next(x)},()=>{D=!0},void 0,()=>{if(D)try{for(l--;u.length&&l<r;){const x=u.shift();o?Oa(e,o,()=>v(x)):v(x)}m()}catch(x){e.error(x)}}))};return t.subscribe(ce(e,_,()=>{f=!0,m()})),()=>{a?.()}}(r,i,t,n)))}function _h(t=1/0){return ni(tr,t)}function eA(...t){return function Ote(){return _h(1)}()(Kt(t,Lg(t)))}function LU(t){return new Ct(e=>{ps(t()).subscribe(e)})}function WE(t,e){const n=ke(t)?t:()=>t,r=i=>i.error(n());return new Ct(e?i=>e.schedule(r,0,i):r)}const $o=new Ct(t=>t.complete());function tA(){return U((t,e)=>{let n=null;t._refCount++;const r=ce(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(n=null);const i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}class FU extends Ct{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,O(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new At;const n=this.getSubject();e.add(this.source.subscribe(ce(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=At.EMPTY)}return e}refCount(){return tA()(this)}}function Yn(t,e){return U((n,r)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&r.complete();n.subscribe(ce(r,u=>{i?.unsubscribe();let l=0;const d=s++;ps(t(u,d)).subscribe(i=ce(r,f=>r.next(e?e(u,f,d,l++):f),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function yh(t){return t<=0?()=>$o:U((e,n)=>{let r=0;e.subscribe(ce(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function qE(...t){const e=Lg(t);return U((n,r)=>{(e?eA(t,n,e):eA(t,n)).subscribe(r)})}function po(t,e){return U((n,r)=>{let i=0;n.subscribe(ce(r,s=>t.call(e,s,i++)&&r.next(s)))})}function GE(t){return U((e,n)=>{let r=!1;e.subscribe(ce(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function VU(t=Fte){return U((e,n)=>{let r=!1;e.subscribe(ce(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function Fte(){return new zE}function Mu(t,e){const n=arguments.length>=2;return r=>r.pipe(t?po((i,s)=>t(i,s,r)):tr,yh(1),n?GE(e):VU(()=>new zE))}function Fg(t,e){return ke(e)?ni(t,e,1):ni(t,1)}function $r(t,e,n){const r=ke(t)||e||n?{next:t,error:e,complete:n}:t;return r?U((i,s)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let a=!0;i.subscribe(ce(s,u=>{var l;null===(l=r.next)||void 0===l||l.call(r,u),s.next(u)},()=>{var u;a=!1,null===(u=r.complete)||void 0===u||u.call(r),s.complete()},u=>{var l;a=!1,null===(l=r.error)||void 0===l||l.call(r,u),s.error(u)},()=>{var u,l;a&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(l=r.finalize)||void 0===l||l.call(r)}))}):tr}function vh(t){return U((e,n)=>{let s,r=null,i=!1;r=e.subscribe(ce(n,void 0,void 0,o=>{s=ps(t(o,vh(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function Eh(t,e){return U(function Vte(t,e,n,r,i){return(s,o)=>{let a=n,u=e,l=0;s.subscribe(ce(o,d=>{const f=l++;u=a?t(u,d,f):(a=!0,d),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}(t,e,arguments.length>=2,!0))}function nA(t){return t<=0?()=>$o:U((e,n)=>{let r=[];e.subscribe(ce(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(const i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function rA(t){return U((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}const ut="primary",Vg=Symbol("RouteTitle");class $te{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function Ih(t){return new $te(t)}function Hte(t,e,n){const r=n.path.split("/");if(r.length>t.length||"full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const i={};for(let s=0;s<r.length;s++){const o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function Ho(t,e){const n=t?iA(t):void 0,r=e?iA(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!UU(t[i],e[i]))return!1;return!0}function iA(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function UU(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}return t===e}function BU(t){return t.length>0?t[t.length-1]:null}function xu(t){return function ate(t){return!!t&&(t instanceof Ct||ke(t.lift)&&ke(t.subscribe))}(t)?t:eE(t)?Kt(Promise.resolve(t)):Me(t)}const Wte={exact:function HU(t,e,n){if(!lc(t.segments,e.segments)||!KE(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!t.children[r]||!HU(t.children[r],e.children[r],n))return!1;return!0},subset:zU},jU={exact:function qte(t,e){return Ho(t,e)},subset:function Gte(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>UU(t[n],e[n]))},ignored:()=>!0};function $U(t,e,n){return Wte[n.paths](t.root,e.root,n.matrixParams)&&jU[n.queryParams](t.queryParams,e.queryParams)&&!("exact"===n.fragment&&t.fragment!==e.fragment)}function zU(t,e,n){return WU(t,e,e.segments,n)}function WU(t,e,n,r){if(t.segments.length>n.length){const i=t.segments.slice(0,n.length);return!(!lc(i,n)||e.hasChildren()||!KE(i,n,r))}if(t.segments.length===n.length){if(!lc(t.segments,n)||!KE(t.segments,n,r))return!1;for(const i in e.children)if(!t.children[i]||!zU(t.children[i],e.children[i],r))return!1;return!0}{const i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!!(lc(t.segments,i)&&KE(t.segments,i,r)&&t.children[ut])&&WU(t.children[ut],e,s,r)}}function KE(t,e,n){return e.every((r,i)=>jU[n](t[i].parameters,r.parameters))}class wh{constructor(e=new Zt([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Ih(this.queryParams)),this._queryParamMap}toString(){return Qte.serialize(this)}}class Zt{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ZE(this)}}class Ug{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=Ih(this.parameters)),this._parameterMap}toString(){return KU(this)}}function lc(t,e){return t.length===e.length&&t.every((n,r)=>n.path===e[r].path)}let Th=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:()=>new sA,providedIn:"root"})}return t})();class sA{parse(e){const n=new ane(e);return new wh(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){const n=`/${Bg(e.root,!0)}`,r=function Jte(t){const e=Object.keys(t).map(n=>{const r=t[n];return Array.isArray(r)?r.map(i=>`${QE(n)}=${QE(i)}`).join("&"):`${QE(n)}=${QE(r)}`}).filter(n=>!!n);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${n}${r}${"string"==typeof e.fragment?`#${function Yte(t){return encodeURI(t)}(e.fragment)}`:""}`}}const Qte=new sA;function ZE(t){return t.segments.map(e=>KU(e)).join("/")}function Bg(t,e){if(!t.hasChildren())return ZE(t);if(e){const n=t.children[ut]?Bg(t.children[ut],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==ut&&r.push(`${i}:${Bg(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=function Zte(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===ut&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==ut&&(n=n.concat(e(i,r)))}),n}(t,(r,i)=>i===ut?[Bg(t.children[ut],!1)]:[`${i}:${Bg(r,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[ut]?`${ZE(t)}/${n[0]}`:`${ZE(t)}/(${n.join("//")})`}}function qU(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function QE(t){return qU(t).replace(/%3B/gi,";")}function oA(t){return qU(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function YE(t){return decodeURIComponent(t)}function GU(t){return YE(t.replace(/\+/g,"%20"))}function KU(t){return`${oA(t.path)}${function Xte(t){return Object.keys(t).map(e=>`;${oA(e)}=${oA(t[e])}`).join("")}(t.parameters)}`}const ene=/^[^\/()?;#]+/;function aA(t){const e=t.match(ene);return e?e[0]:""}const tne=/^[^\/()?;=#]+/,rne=/^[^=?&#]+/,sne=/^[^&#]+/;class ane{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Zt([],{}):new Zt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[ut]=new Zt(e,n)),r}parseSegment(){const e=aA(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new V(4009,!1);return this.capture(e),new Ug(YE(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const n=function nne(t){const e=t.match(tne);return e?e[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const i=aA(this.remaining);i&&(r=i,this.capture(r))}e[YE(n)]=YE(r)}parseQueryParam(e){const n=function ine(t){const e=t.match(rne);return e?e[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const o=function one(t){const e=t.match(sne);return e?e[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const i=GU(n),s=GU(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=aA(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new V(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=ut);const o=this.parseChildren();n[s]=1===Object.keys(o).length?o[ut]:new Zt([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new V(4011,!1)}}function ZU(t){return t.segments.length>0?new Zt([],{[ut]:t}):t}function QU(t){const e={};for(const r of Object.keys(t.children)){const s=QU(t.children[r]);if(r===ut&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}return function une(t){if(1===t.numberOfChildren&&t.children[ut]){const e=t.children[ut];return new Zt(t.segments.concat(e.segments),e.children)}return t}(new Zt(t.segments,e))}function cc(t){return t instanceof wh}function YU(t){let e;const i=ZU(function n(s){const o={};for(const u of s.children){const l=n(u);o[u.outlet]=l}const a=new Zt(s.url,o);return s===t&&(e=a),a}(t.root));return e??i}function XU(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(0===e.length)return uA(i,i,i,n,r);const s=function cne(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new e2(!0,0,t);let e=0,n=!1;const r=t.reduce((i,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([u,l])=>{a[u]="string"==typeof l?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return"string"!=typeof s?[...i,s]:0===o?(s.split("/").forEach((a,u)=>{0==u&&"."===a||(0==u&&""===a?n=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,s]},[]);return new e2(n,e,r)}(e);if(s.toRoot())return uA(i,i,new Zt([],{}),n,r);const o=function dne(t,e,n){if(t.isAbsolute)return new JE(e,!0,0);if(!n)return new JE(e,!1,NaN);if(null===n.parent)return new JE(n,!0,0);const r=XE(t.commands[0])?0:1;return function hne(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new V(4005,!1);i=r.segments.length}return new JE(r,!1,i-s)}(n,n.segments.length-1+r,t.numberOfDoubleDots)}(s,i,t),a=o.processChildren?$g(o.segmentGroup,o.index,s.commands):t2(o.segmentGroup,o.index,s.commands);return uA(i,o.segmentGroup,a,n,r)}function XE(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function jg(t){return"object"==typeof t&&null!=t&&t.outlets}function uA(t,e,n,r,i){let o,s={};r&&Object.entries(r).forEach(([u,l])=>{s[u]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`}),o=t===e?n:JU(t,e,n);const a=ZU(QU(o));return new wh(a,s,i)}function JU(t,e,n){const r={};return Object.entries(t.children).forEach(([i,s])=>{r[i]=s===e?n:JU(s,e,n)}),new Zt(t.segments,r)}class e2{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&XE(r[0]))throw new V(4003,!1);const i=r.find(jg);if(i&&i!==BU(r))throw new V(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class JE{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}}function t2(t,e,n){if(t||(t=new Zt([],{})),0===t.segments.length&&t.hasChildren())return $g(t,e,n);const r=function pne(t,e,n){let r=0,i=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;const o=t.segments[i],a=n[r];if(jg(a))break;const u=`${a}`,l=r<n.length-1?n[r+1]:null;if(i>0&&void 0===u)break;if(u&&l&&"object"==typeof l&&void 0===l.outlets){if(!r2(u,l,o))return s;r+=2}else{if(!r2(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const s=new Zt(t.segments.slice(0,r.pathIndex),{});return s.children[ut]=new Zt(t.segments.slice(r.pathIndex),t.children),$g(s,0,i)}return r.match&&0===i.length?new Zt(t.segments,{}):r.match&&!t.hasChildren()?lA(t,e,n):r.match?$g(t,0,i):lA(t,e,n)}function $g(t,e,n){if(0===n.length)return new Zt(t.segments,{});{const r=function fne(t){return jg(t[0])?t[0].outlets:{[ut]:t}}(n),i={};if(Object.keys(r).some(s=>s!==ut)&&t.children[ut]&&1===t.numberOfChildren&&0===t.children[ut].segments.length){const s=$g(t.children[ut],e,n);return new Zt(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(i[s]=t2(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{void 0===r[s]&&(i[s]=o)}),new Zt(t.segments,i)}}function lA(t,e,n){const r=t.segments.slice(0,e);let i=0;for(;i<n.length;){const s=n[i];if(jg(s)){const u=gne(s.outlets);return new Zt(r,u)}if(0===i&&XE(n[0])){r.push(new Ug(t.segments[e].path,n2(n[0]))),i++;continue}const o=jg(s)?s.outlets[ut]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&XE(a)?(r.push(new Ug(o,n2(a))),i+=2):(r.push(new Ug(o,{})),i++)}return new Zt(r,{})}function gne(t){const e={};return Object.entries(t).forEach(([n,r])=>{"string"==typeof r&&(r=[r]),null!==r&&(e[n]=lA(new Zt([],{}),0,r))}),e}function n2(t){const e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function r2(t,e,n){return t==n.path&&Ho(e,n.parameters)}const Hg="imperative";class zo{constructor(e,n){this.id=e,this.url=n}}class eI extends zo{constructor(e,n,r="imperative",i=null){super(e,n),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Fa extends zo{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Ch extends zo{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Sh extends zo{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=16}}class tI extends zo{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class s2 extends zo{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class mne extends zo{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class _ne extends zo{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class yne extends zo{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class vne extends zo{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ene{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Ine{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class wne{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Tne{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Cne{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Sne{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class o2{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class cA{}class dA{constructor(e){this.url=e}}class Dne{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new zg,this.attachRef=null}}let zg=(()=>{class t{constructor(){this.contexts=new Map}onChildOutletCreated(n,r){const i=this.getOrCreateContext(n);i.outlet=r,this.contexts.set(n,i)}onChildOutletDestroyed(n){const r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new Dne,this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class a2{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){const n=hA(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){const n=hA(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){const n=fA(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return fA(e,this._root).map(n=>n.value)}}function hA(t,e){if(t===e.value)return e;for(const n of e.children){const r=hA(t,n);if(r)return r}return null}function fA(t,e){if(t===e.value)return[e];for(const n of e.children){const r=fA(t,n);if(r.length)return r.unshift(e),r}return[]}class go{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}}function Dh(t){const e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}class u2 extends a2{constructor(e,n){super(e),this.snapshot=n,mA(this,e)}toString(){return this.snapshot.toString()}}function l2(t,e){const n=function Ane(t,e){const o=new gA([],{},{},"",{},ut,e,null,{});return new c2("",new go(o,[]))}(0,e),r=new E([new Ug("",{})]),i=new E({}),s=new E({}),o=new E({}),a=new E(""),u=new dc(r,i,o,a,s,ut,e,n.root);return u.snapshot=n.root,new u2(new go(u,[]),n)}class dc{constructor(e,n,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(oe(l=>l[Vg]))??Me(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(oe(e=>Ih(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(oe(e=>Ih(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function pA(t,e,n="emptyOnly"){let r;const{routeConfig:i}=t;return r=null===e||"always"!==n&&""!==i?.path&&(e.component||e.routeConfig?.loadComponent)?{params:{...t.params},data:{...t.data},resolve:{...t.data,...t._resolvedData??{}}}:{params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.data,...i?.data,...t._resolvedData}},i&&h2(i)&&(r.resolve[Vg]=i.title),r}class gA{get title(){return this.data?.[Vg]}constructor(e,n,r,i,s,o,a,u,l){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Ih(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Ih(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class c2 extends a2{constructor(e,n){super(n),this.url=e,mA(this,n)}toString(){return d2(this._root)}}function mA(t,e){e.value._routerState=t,e.children.forEach(n=>mA(t,n))}function d2(t){const e=t.children.length>0?` { ${t.children.map(d2).join(", ")} } `:"";return`${t.value}${e}`}function _A(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,Ho(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),Ho(e.params,n.params)||t.paramsSubject.next(n.params),function zte(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!Ho(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.urlSubject.next(n.url),Ho(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function yA(t,e){const n=Ho(t.params,e.params)&&function Kte(t,e){return lc(t,e)&&t.every((n,r)=>Ho(n.parameters,e[r].parameters))}(t.url,e.url);return n&&!(!t.parent!=!e.parent)&&(!t.parent||yA(t.parent,e.parent))}function h2(t){return"string"==typeof t.title||null===t.title}let vA=(()=>{class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=ut,this.activateEvents=new Ei,this.deactivateEvents=new Ei,this.attachEvents=new Ei,this.detachEvents=new Ei,this.parentContexts=he(zg),this.location=he(lo),this.changeDetector=he(xv),this.environmentInjector=he(Vs),this.inputBinder=he(nI,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){const{firstChange:r,previousValue:i}=n.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new V(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new V(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new V(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new V(4013,!1);this._activatedRoute=n;const i=this.location,o=n.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,u=new bne(n,a,i.injector);this.activated=i.createComponent(o,{index:i.length,injector:u,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275dir=ur({type:t,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ma]})}return t})();class bne{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===dc?this.route:e===zg?this.childContexts:this.parent.get(e,n)}}const nI=new de("");let f2=(()=>{class t{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){const{activatedRoute:r}=n,i=JD([r.queryParams,r.params,r.data]).pipe(Yn(([s,o,a],u)=>(a={...s,...o,...a},0===u?Me(a):Promise.resolve(a)))).subscribe(s=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==r||null===r.component)return void this.unsubscribeFromRouteData(n);const o=function BQ(t){const e=at(t);if(!e)return null;const n=new eg(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(r.component);if(o)for(const{templateName:a}of o.inputs)n.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(n)});this.outletDataSubscriptions.set(n,i)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac})}return t})();function Wg(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=e.value;const i=function Pne(t,e,n){return e.children.map(r=>{for(const i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return Wg(t,r,i);return Wg(t,r)})}(t,e,n);return new go(r,i)}{if(t.shouldAttach(e.value)){const s=t.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Wg(t,a)),o}}const r=function Nne(t){return new dc(new E(t.url),new E(t.params),new E(t.queryParams),new E(t.fragment),new E(t.data),t.outlet,t.component,t)}(e.value),i=e.children.map(s=>Wg(t,s));return new go(r,i)}}const EA="ngNavigationCancelingError";function p2(t,e){const{redirectTo:n,navigationBehaviorOptions:r}=cc(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=g2(!1,0,e);return i.url=n,i.navigationBehaviorOptions=r,i}function g2(t,e,n){const r=new Error("NavigationCancelingError: "+(t||""));return r[EA]=!0,r.cancellationCode=e,n&&(r.url=n),r}function m2(t){return t&&t[EA]}let _2=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=vr({type:t,selectors:[["ng-component"]],standalone:!0,features:[NL],decls:1,vars:0,template:function(r,i){1&r&&cs(0,"router-outlet")},dependencies:[vA],encapsulation:2})}return t})();function IA(t){const e=t.children&&t.children.map(IA),n=e?{...t,children:e}:{...t};return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==ut&&(n.component=_2),n}function Wo(t){return t.outlet||ut}function qg(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){const n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}class Une{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){const n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),_A(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){const i=Dh(n);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){const i=e.value,s=n?n.value:null;if(i===s)if(i.component){const o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){const r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Dh(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);if(r&&r.outlet){const o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){const r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Dh(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){const i=Dh(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Sne(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Tne(e.value.snapshot))}activateRoutes(e,n,r){const i=e.value,s=n?n.value:null;if(_A(i),i===s)if(i.component){const o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){const o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),_A(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=qg(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}}class y2{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class rI{constructor(e,n){this.component=e,this.route=n}}function Bne(t,e,n){const r=t._root;return Gg(r,e?e._root:null,n,[r.value])}function Ah(t,e){const n=Symbol(),r=e.get(t,n);return r===n?"function"!=typeof t||function Gf(t){return null!==Xc(t)}(t)?e.get(t):t:r}function Gg(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=Dh(e);return t.children.forEach(o=>{(function $ne(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const u=function Hne(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!lc(t.url,e.url);case"pathParamsOrQueryParamsChange":return!lc(t.url,e.url)||!Ho(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!yA(t,e)||!Ho(t.queryParams,e.queryParams);default:return!yA(t,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new y2(r)):(s.data=o.data,s._resolvedData=o._resolvedData),Gg(t,e,s.component?a?a.children:null:n,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new rI(a.outlet.component,o))}else o&&Kg(e,a,i),i.canActivateChecks.push(new y2(r)),Gg(t,null,s.component?a?a.children:null:n,r,i)})(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Kg(a,n.getContext(o),i)),i}function Kg(t,e,n){const r=Dh(t),i=t.value;Object.entries(r).forEach(([s,o])=>{Kg(o,i.component?e?e.children.getContext(s):null:e,n)}),n.canDeactivateChecks.push(new rI(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function Zg(t){return"function"==typeof t}function v2(t){return t instanceof zE||"EmptyError"===t?.name}const iI=Symbol("INITIAL_VALUE");function bh(){return Yn(t=>JD(t.map(e=>e.pipe(yh(1),qE(iI)))).pipe(oe(e=>{for(const n of e)if(!0!==n){if(n===iI)return iI;if(!1===n||n instanceof wh)return n}return!0}),po(e=>e!==iI),yh(1)))}function E2(t){return Jr($r(e=>{if(cc(e))throw p2(0,e)}),oe(e=>!0===e))}class wA{constructor(e){this.segmentGroup=e||null}}class TA extends Error{constructor(e){super(),this.urlTree=e}}function Rh(t){return WE(new wA(t))}class lre{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return Me(r);if(i.numberOfChildren>1||!i.children[ut])return WE(new V(4e3,!1));i=i.children[ut]}}applyRedirectCommands(e,n,r){const i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new TA(i);return i}applyRedirectCreateUrlTree(e,n,r,i){const s=this.createSegmentGroup(e,n.root,r,i);return new wh(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){const r={};return Object.entries(e).forEach(([i,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){const s=this.createSegments(e,n.segments,r,i);let o={};return Object.entries(n.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new Zt(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){const i=r[n.path.substring(1)];if(!i)throw new V(4001,!1);return i}findOrReturn(e,n){let r=0;for(const i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}}const CA={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function cre(t,e,n,r,i){const s=SA(t,e,n);return s.matched?(r=function xne(t,e){return t.providers&&!t._injector&&(t._injector=ES(t.providers,e,`Route: ${t.path}`)),t._injector??e}(e,r),function ore(t,e,n,r){const i=e.canMatch;return i&&0!==i.length?Me(i.map(o=>{const a=Ah(o,t);return xu(function Zne(t){return t&&Zg(t.canMatch)}(a)?a.canMatch(e,n):Wl(t,()=>a(e,n)))})).pipe(bh(),E2()):Me(!0)}(r,e,n).pipe(oe(o=>!0===o?s:{...CA}))):Me(s)}function SA(t,e,n){if("**"===e.path)return function dre(t){return{matched:!0,parameters:t.length>0?BU(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}(n);if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{...CA}:{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const i=(e.matcher||Hte)(n,t,e);if(!i)return{...CA};const s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});const o=i.consumed.length>0?{...s,...i.consumed[i.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function I2(t,e,n,r){return n.length>0&&function pre(t,e,n){return n.some(r=>sI(t,e,r)&&Wo(r)!==ut)}(t,n,r)?{segmentGroup:new Zt(e,fre(r,new Zt(n,t.children))),slicedSegments:[]}:0===n.length&&function gre(t,e,n){return n.some(r=>sI(t,e,r))}(t,n,r)?{segmentGroup:new Zt(t.segments,hre(t,0,n,r,t.children)),slicedSegments:n}:{segmentGroup:new Zt(t.segments,t.children),slicedSegments:n}}function hre(t,e,n,r,i){const s={};for(const o of r)if(sI(t,n,o)&&!i[Wo(o)]){const a=new Zt([],{});s[Wo(o)]=a}return{...i,...s}}function fre(t,e){const n={};n[ut]=e;for(const r of t)if(""===r.path&&Wo(r)!==ut){const i=new Zt([],{});n[Wo(r)]=i}return n}function sI(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path}class yre{}class Ire{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new lre(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new V(4002,`'${e.segmentGroup}'`)}recognize(){const e=I2(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(oe(n=>{const r=new gA([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},ut,this.rootComponentType,null,{}),i=new go(r,n),s=new c2("",i),o=function lne(t,e,n=null,r=null){return XU(YU(t),e,n,r)}(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,ut).pipe(vh(r=>{if(r instanceof TA)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof wA?this.noMatchError(r):r}))}inheritParamsAndData(e,n){const r=e.value,i=pA(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return 0===r.segments.length&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(oe(s=>s instanceof go?[s]:[]))}processChildren(e,n,r){const i=[];for(const s of Object.keys(r.children))"primary"===s?i.unshift(s):i.push(s);return Kt(i).pipe(Fg(s=>{const o=r.children[s],a=function Fne(t,e){const n=t.filter(r=>Wo(r)===e);return n.push(...t.filter(r=>Wo(r)!==e)),n}(n,s);return this.processSegmentGroup(e,a,o,s)}),Eh((s,o)=>(s.push(...o),s)),GE(null),function Ute(t,e){const n=arguments.length>=2;return r=>r.pipe(t?po((i,s)=>t(i,s,r)):tr,nA(1),n?GE(e):VU(()=>new zE))}(),ni(s=>{if(null===s)return Rh(r);const o=w2(s);return function wre(t){t.sort((e,n)=>e.value.outlet===ut?-1:n.value.outlet===ut?1:e.value.outlet.localeCompare(n.value.outlet))}(o),Me(o)}))}processSegment(e,n,r,i,s,o){return Kt(n).pipe(Fg(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(vh(u=>{if(u instanceof wA)return Me(null);throw u}))),Mu(a=>!!a),vh(a=>{if(v2(a))return function _re(t,e,n){return 0===e.length&&!t.children[n]}(r,i,s)?Me(new yre):Rh(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return function mre(t,e,n,r){return!!(Wo(t)===r||r!==ut&&sI(e,n,t))&&SA(e,t,n).matched}(r,i,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):Rh(i):Rh(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){const{matched:a,consumedSegments:u,positionalParamSegments:l,remainingSegments:d}=SA(n,i,s);if(!a)return Rh(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const f=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,f).pipe(ni(m=>this.processSegment(e,r,n,m.concat(d),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){const o=cre(n,r,i,e);return"**"===r.path&&(n.children={}),o.pipe(Yn(a=>a.matched?this.getChildConfig(e=r._injector??e,r,i).pipe(Yn(({routes:u})=>{const l=r._loadedInjector??e,{consumedSegments:d,remainingSegments:f,parameters:m}=a,_=new gA(d,m,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,function Cre(t){return t.data||{}}(r),Wo(r),r.component??r._loadedComponent??null,r,function Sre(t){return t.resolve||{}}(r)),{segmentGroup:v,slicedSegments:T}=I2(n,d,f,u);if(0===T.length&&v.hasChildren())return this.processChildren(l,u,v).pipe(oe(x=>null===x?null:new go(_,x)));if(0===u.length&&0===T.length)return Me(new go(_,[]));const D=Wo(r)===s;return this.processSegment(l,u,v,T,D?ut:s,!0).pipe(oe(x=>new go(_,x instanceof go?[x]:[])))})):Rh(n)))}getChildConfig(e,n,r){return n.children?Me({routes:n.children,injector:e}):n.loadChildren?void 0!==n._loadedRoutes?Me({routes:n._loadedRoutes,injector:n._loadedInjector}):function sre(t,e,n,r){const i=e.canLoad;return void 0===i||0===i.length?Me(!0):Me(i.map(o=>{const a=Ah(o,t);return xu(function Wne(t){return t&&Zg(t.canLoad)}(a)?a.canLoad(e,n):Wl(t,()=>a(e,n)))})).pipe(bh(),E2())}(e,n,r).pipe(ni(i=>i?this.configLoader.loadChildren(e,n).pipe($r(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):function ure(t){return WE(g2(!1,3))}())):Me({routes:[],injector:e})}}function Tre(t){const e=t.value.routeConfig;return e&&""===e.path}function w2(t){const e=[],n=new Set;for(const r of t){if(!Tre(r)){e.push(r);continue}const i=e.find(s=>r.value.routeConfig===s.value.routeConfig);void 0!==i?(i.children.push(...r.children),n.add(i)):e.push(r)}for(const r of n){const i=w2(r.children);e.push(new go(r.value,i))}return e.filter(r=>!n.has(r))}function T2(t){const e=t.children.map(n=>T2(n)).flat();return[t,...e]}function DA(t){return Yn(e=>{const n=t(e);return n?Kt(n).pipe(oe(()=>e)):Me(e)})}let C2=(()=>{class t{buildTitle(n){let r,i=n.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===ut);return r}getResolvedTitleForRoute(n){return n.data[Vg]}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:()=>he(Nre),providedIn:"root"})}return t})(),Nre=(()=>{class t extends C2{constructor(n){super(),this.title=n}updateTitle(n){const r=this.buildTitle(n);void 0!==r&&this.title.setTitle(r)}static#e=this.\u0275fac=function(r){return new(r||t)(Y(VV))};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Ph=new de("",{providedIn:"root",factory:()=>({})}),Nh=new de("ROUTES");let AA=(()=>{class t{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=he(gF)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return Me(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const r=xu(n.loadComponent()).pipe(oe(S2),$r(s=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=s}),rA(()=>{this.componentLoaders.delete(n)})),i=new FU(r,()=>new I).pipe(tA());return this.componentLoaders.set(n,i),i}loadChildren(n,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Me({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const s=function Mre(t,e,n,r){return xu(t.loadChildren()).pipe(oe(S2),ni(i=>i instanceof RL||Array.isArray(i)?Me(i):Kt(e.compileModuleAsync(i))),oe(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,!0):(s=i.create(n).injector,o=s.get(Nh,[],{optional:!0,self:!0}).flat()),{routes:o.map(IA),injector:s}}))}(r,this.compiler,n,this.onLoadEndListener).pipe(rA(()=>{this.childrenLoaders.delete(r)})),o=new FU(s,()=>new I).pipe(tA());return this.childrenLoaders.set(r,o),o}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function S2(t){return function xre(t){return t&&"object"==typeof t&&"default"in t}(t)?t.default:t}let bA=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:()=>he(kre),providedIn:"root"})}return t})(),kre=(()=>{class t{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,r){return n}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const D2=new de(""),A2=new de("");function Ore(t,e,n){const r=t.get(A2),i=t.get(zi);return t.get(Et).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s;const o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),function Lre(t){return new Promise(e=>{Qk(e,{injector:t})})}(t))),{onViewTransitionCreated:u}=r;return u&&Wl(t,()=>u({transition:a,from:e,to:n})),o})}let oI=(()=>{class t{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new I,this.transitionAbortSubject=new I,this.configLoader=he(AA),this.environmentInjector=he(Vs),this.urlSerializer=he(Th),this.rootContexts=he(zg),this.location=he(Sg),this.inputBindingEnabled=null!==he(nI,{optional:!0}),this.titleStrategy=he(C2),this.options=he(Ph,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=he(bA),this.createViewTransition=he(D2,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Me(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=i=>this.events.next(new Ine(i)),this.configLoader.onLoadStartListener=i=>this.events.next(new Ene(i))}complete(){this.transitions?.complete()}handleNavigationRequest(n){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...n,id:r})}setupNavigations(n,r,i){return this.transitions=new E({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Hg,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(po(s=>0!==s.id),oe(s=>({...s,extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),Yn(s=>{this.currentTransition=s;let o=!1,a=!1;return Me(s).pipe($r(u=>{this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Yn(u=>{const l=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!l&&"reload"!==(u.extras.onSameUrlNavigation??n.onSameUrlNavigation)){const f="";return this.events.next(new Sh(u.id,this.urlSerializer.serialize(u.rawUrl),f,0)),u.resolve(null),$o}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return Me(u).pipe(Yn(f=>{const m=this.transitions?.getValue();return this.events.next(new eI(f.id,this.urlSerializer.serialize(f.extractedUrl),f.source,f.restoredState)),m!==this.transitions?.getValue()?$o:Promise.resolve(f)}),function Dre(t,e,n,r,i,s){return ni(o=>function vre(t,e,n,r,i,s,o="emptyOnly"){return new Ire(t,e,n,r,i,o,s).recognize()}(t,e,n,r,o.extractedUrl,i,s).pipe(oe(({state:a,tree:u})=>({...o,targetSnapshot:a,urlAfterRedirects:u}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),$r(f=>{s.targetSnapshot=f.targetSnapshot,s.urlAfterRedirects=f.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:f.urlAfterRedirects};const m=new s2(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(m)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){const{id:f,extractedUrl:m,source:_,restoredState:v,extras:T}=u,D=new eI(f,this.urlSerializer.serialize(m),_,v);this.events.next(D);const x=l2(0,this.rootComponentType).snapshot;return this.currentTransition=s={...u,targetSnapshot:x,urlAfterRedirects:m,extras:{...T,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=m,Me(s)}{const f="";return this.events.next(new Sh(u.id,this.urlSerializer.serialize(u.extractedUrl),f,1)),u.resolve(null),$o}}),$r(u=>{const l=new mne(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(l)}),oe(u=>(this.currentTransition=s={...u,guards:Bne(u.targetSnapshot,u.currentSnapshot,this.rootContexts)},s)),function Yne(t,e){return ni(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return 0===o.length&&0===s.length?Me({...n,guardsResult:!0}):function Xne(t,e,n,r){return Kt(t).pipe(ni(i=>function ire(t,e,n,r,i){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Me(s.map(a=>{const u=qg(e)??i,l=Ah(a,u);return xu(function Kne(t){return t&&Zg(t.canDeactivate)}(l)?l.canDeactivate(t,e,n,r):Wl(u,()=>l(t,e,n,r))).pipe(Mu())})).pipe(bh()):Me(!0)}(i.component,i.route,n,e,r)),Mu(i=>!0!==i,!0))}(o,r,i,t).pipe(ni(a=>a&&function zne(t){return"boolean"==typeof t}(a)?function Jne(t,e,n,r){return Kt(e).pipe(Fg(i=>eA(function tre(t,e){return null!==t&&e&&e(new wne(t)),Me(!0)}(i.route.parent,r),function ere(t,e){return null!==t&&e&&e(new Cne(t)),Me(!0)}(i.route,r),function rre(t,e,n){const r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function jne(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(o)).filter(o=>null!==o).map(o=>LU(()=>Me(o.guards.map(u=>{const l=qg(o.node)??n,d=Ah(u,l);return xu(function Gne(t){return t&&Zg(t.canActivateChild)}(d)?d.canActivateChild(r,t):Wl(l,()=>d(r,t))).pipe(Mu())})).pipe(bh())));return Me(s).pipe(bh())}(t,i.path,n),function nre(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return Me(!0);const i=r.map(s=>LU(()=>{const o=qg(e)??n,a=Ah(s,o);return xu(function qne(t){return t&&Zg(t.canActivate)}(a)?a.canActivate(e,t):Wl(o,()=>a(e,t))).pipe(Mu())}));return Me(i).pipe(bh())}(t,i.route,n))),Mu(i=>!0!==i,!0))}(r,s,t,e):Me(a)),oe(a=>({...n,guardsResult:a})))})}(this.environmentInjector,u=>this.events.next(u)),$r(u=>{if(s.guardsResult=u.guardsResult,cc(u.guardsResult))throw p2(0,u.guardsResult);const l=new _ne(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(l)}),po(u=>!!u.guardsResult||(this.cancelNavigationTransition(u,"",3),!1)),DA(u=>{if(u.guards.canActivateChecks.length)return Me(u).pipe($r(l=>{const d=new yne(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Yn(l=>{let d=!1;return Me(l).pipe(function Are(t,e){return ni(n=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return Me(n);const s=new Set(i.map(u=>u.route)),o=new Set;for(const u of s)if(!o.has(u))for(const l of T2(u))o.add(l);let a=0;return Kt(o).pipe(Fg(u=>s.has(u)?function bre(t,e,n,r){const i=t.routeConfig,s=t._resolve;return void 0!==i?.title&&!h2(i)&&(s[Vg]=i.title),function Rre(t,e,n,r){const i=iA(t);if(0===i.length)return Me({});const s={};return Kt(i).pipe(ni(o=>function Pre(t,e,n,r){const i=qg(e)??r,s=Ah(t,i);return xu(s.resolve?s.resolve(e,n):Wl(i,()=>s(e,n)))}(t[o],e,n,r).pipe(Mu(),$r(a=>{s[o]=a}))),nA(1),function Bte(t){return oe(()=>t)}(s),vh(o=>v2(o)?$o:WE(o)))}(s,t,e,r).pipe(oe(o=>(t._resolvedData=o,t.data=pA(t,t.parent,n).resolve,null)))}(u,r,t,e):(u.data=pA(u,u.parent,t).resolve,Me(void 0))),$r(()=>a++),nA(1),ni(u=>a===o.size?Me(n):$o))})}(this.paramsInheritanceStrategy,this.environmentInjector),$r({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",2)}}))}),$r(l=>{const d=new vne(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),DA(u=>{const l=d=>{const f=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(d.routeConfig).pipe($r(m=>{d.component=m}),oe(()=>{})));for(const m of d.children)f.push(...l(m));return f};return JD(l(u.targetSnapshot.root)).pipe(GE(null),yh(1))}),DA(()=>this.afterPreactivation()),Yn(()=>{const{currentSnapshot:u,targetSnapshot:l}=s,d=this.createViewTransition?.(this.environmentInjector,u.root,l.root);return d?Kt(d).pipe(oe(()=>s)):Me(s)}),oe(u=>{const l=function Rne(t,e,n){const r=Wg(t,e._root,n?n._root:void 0);return new u2(r,e)}(n.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=s={...u,targetRouterState:l},this.currentNavigation.targetRouterState=l,s}),$r(()=>{this.events.next(new cA)}),((t,e,n,r)=>oe(i=>(new Une(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)))(this.rootContexts,n.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),yh(1),$r({next:u=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Fa(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{o=!0}}),function jte(t){return U((e,n)=>{ps(t).subscribe(ce(n,()=>n.complete(),Xr)),!n.closed&&e.subscribe(n)})}(this.transitionAbortSubject.pipe($r(u=>{throw u}))),rA(()=>{o||a||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),vh(u=>{if(a=!0,m2(u))this.events.next(new Ch(s.id,this.urlSerializer.serialize(s.extractedUrl),u.message,u.cancellationCode)),function Mne(t){return m2(t)&&cc(t.url)}(u)?this.events.next(new dA(u.url)):s.resolve(!1);else{this.events.next(new tI(s.id,this.urlSerializer.serialize(s.extractedUrl),u,s.targetSnapshot??void 0));try{s.resolve(n.errorHandler(u))}catch(l){s.reject(l)}}return $o}))}))}cancelNavigationTransition(n,r,i){const s=new Ch(n.id,this.urlSerializer.serialize(n.extractedUrl),r,i);this.events.next(s),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Fre(t){return t!==Hg}let Vre=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:()=>he(Bre),providedIn:"root"})}return t})();class Ure{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}}let Bre=(()=>{class t extends Ure{static#e=this.\u0275fac=(()=>{let n;return function(i){return(n||(n=jl(t)))(i||t)}})();static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),b2=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:()=>he(jre),providedIn:"root"})}return t})(),jre=(()=>{class t extends b2{constructor(){super(...arguments),this.location=he(Sg),this.urlSerializer=he(Th),this.options=he(Ph,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=he(bA),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new wh,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=l2(0,null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(r=>{"popstate"===r.type&&n(r.url,r.state)})}handleRouterEvent(n,r){if(n instanceof eI)this.stateMemento=this.createStateMemento();else if(n instanceof Sh)this.rawUrlTree=r.initialUrl;else if(n instanceof s2){if("eager"===this.urlUpdateStrategy&&!r.extras.skipLocationChange){const i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(i,r)}}else n instanceof cA?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r))):n instanceof Ch&&(3===n.code||2===n.code)?this.restoreHistory(r):n instanceof tI?this.restoreHistory(r,!0):n instanceof Fa&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,r){const i=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){const o={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId)};this.location.replaceState(i,"",o)}else{const s={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId+1)};this.location.go(i,"",s)}}restoreHistory(n,r=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===n.finalUrl&&0===s&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,r){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}static#e=this.\u0275fac=(()=>{let n;return function(i){return(n||(n=jl(t)))(i||t)}})();static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Qg=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(Qg||{});function R2(t,e){t.events.pipe(po(n=>n instanceof Fa||n instanceof Ch||n instanceof tI||n instanceof Sh),oe(n=>n instanceof Fa||n instanceof Sh?Qg.COMPLETE:n instanceof Ch&&(0===n.code||1===n.code)?Qg.REDIRECTING:Qg.FAILED),po(n=>n!==Qg.REDIRECTING),yh(1)).subscribe(()=>{e()})}function $re(t){throw t}const Hre={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},zre={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let gs=(()=>{class t{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=he(pF),this.stateManager=he(b2),this.options=he(Ph,{optional:!0})||{},this.pendingTasks=he(kS),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=he(oI),this.urlSerializer=he(Th),this.location=he(Sg),this.urlHandlingStrategy=he(bA),this._events=new I,this.errorHandler=this.options.errorHandler||$re,this.navigated=!1,this.routeReuseStrategy=he(Vre),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=he(Nh,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!he(nI,{optional:!0}),this.eventsSubscription=new At,this.isNgZoneEnabled=he(Et)instanceof Et&&Et.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const n=this.navigationTransitions.events.subscribe(r=>{try{const i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(null!==i&&null!==s)if(this.stateManager.handleRouterEvent(r,s),r instanceof Ch&&0!==r.code&&1!==r.code)this.navigated=!0;else if(r instanceof Fa)this.navigated=!0;else if(r instanceof dA){const o=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),a={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Fre(i.source)};this.scheduleNavigation(o,Hg,null,a,{resolve:i.resolve,reject:i.reject,promise:i.promise})}(function qre(t){return!(t instanceof cA||t instanceof dA)})(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Hg,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription||(this.nonRouterCurrentEntryChangeSubscription=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",r)},0)}))}navigateToSyncWithBrowser(n,r,i){const s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){const u={...i};delete u.navigationId,delete u.\u0275routerPageId,0!==Object.keys(u).length&&(s.state=u)}const a=this.parseUrl(n);this.scheduleNavigation(a,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(IA),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,r={}){const{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:u}=r,l=u?this.currentUrlTree.fragment:o;let f,d=null;switch(a){case"merge":d={...this.currentUrlTree.queryParams,...s};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}null!==d&&(d=this.removeEmptyProps(d));try{f=YU(i?i.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||!n[0].startsWith("/"))&&(n=[]),f=this.currentUrlTree.root}return XU(f,n,d,l??null)}navigateByUrl(n,r={skipLocationChange:!1}){const i=cc(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Hg,null,r)}navigate(n,r={skipLocationChange:!1}){return function Wre(t){for(let e=0;e<t.length;e++)if(null==t[e])throw new V(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,r){let i;if(i=!0===r?{...Hre}:!1===r?{...zre}:r,cc(n))return $U(this.currentUrlTree,n,i);const s=this.parseUrl(n);return $U(this.currentUrlTree,s,i)}removeEmptyProps(n){return Object.keys(n).reduce((r,i)=>{const s=n[i];return null!=s&&(r[i]=s),r},{})}scheduleNavigation(n,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,u,l;o?(a=o.resolve,u=o.reject,l=o.promise):l=new Promise((f,m)=>{a=f,u=m});const d=this.pendingTasks.add();return R2(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:s,resolve:a,reject:u,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(f=>Promise.reject(f))}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),aI=(()=>{class t{constructor(n,r,i,s,o,a){this.router=n,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=o,this.locationStrategy=a,this.href=null,this.commands=null,this.onChanges=new I,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const u=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===u||"area"===u,this.isAnchorElement?this.subscription=n.events.subscribe(l=>{l instanceof Fa&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){null!=n?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(n,r,i,s,o){return!!(null===this.urlTree||this.isAnchorElement&&(0!==n||r||i||s||o||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const n=null===this.href?null:function ik(t,e,n){return function Q3(t,e){return"src"===e&&("embed"===t||"frame"===t||"iframe"===t||"media"===t||"script"===t)||"href"===e&&("base"===t||"link"===t)?rk:r0}(e,n)(t)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(n,r){const i=this.renderer,s=this.el.nativeElement;null!==r?i.setAttribute(s,n,r):i.removeAttribute(s,n)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static#e=this.\u0275fac=function(r){return new(r||t)(Ve(gs),Ve(dc),function $l(t){return function mC(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const r=n.length;let i=0;for(;i<r;){const s=n[i];if(Yf(s))break;if(0===s)i+=2;else if("number"==typeof s)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(s===e)return n[i+1];i+=2}}}return null}(Vt(),t)}("tabindex"),Ve(Dv),Ve(Cu),Ve(ic))};static#t=this.\u0275dir=ur({type:t,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,i){1&r&&_g("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),2&r&&O0("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",XS],skipLocationChange:["skipLocationChange","skipLocationChange",XS],replaceUrl:["replaceUrl","replaceUrl",XS],routerLink:"routerLink"},standalone:!0,features:[oO,ma]})}return t})(),P2=(()=>{class t{get isActive(){return this._isActive}constructor(n,r,i,s,o){this.router=n,this.element=r,this.renderer=i,this.cdr=s,this.link=o,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new Ei,this.routerEventsSubscription=n.events.subscribe(a=>{a instanceof Fa&&this.update()})}ngAfterContentInit(){Me(this.links.changes,Me(null)).pipe(_h()).subscribe(n=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const n=[...this.links.toArray(),this.link].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=Kt(n).pipe(_h()).subscribe(r=>{this._isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(n){const r=Array.isArray(n)?n:n.split(" ");this.classes=r.filter(i=>!!i)}ngOnChanges(n){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{const n=this.hasActiveLinks();this._isActive!==n&&(this._isActive=n,this.cdr.markForCheck(),this.classes.forEach(r=>{n?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),n&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(n))})}isLinkActive(n){const r=function Gre(t){return!!t.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return i=>!!i.urlTree&&n.isActive(i.urlTree,r)}hasActiveLinks(){const n=this.isLinkActive(this.router);return this.link&&n(this.link)||this.links.some(n)}static#e=this.\u0275fac=function(r){return new(r||t)(Ve(gs),Ve(Cu),Ve(Dv),Ve(xv),Ve(aI,8))};static#t=this.\u0275dir=ur({type:t,selectors:[["","routerLinkActive",""]],contentQueries:function(r,i,s){if(1&r&&GL(s,aI,5),2&r){let o;qL(o=function KL(){return function eZ(t,e){return t[Ms].queries[e].queryList}(K(),md())}())&&(i.links=o)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[ma]})}return t})();class N2{}let Kre=(()=>{class t{constructor(n,r,i,s,o){this.router=n,this.injector=i,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(po(n=>n instanceof Fa),Fg(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,r){const i=[];for(const s of r){s.providers&&!s._injector&&(s._injector=ES(s.providers,n,`Route: ${s.path}`));const o=s._injector??n,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&i.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&i.push(this.processRoutes(a,s.children??s._loadedRoutes))}return Kt(i).pipe(_h())}preloadConfig(n,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(n,r):Me(null);const s=i.pipe(ni(o=>null===o?Me(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??n,o.routes))));return r.loadComponent&&!r._loadedComponent?Kt([s,this.loader.loadComponent(r)]).pipe(_h()):s})}static#e=this.\u0275fac=function(r){return new(r||t)(Y(gs),Y(gF),Y(Vs),Y(N2),Y(AA))};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const RA=new de("");let M2=(()=>{class t{constructor(n,r,i,s,o={}){this.urlSerializer=n,this.transitions=r,this.viewportScroller=i,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof eI?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof Fa?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof Sh&&0===n.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof o2&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new o2(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){!function Ak(){throw new Error("invalid")}()};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac})}return t})();function qo(t,e){return{\u0275kind:t,\u0275providers:e}}function k2(){const t=he(as);return e=>{const n=t.get(nc);if(e!==n.components[0])return;const r=t.get(gs),i=t.get(O2);1===t.get(PA)&&r.initialNavigation(),t.get(L2,null,ot.Optional)?.setUpPreloading(),t.get(RA,null,ot.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const O2=new de("",{factory:()=>new I}),PA=new de("",{providedIn:"root",factory:()=>1}),L2=new de("");function Xre(t){return qo(0,[{provide:L2,useExisting:Kre},{provide:N2,useExisting:t}])}function eie(t){return qo(9,[{provide:D2,useValue:Ore},{provide:A2,useValue:{skipNextTransition:!!t?.skipInitialTransition,...t}}])}const F2=new de("ROUTER_FORROOT_GUARD"),tie=[Sg,{provide:Th,useClass:sA},gs,zg,{provide:dc,useFactory:function x2(t){return t.routerState.root},deps:[gs]},AA,[]];let NA=(()=>{class t{constructor(n){}static forRoot(n,r){return{ngModule:t,providers:[tie,[],{provide:Nh,multi:!0,useValue:n},{provide:F2,useFactory:sie,deps:[[gs,new Ca,new Xy]]},{provide:Ph,useValue:r||{}},r?.useHash?{provide:ic,useClass:WQ}:{provide:ic,useClass:rV},{provide:RA,useFactory:()=>{const t=he(hX),e=he(Et),n=he(Ph),r=he(oI),i=he(Th);return n.scrollOffset&&t.setOffset(n.scrollOffset),new M2(i,r,t,e,n)}},r?.preloadingStrategy?Xre(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?oie(r):[],r?.bindToComponentInputs?qo(8,[f2,{provide:nI,useExisting:f2}]).\u0275providers:[],r?.enableViewTransitions?eie().\u0275providers:[],[{provide:V2,useFactory:k2},{provide:jS,multi:!0,useExisting:V2}]]}}static forChild(n){return{ngModule:t,providers:[{provide:Nh,multi:!0,useValue:n}]}}static#e=this.\u0275fac=function(r){return new(r||t)(Y(F2,8))};static#t=this.\u0275mod=Er({type:t});static#n=this.\u0275inj=ar({})}return t})();function sie(t){return"guarded"}function oie(t){return["disabled"===t.initialNavigation?qo(3,[{provide:US,multi:!0,useFactory:()=>{const e=he(gs);return()=>{e.setUpLocationChangeListener()}}},{provide:PA,useValue:2}]).\u0275providers:[],"enabledBlocking"===t.initialNavigation?qo(2,[{provide:PA,useValue:0},{provide:US,multi:!0,deps:[as],useFactory:e=>{const n=e.get(HQ,Promise.resolve());return()=>n.then(()=>new Promise(r=>{const i=e.get(gs),s=e.get(O2);R2(i,()=>{r(!0)}),e.get(oI).afterPreactivation=()=>(r(!0),s.closed?Me(void 0):s),i.initialNavigation()}))}}]).\u0275providers:[]]}const V2=new de(""),uie_firebaseConfig={apiKey:"AIzaSyCwVifARku6nPemSHNDWivjnivQKT2cc8g",authDomain:"e-shop-c52ad.firebaseapp.com",projectId:"e-shop-c52ad",storageBucket:"e-shop-c52ad.appspot.com",messagingSenderId:"444472786878",appId:"1:444472786878:web:470744a21521084819c3ef",measurementId:"G-VL5TBK5XY1"};var ri=xe(534);(0,ri.registerVersion)("firebase","10.7.1","app");class die extends At{constructor(e,n){super()}schedule(e,n=0){return this}}const uI={setInterval(t,e,...n){const{delegate:r}=uI;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){const{delegate:e}=uI;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};class U2 extends die{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;const i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return uI.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return n;null!=n&&uI.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,n);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let i,r=!1;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,En(r,this),null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}}const MA={now:()=>(MA.delegate||Date).now(),delegate:void 0};class Yg{constructor(e,n=Yg.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}}Yg.now=MA.now;class B2 extends Yg{constructor(e,n=Yg.now){super(e,n),this.actions=[],this._active=!1}flush(e){const{actions:n}=this;if(this._active)return void n.push(e);let r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}}const pie=new class fie extends B2{}(class hie extends U2{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}}),lI=new B2(U2),Mh=new Ig("ANGULARFIRE2_VERSION");class cI{constructor(){return((t,e)=>{const n=e?[e]:(0,ri.getApps)(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r})(mie)}}const mie="app-check";function xh(){}class $2{zone;delegate;constructor(e,n=pie){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){const i=this.zone;return this.delegate.schedule(function(o){i.runGuarded(()=>{e.apply(this,[o])})},n,r)}}class _ie{zone;task=null;constructor(e){this.zone=e}call(e,n){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",xh,{},xh,xh)),n.pipe($r({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let dI=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new $2(Zone.current)),this.insideAngular=n.run(()=>new $2(Zone.current,lI)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(Y(Et))};static \u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function kh(){const t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return t}function hc(t){return kh().ngZone.run(()=>t())}function H2(t){return t.pipe(La(kh().outsideAngular))}function Xn(t){return function vie(t){return function(n){return(n=n.lift(new _ie(t.ngZone))).pipe(uc(t.outsideAngular),La(t.insideAngular))}}(kh())(t)}const Eie=(t,e)=>function(){const r=arguments;return e&&setTimeout(()=>{"scheduled"===e.state&&e.invoke()},10),hc(()=>t.apply(void 0,r))},Iie=(t,e)=>function(){let n;const r=arguments;for(let s=0;s<arguments.length;s++)"function"==typeof r[s]&&(e&&(n||=hc(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",xh,{},xh,xh))),r[s]=Eie(r[s],n));const i=function yie(t){return kh().ngZone.runOutsideAngular(()=>t())}(()=>t.apply(this,r));if(!e){if(i instanceof Ct){const s=kh();return i.pipe(uc(s.outsideAngular),La(s.insideAngular))}return hc(()=>i)}return i instanceof Ct?i.pipe(Xn):i instanceof Promise?hc(()=>new Promise((s,o)=>i.then(a=>hc(()=>s(a)),a=>hc(()=>o(a))))):"function"==typeof i&&n?function(){return setTimeout(()=>{n&&"scheduled"===n.state&&n.invoke()},10),i.apply(this,arguments)}:hc(()=>i)};var ms=xe(106);ms.Z.registerVersion("firebase","10.7.1","app-compat");const Cie=["ngOnDestroy"];class z2{constructor(e){return e}}const Oh=new de("angularfire2.app.options"),Lh=new de("angularfire2.app.name");function Xg(t,e,n){const i="object"==typeof n&&n||{};i.name=i.name||"string"==typeof n&&n||"[DEFAULT]";const o=ms.Z.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>ms.Z.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){const a=!!module.hot;Aie("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new z2(o)}const Aie=(t,...e)=>{},bie={provide:z2,useFactory:Xg,deps:[Oh,Et,[new Ca,Lh]]};let Rie=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:Oh,useValue:n},{provide:Lh,useValue:r}]}}constructor(n){ms.Z.registerVersion("angularfire",Mh.full,"core"),ms.Z.registerVersion("angularfire",Mh.full,"app-compat"),ms.Z.registerVersion("angular",TZ.full,n.toString())}static \u0275fac=function(r){return new(r||t)(Y(oo))};static \u0275mod=Er({type:t});static \u0275inj=ar({providers:[bie]})}return t})();function hI(t,e,n,r,i){const[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return function Pie(t,e){try{return t.toString()===e.toString()}catch{return t===e}}(i,o)||(W2("error",`${e} was already initialized on the ${n} Firebase App with different settings.${Nie?" You may need to reload as Firebase is not HMR aware.":""}`),W2("warn",{is:i,was:o})),s;{const a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}const Nie=typeof module<"u"&&!!module.hot,W2=(t,...e)=>{};function xA(...t){const e=Lg(t),n=function wte(t,e){return"number"==typeof XD(t)?t.pop():e}(t,1/0),r=t;return r.length?1===r.length?ps(r[0]):_h(n)(Kt(r,e)):$o}globalThis.\u0275AngularfireInstanceCache||=[],xe(365);class Mie extends I{constructor(e=1/0,n=1/0,r=MA){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){const{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){const{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){const o=n.now();let a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}}function q2(t={}){const{connector:e=(()=>new I),resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,u,l=0,d=!1,f=!1;const m=()=>{a?.unsubscribe(),a=void 0},_=()=>{m(),o=u=void 0,d=f=!1},v=()=>{const T=o;_(),T?.unsubscribe()};return U((T,D)=>{l++,!f&&!d&&m();const x=u=u??e();D.add(()=>{l--,0===l&&!f&&!d&&(a=kA(v,i))}),x.subscribe(D),!o&&l>0&&(o=new qt({next:R=>x.next(R),error:R=>{f=!0,m(),a=kA(_,n,R),x.error(R)},complete:()=>{d=!0,m(),a=kA(_,r),x.complete()}}),ps(T).subscribe(o))})(s)}}function kA(t,e,...n){if(!0===e)return void t();if(!1===e)return;const r=new qt({next:()=>{r.unsubscribe(),t()}});return ps(e(...n)).subscribe(r)}function G2(t,e,n){let r,i=!1;return t&&"object"==typeof t?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t):r=t??1/0,q2({connector:()=>new Mie(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function K2(t,e){return ke(e)?Yn(()=>t,e):Yn(()=>t)}const OA=new de("angularfire2.auth.use-emulator"),LA=new de("angularfire2.auth.settings"),FA=new de("angularfire2.auth.tenant-id"),VA=new de("angularfire2.auth.langugage-code"),UA=new de("angularfire2.auth.use-device-language"),BA=new de("angularfire.auth.persistence"),jA=(t,e,n,r,i,s,o,a)=>hI(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{const u=e.runOutsideAngular(()=>t.auth());if(n&&u.useEmulator(...n),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(const[l,d]of Object.entries(o))u.settings[l]=d;return a&&u.setPersistence(a),u},[n,r,i,s,o,a]);let Jg=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,u,l,d,f,m,_){const v=new I,T=Me(void 0).pipe(La(o.outsideAngular),Yn(()=>s.runOutsideAngular(()=>Promise.resolve().then(xe.bind(xe,365)))),oe(()=>Xg(n,s,r)),oe(D=>jA(D,s,a,l,d,f,u,m)),G2({bufferSize:1,refCount:!1}));if(bE(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Me(null);else{T.pipe(Mu()).subscribe();const D=T.pipe(Yn(L=>L.getRedirectResult().then(G=>G,()=>null)),Xn,G2({bufferSize:1,refCount:!1})),x=T.pipe(Yn(L=>new Ct(G=>({unsubscribe:s.runOutsideAngular(()=>L.onAuthStateChanged(ae=>G.next(ae),ae=>G.error(ae),()=>G.complete()))})))),R=T.pipe(Yn(L=>new Ct(G=>({unsubscribe:s.runOutsideAngular(()=>L.onIdTokenChanged(ae=>G.next(ae),ae=>G.error(ae),()=>G.complete()))}))));this.authState=D.pipe(K2(x),uc(o.outsideAngular),La(o.insideAngular)),this.user=D.pipe(K2(R),uc(o.outsideAngular),La(o.insideAngular)),this.idToken=this.user.pipe(Yn(L=>L?Kt(L.getIdToken()):Me(null))),this.idTokenResult=this.user.pipe(Yn(L=>L?Kt(L.getIdTokenResult()):Me(null))),this.credential=xA(D,v,this.authState.pipe(po(L=>!L))).pipe(oe(L=>L?.user?L:null),uc(o.outsideAngular),La(o.insideAngular))}return((t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(Cie.indexOf(s)>-1)return()=>{};const o=e.toPromise().then(a=>{const u=a?.[s];return"function"==typeof u?u.bind(a):u?.then?u.then(l=>n.run(()=>l)):n.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,l)=>o.then(d=>{const f=d?.(...l);return r?.spy?.apply&&r.spy.apply(s,l,f),f})})})}))(this,T,s,{spy:{apply:(D,x,R)=>{(D.startsWith("signIn")||D.startsWith("createUser"))&&R.then(L=>v.next(L))}}})}static \u0275fac=function(r){return new(r||t)(Y(Oh),Y(Lh,8),Y(oo),Y(Et),Y(dI),Y(OA,8),Y(LA,8),Y(FA,8),Y(VA,8),Y(UA,8),Y(BA,8),Y(cI,8))};static \u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),kie=(()=>{class t{constructor(){ms.Z.registerVersion("angularfire",Mh.full,"auth-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Er({type:t});static \u0275inj=ar({providers:[Jg]})}return t})();var Z=xe(861),S=xe(58),mo=xe(537);const Z2="firebasestorage.googleapis.com",Q2="storageBucket";class kn extends S.ZR{constructor(e,n,r=0){super($A(e),`Firebase Storage: ${n} (${$A(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,kn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return $A(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var wn=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(wn||{});function $A(t){return"storage/"+t}function HA(){return new kn(wn.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function Y2(){return new kn(wn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function X2(){return new kn(wn.CANCELED,"User canceled the upload/download.")}function J2(){return new kn(wn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Fh(t){return new kn(wn.INVALID_ARGUMENT,t)}function eB(){return new kn(wn.APP_DELETED,"The Firebase app was deleted.")}function tB(t){return new kn(wn.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function em(t,e){return new kn(wn.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function tm(t){throw new kn(wn.INTERNAL_ERROR,"Internal error: "+t)}class ii{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=ii.makeFromUrl(e,n)}catch{return new ii(e,"")}if(""===r.path)return r;throw function Wie(t){return new kn(wn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)",a=new RegExp("^gs://"+i+"(/(.*))?$","i");function l(G){G.path_=decodeURIComponent(G.path)}const f=n.replace(/[.]/g,"\\."),L=[{regex:a,indices:{bucket:1,path:3},postModify:function s(G){"/"===G.path.charAt(G.path.length-1)&&(G.path_=G.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${f}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:l},{regex:new RegExp(`^https?://${n===Z2?"(?:storage.googleapis.com|storage.cloud.google.com)":n}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:l}];for(let G=0;G<L.length;G++){const ae=L[G],ye=ae.regex.exec(e);if(ye){let Bt=ye[ae.indices.path];Bt||(Bt=""),r=new ii(ye[ae.indices.bucket],Bt),ae.postModify(r);break}}if(null==r)throw function zie(t){return new kn(wn.INVALID_URL,"Invalid URL '"+t+"'.")}(e);return r}}class Qie{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function fI(t){return"string"==typeof t||t instanceof String}function nB(t){return zA()&&t instanceof Blob}function zA(){return typeof Blob<"u"}function WA(t,e,n,r){if(r<e)throw Fh(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Fh(`Invalid value for '${t}'. Expected ${n} or less.`)}function Va(t,e,n){let r=e;return null==n&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function rB(t){const e=encodeURIComponent;let n="?";for(const r in t)t.hasOwnProperty(r)&&(n=n+(e(r)+"=")+e(t[r])+"&");return n=n.slice(0,-1),n}var Vh=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(Vh||{});function iB(t,e){const n=t>=500&&t<600,i=-1!==[408,429].indexOf(t),s=-1!==e.indexOf(t);return n||i||s}class nse{constructor(e,n,r,i,s,o,a,u,l,d,f,m=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=u,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=f,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,v)=>{this.resolve_=_,this.reject_=v,this.start_()})}start_(){const n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const u=this.callback_(a,a.getResponse());!function Jie(t){return void 0!==t}(u)?s():s(u)}catch(u){o(u)}else if(null!==a){const u=HA();u.serverResponse=a.getErrorText(),o(this.errorCallback_?this.errorCallback_(a,u):u)}else o(i.canceled?this.appDelete_?eB():X2():Y2())};this.canceled_?n(0,new pI(!1,null,!0)):this.backoffId_=function Yie(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function u(){return 2===a}let l=!1;function d(...D){l||(l=!0,e.apply(null,D))}function f(D){i=setTimeout(()=>{i=null,t(_,u())},D)}function m(){s&&clearTimeout(s)}function _(D,...x){if(l)return void m();if(D)return m(),void d.call(null,D,...x);if(u()||o)return m(),void d.call(null,D,...x);let L;r<64&&(r*=2),1===a?(a=2,L=0):L=1e3*(r+Math.random()),f(L)}let v=!1;function T(D){v||(v=!0,m(),!l&&(null!==i?(D||(a=2),clearTimeout(i),f(0)):D||(a=1)))}return f(0),s=setTimeout(()=>{o=!0,T(!0)},n),T}((r,i)=>{if(i)return void r(!1,new pI(!1,null,!0));const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{null!==this.progressCallback_&&this.progressCallback_(a.loaded,a.lengthComputable?a.total:-1)};null!==this.progressCallback_&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Vh.NO_ERROR,u=s.getStatus();if(!a||iB(u,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===Vh.ABORT;return void r(!1,new pI(!1,null,d))}const l=-1!==this.successCodes_.indexOf(u);r(!0,new pI(l,s))})},n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function Xie(t){t(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class pI{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function lse(...t){const e=function use(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==e){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}if(zA())return new Blob(t);throw new kn(wn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const _s={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class qA{constructor(e,n){this.data=e,this.contentType=n||null}}function GA(t,e){switch(t){case _s.RAW:return new qA(sB(e));case _s.BASE64:case _s.BASE64URL:return new qA(oB(t,e));case _s.DATA_URL:return new qA(function fse(t){const e=new aB(t);return e.base64?oB(_s.BASE64,e.rest):function hse(t){let e;try{e=decodeURIComponent(t)}catch{throw em(_s.DATA_URL,"Malformed data URL.")}return sB(e)}(e.rest)}(e),function pse(t){return new aB(t).contentType}(e))}throw HA()}function sB(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?n<t.length-1&&56320==(64512&t.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function oB(t,e){switch(t){case _s.BASE64:{const i=-1!==e.indexOf("-"),s=-1!==e.indexOf("_");if(i||s)throw em(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case _s.BASE64URL:{const i=-1!==e.indexOf("+"),s=-1!==e.indexOf("/");if(i||s)throw em(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=function dse(t){if(typeof atob>"u")throw function Zie(t){return new kn(wn.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(t)}(e)}catch(i){throw i.message.includes("polyfill")?i:em(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class aB{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(null===n)throw em(_s.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;null!=r&&(this.base64=function gse(t,e){return t.length>=e.length&&t.substring(t.length-e.length)===e}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class Go{constructor(e,n){let r=0,i="";nB(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(nB(this.data_)){const i=function cse(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}(this.data_,e,n);return null===i?null:new Go(i)}{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Go(r,!0)}}static getBlob(...e){if(zA()){const n=e.map(r=>r instanceof Go?r.data_:r);return new Go(lse.apply(null,n))}{const n=e.map(o=>fI(o)?GA(_s.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new Go(i,!0)}}uploadData(){return this.data_}}function KA(t){let e;try{e=JSON.parse(t)}catch{return null}return function tse(t){return"object"==typeof t&&!Array.isArray(t)}(e)?e:null}function uB(t){const e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function yse(t,e){return e}class Si{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||yse}}let gI=null;function nm(){if(gI)return gI;const t=[];t.push(new Si("bucket")),t.push(new Si("generation")),t.push(new Si("metageneration")),t.push(new Si("name","fullPath",!0));const n=new Si("name");n.xform=function e(s,o){return function vse(t){return!fI(t)||t.length<2?t:uB(t)}(o)},t.push(n);const i=new Si("size");return i.xform=function r(s,o){return void 0!==o?Number(o):o},t.push(i),t.push(new Si("timeCreated")),t.push(new Si("updated")),t.push(new Si("md5Hash",null,!0)),t.push(new Si("cacheControl",null,!0)),t.push(new Si("contentDisposition",null,!0)),t.push(new Si("contentEncoding",null,!0)),t.push(new Si("contentLanguage",null,!0)),t.push(new Si("contentType",null,!0)),t.push(new Si("metadata","customMetadata",!0)),gI=t,gI}function lB(t,e,n){const r=KA(e);return null===r?null:function Ise(t,e,n){const r={type:"file"},i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return function Ese(t,e){Object.defineProperty(t,"ref",{get:function n(){const s=new ii(t.bucket,t.fullPath);return e._makeStorageReference(s)}})}(r,t),r}(t,r,n)}function ZA(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}const cB="prefixes",dB="items";class Ko{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Zo(t){if(!t)throw HA()}function mI(t,e){return function n(r,i){const s=lB(t,i,e);return Zo(null!==s),s}}function Uh(t){return function e(n,r){let i;return i=401===n.getStatus()?n.getErrorText().includes("Firebase App Check token is invalid")?function $ie(){return new kn(wn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function jie(){return new kn(wn.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===n.getStatus()?function Bie(t){return new kn(wn.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(t.bucket):403===n.getStatus()?function Hie(t){return new kn(wn.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}(t.path):r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}}function rm(t){const e=Uh(t);return function n(r,i){let s=e(r,i);return 404===r.getStatus()&&(s=function Uie(t){return new kn(wn.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}(t.path)),s.serverResponse=i.serverResponse,s}}function hB(t,e,n){const i=Va(e.fullServerUrl(),t.host,t._protocol),o=t.maxOperationRetryTime,a=new Ko(i,"GET",mI(t,n),o);return a.errorHandler=rm(e),a}function Ase(t,e,n,r,i){const s={};s.prefix=e.isRoot?"":e.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);const a=Va(e.bucketOnlyServerUrl(),t.host,t._protocol),l=t.maxOperationRetryTime,d=new Ko(a,"GET",function Sse(t,e){return function n(r,i){const s=function Cse(t,e,n){const r=KA(n);return null===r?null:function Tse(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[cB])for(const i of n[cB]){const s=i.replace(/\/$/,""),o=t._makeStorageReference(new ii(e,s));r.prefixes.push(o)}if(n[dB])for(const i of n[dB]){const s=t._makeStorageReference(new ii(e,i.name));r.items.push(s)}return r}(t,e,r)}(t,e,i);return Zo(null!==s),s}}(t,e.bucket),l);return d.urlParams=s,d.errorHandler=Uh(e),d}function pB(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function Nse(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}class _I{constructor(e,n,r,i){this.current=e,this.total=n,this.finalized=!!r,this.metadata=i||null}}function QA(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Zo(!1)}return Zo(!!n&&-1!==(e||["active"]).indexOf(n)),n}const Ose={STATE_CHANGED:"state_changed"},Di={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function YA(t){switch(t){case"running":case"pausing":case"canceling":return Di.RUNNING;case"paused":return Di.PAUSED;case"success":return Di.SUCCESS;case"canceled":return Di.CANCELED;default:return Di.ERROR}}class Lse{constructor(e,n,r){if(function ese(t){return"function"==typeof t}(e)||null!=n||null!=r)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{const s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}}function Bh(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}let _B=null;class Fse{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Vh.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Vh.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Vh.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw tm("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),void 0!==i)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw tm("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw tm("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw tm("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw tm("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class Vse extends Fse{initXhr(){this.xhr_.responseType="text"}}function _o(){return _B?_B():new Vse}class yB{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=nm(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(wn.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const s=this.isExponentialBackoffExpired();if(iB(i.status,[])){if(!s)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();i=Y2()}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(wn.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,n)=>{const r=function Mse(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o=pB(e,r,i),a={name:o.fullPath},u=Va(s,t.host,t._protocol),d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},f=ZA(o,n),v=new Ko(u,"POST",function _(T){let D;QA(T);try{D=T.getResponseHeader("X-Goog-Upload-URL")}catch{Zo(!1)}return Zo(fI(D)),D},t.maxUploadRetryTime);return v.urlParams=a,v.headers=d,v.body=f,v.errorHandler=Uh(e),v}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,_o,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const i=function xse(t,e,n,r){const u=new Ko(n,"POST",function s(l){const d=QA(l,["active","final"]);let f=null;try{f=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Zo(!1)}f||Zo(!1);const m=Number(f);return Zo(!isNaN(m)),new _I(m,r.size(),"final"===d)},t.maxUploadRetryTime);return u.headers={"X-Goog-Upload-Command":"query"},u.errorHandler=Uh(e),u}(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,_o,n,r);this._request=s,s.getPromise().then(o=>{this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,n=new _I(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=function kse(t,e,n,r,i,s,o,a){const u=new _I(0,0);if(o?(u.current=o.current,u.total=o.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw function Gie(){return new kn(wn.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const l=u.total-u.current;let d=l;i>0&&(d=Math.min(d,i));const f=u.current;let _="";_=0===d?"finalize":l===d?"upload, finalize":"upload";const v={"X-Goog-Upload-Command":_,"X-Goog-Upload-Offset":`${u.current}`},T=r.slice(f,f+d);if(null===T)throw J2();const L=new Ko(n,"POST",function D(G,ae){const ye=QA(G,["active","final"]),Qe=u.current+d,Bt=r.size();let Zr;return Zr="final"===ye?mI(e,s)(G,ae):null,new _I(Qe,Bt,"final"===ye,Zr)},e.maxUploadRetryTime);return L.headers=v,L.body=T.uploadData(),L.progressCallback=a||null,L.errorHandler=Uh(t),L}(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(u){return this._error=u,void this._transition("error")}const a=this._ref.storage._makeRequest(o,_o,i,s,!1);this._request=a,a.getPromise().then(u=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(u.current),u.finalized?(this._metadata=u.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=hB(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,_o,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=function gB(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},u=function a(){let L="";for(let G=0;G<2;G++)L+=Math.random().toString().slice(2);return L}();o["Content-Type"]="multipart/related; boundary="+u;const l=pB(e,r,i),d=ZA(l,n),_=Go.getBlob("--"+u+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+d+"\r\n--"+u+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",r,"\r\n--"+u+"--");if(null===_)throw J2();const v={name:l.fullPath},T=Va(s,t.host,t._protocol),x=t.maxUploadRetryTime,R=new Ko(T,"POST",mI(t,n),x);return R.urlParams=v,R.headers=o,R.body=_.uploadData(),R.errorHandler=Uh(e),R}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,_o,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const n="paused"===this._state;this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=X2(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=YA(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,i){const s=new Lse(n||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);-1!==n&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(YA(this._state)){case Di.SUCCESS:Bh(this._resolve.bind(null,this.snapshot))();break;case Di.CANCELED:case Di.ERROR:Bh(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(YA(this._state)){case Di.RUNNING:case Di.PAUSED:e.next&&Bh(e.next.bind(e,this.snapshot))();break;case Di.SUCCESS:e.complete&&Bh(e.complete.bind(e))();break;default:e.error&&Bh(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class fc{constructor(e,n){this._service=e,this._location=n instanceof ii?n:ii.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new fc(e,n)}get root(){const e=new ii(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return uB(this._location.path)}get storage(){return this._service}get parent(){const e=function mse(t){if(0===t.length)return null;const e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;const n=new ii(this._location.bucket,e);return new fc(this._service,n)}_throwIfRoot(e){if(""===this._location.path)throw tB(e)}}function EB(t,e,n){return XA.apply(this,arguments)}function XA(){return(XA=(0,Z.Z)(function*(t,e,n){const i=yield IB(t,{pageToken:n});e.prefixes.push(...i.prefixes),e.items.push(...i.items),null!=i.nextPageToken&&(yield EB(t,e,i.nextPageToken))})).apply(this,arguments)}function IB(t,e){null!=e&&"number"==typeof e.maxResults&&WA("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=Ase(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,_o)}function Qse(t){t._throwIfRoot("getDownloadURL");const e=function bse(t,e,n){const i=Va(e.fullServerUrl(),t.host,t._protocol),o=t.maxOperationRetryTime,a=new Ko(i,"GET",function Dse(t,e){return function n(r,i){const s=lB(t,i,e);return Zo(null!==s),function wse(t,e,n,r){const i=KA(e);if(null===i||!fI(i.downloadTokens))return null;const s=i.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map(l=>{const f=t.fullPath;return Va("/b/"+o(t.bucket)+"/o/"+o(f),n,r)+rB({alt:"media",token:l})})[0]}(s,i,t.host,t._protocol)}}(t,n),o);return a.errorHandler=rm(e),a}(t.storage,t._location,nm());return t.storage.makeRequestWithTokens(e,_o).then(n=>{if(null===n)throw function Kie(){return new kn(wn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return n})}function wB(t,e){const n=function _se(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),r=new ii(t._location.bucket,n);return new fc(t.storage,r)}function TB(t,e){if(t instanceof JA){const n=t;if(null==n._bucket)throw function qie(){return new kn(wn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Q2+"' property when initializing the app?")}();const r=new fc(n,n._bucket);return null!=e?TB(r,e):r}return void 0!==e?wB(t,e):t}function eoe(t,e){if(e&&function Xse(t){return/^[A-Za-z]+:\/\//.test(t)}(e)){if(t instanceof JA)return function Jse(t,e){return new fc(t,e)}(t,e);throw Fh("To use ref(service, url), the first argument must be a Storage instance.")}return TB(t,e)}function CB(t,e){const n=e?.[Q2];return null==n?null:ii.makeFromBucketSpec(n,t)}class JA{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=Z2,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?ii.makeFromBucketSpec(i,this._host):CB(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?ii.makeFromBucketSpec(this._url,e):CB(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){WA("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){WA("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,Z.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const n=e._authProvider.getImmediate({optional:!0});if(n){const r=yield n.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,Z.Z)(function*(){const n=e._appCheckProvider.getImmediate({optional:!0});return n?(yield n.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new fc(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new Qie(eB());{const o=function ase(t,e,n,r,i,s,o=!0){const a=rB(t.urlParams),u=t.url+a,l=Object.assign({},t.headers);return function sse(t,e){e&&(t["X-Firebase-GMPID"]=e)}(l,e),function rse(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(l,n),function ise(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(l,s),function ose(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(l,r),new nse(u,t.method,l,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,n){var r=this;return(0,Z.Z)(function*(){const[i,s]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,n,i,s).getPromise()})()}}const SB="@firebase/storage";function bB(t,e){return eoe(t=(0,S.m9)(t),e)}function coe(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new JA(n,r,i,e,ri.SDK_VERSION)}!function doe(){(0,ri._registerComponent)(new mo.wA("storage",coe,"PUBLIC").setMultipleInstances(!0)),(0,ri.registerVersion)(SB,"0.12.0",""),(0,ri.registerVersion)(SB,"0.12.0","esm2017")}();class yI{constructor(e,n,r){this._delegate=e,this.task=n,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class PB{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new yI(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(r=>{if(e)return e(new yI(r,this,this._ref))},n)}on(e,n,r,i){let s;return n&&(s="function"==typeof n?o=>n(new yI(o,this,this._ref)):{next:n.next?o=>n.next(new yI(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}}class NB{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new Ua(e,this._service))}get items(){return this._delegate.items.map(e=>new Ua(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class Ua{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const n=function loe(t,e){return wB(t,e)}(this._delegate,e);return new Ua(n,this.storage)}get root(){return new Ua(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new Ua(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new PB(function noe(t,e,n){return function Wse(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new yB(t,new Go(e),n)}(t=(0,S.m9)(t),e,n)}(this._delegate,e,n),this)}putString(e,n=_s.RAW,r){this._throwIfRoot("putString");const i=GA(n,e),s=Object.assign({},r);return null==s.contentType&&null!=i.contentType&&(s.contentType=i.contentType),new PB(new yB(this._delegate,new Go(i.data,!0),s),this)}listAll(){return function ooe(t){return function Gse(t){const e={prefixes:[],items:[]};return EB(t,e).then(()=>e)}(t=(0,S.m9)(t))}(this._delegate).then(e=>new NB(e,this.storage))}list(e){return function soe(t,e){return IB(t=(0,S.m9)(t),e)}(this._delegate,e||void 0).then(n=>new NB(n,this.storage))}getMetadata(){return function roe(t){return function Kse(t){t._throwIfRoot("getMetadata");const e=hB(t.storage,t._location,nm());return t.storage.makeRequestWithTokens(e,_o)}(t=(0,S.m9)(t))}(this._delegate)}updateMetadata(e){return function ioe(t,e){return function Zse(t,e){t._throwIfRoot("updateMetadata");const n=function Rse(t,e,n,r){const s=Va(e.fullServerUrl(),t.host,t._protocol),a=ZA(n,r),l=t.maxOperationRetryTime,d=new Ko(s,"PATCH",mI(t,r),l);return d.headers={"Content-Type":"application/json; charset=utf-8"},d.body=a,d.errorHandler=rm(e),d}(t.storage,t._location,e,nm());return t.storage.makeRequestWithTokens(n,_o)}(t=(0,S.m9)(t),e)}(this._delegate,e)}getDownloadURL(){return function aoe(t){return Qse(t=(0,S.m9)(t))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function uoe(t){return function Yse(t){t._throwIfRoot("deleteObject");const e=function Pse(t,e){const r=Va(e.fullServerUrl(),t.host,t._protocol),a=new Ko(r,"DELETE",function o(u,l){},t.maxOperationRetryTime);return a.successCodes=[200,204],a.errorHandler=rm(e),a}(t.storage,t._location);return t.storage.makeRequestWithTokens(e,_o)}(t=(0,S.m9)(t))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw tB(e)}}class MB{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(xB(e))throw Fh("ref() expected a child path but got a URL, use refFromURL instead.");return new Ua(bB(this._delegate,e),this)}refFromURL(e){if(!xB(e))throw Fh("refFromURL() expected a full URL but got a child path, use ref() instead.");try{ii.makeFromUrl(e,this._delegate.host)}catch{throw Fh("refFromUrl() expected a valid full URL but got an invalid one.")}return new Ua(bB(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,r={}){!function RB(t,e,n,r={}){!function toe(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken="string"==typeof i?i:(0,S.Sg)(i,t.app.options.projectId))}(t,e,n,r)}(this._delegate,e,n,r)}}function xB(t){return/^[A-Za-z]+:\/\//.test(t)}function goe(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("storage").getImmediate({identifier:e});return new MB(n,r)}function kB(t){const e=function _oe(t){return new Ct(e=>{const n=o=>e.next(o);n(t.snapshot);const s=t.on("state_changed",n);return t.then(o=>{n(o),e.complete()},o=>{n(t.snapshot),(o=>{e.error(o)})(o)}),function(){s()}}).pipe(function Oie(t,e=lI){return U((n,r)=>{let i=null,s=null,o=null;const a=()=>{if(i){i.unsubscribe(),i=null;const l=s;s=null,r.next(l)}};function u(){const l=o+t,d=e.now();if(d<l)return i=this.schedule(void 0,l-d),void r.add(i);a()}n.subscribe(ce(r,l=>{s=l,o=e.now(),i||(i=e.schedule(u,t),r.add(i))},()=>{a(),r.complete()},void 0,()=>{s=i=null}))})}(0))}(t);return{task:t,then:t.then.bind(t),catch:t.catch.bind(t),pause:t.pause.bind(t),cancel:t.cancel.bind(t),resume:t.resume.bind(t),snapshotChanges:()=>e,percentageChanges:()=>e.pipe(oe(n=>n.bytesTransferred/n.totalBytes*100))}}function vI(t){return{getDownloadURL:()=>Me(void 0).pipe(H2,Yn(()=>t.getDownloadURL()),Xn),getMetadata:()=>Me(void 0).pipe(H2,Yn(()=>t.getMetadata()),Xn),delete:()=>Kt(t.delete()),child:e=>vI(t.child(e)),updateMetadata:e=>Kt(t.updateMetadata(e)),put:(e,n)=>kB(t.put(e,n)),putString:(e,n,r)=>kB(t.putString(e,n,r)),list:e=>Kt(t.list(e)),listAll:()=>Kt(t.listAll())}}!function moe(t){const e={TaskState:Di,TaskEvent:Ose,StringFormat:_s,Storage:MB,Reference:Ua};t.INTERNAL.registerComponent(new mo.wA("storage-compat",goe,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage-compat","0.3.3")}(ms.Z);const yoe=new de("angularfire2.storageBucket"),voe=new de("angularfire2.storage.maxUploadRetryTime"),Eoe=new de("angularfire2.storage.maxOperationRetryTime"),Ioe=new de("angularfire2.storage.use-emulator");let woe=(()=>{class t{storage;constructor(n,r,i,s,o,a,u,l,d,f){const m=Xg(n,o,r);this.storage=hI(`${m.name}.storage.${i}`,"AngularFireStorage",m.name,()=>{const _=o.runOutsideAngular(()=>m.storage(i||void 0)),v=d;return v&&_.useEmulator(...v),u&&_.setMaxUploadRetryTime(u),l&&_.setMaxOperationRetryTime(l),_},[u,l])}ref(n){return vI(this.storage.ref(n))}refFromURL(n){return vI(this.storage.refFromURL(n))}upload(n,r,i){return vI(this.storage.ref(n)).put(r,i)}static \u0275fac=function(r){return new(r||t)(Y(Oh),Y(Lh,8),Y(yoe,8),Y(oo),Y(Et),Y(dI),Y(voe,8),Y(Eoe,8),Y(Ioe,8),Y(cI,8))};static \u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),Toe=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=Er({type:t});static \u0275inj=ar({})}return t})(),Coe=(()=>{class t{constructor(){ms.Z.registerVersion("angularfire",Mh.full,"gcs-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Er({type:t});static \u0275inj=ar({providers:[woe],imports:[Toe]})}return t})();function eb(){return U((t,e)=>{let n,r=!1;t.subscribe(ce(e,i=>{const s=n;n=i,r&&e.next([s,i]),r=!0}))})}function OB(t,e=tr){return t=t??Soe,U((n,r)=>{let i,s=!0;n.subscribe(ce(r,o=>{const a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function Soe(t,e){return t===e}var ge,ys=xe(879),Doe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},yo={},tb=tb||{},Xe=Doe||self;function EI(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function im(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var nb="closure_uid_"+(1e9*Math.random()>>>0),boe=0;function Roe(t,e,n){return t.call.apply(t.bind,arguments)}function Poe(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function si(t,e,n){return(si=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Roe:Poe).apply(null,arguments)}function II(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Sr(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function ku(){this.s=this.s,this.o=this.o}ku.prototype.s=!1,ku.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function Aoe(t){Object.prototype.hasOwnProperty.call(t,nb)&&t[nb]||(t[nb]=++boe)}(this)},ku.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const LB=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function rb(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function FB(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(EI(r)){const i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function oi(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}oi.prototype.h=function(){this.defaultPrevented=!0};var Moe=function(){if(!Xe.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const n=()=>{};Xe.addEventListener("test",n,e),Xe.removeEventListener("test",n,e)}catch{}return t}();function sm(t){return/^[\s\xa0]*$/.test(t)}function wI(){var t=Xe.navigator;return t&&(t=t.userAgent)?t:""}function Qo(t){return-1!=wI().indexOf(t)}function ib(t){return ib[" "](t),t}ib[" "]=function(){};var ob,t,koe=Qo("Opera"),jh=Qo("Trident")||Qo("MSIE"),VB=Qo("Edge"),sb=VB||jh,UB=Qo("Gecko")&&!(-1!=wI().toLowerCase().indexOf("webkit")&&!Qo("Edge"))&&!(Qo("Trident")||Qo("MSIE"))&&!Qo("Edge"),Ooe=-1!=wI().toLowerCase().indexOf("webkit")&&!Qo("Edge");function BB(){var t=Xe.document;return t?t.documentMode:void 0}e:{var ab="",ub=(t=wI(),UB?/rv:([^\);]+)(\)|;)/.exec(t):VB?/Edge\/([\d\.]+)/.exec(t):jh?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):Ooe?/WebKit\/(\S+)/.exec(t):koe?/(?:Version)[ \/]?(\S+)/.exec(t):void 0);if(ub&&(ab=ub?ub[1]:""),jh){var lb=BB();if(null!=lb&&lb>parseFloat(ab)){ob=String(lb);break e}}ob=ab}var Loe=Xe.document&&jh&&(BB()||parseInt(ob,10))||void 0;function om(t,e){if(oi.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(UB){e:{try{ib(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Foe[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&om.$.h.call(this)}}Sr(om,oi);var Foe={2:"touch",3:"pen",4:"mouse"};om.prototype.h=function(){om.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var am="closure_listenable_"+(1e6*Math.random()|0),Voe=0;function Uoe(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++Voe,this.fa=this.ia=!1}function TI(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function db(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function $B(t){const e={};for(const n in t)e[n]=t[n];return e}const HB="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function zB(t,e){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)t[n]=r[n];for(let s=0;s<HB.length;s++)n=HB[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function CI(t){this.src=t,this.g={},this.h=0}function hb(t,e){var n=e.type;if(n in t.g){var s,r=t.g[n],i=LB(r,e);(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(TI(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function fb(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}CI.prototype.add=function(t,e,n,r,i){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=fb(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new Uoe(e,this.src,s,!!r,i)).ia=n,t.push(e)),e};var pb="closure_lm_"+(1e6*Math.random()|0),gb={};function WB(t,e,n,r,i){if(r&&r.once)return GB(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)WB(t,e[s],n,r,i);return null}return n=vb(n),t&&t[am]?t.O(e,n,im(r)?!!r.capture:!!r,i):qB(t,e,n,!1,r,i)}function qB(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=im(i)?!!i.capture:!!i,a=_b(t);if(a||(t[pb]=a=new CI(t)),(n=a.add(e,n,r,o,s)).proxy)return n;if(r=function joe(){const e=$oe;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Moe||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(ZB(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function GB(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)GB(t,e[s],n,r,i);return null}return n=vb(n),t&&t[am]?t.P(e,n,im(r)?!!r.capture:!!r,i):qB(t,e,n,!0,r,i)}function KB(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)KB(t,e[s],n,r,i);else r=im(r)?!!r.capture:!!r,n=vb(n),t&&t[am]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=fb(s=t.g[e],n,r,i))&&(TI(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=_b(t))&&(e=t.g[e.toString()],t=-1,e&&(t=fb(e,n,r,i)),(n=-1<t?e[t]:null)&&mb(n))}function mb(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[am])hb(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(ZB(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=_b(e))?(hb(n,t),0==n.h&&(n.src=null,e[pb]=null)):TI(t)}}}function ZB(t){return t in gb?gb[t]:gb[t]="on"+t}function $oe(t,e){if(t.fa)t=!0;else{e=new om(e,this);var n=t.listener,r=t.la||t.src;t.ia&&mb(t),t=n.call(r,e)}return t}function _b(t){return(t=t[pb])instanceof CI?t:null}var yb="__closure_events_fn_"+(1e9*Math.random()>>>0);function vb(t){return"function"==typeof t?t:(t[yb]||(t[yb]=function(e){return t.handleEvent(e)}),t[yb])}function Dr(){ku.call(this),this.i=new CI(this),this.S=this,this.J=null}function Hr(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,"string"==typeof e)e=new oi(e,t);else if(e instanceof oi)e.target=e.target||t;else{var i=e;zB(e=new oi(r,t),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=SI(o,r,!0,e)&&i}if(i=SI(o=e.g=t,r,!0,e)&&i,i=SI(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)i=SI(o=e.g=n[s],r,!1,e)&&i}function SI(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,u=o.la||o.src;o.ia&&hb(t.i,o),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}Sr(Dr,ku),Dr.prototype[am]=!0,Dr.prototype.removeEventListener=function(t,e,n,r){KB(this,t,e,n,r)},Dr.prototype.N=function(){if(Dr.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)TI(n[r]);delete t.g[e],t.h--}}this.J=null},Dr.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Dr.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var Eb=Xe.JSON.stringify;function zoe(){var t=Ib;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var QB=new class Hoe{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new qoe,t=>t.reset());class qoe{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function Goe(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function Koe(t){Xe.setTimeout(()=>{throw t},0)}let um,lm=!1,Ib=new class Woe{constructor(){this.h=this.g=null}add(e,n){const r=QB.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},YB=()=>{const t=Xe.Promise.resolve(void 0);um=()=>{t.then(Zoe)}};var Zoe=()=>{for(var t;t=zoe();){try{t.h.call(t.g)}catch(n){Koe(n)}var e=QB;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}lm=!1};function DI(t,e){Dr.call(this),this.h=t||1,this.g=e||Xe,this.j=si(this.qb,this),this.l=Date.now()}function wb(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function Tb(t,e,n){if("function"==typeof t)n&&(t=si(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=si(t.handleEvent,t)}return 2147483647<Number(e)?-1:Xe.setTimeout(t,e||0)}function XB(t){t.g=Tb(()=>{t.g=null,t.i&&(t.i=!1,XB(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}Sr(DI,Dr),(ge=DI.prototype).ga=!1,ge.T=null,ge.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Hr(this,"tick"),this.ga&&(wb(this),this.start()))}},ge.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},ge.N=function(){DI.$.N.call(this),wb(this),delete this.g};class Qoe extends ku{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:XB(this)}N(){super.N(),this.g&&(Xe.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function cm(t){ku.call(this),this.h=t,this.g={}}Sr(cm,ku);var JB=[];function ej(t,e,n,r){Array.isArray(n)||(n&&(JB[0]=n.toString()),n=JB);for(var i=0;i<n.length;i++){var s=WB(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function tj(t){db(t.g,function(e,n){this.g.hasOwnProperty(n)&&mb(e)},t),t.g={}}function AI(){this.g=!0}function $h(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function eae(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return Eb(n)}catch{return e}}(t,n)+(r?" "+r:"")})}cm.prototype.N=function(){cm.$.N.call(this),tj(this)},cm.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},AI.prototype.Ea=function(){this.g=!1},AI.prototype.info=function(){};var pc={},nj=null;function bI(){return nj=nj||new Dr}function rj(t){oi.call(this,pc.Ta,t)}function dm(t){const e=bI();Hr(e,new rj(e))}function ij(t,e){oi.call(this,pc.STAT_EVENT,t),this.stat=e}function Ai(t){const e=bI();Hr(e,new ij(e,t))}function sj(t,e){oi.call(this,pc.Ua,t),this.size=e}function hm(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Xe.setTimeout(function(){t()},e)}pc.Ta="serverreachability",Sr(rj,oi),pc.STAT_EVENT="statevent",Sr(ij,oi),pc.Ua="timingevent",Sr(sj,oi);var RI={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},oj={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Cb(){}function uj(){}Cb.prototype.h=null;var Ab,fm={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Sb(){oi.call(this,"d")}function Db(){oi.call(this,"c")}function PI(){}function pm(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new cm(this),this.P=tae,this.V=new DI(t=sb?125:void 0),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new lj}function lj(){this.i=null,this.g="",this.h=!1}Sr(Sb,oi),Sr(Db,oi),Sr(PI,Cb),PI.prototype.g=function(){return new XMLHttpRequest},PI.prototype.i=function(){return{}},Ab=new PI;var tae=45e3,cj={},bb={};function Rb(t,e,n){t.L=1,t.A=kI(Ba(e)),t.u=n,t.S=!0,dj(t,null)}function dj(t,e){t.G=Date.now(),gm(t),t.B=Ba(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),Ij(n.i,"t",r),t.o=0,n=t.l.J,t.h=new lj,t.g=Wj(t.l,n?e:null,!t.u),0<t.O&&(t.M=new Qoe(si(t.Pa,t,t.g),t.O)),ej(t.U,t.g,"readystatechange",t.nb),e=t.I?$B(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),dm(),function Yoe(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var l=a[u].split("=");if(1<l.length){var d=l[0];l=l[1];var f=d.split("_");o=2<=f.length&&"type"==f[1]?o+(d+"=")+l+"&":o+(d+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o})}(t.j,t.v,t.B,t.m,t.W,t.u)}function hj(t){return!!t.g&&"GET"==t.v&&2!=t.L&&t.l.Ha}function fj(t,e,n){let i,r=!0;for(;!t.J&&t.o<n.length;){if(i=nae(t,n),i==bb){4==e&&(t.s=4,Ai(14),r=!1),$h(t.j,t.m,null,"[Incomplete Response]");break}if(i==cj){t.s=4,Ai(15),$h(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}$h(t.j,t.m,i,null),Pb(t,i)}hj(t)&&0!=t.o&&(t.h.g=t.h.g.slice(t.o),t.o=0),4!=e||0!=n.length||t.h.h||(t.s=1,Ai(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Fb(e),e.M=!0,Ai(11))):($h(t.j,t.m,n,"[Invalid Chunked Response]"),gc(t),mm(t))}function nae(t,e){var n=t.o,r=e.indexOf("\n",n);return-1==r?bb:(n=Number(e.substring(n,r)),isNaN(n)?cj:(r+=1)+n>e.length?bb:(e=e.slice(r,r+n),t.o=r+n,e))}function gm(t){t.Y=Date.now()+t.P,pj(t,t.P)}function pj(t,e){if(null!=t.C)throw Error("WatchDog timer not null");t.C=hm(si(t.lb,t),e)}function NI(t){t.C&&(Xe.clearTimeout(t.C),t.C=null)}function mm(t){0==t.l.H||t.J||jj(t.l,t)}function gc(t){NI(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,wb(t.V),tj(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Pb(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||Nb(n.i,t)))if(!t.K&&Nb(n.i,t)&&3==n.H){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break e;BI(n),VI(n)}Lb(n),Ai(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=hm(si(n.ib,n),6e3));if(1>=Cj(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else _c(n,11)}else if((t.K||n.g==t)&&BI(n),!sm(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(n.V=l[0],l=l[1],2==n.H)if("c"==l[0]){n.K=l[1],n.pa=l[2];const d=l[3];null!=d&&(n.ra=d,n.l.info("VER="+n.ra));const f=l[4];null!=f&&(n.Ga=f,n.l.info("SVER="+n.Ga));const m=l[5];null!=m&&"number"==typeof m&&0<m&&(n.L=r=1.5*m,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const _=t.g;if(_){const v=_.g?_.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(v){var s=r.i;s.g||-1==v.indexOf("spdy")&&-1==v.indexOf("quic")&&-1==v.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Mb(s,s.h),s.h=null))}if(r.F){const T=_.g?_.g.getResponseHeader("X-HTTP-Session-Id"):null;T&&(r.Da=T,gn(r.I,r.F,T))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=t;if((r=n).wa=zj(r,r.J?r.pa:null,r.Y),o.K){Sj(r.i,o);var a=o,u=r.L;u&&a.setTimeout(u),a.C&&(NI(a),gm(a)),r.g=o}else Uj(r);0<n.j.length&&UI(n)}else"stop"!=l[0]&&"close"!=l[0]||_c(n,7);else 3==n.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?_c(n,7):Ob(n):"noop"!=l[0]&&n.h&&n.h.Aa(l),n.A=0)}dm()}catch{}}function gj(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(EI(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function iae(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(EI(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}(t),r=function rae(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(EI(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}(ge=pm.prototype).setTimeout=function(t){this.P=t},ge.nb=function(t){t=t.target;const e=this.M;e&&3==Yo(t)?e.l():this.Pa(t)},ge.Pa=function(t){try{if(t==this.g)e:{const d=Yo(this.g);var e=this.g.Ia();if(this.g.da(),!(3>d)&&(3!=d||sb||this.g&&(this.h.h||this.g.ja()||xj(this.g)))){this.J||4!=d||7==e||dm(),NI(this);var n=this.g.da();this.ca=n;t:if(hj(this)){var r=xj(this.g);t="";var i=r.length,s=4==Yo(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){gc(this),mm(this);var o="";break t}this.h.i=new Xe.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function Xoe(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+s+" "+o})}(this.j,this.v,this.B,this.m,this.W,d,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!sm(a)){var l=a;break t}}l=null}if(!(n=l)){this.i=!1,this.s=3,Ai(12),gc(this),mm(this);break e}$h(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Pb(this,n)}this.S?(fj(this,d,o),sb&&this.i&&3==d&&(ej(this.U,this.V,"tick",this.mb),this.V.start())):($h(this.j,this.m,o,null),Pb(this,o)),4==d&&gc(this),this.i&&!this.J&&(4==d?jj(this.l,this):(this.i=!1,gm(this)))}else(function wae(t){const e={};t=(t.g&&2<=Yo(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<t.length;r++){if(sm(t[r]))continue;var n=Goe(t[r]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}!function Boe(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,function(r){return r.join(", ")})})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Ai(12)):(this.s=0,Ai(13)),gc(this),mm(this)}}}catch{}},ge.mb=function(){if(this.g){var t=Yo(this.g),e=this.g.ja();this.o<e.length&&(NI(this),fj(this,t,e),this.i&&4!=t&&gm(this))}},ge.cancel=function(){this.J=!0,gc(this)},ge.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(function Joe(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.j,this.B),2!=this.L&&(dm(),Ai(17)),gc(this),this.s=2,mm(this)):pj(this,this.Y-t)};var mj=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function mc(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof mc){this.h=t.h,MI(this,t.j),this.s=t.s,this.g=t.g,xI(this,t.m),this.l=t.l;var e=t.i,n=new vm;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),_j(this,n),this.o=t.o}else t&&(e=String(t).match(mj))?(this.h=!1,MI(this,e[1]||"",!0),this.s=_m(e[2]||""),this.g=_m(e[3]||"",!0),xI(this,e[4]),this.l=_m(e[5]||"",!0),_j(this,e[6]||"",!0),this.o=_m(e[7]||"")):(this.h=!1,this.i=new vm(null,this.h))}function Ba(t){return new mc(t)}function MI(t,e,n){t.j=n?_m(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function xI(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function _j(t,e,n){e instanceof vm?(t.i=e,function dae(t,e){e&&!t.j&&(Ou(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(vj(this,r),Ij(this,i,n))},t)),t.j=e}(t.i,t.h)):(n||(e=ym(e,lae)),t.i=new vm(e,t.h))}function gn(t,e,n){t.i.set(e,n)}function kI(t){return gn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function _m(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ym(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,oae),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function oae(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}mc.prototype.toString=function(){var t=[],e=this.j;e&&t.push(ym(e,yj,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(ym(e,yj,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(ym(n,"/"==n.charAt(0)?uae:aae,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",ym(n,cae)),t.join("")};var yj=/[#\/\?@]/g,aae=/[#\?:]/g,uae=/[#\?]/g,lae=/[#\?@]/g,cae=/#/g;function vm(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ou(t){t.g||(t.g=new Map,t.h=0,t.i&&function sae(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function vj(t,e){Ou(t),e=Hh(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Ej(t,e){return Ou(t),e=Hh(t,e),t.g.has(e)}function Ij(t,e,n){vj(t,e),0<n.length&&(t.i=null,t.g.set(Hh(t,e),rb(n)),t.h+=n.length)}function Hh(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(ge=vm.prototype).add=function(t,e){Ou(this),this.i=null,t=Hh(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},ge.forEach=function(t,e){Ou(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)},ge.ta=function(){Ou(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n},ge.Z=function(t){Ou(this);let e=[];if("string"==typeof t)Ej(this,t)&&(e=e.concat(this.g.get(Hh(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},ge.set=function(t,e){return Ou(this),this.i=null,Ej(this,t=Hh(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},ge.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},ge.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};var hae=class{constructor(t,e){this.g=t,this.map=e}};function wj(t){this.l=t||fae,t=Xe.PerformanceNavigationTiming?0<(t=Xe.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Xe.g&&Xe.g.Ka&&Xe.g.Ka()&&Xe.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var fae=10;function Tj(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Cj(t){return t.h?1:t.g?t.g.size:0}function Nb(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Mb(t,e){t.g?t.g.add(e):t.h=e}function Sj(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Dj(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return rb(t.i)}wj.prototype.cancel=function(){if(this.i=Dj(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var pae=class{stringify(t){return Xe.JSON.stringify(t,void 0)}parse(t){return Xe.JSON.parse(t,void 0)}};function gae(){this.g=new pae}function mae(t,e,n){const r=n||"";try{gj(t,function(i,s){let o=i;im(i)&&(o=Eb(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function OI(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Em(t){this.l=t.ec||null,this.j=t.ob||!1}function LI(t,e){Dr.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=xb,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Sr(Em,Cb),Em.prototype.g=function(){return new LI(this.l,this.j)},Em.prototype.i=function(t){return function(){return t}}({}),Sr(LI,Dr);var xb=0;function Aj(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function Im(t){t.readyState=4,t.l=null,t.j=null,t.A=null,wm(t)}function wm(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(ge=LI.prototype).open=function(t,e){if(this.readyState!=xb)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,wm(this)},ge.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Xe).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},ge.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Im(this)),this.readyState=xb},ge.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,wm(this)),this.g&&(this.readyState=3,wm(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Xe.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Aj(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},ge.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Im(this):wm(this),3==this.readyState&&Aj(this)}},ge.Za=function(t){this.g&&(this.response=this.responseText=t,Im(this))},ge.Ya=function(t){this.g&&(this.response=t,Im(this))},ge.ka=function(){this.g&&Im(this)},ge.setRequestHeader=function(t,e){this.v.append(t,e)},ge.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},ge.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(LI.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var yae=Xe.JSON.parse;function $n(t){Dr.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=bj,this.L=this.M=!1}Sr($n,Dr);var bj="",vae=/^https?$/i,Eae=["POST","PUT"];function Rj(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Pj(t),FI(t)}function Pj(t){t.F||(t.F=!0,Hr(t,"complete"),Hr(t,"error"))}function Nj(t){if(t.h&&typeof tb<"u"&&(!t.C[1]||4!=Yo(t)||2!=t.da()))if(t.v&&4==Yo(t))Tb(t.La,0,t);else if(Hr(t,"readystatechange"),4==Yo(t)){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=0===o){var i=String(t.I).match(mj)[1]||null;!i&&Xe.self&&Xe.self.location&&(i=Xe.self.location.protocol.slice(0,-1)),r=!vae.test(i?i.toLowerCase():"")}n=r}if(n)Hr(t,"complete"),Hr(t,"success");else{t.m=6;try{var s=2<Yo(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",Pj(t)}}finally{FI(t)}}}function FI(t,e){if(t.g){Mj(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Hr(t,"ready");try{n.onreadystatechange=r}catch{}}}function Mj(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Xe.clearTimeout(t.A),t.A=null)}function Yo(t){return t.g?t.g.readyState:0}function xj(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case bj:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function kj(t){let e="";return db(t,function(n,r){e+=r,e+=":",e+=n,e+="\r\n"}),e}function kb(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=kj(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):gn(t,e,n))}function Tm(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Oj(t){this.Ga=0,this.j=[],this.l=new AI,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Tm("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Tm("baseRetryDelayMs",5e3,t),this.hb=Tm("retryDelaySeedMs",1e4,t),this.eb=Tm("forwardChannelMaxRetries",2,t),this.xa=Tm("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new wj(t&&t.concurrentRequestLimit),this.Ja=new gae,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Ob(t){if(Lj(t),3==t.H){var e=t.W++,n=Ba(t.I);if(gn(n,"SID",t.K),gn(n,"RID",e),gn(n,"TYPE","terminate"),Cm(t,n),(e=new pm(t,t.l,e)).L=2,e.A=kI(Ba(n)),n=!1,Xe.navigator&&Xe.navigator.sendBeacon)try{n=Xe.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&Xe.Image&&((new Image).src=e.A,n=!0),n||(e.g=Wj(e.l,null),e.g.ha(e.A)),e.G=Date.now(),gm(e)}Hj(t)}function VI(t){t.g&&(Fb(t),t.g.cancel(),t.g=null)}function Lj(t){VI(t),t.u&&(Xe.clearTimeout(t.u),t.u=null),BI(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Xe.clearTimeout(t.m),t.m=null)}function UI(t){if(!Tj(t.i)&&!t.m){t.m=!0;var e=t.Na;um||YB(),lm||(um(),lm=!0),Ib.add(e,t),t.C=0}}function Fj(t,e){var n;n=e?e.m:t.W++;const r=Ba(t.I);gn(r,"SID",t.K),gn(r,"RID",n),gn(r,"AID",t.V),Cm(t,r),t.o&&t.s&&kb(r,t.o,t.s),n=new pm(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=Vj(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Mb(t.i,n),Rb(n,r,e)}function Cm(t,e){t.na&&db(t.na,function(n,r){gn(e,r,n)}),t.h&&gj({},function(n,r){gn(e,r,n)})}function Vj(t,e,n){n=Math.min(t.j.length,n);var r=t.h?si(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){const o=["count="+n];-1==s?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let u=0;u<n;u++){let l=i[u].g;const d=i[u].map;if(l-=s,0>l)s=Math.max(0,i[u].g-100),a=!1;else try{mae(d,o,"req"+l+"_")}catch{r&&r(d)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function Uj(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;um||YB(),lm||(um(),lm=!0),Ib.add(e,t),t.A=0}}function Lb(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=hm(si(t.Ma,t),$j(t,t.A)),t.A++,0))}function Fb(t){null!=t.B&&(Xe.clearTimeout(t.B),t.B=null)}function Bj(t){t.g=new pm(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=Ba(t.wa);gn(e,"RID","rpc"),gn(e,"SID",t.K),gn(e,"AID",t.V),gn(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&gn(e,"TO",t.qa),gn(e,"TYPE","xmlhttp"),Cm(t,e),t.o&&t.s&&kb(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=kI(Ba(e)),n.u=null,n.S=!0,dj(n,t)}function BI(t){null!=t.v&&(Xe.clearTimeout(t.v),t.v=null)}function jj(t,e){var n=null;if(t.g==e){BI(t),Fb(t),t.g=null;var r=2}else{if(!Nb(t.i,e))return;n=e.F,Sj(t.i,e),r=1}if(0!=t.H)if(e.i)if(1==r){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;Hr(r=bI(),new sj(r,n)),UI(t)}else Uj(t);else if(3==(i=e.s)||0==i&&0<e.ca||!(1==r&&function Tae(t,e){return!(Cj(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=hm(si(t.Na,t,e),$j(t,t.C)),t.C++,0)))}(t,e)||2==r&&Lb(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:_c(t,5);break;case 4:_c(t,10);break;case 3:_c(t,6);break;default:_c(t,2)}}function $j(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function _c(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var r=si(t.pb,t);n||(n=new mc("//www.google.com/images/cleardot.gif"),Xe.location&&"http"==Xe.location.protocol||MI(n,"https"),kI(n)),function _ae(t,e){const n=new AI;if(Xe.Image){const r=new Image;r.onload=II(OI,n,r,"TestLoadImage: loaded",!0,e),r.onerror=II(OI,n,r,"TestLoadImage: error",!1,e),r.onabort=II(OI,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=II(OI,n,r,"TestLoadImage: timeout",!1,e),Xe.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Ai(2);t.H=0,t.h&&t.h.za(e),Hj(t),Lj(t)}function Hj(t){if(t.H=0,t.ma=[],t.h){const e=Dj(t.i);(0!=e.length||0!=t.j.length)&&(FB(t.ma,e),FB(t.ma,t.j),t.i.i.length=0,rb(t.j),t.j.length=0),t.h.ya()}}function zj(t,e,n){var r=n instanceof mc?Ba(n):new mc(n);if(""!=r.g)e&&(r.g=e+"."+r.g),xI(r,r.m);else{var i=Xe.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new mc(null);r&&MI(s,r),e&&(s.g=e),i&&xI(s,i),n&&(s.l=n),r=s}return e=t.Da,(n=t.F)&&e&&gn(r,n,e),gn(r,"VER",t.ra),Cm(t,r),r}function Wj(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new $n(t.Ha&&!t.va?new Em({ob:n}):t.va)).Oa(t.J),e}function qj(){}function jI(){if(jh&&!(10<=Number(Loe)))throw Error("Environmental error: no available transport.")}function vs(t,e){Dr.call(this),this.g=new Oj(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!sm(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!sm(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new zh(this)}function Gj(t){Sb.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Kj(){Db.call(this),this.status=1}function zh(t){this.g=t}function vo(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Vb(t,e,n){n||(n=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;var s=t.g[3],o=(e=t.g[0])+(s^(n=t.g[1])&((i=t.g[2])^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}function Ht(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=0|t[i];r&&s==e||(n[i]=s,r=!1)}this.g=n}(ge=$n.prototype).Oa=function(t){this.M=t},ge.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Ab.g(),this.C=function aj(t){return t.h||(t.h=t.i())}(this.u?this.u:Ab),this.g.onreadystatechange=si(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){return void Rj(this,s)}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const s of r.keys())n.set(s,r.get(s))}r=Array.from(n.keys()).find(s=>"content-type"==s.toLowerCase()),i=Xe.FormData&&t instanceof Xe.FormData,!(0<=LB(Eae,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Mj(this),0<this.B&&((this.L=function Iae(t){return jh&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=si(this.ua,this)):this.A=Tb(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){Rj(this,s)}},ge.ua=function(){typeof tb<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Hr(this,"timeout"),this.abort(8))},ge.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Hr(this,"complete"),Hr(this,"abort"),FI(this))},ge.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),FI(this,!0)),$n.$.N.call(this)},ge.La=function(){this.s||(this.G||this.v||this.l?Nj(this):this.kb())},ge.kb=function(){Nj(this)},ge.isActive=function(){return!!this.g},ge.da=function(){try{return 2<Yo(this)?this.g.status:-1}catch{return-1}},ge.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},ge.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),yae(e)}},ge.Ia=function(){return this.m},ge.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(ge=Oj.prototype).ra=8,ge.H=1,ge.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new pm(this,this.l,t);let s=this.s;if(this.U&&(s?(s=$B(s),zB(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=n;break e}if(4096===e||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=Vj(this,i,e),gn(n=Ba(this.I),"RID",t),gn(n,"CVER",22),this.F&&gn(n,"X-HTTP-Session-Id",this.F),Cm(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(kj(s)))+"&"+e:this.o&&kb(n,this.o,s)),Mb(this.i,i),this.bb&&gn(n,"TYPE","init"),this.P?(gn(n,"$req",e),gn(n,"SID","null"),i.aa=!0,Rb(i,n,null)):Rb(i,n,e),this.H=2}}else 3==this.H&&(t?Fj(this,t):0==this.j.length||Tj(this.i)||Fj(this))},ge.Ma=function(){if(this.u=null,Bj(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=hm(si(this.jb,this),t)}},ge.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Ai(10),VI(this),Bj(this))},ge.ib=function(){null!=this.v&&(this.v=null,VI(this),Lb(this),Ai(19))},ge.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Ai(2)):(this.l.info("Failed to ping google.com"),Ai(1))},ge.isActive=function(){return!!this.h&&this.h.isActive(this)},(ge=qj.prototype).Ba=function(){},ge.Aa=function(){},ge.za=function(){},ge.ya=function(){},ge.isActive=function(){return!0},ge.Va=function(){},jI.prototype.g=function(t,e){return new vs(t,e)},Sr(vs,Dr),vs.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Ai(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=zj(t,null,t.Y),UI(t)},vs.prototype.close=function(){Ob(this.g)},vs.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=Eb(t),t=n);e.j.push(new hae(e.fb++,t)),3==e.H&&UI(e)},vs.prototype.N=function(){this.g.h=null,delete this.j,Ob(this.g),delete this.g,vs.$.N.call(this)},Sr(Gj,Sb),Sr(Kj,Db),Sr(zh,qj),zh.prototype.Ba=function(){Hr(this.g,"a")},zh.prototype.Aa=function(t){Hr(this.g,new Gj(t))},zh.prototype.za=function(t){Hr(this.g,new Kj)},zh.prototype.ya=function(){Hr(this.g,"b")},Sr(vo,function Cae(){this.blockSize=-1}),vo.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},vo.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=n;)Vb(this,t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){Vb(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){Vb(this,r),i=0;break}}this.h=i,this.i+=e},vo.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};var Sae={};function Ub(t){return-128<=t&&128>t?function xoe(t,e){var n=Sae;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(e){return new Ht([0|e],0>e?-1:0)}):new Ht([0|t],0>t?-1:0)}function Xo(t){if(isNaN(t)||!isFinite(t))return Wh;if(0>t)return zr(Xo(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Bb;return new Ht(e,0)}var Bb=4294967296,Wh=Ub(0),jb=Ub(1),Qj=Ub(16777216);function ja(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function zs(t){return-1==t.h}function zr(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Ht(n,~t.h).add(jb)}function $I(t,e){return t.add(zr(e))}function HI(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Sm(t,e){this.g=t,this.h=e}function zI(t,e){if(ja(e))throw Error("division by zero");if(ja(t))return new Sm(Wh,Wh);if(zs(t))return e=zI(zr(t),e),new Sm(zr(e.g),zr(e.h));if(zs(e))return e=zI(t,zr(e)),new Sm(zr(e.g),e.h);if(30<t.g.length){if(zs(t)||zs(e))throw Error("slowDivide_ only works with positive integers.");for(var n=jb,r=e;0>=r.X(t);)n=Yj(n),r=Yj(r);var i=qh(n,1),s=qh(r,1);for(r=qh(r,2),n=qh(n,2);!ja(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=qh(r,1),n=qh(n,1)}return e=$I(t,i.R(e)),new Sm(i,e)}for(i=Wh;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=Xo(n)).R(e);zs(o)||0<o.X(t);)o=(s=Xo(n-=r)).R(e);ja(s)&&(s=jb),i=i.add(s),t=$I(t,o)}return new Sm(i,t)}function Yj(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Ht(n,t.h)}function qh(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Ht(i,t.h)}(ge=Ht.prototype).ea=function(){if(zs(this))return-zr(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Bb+r)*e,e*=Bb}return t},ge.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(ja(this))return"0";if(zs(this))return"-"+zr(this).toString(t);for(var e=Xo(Math.pow(t,6)),n=this,r="";;){var i=zI(n,e).g,s=((0<(n=$I(n,i.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(ja(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},ge.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},ge.X=function(t){return zs(t=$I(this,t))?-1:ja(t)?0:1},ge.abs=function(){return zs(this)?zr(this):this},ge.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(65535&this.D(i))+(65535&t.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,n[i]=(o&=65535)<<16|(s&=65535)}return new Ht(n,-2147483648&n[n.length-1]?-1:0)},ge.R=function(t){if(ja(this)||ja(t))return Wh;if(zs(this))return zs(t)?zr(this).R(zr(t)):zr(zr(this).R(t));if(zs(t))return zr(this.R(zr(t)));if(0>this.X(Qj)&&0>t.X(Qj))return Xo(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=t.D(i)>>>16,u=65535&t.D(i);n[2*r+2*i]+=o*u,HI(n,2*r+2*i),n[2*r+2*i+1]+=s*u,HI(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,HI(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,HI(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Ht(n,0)},ge.gb=function(t){return zI(this,t).h},ge.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Ht(n,this.h&t.h)},ge.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Ht(n,this.h|t.h)},ge.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Ht(n,this.h^t.h)},jI.prototype.createWebChannel=jI.prototype.g,vs.prototype.send=vs.prototype.u,vs.prototype.open=vs.prototype.m,vs.prototype.close=vs.prototype.close,RI.NO_ERROR=0,RI.TIMEOUT=8,RI.HTTP_ERROR=6,oj.COMPLETE="complete",uj.EventType=fm,fm.OPEN="a",fm.CLOSE="b",fm.ERROR="c",fm.MESSAGE="d",Dr.prototype.listen=Dr.prototype.O,$n.prototype.listenOnce=$n.prototype.P,$n.prototype.getLastError=$n.prototype.Sa,$n.prototype.getLastErrorCode=$n.prototype.Ia,$n.prototype.getStatus=$n.prototype.da,$n.prototype.getResponseJson=$n.prototype.Wa,$n.prototype.getResponseText=$n.prototype.ja,$n.prototype.send=$n.prototype.ha,$n.prototype.setWithCredentials=$n.prototype.Oa,vo.prototype.digest=vo.prototype.l,vo.prototype.reset=vo.prototype.reset,vo.prototype.update=vo.prototype.j,Ht.prototype.add=Ht.prototype.add,Ht.prototype.multiply=Ht.prototype.R,Ht.prototype.modulo=Ht.prototype.gb,Ht.prototype.compare=Ht.prototype.X,Ht.prototype.toNumber=Ht.prototype.ea,Ht.prototype.toString=Ht.prototype.toString,Ht.prototype.getBits=Ht.prototype.D,Ht.fromNumber=Xo,Ht.fromString=function Zj(t,e){if(0==t.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==t.charAt(0))return zr(Zj(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Xo(Math.pow(e,8)),r=Wh,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Xo(Math.pow(e,s)),r=r.R(s).add(Xo(o))):r=(r=r.R(n)).add(Xo(o))}return r};var Dae=yo.createWebChannelTransport=function(){return new jI},Aae=yo.getStatEventTarget=function(){return bI()},$b=yo.ErrorCode=RI,bae=yo.EventType=oj,Rae=yo.Event=pc,Xj=yo.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},WI=(yo.FetchXmlHttpFactory=Em,yo.WebChannel=uj),Pae=yo.XhrIo=$n,Nae=yo.Md5=vo,Gh=yo.Integer=Ht;const Jj="@firebase/firestore";class Ar{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ar.UNAUTHENTICATED=new Ar(null),Ar.GOOGLE_CREDENTIALS=new Ar("google-credentials-uid"),Ar.FIRST_PARTY=new Ar("first-party-uid"),Ar.MOCK_USER=new Ar("mock-user");let Kh="10.7.0";const Lu=new ys.Yd("@firebase/firestore");function Zh(){return Lu.logLevel}function re(t,...e){if(Lu.logLevel<=ys.in.DEBUG){const n=e.map(Hb);Lu.debug(`Firestore (${Kh}): ${t}`,...n)}}function Jn(t,...e){if(Lu.logLevel<=ys.in.ERROR){const n=e.map(Hb);Lu.error(`Firestore (${Kh}): ${t}`,...n)}}function Wi(t,...e){if(Lu.logLevel<=ys.in.WARN){const n=e.map(Hb);Lu.warn(`Firestore (${Kh}): ${t}`,...n)}}function Hb(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch{return t}}function Ee(t="Unexpected state"){const e=`FIRESTORE (${Kh}) INTERNAL ASSERTION FAILED: `+t;throw Jn(e),new Error(e)}function De(t,e){t||Ee()}function fe(t,e){return t}const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class te extends S.ZR{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class mr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}class e${constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class kae{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ar.UNAUTHENTICATED))}shutdown(){}}class Oae{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Lae{constructor(e){this.t=e,this.currentUser=Ar.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){var r=this;let i=this.i;const s=l=>this.i!==i?(i=this.i,n(l)):Promise.resolve();let o=new mr;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new mr,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=o;e.enqueueRetryable((0,Z.Z)(function*(){yield l.promise,yield s(r.currentUser)}))},u=l=>{re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>u(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?u(l):(re("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new mr)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(De("string"==typeof r.accessToken),new e$(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return De(null===e||"string"==typeof e),new Ar(e)}}class Fae{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Ar.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Vae{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new Fae(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ar.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class t${constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Uae{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=s=>{null!=s.error&&re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,re("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(De("string"==typeof n.token),this.R=n.token,new t$(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Bae(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class n${static newId(){const n=62*Math.floor(256/62);let r="";for(;r.length<20;){const i=Bae(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return r}}function Ze(t,e){return t<e?-1:t>e?1:0}function Qh(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function r$(t){return t+"\0"}class Tn{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new te(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new te(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new te(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new te(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Tn.fromMillis(Date.now())}static fromDate(e){return Tn.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Tn(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ze(this.nanoseconds,e.nanoseconds):Ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class be{constructor(e){this.timestamp=e}static fromTimestamp(e){return new be(e)}static min(){return new be(new Tn(0,0))}static max(){return new be(new Tn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Dm{constructor(e,n,r){void 0===n?n=0:n>e.length&&Ee(),void 0===r?r=e.length-n:r>e.length-n&&Ee(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return 0===Dm.comparator(this,e)}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Dm?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class St extends Dm{construct(e,n,r){return new St(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new te(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new St(n)}static emptyPath(){return new St([])}}const jae=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class mn extends Dm{construct(e,n,r){return new mn(e,n,r)}static isValidIdentifier(e){return jae.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),mn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new mn(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(0===r.length)throw new te(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if("\\"===a){if(i+1===e.length)throw new te(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new te(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===a?(o=!o,i++):"."!==a||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new te(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new mn(n)}static emptyPath(){return new mn([])}}class pe{constructor(e){this.path=e}static fromPath(e){return new pe(St.fromString(e))}static fromName(e){return new pe(St.fromString(e).popFirst(5))}static empty(){return new pe(St.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===St.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,n){return St.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new pe(new St(e.slice()))}}class Yh{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function zb(t){return t.fields.find(e=>2===e.kind)}function yc(t){return t.fields.filter(e=>2!==e.kind)}Yh.UNKNOWN_ID=-1;class vc{constructor(e,n){this.fieldPath=e,this.kind=n}}class Xh{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Xh(0,Es.min())}}function i$(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=be.fromTimestamp(1e9===r?new Tn(n+1,0):new Tn(n,r));return new Es(i,pe.empty(),e)}function s$(t){return new Es(t.readTime,t.key,-1)}class Es{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Es(be.min(),pe.empty(),-1)}static max(){return new Es(be.max(),pe.empty(),-1)}}function Wb(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=pe.comparator(t.documentKey,e.documentKey),0!==n?n:Ze(t.largestBatchId,e.largestBatchId))}const o$="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class a${constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Fu(t){return qb.apply(this,arguments)}function qb(){return qb=(0,Z.Z)(function*(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==o$)throw t;re("LocalStore","Unexpectedly lost primary lease")}),qb.apply(this,arguments)}class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ee(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new F((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof F?n:F.resolve(n)}catch(n){return F.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):F.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):F.reject(n)}static resolve(e){return new F((n,r)=>{n(e)})}static reject(e){return new F((n,r)=>{r(e)})}static waitFor(e){return new F((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=F.resolve(!1);for(const r of e)n=n.next(i=>i?F.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new F((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let u=0;u<s;u++){const l=u;n(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new F((r,i)=>{const s=()=>{!0===e()?n().next(()=>{s()},i):r()};s()})}}class qI{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new mr,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Am(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=Gb(r.target.error);this.V.reject(new Am(e,i))}}static open(e,n,r,i){try{return new qI(n,e.transaction(i,r))}catch(s){throw new Am(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(re("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const n=this.transaction.objectStore(e);return new Wae(n)}}class Eo{constructor(e,n,r){this.name=e,this.version=n,this.p=r,12.2===Eo.S((0,S.z$)())&&Jn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return re("SimpleDb","Removing database:",e),Ec(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,S.hl)())return!1;if(Eo.C())return!0;const e=(0,S.z$)(),n=Eo.S(e),r=0<n&&n<10,i=Eo.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.F)}static M(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){var n=this;return(0,Z.Z)(function*(){return n.db||(re("SimpleDb","Opening database:",n.name),n.db=yield new Promise((r,i)=>{const s=indexedDB.open(n.name,n.version);s.onsuccess=o=>{r(o.target.result)},s.onblocked=()=>{i(new Am(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const a=o.target.error;i("VersionError"===a.name?new te(z.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===a.name?new te(z.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a):new Am(e,a))},s.onupgradeneeded=o=>{re("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',o.oldVersion),n.p.N(o.target.result,s.transaction,o.oldVersion,n.version).next(()=>{re("SimpleDb","Database upgrade to version "+n.version+" complete")})}})),n.B&&(n.db.onversionchange=r=>n.B(r)),n.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){var s=this;return(0,Z.Z)(function*(){const o="readonly"===n;let a=0;for(;;){++a;try{s.db=yield s.O(e);const u=qI.open(s.db,e,o?"readonly":"readwrite",r),l=i(u).next(d=>(u.g(),d)).catch(d=>(u.abort(d),F.reject(d))).toPromise();return l.catch(()=>{}),yield u.m,l}catch(u){const l=u,d="FirebaseError"!==l.name&&a<3;if(re("SimpleDb","Transaction failed with error:",l.message,"Retrying:",d),s.close(),!d)return Promise.reject(l)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class zae{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return Ec(this.k.delete())}}class Am extends te{constructor(e,n){super(z.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Vu(t){return"IndexedDbTransactionError"===t.name}class Wae{constructor(e){this.store=e}put(e,n){let r;return void 0!==n?(re("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(re("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ec(r)}add(e){return re("SimpleDb","ADD",this.store.name,e,e),Ec(this.store.add(e))}get(e){return Ec(this.store.get(e)).next(n=>(void 0===n&&(n=null),re("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return re("SimpleDb","DELETE",this.store.name,e),Ec(this.store.delete(e))}count(){return re("SimpleDb","COUNT",this.store.name),Ec(this.store.count())}W(e,n){const r=this.options(e,n);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),s=[];return this.G(i,(o,a)=>{s.push(a)}).next(()=>s)}{const i=this.store.getAll(r.range);return new F((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}}j(e,n){const r=this.store.getAll(e,null===n?void 0:n);return new F((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){re("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.J=!1;const i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.G(i,n)}Z(e){const n=this.cursor({});return new F((r,i)=>{n.onerror=s=>{const o=Gb(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){const r=[];return new F((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const u=new zae(a),l=n(a.primaryKey,a.value,u);if(l instanceof F){const d=l.catch(f=>(u.done(),F.reject(f)));r.push(d)}u.isDone?i():null===u.$?a.continue():a.continue(u.$)}}).next(()=>F.waitFor(r))}options(e,n){let r;return void 0!==e&&("string"==typeof e?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Ec(t){return new F((e,n)=>{t.onsuccess=r=>{e(r.target.result)},t.onerror=r=>{const i=Gb(r.target.error);n(i)}})}let u$=!1;function Gb(t){const e=Eo.S((0,S.z$)());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new te("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return u$||(u$=!0,setTimeout(()=>{throw r},0)),r}}return t}class qae{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ee(e){var n=this;re("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,Z.Z)(function*(){n.task=null;try{re("IndexBackiller",`Documents written: ${yield n.X.te()}`)}catch(r){Vu(r)?re("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield Fu(r)}yield n.ee(6e4)}))}}class Gae{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){var n=this;return(0,Z.Z)(function*(){return n.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>n.ne(r,e))})()}ne(e,n){const r=new Set;let i=n,s=!0;return F.doWhile(()=>!0===s&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(null!==o&&!r.has(o))return re("IndexBackiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(re("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=s$(s);Wb(o,r)>0&&(r=o)}),new Es(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}let Is=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){const n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function bm(t){return null==t}function Rm(t){return 0===t&&1/t==-1/0}function l$(t){return"number"==typeof t&&Number.isInteger(t)&&!Rm(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function ai(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=c$(e)),e=Kae(t.get(n),e);return c$(e)}function Kae(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=s}}return n}function c$(t){return t+"\x01\x01"}function Jo(t){const e=t.length;if(De(e>=2),2===e)return De("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),St.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("\x01",s);switch((o<0||o>n)&&Ee(),t.charAt(o+1)){case"\x01":const a=t.substring(s,o);let u;0===i.length?u=a:(i+=a,u=i,i=""),r.push(u);break;case"\x10":i+=t.substring(s,o),i+="\0";break;case"\x11":i+=t.substring(s,o+1);break;default:Ee()}s=o+2}return new St(r)}const d$=["userId","batchId"];function GI(t,e){return[t,ai(e)]}function h$(t,e,n){return[t,ai(e),n]}const Zae={},Qae=["prefixPath","collectionGroup","readTime","documentId"],Yae=["prefixPath","collectionGroup","documentId"],Xae=["collectionGroup","readTime","prefixPath","documentId"],Jae=["canonicalId","targetId"],eue=["targetId","path"],tue=["path","targetId"],nue=["collectionId","parent"],rue=["indexId","uid"],iue=["uid","sequenceNumber"],sue=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],oue=["indexId","uid","orderedDocumentKey"],aue=["userId","collectionPath","documentId"],uue=["userId","collectionPath","largestBatchId"],lue=["userId","collectionGroup","largestBatchId"],f$=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],cue=[...f$,"documentOverlays"],p$=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],g$=p$,due=[...g$,"indexConfiguration","indexState","indexEntries"];class Kb extends a${constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}}function br(t,e){const n=fe(t);return Eo.M(n.ae,e)}function m$(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Uu(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function _$(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class dn{constructor(e,n){this.comparator=e,this.root=n||Wr.EMPTY}insert(e,n){return new dn(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Wr.BLACK,null,null))}remove(e){return new dn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new KI(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new KI(this.root,e,this.comparator,!1)}getReverseIterator(){return new KI(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new KI(this.root,e,this.comparator,!0)}}class KI{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Wr{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Wr.RED,this.left=i??Wr.EMPTY,this.right=s??Wr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Wr(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):0===s?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Wr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return Wr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Wr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Wr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ee();const e=this.left.check();if(e!==this.right.check())throw Ee();return e+(this.isRed()?0:1)}}Wr.EMPTY=null,Wr.RED=!0,Wr.BLACK=!1,Wr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ee()}get value(){throw Ee()}get color(){throw Ee()}get left(){throw Ee()}get right(){throw Ee()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Wr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Qt{constructor(e){this.comparator=e,this.data=new dn(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=void 0!==n?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new y$(this.data.getIterator())}getIteratorFrom(e){return new y$(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Qt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Qt(this.comparator);return n.data=e,n}}class y${constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Jh(t){return t.hasNext()?t.getNext():void 0}class qi{constructor(e){this.fields=e,e.sort(mn.comparator)}static empty(){return new qi([])}unionWith(e){let n=new Qt(mn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new qi(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Qh(this.fields,e.fields,(n,r)=>n.isEqual(r))}}class v$ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class _r{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new v$("Invalid base64 string: "+s):s}}(e);return new _r(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new _r(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_r.EMPTY_BYTE_STRING=new _r("");const fue=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bu(t){if(De(!!t),"string"==typeof t){let e=0;const n=fue.exec(t);if(De(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Hn(t.seconds),nanos:Hn(t.nanos)}}function Hn(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function $a(t){return"string"==typeof t?_r.fromBase64String(t):_r.fromUint8Array(t)}function ZI(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=t?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function QI(t){const e=t.mapValue.fields.__previous_value__;return ZI(e)?QI(e):e}function Pm(t){const e=Bu(t.mapValue.fields.__local_write_time__.timestampValue);return new Tn(e.seconds,e.nanos)}class pue{constructor(e,n,r,i,s,o,a,u,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=l}}class ju{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new ju("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof ju&&e.projectId===this.projectId&&e.database===this.database}}const $u={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},YI={nullValue:"NULL_VALUE"};function Hu(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ZI(t)?4:T$(t)?9007199254740991:10:Ee()}function ea(t,e){if(t===e)return!0;const n=Hu(t);if(n!==Hu(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Pm(t).isEqual(Pm(e));case 3:return function(i,s){if("string"==typeof i.timestampValue&&"string"==typeof s.timestampValue&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Bu(i.timestampValue),a=Bu(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return s=e,$a(t.bytesValue).isEqual($a(s.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Hn(i.geoPointValue.latitude)===Hn(s.geoPointValue.latitude)&&Hn(i.geoPointValue.longitude)===Hn(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Hn(i.integerValue)===Hn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Hn(i.doubleValue),a=Hn(s.doubleValue);return o===a?Rm(o)===Rm(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Qh(t.arrayValue.values||[],e.arrayValue.values||[],ea);case 10:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(m$(o)!==m$(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(void 0===a[u]||!ea(o[u],a[u])))return!1;return!0}(t,e);default:return Ee()}var s}function Nm(t,e){return void 0!==(t.values||[]).find(n=>ea(n,e))}function zu(t,e){if(t===e)return 0;const n=Hu(t),r=Hu(e);if(n!==r)return Ze(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ze(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Hn(s.integerValue||s.doubleValue),u=Hn(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return E$(t.timestampValue,e.timestampValue);case 4:return E$(Pm(t),Pm(e));case 5:return Ze(t.stringValue,e.stringValue);case 6:return function(s,o){const a=$a(s),u=$a(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),u=o.split("/");for(let l=0;l<a.length&&l<u.length;l++){const d=Ze(a[l],u[l]);if(0!==d)return d}return Ze(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ze(Hn(s.latitude),Hn(o.latitude));return 0!==a?a:Ze(Hn(s.longitude),Hn(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],u=o.values||[];for(let l=0;l<a.length&&l<u.length;++l){const d=zu(a[l],u[l]);if(d)return d}return Ze(a.length,u.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===$u.mapValue&&o===$u.mapValue)return 0;if(s===$u.mapValue)return 1;if(o===$u.mapValue)return-1;const a=s.fields||{},u=Object.keys(a),l=o.fields||{},d=Object.keys(l);u.sort(),d.sort();for(let f=0;f<u.length&&f<d.length;++f){const m=Ze(u[f],d[f]);if(0!==m)return m;const _=zu(a[u[f]],l[d[f]]);if(0!==_)return _}return Ze(u.length,d.length)}(t.mapValue,e.mapValue);default:throw Ee()}}function E$(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ze(t,e);const n=Bu(t),r=Bu(e),i=Ze(n.seconds,r.seconds);return 0!==i?i:Ze(n.nanos,r.nanos)}function ef(t){return Zb(t)}function Zb(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Bu(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?$a(t.bytesValue).toBase64():"referenceValue"in t?pe.fromName(t.referenceValue).toString():"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Zb(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Zb(n.fields[o])}`;return i+"}"}(t.mapValue):Ee()}function Ic(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Qb(t){return!!t&&"integerValue"in t}function Mm(t){return!!t&&"arrayValue"in t}function I$(t){return!!t&&"nullValue"in t}function w$(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function JI(t){return!!t&&"mapValue"in t}function xm(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Uu(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=xm(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=xm(t.arrayValue.values[n]);return e}return Object.assign({},t)}function T$(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}function gue(t){return"nullValue"in t?YI:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Ic(ju.empty(),pe.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:Ee()}function mue(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Ic(ju.empty(),pe.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?$u:Ee()}function C$(t,e){const n=zu(t.value,e.value);return 0!==n?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function S$(t,e){const n=zu(t.value,e.value);return 0!==n?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}class qr{constructor(e){this.value=e}static empty(){return new qr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!JI(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=xm(n)}setAll(e){let n=mn.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=xm(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());JI(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ea(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];JI(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Uu(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new qr(xm(this.value))}}function D$(t){const e=[];return Uu(t.fields,(n,r)=>{const i=new mn([n]);if(JI(r)){const s=D$(r.mapValue).fields;if(0===s.length)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new qi(e)}class _n{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new _n(e,0,be.min(),be.min(),be.min(),qr.empty(),0)}static newFoundDocument(e,n,r,i){return new _n(e,1,n,be.min(),r,i,0)}static newNoDocument(e,n){return new _n(e,2,n,be.min(),be.min(),qr.empty(),0)}static newUnknownDocument(e,n){return new _n(e,3,n,be.min(),be.min(),qr.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(be.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=be.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof _n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new _n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Wu{constructor(e,n){this.position=e,this.inclusive=n}}function A$(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(r=s.field.isKeyField()?pe.comparator(pe.fromName(o.referenceValue),n.key):zu(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function b$(t,e){if(null===t)return null===e;if(null===e||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ea(t.position[n],e.position[n]))return!1;return!0}class km{constructor(e,n="asc"){this.field=e,this.dir=n}}function _ue(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class R${}class It extends R${constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?"in"===n||"not-in"===n?this.createKeyFieldInFilter(e,n,r):new yue(e,n,r):"array-contains"===n?new Iue(e,r):"in"===n?new O$(e,r):"not-in"===n?new wue(e,r):"array-contains-any"===n?new Tue(e,r):new It(e,n,r)}static createKeyFieldInFilter(e,n,r){return"in"===n?new vue(e,r):new Eue(e,r)}matches(e){const n=e.data.field(this.field);return"!="===this.op?null!==n&&this.matchesComparison(zu(n,this.value)):null!==n&&Hu(this.value)===Hu(n)&&this.matchesComparison(zu(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Ee()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zt extends R${constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new zt(e,n)}matches(e){return tf(this)?void 0===this.filters.find(n=>!n.matches(e)):void 0!==this.filters.find(n=>n.matches(e))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function tf(t){return"and"===t.op}function Yb(t){return"or"===t.op}function Xb(t){return P$(t)&&tf(t)}function P$(t){for(const e of t.filters)if(e instanceof zt)return!1;return!0}function Jb(t){if(t instanceof It)return t.field.canonicalString()+t.op.toString()+ef(t.value);if(Xb(t))return t.filters.map(e=>Jb(e)).join(",");{const e=t.filters.map(n=>Jb(n)).join(",");return`${t.op}(${e})`}}function N$(t,e){return t instanceof It?(r=t,(i=e)instanceof It&&r.op===i.op&&r.field.isEqual(i.field)&&ea(r.value,i.value)):t instanceof zt?function(r,i){return i instanceof zt&&r.op===i.op&&r.filters.length===i.filters.length&&r.filters.reduce((s,o,a)=>s&&N$(o,i.filters[a]),!0)}(t,e):void Ee();var r,i}function M$(t,e){const n=t.filters.concat(e);return zt.create(n,t.op)}function x$(t){return t instanceof It?`${(n=t).field.canonicalString()} ${n.op} ${ef(n.value)}`:t instanceof zt?function(n){return n.op.toString()+" {"+n.getFilters().map(x$).join(" ,")+"}"}(t):"Filter";var n}class yue extends It{constructor(e,n,r){super(e,n,r),this.key=pe.fromName(r.referenceValue)}matches(e){const n=pe.comparator(e.key,this.key);return this.matchesComparison(n)}}class vue extends It{constructor(e,n){super(e,"in",n),this.keys=k$(0,n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Eue extends It{constructor(e,n){super(e,"not-in",n),this.keys=k$(0,n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function k$(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(r=>pe.fromName(r.referenceValue))}class Iue extends It{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Mm(n)&&Nm(n.arrayValue,this.value)}}class O$ extends It{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return null!==n&&Nm(this.value.arrayValue,n)}}class wue extends It{constructor(e,n){super(e,"not-in",n)}matches(e){if(Nm(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return null!==n&&!Nm(this.value.arrayValue,n)}}class Tue extends It{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Mm(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Nm(this.value.arrayValue,r))}}class Cue{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}}function eR(t,e=null,n=[],r=[],i=null,s=null,o=null){return new Cue(t,e,n,r,i,s,o)}function wc(t){const e=fe(t);if(null===e.ce){let n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Jb(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),bm(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ef(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ef(r)).join(",")),e.ce=n}return e.ce}function Om(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!_ue(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!N$(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!b$(t.startAt,e.startAt)&&b$(t.endAt,e.endAt)}function ew(t){return pe.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}function tw(t,e){return t.filters.filter(n=>n instanceof It&&n.field.isEqual(e))}function L$(t,e,n){let r=YI,i=!0;for(const s of tw(t,e)){let o=YI,a=!0;switch(s.op){case"<":case"<=":o=gue(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=YI}C$({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(null!==n)for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];C$({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}return{value:r,inclusive:i}}function F$(t,e,n){let r=$u,i=!0;for(const s of tw(t,e)){let o=$u,a=!0;switch(s.op){case">=":case">":o=mue(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=$u}S$({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(null!==n)for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];S$({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}return{value:r,inclusive:i}}class Ha{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.le=null,this.he=null,this.Pe=null}}function V$(t,e,n,r,i,s,o,a){return new Ha(t,e,n,r,i,s,o,a)}function nf(t){return new Ha(t)}function U$(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function tR(t){return null!==t.collectionGroup}function rf(t){const e=fe(t);if(null===e.le){e.le=[];const n=new Set;for(const s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Qt(mn.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new km(s,r))}),n.has(mn.keyField().canonicalString())||e.le.push(new km(mn.keyField(),r))}return e.le}function bi(t){const e=fe(t);return e.he||(e.he=function B$(t,e){if("F"===t.limitType)return eR(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>new km(i.field,"desc"===i.dir?"asc":"desc"));const n=t.endAt?new Wu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Wu(t.startAt.position,t.startAt.inclusive):null;return eR(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}(e,rf(t))),e.he}function nR(t,e){const n=t.filters.concat([e]);return new Ha(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function nw(t,e,n){return new Ha(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Lm(t,e){return Om(bi(t),bi(e))&&t.limitType===e.limitType}function j$(t){return`${wc(bi(t))}|lt:${t.limitType}`}function sf(t){return`Query(target=${function(n){let r=n.path.canonicalString();return null!==n.collectionGroup&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>x$(i)).join(", ")}]`),bm(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>{return`${(o=i).field.canonicalString()} (${o.dir})`;var o}).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>ef(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>ef(i)).join(",")),`Target(${r})`}(bi(t))}; limitType=${t.limitType})`}function Fm(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return null!==r.collectionGroup?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):pe.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of rf(r))if(!s.field.isKeyField()&&null===i.data.field(s.field))return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&(i=e,!((r=t).startAt&&!function(o,a,u){const l=A$(o,a,u);return o.inclusive?l<=0:l<0}(r.startAt,rf(r),i)||r.endAt&&!function(o,a,u){const l=A$(o,a,u);return o.inclusive?l>=0:l>0}(r.endAt,rf(r),i)));var r,i}function $$(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function H$(t){return(e,n)=>{let r=!1;for(const i of rf(t)){const s=Sue(i,e,n);if(0!==s)return s;r=r||i.field.isKeyField()}return 0}}function Sue(t,e,n){const r=t.field.isKeyField()?pe.comparator(e.key,n.key):function(s,o,a){const u=o.data.field(s),l=a.data.field(s);return null!==u&&null!==l?zu(u,l):Ee()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ee()}}class za{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r)for(const[i,s]of r)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Uu(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return _$(this.inner)}size(){return this.innerSize}}const Due=new dn(pe.comparator);function Gi(){return Due}const z$=new dn(pe.comparator);function Vm(...t){let e=z$;for(const n of t)e=e.insert(n.key,n);return e}function W$(t){let e=z$;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ta(){return Um()}function q$(){return Um()}function Um(){return new za(t=>t.toString(),(t,e)=>t.isEqual(e))}const Aue=new dn(pe.comparator),bue=new Qt(pe.comparator);function rt(...t){let e=bue;for(const n of t)e=e.add(n);return e}const Rue=new Qt(Ze);function rR(){return Rue}function G$(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Rm(e)?"-0":e}}function K$(t){return{integerValue:""+t}}function Z$(t,e){return l$(e)?K$(e):G$(t,e)}class rw{constructor(){this._=void 0}}function Pue(t,e,n){return t instanceof af?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&ZI(s)&&(s=QI(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Tc?Y$(t,e):t instanceof Cc?X$(t,e):function(i,s){const o=Q$(i,s),a=J$(o)+J$(i.Ie);return Qb(o)&&Qb(i.Ie)?K$(a):G$(i.serializer,a)}(t,e)}function Nue(t,e,n){return t instanceof Tc?Y$(t,e):t instanceof Cc?X$(t,e):n}function Q$(t,e){return t instanceof uf?Qb(r=e)||(s=r)&&"doubleValue"in s?e:{integerValue:0}:null;var r,s}class af extends rw{}class Tc extends rw{constructor(e){super(),this.elements=e}}function Y$(t,e){const n=eH(e);for(const r of t.elements)n.some(i=>ea(i,r))||n.push(r);return{arrayValue:{values:n}}}class Cc extends rw{constructor(e){super(),this.elements=e}}function X$(t,e){let n=eH(e);for(const r of t.elements)n=n.filter(i=>!ea(i,r));return{arrayValue:{values:n}}}class uf extends rw{constructor(e,n){super(),this.serializer=e,this.Ie=n}}function J$(t){return Hn(t.integerValue||t.doubleValue)}function eH(t){return Mm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Bm{constructor(e,n){this.field=e,this.transform=n}}class xue{constructor(e,n){this.version=e,this.transformResults=n}}class Cn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Cn}static exists(e){return new Cn(void 0,e)}static updateTime(e){return new Cn(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function iw(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class sw{}function tH(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new cf(t.key,Cn.none()):new lf(t.key,t.data,Cn.none());{const n=t.data,r=qr.empty();let i=new Qt(mn.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);null===o&&s.length>1&&(s=s.popLast(),o=n.field(s)),null===o?r.delete(s):r.set(s,o),i=i.add(s)}return new Wa(t.key,r,new qi(i.toArray()),Cn.none())}}function kue(t,e,n){t instanceof lf?function(i,s,o){const a=i.value.clone(),u=iH(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Wa?function(i,s,o){if(!iw(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=iH(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(rH(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):e.convertToNoDocument(n.version).setHasCommittedMutations()}function jm(t,e,n,r){return t instanceof lf?function(s,o,a,u){if(!iw(s.precondition,o))return a;const l=s.value.clone(),d=sH(s.fieldTransforms,u,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof Wa?function(s,o,a,u){if(!iw(s.precondition,o))return a;const l=sH(s.fieldTransforms,u,o),d=o.data;return d.setAll(rH(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null===a?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,n,r):(a=n,iw(t.precondition,o=e)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a);var o,a}function Oue(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=Q$(r.transform,i||null);null!=s&&(null===n&&(n=qr.empty()),n.set(r.field,s))}return n||null}function nH(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(r=t.fieldTransforms)&&void 0===i||r&&i&&Qh(r,i,(s,o)=>function Mue(t,e){return t.field.isEqual(e.field)&&(i=e.transform,(r=t.transform)instanceof Tc&&i instanceof Tc||r instanceof Cc&&i instanceof Cc?Qh(r.elements,i.elements,ea):r instanceof uf&&i instanceof uf?ea(r.Ie,i.Ie):r instanceof af&&i instanceof af);var r,i}(s,o))))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask));var r,i}class lf extends sw{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Wa extends sw{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function rH(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function iH(t,e,n){const r=new Map;De(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,Nue(o,a,n[i]))}return r}function sH(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,Pue(s,o,e))}return r}class cf extends sw{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class iR extends sw{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class sR{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&kue(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=jm(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=jm(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=q$();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const u=tH(o,a);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(be.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),rt())}isEqual(e){return this.batchId===e.batchId&&Qh(this.mutations,e.mutations,(n,r)=>nH(n,r))&&Qh(this.baseMutations,e.baseMutations,(n,r)=>nH(n,r))}}class oR{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){De(e.mutations.length===r.length);let i=Aue;const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new oR(e,n,r,i)}}class aR{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Fue{constructor(e,n){this.count=e,this.unchangedNames=n}}var sr,Dt;function oH(t){switch(t){default:return Ee();case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0}}function aH(t){if(void 0===t)return Jn("GRPC error has no .code"),z.UNKNOWN;switch(t){case sr.OK:return z.OK;case sr.CANCELLED:return z.CANCELLED;case sr.UNKNOWN:return z.UNKNOWN;case sr.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case sr.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case sr.INTERNAL:return z.INTERNAL;case sr.UNAVAILABLE:return z.UNAVAILABLE;case sr.UNAUTHENTICATED:return z.UNAUTHENTICATED;case sr.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case sr.NOT_FOUND:return z.NOT_FOUND;case sr.ALREADY_EXISTS:return z.ALREADY_EXISTS;case sr.PERMISSION_DENIED:return z.PERMISSION_DENIED;case sr.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case sr.ABORTED:return z.ABORTED;case sr.OUT_OF_RANGE:return z.OUT_OF_RANGE;case sr.UNIMPLEMENTED:return z.UNIMPLEMENTED;case sr.DATA_LOSS:return z.DATA_LOSS;default:return Ee()}}(Dt=sr||(sr={}))[Dt.OK=0]="OK",Dt[Dt.CANCELLED=1]="CANCELLED",Dt[Dt.UNKNOWN=2]="UNKNOWN",Dt[Dt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Dt[Dt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Dt[Dt.NOT_FOUND=5]="NOT_FOUND",Dt[Dt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Dt[Dt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Dt[Dt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Dt[Dt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Dt[Dt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Dt[Dt.ABORTED=10]="ABORTED",Dt[Dt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Dt[Dt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Dt[Dt.INTERNAL=13]="INTERNAL",Dt[Dt.UNAVAILABLE=14]="UNAVAILABLE",Dt[Dt.DATA_LOSS=15]="DATA_LOSS";function uH(){return new TextEncoder}const Vue=new Gh([4294967295,4294967295],0);function lH(t){const e=uH().encode(t),n=new Nae;return n.update(e),new Uint8Array(n.digest())}function cH(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Gh([n,r],0),new Gh([i,s],0)]}class uR{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new $m(`Invalid padding: ${n}`);if(r<0)throw new $m(`Invalid hash count: ${r}`);if(e.length>0&&0===this.hashCount)throw new $m(`Invalid hash count: ${r}`);if(0===e.length&&0!==n)throw new $m(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Gh.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Gh.fromNumber(r)));return 1===i.compare(Vue)&&(i=new Gh([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const n=lH(e),[r,i]=cH(n);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new uR(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(0===this.Te)return;const n=lH(e),[r,i]=cH(n);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);this.Re(o)}}Re(e){const n=Math.floor(e/8);this.bitmap[n]|=1<<e%8}}class $m extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Hm{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,zm.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Hm(be.min(),i,new dn(Ze),Gi(),rt())}}class zm{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new zm(r,n,rt(),rt(),rt())}}class aw{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}}class dH{constructor(e,n){this.targetId=e,this.fe=n}}class hH{constructor(e,n,r=_r.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class fH{constructor(){this.ge=0,this.pe=gH(),this.ye=_r.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=rt(),n=rt(),r=rt();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Ee()}}),new zm(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=gH()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,De(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class Uue{constructor(e){this.Le=e,this.ke=new Map,this.qe=Gi(),this.Qe=pH(),this.Ke=new dn(Ze)}$e(e){for(const n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(const n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{const r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:Ee()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){const n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){const s=i.target;if(ew(s))if(0===r){const o=new pe(s.path);this.We(n,o,_n.newNoDocument(o,be.min()))}else De(1===r);else{const o=this.Ze(n);if(o!==r){const a=this.Xe(e),u=a?this.et(a,e,o):1;0!==u&&(this.He(n),this.Ke=this.Ke.insert(n,2===u?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Xe(e){const n=e.fe.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=$a(r).toUint8Array()}catch(u){if(u instanceof v$)return Wi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new uR(o,i,s)}catch(u){return Wi(u instanceof $m?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return 0===a.Te?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){const n=new Map;this.ke.forEach((s,o)=>{const a=this.Ye(o);if(a){if(s.current&&ew(a.target)){const u=new pe(a.target.path);null!==this.qe.get(u)||this.st(o,u)||this.We(o,u,_n.newNoDocument(u,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=rt();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{const l=this.Ye(u);return!l||"TargetPurposeLimboResolution"===l.purpose||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));const i=new Hm(e,n,this.Ke,this.qe,r);return this.qe=Gi(),this.Qe=pH(),this.Ke=new dn(Ze),i}Ue(e,n){if(!this.je(e))return;const r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new fH,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Qt(Ze),this.Qe=this.Qe.insert(e,n)),n}je(e){const n=null!==this.Ye(e);return n||re("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){const n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new fH),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function pH(){return new dn(pe.comparator)}function gH(){return new dn(pe.comparator)}const Bue={asc:"ASCENDING",desc:"DESCENDING"},jue={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$ue={and:"AND",or:"OR"};class Hue{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function lR(t,e){return t.useProto3Json||bm(e)?e:{value:e}}function df(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function mH(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function zue(t,e){return df(t,e.toTimestamp())}function er(t){return De(!!t),be.fromTimestamp(function(n){const r=Bu(n);return new Tn(r.seconds,r.nanos)}(t))}function cR(t,e){return(r=t,new St(["projects",r.projectId,"databases",r.database])).child("documents").child(e).canonicalString();var r}function _H(t){const e=St.fromString(t);return De(DH(e)),e}function Wm(t,e){return cR(t.databaseId,e.path)}function na(t,e){const n=_H(e);if(n.get(1)!==t.databaseId.projectId)throw new te(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new te(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new pe(vH(n))}function dR(t,e){return cR(t.databaseId,e)}function yH(t){const e=_H(t);return 4===e.length?St.emptyPath():vH(e)}function qm(t){return new St(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function vH(t){return De(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function EH(t,e,n){return{name:Wm(t,e),fields:n.value.mapValue.fields}}function IH(t,e,n){const r=na(t,e.name),i=er(e.updateTime),s=e.createTime?er(e.createTime):be.min(),o=new qr({mapValue:{fields:e.fields}}),a=_n.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function Gm(t,e){let n;if(e instanceof lf)n={update:EH(t,e.key,e.value)};else if(e instanceof cf)n={delete:Wm(t,e.key)};else if(e instanceof Wa)n={update:EH(t,e.key,e.data),updateMask:Xue(e.fieldMask)};else{if(!(e instanceof iR))return Ee();n={verify:Wm(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof af)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Tc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Cc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof uf)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw Ee()}(0,r))),e.precondition.isNone||(n.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:zue(t,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:Ee()),n;var s}function hR(t,e){const n=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?Cn.updateTime(er(s.updateTime)):void 0!==s.exists?Cn.exists(s.exists):Cn.none():Cn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;"setToServerValue"in a?(De("REQUEST_TIME"===a.setToServerValue),u=new af):"appendMissingElements"in a?u=new Tc(a.appendMissingElements.values||[]):"removeAllFromArray"in a?u=new Cc(a.removeAllFromArray.values||[]):"increment"in a?u=new uf(o,a.increment):Ee();const l=mn.fromServerFormat(a.fieldPath);return new Bm(l,u)}(t,i)):[];var s;if(e.update){const i=na(t,e.update.name),s=new qr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=new qi((e.updateMask.fieldPaths||[]).map(d=>mn.fromServerFormat(d)));return new Wa(i,s,o,n,r)}return new lf(i,s,n,r)}if(e.delete){const i=na(t,e.delete);return new cf(i,n)}if(e.verify){const i=na(t,e.verify);return new iR(i,n)}return Ee()}function wH(t,e){return{documents:[dR(t,e.path)]}}function fR(t,e){const n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=dR(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=dR(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(u){if(0!==u.length)return SH(zt.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const s=function(u){if(0!==u.length)return u.map(l=>{return{field:qu((f=l).field),direction:Zue(f.dir)};var f})}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=lR(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(u=e.startAt).inclusive,values:u.position}),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),n;var u}function TH(t){let e=yH(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){De(1===r);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(f){const m=CH(f);return m instanceof zt&&Xb(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(m=>{return new km(hf((v=m).field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction));var v}));let a=null;n.limit&&(a=function(f){let m;return m="object"==typeof f?f.value:f,bm(m)?null:m}(n.limit));let u=null;var f;n.startAt&&(u=new Wu((f=n.startAt).values||[],!!f.before));let l=null;return n.endAt&&(l=function(f){return new Wu(f.values||[],!f.before)}(n.endAt)),V$(e,i,o,s,a,"F",u,l)}function CH(t){return void 0!==t.unaryFilter?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=hf(n.unaryFilter.field);return It.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=hf(n.unaryFilter.field);return It.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=hf(n.unaryFilter.field);return It.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=hf(n.unaryFilter.field);return It.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Ee()}}(t):void 0!==t.fieldFilter?It.create(hf((n=t).fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ee()}}(n.fieldFilter.op),n.fieldFilter.value):void 0!==t.compositeFilter?function(n){return zt.create(n.compositeFilter.filters.map(r=>CH(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ee()}}(n.compositeFilter.op))}(t):Ee();var n}function Zue(t){return Bue[t]}function Que(t){return jue[t]}function Yue(t){return $ue[t]}function qu(t){return{fieldPath:t.canonicalString()}}function hf(t){return mn.fromServerFormat(t.fieldPath)}function SH(t){return t instanceof It?function(n){if("=="===n.op){if(w$(n.value))return{unaryFilter:{field:qu(n.field),op:"IS_NAN"}};if(I$(n.value))return{unaryFilter:{field:qu(n.field),op:"IS_NULL"}}}else if("!="===n.op){if(w$(n.value))return{unaryFilter:{field:qu(n.field),op:"IS_NOT_NAN"}};if(I$(n.value))return{unaryFilter:{field:qu(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qu(n.field),op:Que(n.op),value:n.value}}}(t):t instanceof zt?function(n){const r=n.getFilters().map(i=>SH(i));return 1===r.length?r[0]:{compositeFilter:{op:Yue(n.op),filters:r}}}(t):Ee()}function Xue(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function DH(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class qa{constructor(e,n,r,i,s=be.min(),o=be.min(),a=_r.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new qa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new qa(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new qa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new qa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class AH{constructor(e){this.ut=e}}function bH(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:uw(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:Wm(s=t.ut,(o=e).key),fields:o.data.value.mapValue.fields,updateTime:df(s,o.version.toTimestamp()),createTime:df(s,o.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Sc(e.version)};else{if(!e.isUnknownDocument())return Ee();r.unknownDocument={path:n.path.toArray(),version:Sc(e.version)}}var s,o;return r}function uw(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Sc(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Dc(t){const e=new Tn(t.seconds,t.nanoseconds);return be.fromTimestamp(e)}function Ac(t,e){const n=(e.baseMutations||[]).map(s=>hR(t.ut,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const r=e.mutations.map(s=>hR(t.ut,s)),i=Tn.fromMillis(e.localWriteTimeMs);return new sR(e.batchId,i,n,r)}function Km(t){const e=Dc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?Dc(t.lastLimboFreeSnapshotVersion):be.min();let r;return r=void 0!==t.query.documents?(De(1===(s=t.query).documents.length),bi(nf(yH(s.documents[0])))):function(s){return bi(TH(s))}(t.query),new qa(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,_r.fromBase64String(t.resumeToken));var s}function RH(t,e){const n=Sc(e.snapshotVersion),r=Sc(e.lastLimboFreeSnapshotVersion);let i;i=ew(e.target)?wH(t.ut,e.target):fR(t.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:wc(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function pR(t){const e=TH({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?nw(e,e.limit,"L"):e}function gR(t,e){return new aR(e.largestBatchId,hR(t.ut,e.overlayMutation))}function PH(t,e){const n=e.path.lastSegment();return[t,ai(e.path.popLast()),n]}function NH(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:Sc(r.readTime),documentKey:ai(r.documentKey.path),largestBatchId:r.largestBatchId}}class ele{getBundleMetadata(e,n){return MH(e).get(n).next(r=>{if(r)return{id:(s=r).bundleId,createTime:Dc(s.createTime),version:s.version};var s})}saveBundleMetadata(e,n){return MH(e).put({bundleId:(i=n).id,createTime:Sc(er(i.createTime)),version:i.version});var i}getNamedQuery(e,n){return xH(e).get(n).next(r=>{if(r)return{name:(s=r).name,query:pR(s.bundledQuery),readTime:Dc(s.readTime)};var s})}saveNamedQuery(e,n){return xH(e).put({name:(i=n).name,readTime:Sc(er(i.readTime)),bundledQuery:i.bundledQuery});var i}}function MH(t){return br(t,"bundles")}function xH(t){return br(t,"namedQueries")}class lw{constructor(e,n){this.serializer=e,this.userId=n}static ct(e,n){return new lw(e,n.uid||"")}getOverlay(e,n){return Zm(e).get(PH(this.userId,n)).next(r=>r?gR(this.serializer,r):null)}getOverlays(e,n){const r=ta();return F.forEach(n,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new aR(n,o);i.push(this.lt(e,a))}),F.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(ai(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Zm(e).H("collectionPathOverlayIndex",a))}),F.waitFor(s)}getOverlaysForCollection(e,n,r){const i=ta(),s=ai(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Zm(e).W("collectionPathOverlayIndex",o).next(a=>{for(const u of a){const l=gR(this.serializer,u);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=ta();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Zm(e).Y({index:"collectionGroupOverlayIndex",range:a},(u,l,d)=>{const f=gR(this.serializer,l);s.size()<i||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>s)}lt(e,n){return Zm(e).put(function(i,s,o){const[a,u,l]=PH(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Gm(i.ut,o.mutation)}}(this.serializer,this.userId,n))}}function Zm(t){return br(t,"documentOverlays")}class bc{constructor(){}ht(e,n){this.Pt(e,n),n.It()}Pt(e,n){if("nullValue"in e)this.Tt(n,5);else if("booleanValue"in e)this.Tt(n,10),n.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(n,15),n.Et(Hn(e.integerValue));else if("doubleValue"in e){const r=Hn(e.doubleValue);isNaN(r)?this.Tt(n,13):(this.Tt(n,15),Rm(r)?n.Et(0):n.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(n,20),"string"==typeof r?n.dt(r):(n.dt(`${r.seconds||""}`),n.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,n),this.Rt(n);else if("bytesValue"in e)this.Tt(n,30),n.Vt($a(e.bytesValue)),this.Rt(n);else if("referenceValue"in e)this.ft(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(n,45),n.Et(r.latitude||0),n.Et(r.longitude||0)}else"mapValue"in e?T$(e)?this.Tt(n,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,n),this.Rt(n)):"arrayValue"in e?(this.yt(e.arrayValue,n),this.Rt(n)):Ee()}At(e,n){this.Tt(n,25),this.wt(e,n)}wt(e,n){n.dt(e)}gt(e,n){const r=e.fields||{};this.Tt(n,55);for(const i of Object.keys(r))this.At(i,n),this.Pt(r[i],n)}yt(e,n){const r=e.values||[];this.Tt(n,50);for(const i of r)this.Pt(i,n)}ft(e,n){this.Tt(n,37),pe.fromName(e).path.forEach(r=>{this.Tt(n,60),this.wt(r,n)})}Tt(e,n){e.Et(n)}Rt(e){e.Et(2)}}function tle(t){if(0===t)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function kH(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=tle(255&r[s]);if(i+=o,8!==o)break}return i}(t);return Math.ceil(e/8)}bc.St=new bc;class nle{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Dt(r.value),r=n.next();this.Ct()}vt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(n<"\ud800"||"\udbff"<n)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=n.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\ud800"||"\udbff"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const n=this.Bt(e),r=kH(n);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}kt(e){const n=this.Bt(e),r=kH(n);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=0!=(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Dt(e){const n=255&e;0===n?(this.Qt(0),this.Qt(255)):255===n?(this.Qt(255),this.Qt(0)):this.Qt(n)}Ft(e){const n=255&e;0===n?(this.$t(0),this.$t(255)):255===n?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class rle{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class ile{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class Qm{constructor(){this.Wt=new nle,this.Gt=new rle(this.Wt),this.zt=new ile(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return 0===e?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class Rc{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,n=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Rc(this.indexId,this.documentKey,this.arrayValue,r)}}function Gu(t,e){let n=t.indexId-e.indexId;return 0!==n?n:(n=OH(t.arrayValue,e.arrayValue),0!==n?n:(n=OH(t.directionalValue,e.directionalValue),0!==n?n:pe.comparator(t.documentKey,e.documentKey)))}function OH(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(0!==r)return r}return t.length-e.length}class LH{constructor(e){this.Jt=new Qt((n,r)=>mn.comparator(n.field,r.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const n of e.filters){const r=n;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(De(e.collectionGroup===this.collectionId),this.Xt)return!1;const n=zb(e);if(void 0!==n&&!this.tn(n))return!1;const r=yc(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const a=this.Jt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const u=r[s];if(!this.nn(a,u)||!this.rn(this.Yt[o++],u))return!1}++s}for(;s<r.length;++s)if(o>=this.Yt.length||!this.rn(this.Yt[o++],r[s]))return!1;return!0}sn(){if(this.Xt)return null;let e=new Qt(mn.comparator);const n=[];for(const r of this.Zt)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)n.push(new vc(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new vc(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new vc(r.field,"asc"===r.dir?0:1)));return new Yh(Yh.UNKNOWN_ID,this.collectionId,n,Xh.empty())}tn(e){for(const n of this.Zt)if(this.nn(n,e))return!0;return!1}nn(e,n){return!(void 0===e||!e.field.isEqual(n.fieldPath))&&2===n.kind==("array-contains"===e.op||"array-contains-any"===e.op)}rn(e,n){return!!e.field.isEqual(n.fieldPath)&&(0===n.kind&&"asc"===e.dir||1===n.kind&&"desc"===e.dir)}}function FH(t){var e,n;if(De(t instanceof It||t instanceof zt),t instanceof It){if(t instanceof O$){const i=(null===(n=null===(e=t.value.arrayValue)||void 0===e?void 0:e.values)||void 0===n?void 0:n.map(s=>It.create(t.field,"==",s)))||[];return zt.create(i,"or")}return t}const r=t.filters.map(i=>FH(i));return zt.create(r,t.op)}function sle(t){if(0===t.getFilters().length)return[];const e=yR(FH(t));return De(VH(e)),mR(e)||_R(e)?[e]:e.getFilters()}function mR(t){return t instanceof It}function _R(t){return t instanceof zt&&Xb(t)}function VH(t){return mR(t)||_R(t)||function(n){if(n instanceof zt&&Yb(n)){for(const r of n.getFilters())if(!mR(r)&&!_R(r))return!1;return!0}return!1}(t)}function yR(t){if(De(t instanceof It||t instanceof zt),t instanceof It)return t;if(1===t.filters.length)return yR(t.filters[0]);const e=t.filters.map(r=>yR(r));let n=zt.create(e,t.op);return n=cw(n),VH(n)?n:(De(n instanceof zt),De(tf(n)),De(n.filters.length>1),n.filters.reduce((r,i)=>vR(r,i)))}function vR(t,e){let n;return De(t instanceof It||t instanceof zt),De(e instanceof It||e instanceof zt),n=t instanceof It?e instanceof It?zt.create([t,e],"and"):UH(t,e):e instanceof It?UH(e,t):function(i,s){if(De(i.filters.length>0&&s.filters.length>0),tf(i)&&tf(s))return M$(i,s.getFilters());const o=Yb(i)?i:s,a=Yb(i)?s:i,u=o.filters.map(l=>vR(l,a));return zt.create(u,"or")}(t,e),cw(n)}function UH(t,e){if(tf(e))return M$(e,t.getFilters());{const n=e.filters.map(r=>vR(t,r));return zt.create(n,"or")}}function cw(t){if(De(t instanceof It||t instanceof zt),t instanceof It)return t;const e=t.getFilters();if(1===e.length)return cw(e[0]);if(P$(t))return t;const n=e.map(i=>cw(i)),r=[];return n.forEach(i=>{i instanceof It?r.push(i):i instanceof zt&&(i.op===t.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:zt.create(r,t.op)}class ole{constructor(){this.on=new ER}addToCollectionParentIndex(e,n){return this.on.add(n),F.resolve()}getCollectionParents(e,n){return F.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return F.resolve()}deleteFieldIndex(e,n){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,n){return F.resolve()}getDocumentsMatchingTarget(e,n){return F.resolve(null)}getIndexType(e,n){return F.resolve(0)}getFieldIndexes(e,n){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,n){return F.resolve(Es.min())}getMinOffsetFromCollectionGroup(e,n){return F.resolve(Es.min())}updateCollectionGroup(e,n,r){return F.resolve()}updateIndexEntries(e,n){return F.resolve()}}class ER{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Qt(St.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Qt(St.comparator)).toArray()}}const dw=new Uint8Array(0);class ale{constructor(e,n){this.user=e,this.databaseId=n,this._n=new ER,this.an=new za(r=>wc(r),(r,i)=>Om(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this._n.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this._n.add(n)});const s={collectionId:r,parent:ai(i)};return BH(e).put(s)}return F.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[r$(n),""],!1,!0);return BH(e).W(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Jo(o.parent))}return r})}addFieldIndex(e,n){const r=Ym(e),i={indexId:(a=n).indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])};var a;delete i.indexId;const s=r.add(i);if(n.indexState){const o=pf(e);return s.next(a=>{o.put(NH(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=Ym(e),i=pf(e),s=ff(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Ym(e),r=ff(e),i=pf(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return F.forEach(this.un(n),r=>this.getIndexType(e,r).next(i=>{if(0===i||1===i){const s=new LH(r).sn();if(null!=s)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=ff(e);let i=!0;const s=new Map;return F.forEach(this.un(n),o=>this.cn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=rt();const a=[];return F.forEach(s,(u,l)=>{var L;re("IndexedDbIndexManager",`Using index ${L=u,`id=${L.indexId}|cg=${L.collectionGroup}|f=${L.fields.map(G=>`${G.fieldPath}:${G.kind}`).join(",")}`} to execute ${wc(n)}`);const d=function(L,G){const ae=zb(G);if(void 0===ae)return null;for(const ye of tw(L,ae.fieldPath))switch(ye.op){case"array-contains-any":return ye.value.arrayValue.values||[];case"array-contains":return[ye.value]}return null}(l,u),f=function(L,G){const ae=new Map;for(const ye of yc(G))for(const Qe of tw(L,ye.fieldPath))switch(Qe.op){case"==":case"in":ae.set(ye.fieldPath.canonicalString(),Qe.value);break;case"not-in":case"!=":return ae.set(ye.fieldPath.canonicalString(),Qe.value),Array.from(ae.values())}return null}(l,u),m=function(L,G){const ae=[];let ye=!0;for(const Qe of yc(G)){const Bt=0===Qe.kind?L$(L,Qe.fieldPath,L.startAt):F$(L,Qe.fieldPath,L.startAt);ae.push(Bt.value),ye&&(ye=Bt.inclusive)}return new Wu(ae,ye)}(l,u),_=function(L,G){const ae=[];let ye=!0;for(const Qe of yc(G)){const Bt=0===Qe.kind?F$(L,Qe.fieldPath,L.endAt):L$(L,Qe.fieldPath,L.endAt);ae.push(Bt.value),ye&&(ye=Bt.inclusive)}return new Wu(ae,ye)}(l,u),v=this.ln(u,l,m),T=this.ln(u,l,_),D=this.hn(u,l,f),x=this.Pn(u.indexId,d,v,m.inclusive,T,_.inclusive,D);return F.forEach(x,R=>r.j(R,n.limit).next(L=>{L.forEach(G=>{const ae=pe.fromSegments(G.documentKey);o.has(ae)||(o=o.add(ae),a.push(ae))})}))}).next(()=>a)}return F.resolve(null)})}un(e){let n=this.an.get(e);return n||(n=0===e.filters.length?[e]:sle(zt.create(e.filters,"and")).map(r=>eR(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,n),n)}Pn(e,n,r,i,s,o,a){const u=(null!=n?n.length:1)*Math.max(r.length,s.length),l=u/(null!=n?n.length:1),d=[];for(let f=0;f<u;++f){const m=n?this.In(n[f/l]):dw,_=this.Tn(e,m,r[f%l],i),v=this.En(e,m,s[f%l],o),T=a.map(D=>this.Tn(e,m,D,!0));d.push(...this.createRange(_,v,T))}return d}Tn(e,n,r,i){const s=new Rc(e,pe.empty(),n,r);return i?s:s.Ht()}En(e,n,r,i){const s=new Rc(e,pe.empty(),n,r);return i?s.Ht():s}cn(e,n){const r=new LH(n),i=null!=n.collectionGroup?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.en(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.un(n);return F.forEach(i,s=>this.cn(e,s).next(o=>{o?0!==r&&o.fields.length<function(u){let l=new Qt(mn.comparator),d=!1;for(const f of u.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||("array-contains"===m.op||"array-contains-any"===m.op?d=!0:l=l.add(m.field));for(const f of u.orderBy)f.field.isKeyField()||(l=l.add(f.field));return l.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>null!==n.limit&&i.length>1&&2===r?1:r)}dn(e,n){const r=new Qm;for(const i of yc(e)){const s=n.data.field(i.fieldPath);if(null==s)return null;const o=r.jt(i.kind);bc.St.ht(s,o)}return r.Ut()}In(e){const n=new Qm;return bc.St.ht(e,n.jt(0)),n.Ut()}An(e,n){const r=new Qm;return bc.St.ht(Ic(this.databaseId,n),r.jt(function(s){const o=yc(s);return 0===o.length?0:o[o.length-1].kind}(e))),r.Ut()}hn(e,n,r){if(null===r)return[];let i=[];i.push(new Qm);let s=0;for(const o of yc(e)){const a=r[s++];for(const u of i)if(this.Rn(n,o.fieldPath)&&Mm(a))i=this.Vn(i,o,a);else{const l=u.jt(o.kind);bc.St.ht(a,l)}}return this.mn(i)}ln(e,n,r){return this.hn(e,n,r.position)}mn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Ut();return n}Vn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const u=new Qm;u.seed(a.Ut()),bc.St.ht(o,u.jt(n.kind)),s.push(u)}return s}Rn(e,n){return!!e.filters.find(r=>r instanceof It&&r.field.isEqual(n)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,n){const r=Ym(e),i=pf(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{const o=[];return F.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(d,f){const m=f?new Xh(f.sequenceNumber,new Es(Dc(f.readTime),new pe(Jo(f.documentKey)),f.largestBatchId)):Xh.empty(),_=d.fields.map(([v,T])=>new vc(mn.fromServerFormat(v),T));return new Yh(d.indexId,d.collectionGroup,_,m)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>0===n.length?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==s?s:Ze(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Ym(e),s=pf(e);return this.fn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>F.forEach(a,u=>s.put(NH(u.indexId,this.user,o,r)))))}updateIndexEntries(e,n){const r=new Map;return F.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?F.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),F.forEach(a,u=>this.gn(e,i,u).next(l=>{const d=this.pn(s,u);return l.isEqual(d)?F.resolve():this.yn(e,s,u,l,d)}))))})}wn(e,n,r,i){return ff(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,n.key),documentKey:n.key.path.toArray()})}Sn(e,n,r,i){return ff(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,n.key),n.key.path.toArray()])}gn(e,n,r){const i=ff(e);let s=new Qt(Gu);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,n)])},(o,a)=>{s=s.add(new Rc(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}pn(e,n){let r=new Qt(Gu);const i=this.dn(n,e);if(null==i)return r;const s=zb(n);if(null!=s){const o=e.data.field(s.fieldPath);if(Mm(o))for(const a of o.arrayValue.values||[])r=r.add(new Rc(n.indexId,e.key,this.In(a),i))}else r=r.add(new Rc(n.indexId,e.key,dw,i));return r}yn(e,n,r,i,s){re("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(u,l,d,f,m){const _=u.getIterator(),v=l.getIterator();let T=Jh(_),D=Jh(v);for(;T||D;){let x=!1,R=!1;if(T&&D){const L=d(T,D);L<0?R=!0:L>0&&(x=!0)}else null!=T?R=!0:x=!0;x?(f(D),D=Jh(v)):R?(m(T),T=Jh(_)):(T=Jh(_),D=Jh(v))}}(i,s,Gu,a=>{o.push(this.wn(e,n,r,a))},a=>{o.push(this.Sn(e,n,r,a))}),F.waitFor(o)}fn(e){let n=1;return pf(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Gu(o,a)).filter((o,a,u)=>!a||0!==Gu(o,u[a-1]));const i=[];i.push(e);for(const o of r){const a=Gu(o,e),u=Gu(o,n);if(0===a)i[0]=e.Ht();else if(a>0&&u<0)i.push(o),i.push(o.Ht());else if(u>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.bn(i[o],i[o+1]))return[];s.push(IDBKeyRange.bound([i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,dw,[]],[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,dw,[]]))}return s}bn(e,n){return Gu(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(jH)}getMinOffset(e,n){return F.mapArray(this.un(n),r=>this.cn(e,r).next(i=>i||Ee())).next(jH)}}function BH(t){return br(t,"collectionParents")}function ff(t){return br(t,"indexEntries")}function Ym(t){return br(t,"indexConfiguration")}function pf(t){return br(t,"indexState")}function jH(t){De(0!==t.length);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;Wb(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Es(e.readTime,e.documentKey,n)}const $H={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class ui{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new ui(e,ui.DEFAULT_COLLECTION_PERCENTILE,ui.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function HH(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const u=r.Y({range:o},(d,f,m)=>(a++,m.delete()));s.push(u.next(()=>{De(1===a)}));const l=[];for(const d of n.mutations){const f=h$(e,d.key.path,n.batchId);s.push(i.delete(f)),l.push(d.key)}return F.waitFor(s).next(()=>l)}function hw(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ee();e=t.noDocument}return JSON.stringify(e).length}ui.DEFAULT_COLLECTION_PERCENTILE=10,ui.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ui.DEFAULT=new ui(41943040,ui.DEFAULT_COLLECTION_PERCENTILE,ui.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ui.DISABLED=new ui(-1,0,0);class fw{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,n,r,i){De(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new fw(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ku(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=gf(e),o=Ku(e);return o.add({}).next(a=>{De("number"==typeof a);const u=new sR(a,n,r,i),l=function(_,v,T){const D=T.baseMutations.map(R=>Gm(_.ut,R)),x=T.mutations.map(R=>Gm(_.ut,R));return{userId:v,batchId:T.batchId,localWriteTimeMs:T.localWriteTime.toMillis(),baseMutations:D,mutations:x}}(this.serializer,this.userId,u),d=[];let f=new Qt((m,_)=>Ze(m.canonicalString(),_.canonicalString()));for(const m of i){const _=h$(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),d.push(o.put(l)),d.push(s.put(_,Zae))}return f.forEach(m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Dn[a]=u.keys()}),F.waitFor(d).next(()=>u)})}lookupMutationBatch(e,n){return Ku(e).get(n).next(r=>r?(De(r.userId===this.userId),Ac(this.serializer,r)):null)}Cn(e,n){return this.Dn[n]?F.resolve(this.Dn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Dn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Ku(e).Y({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(De(a.batchId>=r),s=Ac(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Ku(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ku(e).W("userMutationsIndex",n).next(r=>r.map(i=>Ac(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=GI(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return gf(e).Y({range:i},(o,a,u)=>{const[l,d,f]=o,m=Jo(d);if(l===this.userId&&n.path.isEqual(m))return Ku(e).get(f).next(_=>{if(!_)throw Ee();De(_.userId===this.userId),s.push(Ac(this.serializer,_))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Qt(Ze);const i=[];return n.forEach(s=>{const o=GI(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=gf(e).Y({range:a},(l,d,f)=>{const[m,_,v]=l,T=Jo(_);m===this.userId&&s.path.isEqual(T)?r=r.add(v):f.done()});i.push(u)}),F.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=GI(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Qt(Ze);return gf(e).Y({range:o},(u,l,d)=>{const[f,m,_]=u,v=Jo(m);f===this.userId&&r.isPrefixOf(v)?v.length===i&&(a=a.add(_)):d.done()}).next(()=>this.vn(e,a))}vn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Ku(e).get(s).next(o=>{if(null===o)throw Ee();De(o.userId===this.userId),r.push(Ac(this.serializer,o))}))}),F.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return HH(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Fn(n.batchId)}),F.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return F.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return gf(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){const u=Jo(s[1]);i.push(u)}else a.done()}).next(()=>{De(0===i.length)})})}containsKey(e,n){return zH(e,this.userId,n)}Mn(e){return WH(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function zH(t,e,n){const r=GI(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return gf(t).Y({range:s,J:!0},(a,u,l)=>{const[d,f,m]=a;d===e&&f===i&&(o=!0),l.done()}).next(()=>o)}function Ku(t){return br(t,"mutations")}function gf(t){return br(t,"documentMutations")}function WH(t){return br(t,"mutationQueues")}class Pc{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new Pc(0)}static Nn(){return new Pc(-1)}}class ule{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Bn(e).next(n=>{const r=new Pc(n.highestTargetId);return n.highestTargetId=r.next(),this.Ln(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(n=>be.fromTimestamp(new Tn(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Ln(e,i)))}addTargetData(e,n){return this.kn(e,n).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(n,r),this.Ln(e,r))))}updateTargetData(e,n){return this.kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>mf(e).delete(n.targetId)).next(()=>this.Bn(e)).next(r=>(De(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return mf(e).Y((o,a)=>{const u=Km(a);u.sequenceNumber<=n&&null===r.get(u.targetId)&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>F.waitFor(s)).next(()=>i)}forEachTarget(e,n){return mf(e).Y((r,i)=>{const s=Km(i);n(s)})}Bn(e){return qH(e).get("targetGlobalKey").next(n=>(De(null!==n),n))}Ln(e,n){return qH(e).put("targetGlobalKey",n)}kn(e,n){return mf(e).put(RH(this.serializer,n))}qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=wc(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return mf(e).Y({range:i,index:"queryTargetsIndex"},(o,a,u)=>{const l=Km(a);Om(n,l.target)&&(s=l,u.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Zu(e);return n.forEach(o=>{const a=ai(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),F.waitFor(i)}removeMatchingKeys(e,n,r){const i=Zu(e);return F.forEach(n,s=>{const o=ai(s.path);return F.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Zu(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Zu(e);let s=rt();return i.Y({range:r,J:!0},(o,a,u)=>{const l=Jo(o[1]),d=new pe(l);s=s.add(d)}).next(()=>s)}containsKey(e,n){const r=ai(n.path),i=IDBKeyRange.bound([r],[r$(r)],!1,!0);let s=0;return Zu(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],u,l)=>{0!==o&&(s++,l.done())}).next(()=>s>0)}_t(e,n){return mf(e).get(n).next(r=>r?Km(r):null)}}function mf(t){return br(t,"targets")}function qH(t){return br(t,"targetGlobal")}function Zu(t){return br(t,"targetDocuments")}function GH([t,e],[n,r]){const i=Ze(t,n);return 0===i?Ze(e,r):i}class lle{constructor(e){this.Qn=e,this.buffer=new Qt(GH),this.Kn=0}$n(){return++this.Kn}Un(e){const n=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();GH(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class KH{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Wn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return null!==this.Wn}Gn(e){var n=this;re("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,Z.Z)(function*(){n.Wn=null;try{yield n.localStore.collectGarbage(n.garbageCollector)}catch(r){Vu(r)?re("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield Fu(r)}yield n.Gn(3e5)}))}}class cle{constructor(e,n){this.zn=e,this.params=n}calculateTargetCount(e,n){return this.zn.jn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(0===n)return F.resolve(Is._e);const r=new lle(n);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.zn.removeOrphanedDocuments(e,n)}collect(e,n){return-1===this.params.cacheSizeCollectionThreshold?(re("LruGarbageCollector","Garbage collection skipped; disabled"),F.resolve($H)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(re("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),$H):this.Jn(e,n))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,n){let r,i,s,o,a,u,l;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(re("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,n))).next(f=>(s=f,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(l=Date.now(),Zh()<=ys.in.DEBUG&&re("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-d}ms\n\tDetermined least recently used ${i} in `+(a-o)+`ms\n\tRemoved ${s} targets in `+(u-a)+`ms\n\tRemoved ${f} documents in `+(l-u)+`ms\nTotal Duration: ${l-d}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}class dle{constructor(e,n){this.db=e,this.garbageCollector=function ZH(t,e){return new cle(t,e)}(this,n)}jn(e){const n=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Yn(e){let n=0;return this.Hn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Hn(e,n){return this.Zn(e,(r,i)=>n(i))}addReference(e,n,r){return pw(e,r)}removeReference(e,n,r){return pw(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return pw(e,n)}Xn(e,n){return function(i,s){let o=!1;return WH(i).Z(a=>zH(i,a,s).next(u=>(u&&(o=!0),F.resolve(!u)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(o,a)=>{if(a<=n){const u=this.Xn(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,be.min()),Zu(e).delete([0,ai(o.path)])))});i.push(u)}}).next(()=>F.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return pw(e,n)}Zn(e,n){const r=Zu(e);let i,s=Is._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:l})=>{0===o?(s!==Is._e&&n(new pe(Jo(i)),s),s=l,i=u):s=Is._e}).next(()=>{s!==Is._e&&n(new pe(Jo(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function pw(t,e){return Zu(t).put((i=t.currentSequenceNumber,{targetId:0,path:ai(e.path),sequenceNumber:i}));var i}class QH{constructor(){this.changes=new za(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,_n.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return void 0!==r?F.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class hle{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Nc(e).put(r)}removeEntry(e,n,r){return Nc(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],uw(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.er(e,r)))}getEntry(e,n){let r=_n.newInvalidDocument(n);return Nc(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Xm(n))},(i,s)=>{r=this.tr(n,s)}).next(()=>r)}nr(e,n){let r={size:0,document:_n.newInvalidDocument(n)};return Nc(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Xm(n))},(i,s)=>{r={document:this.tr(n,s),size:hw(s)}}).next(()=>r)}getEntries(e,n){let r=Gi();return this.rr(e,n,(i,s)=>{const o=this.tr(i,s);r=r.insert(i,o)}).next(()=>r)}ir(e,n){let r=Gi(),i=new dn(pe.comparator);return this.rr(e,n,(s,o)=>{const a=this.tr(s,o);r=r.insert(s,a),i=i.insert(s,hw(o))}).next(()=>({documents:r,sr:i}))}rr(e,n,r){if(n.isEmpty())return F.resolve();let i=new Qt(ez);n.forEach(u=>i=i.add(u));const s=IDBKeyRange.bound(Xm(i.first()),Xm(i.last())),o=i.getIterator();let a=o.getNext();return Nc(e).Y({index:"documentKeyIndex",range:s},(u,l,d)=>{const f=pe.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&ez(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?d.U(Xm(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),uw(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Nc(e).W(IDBKeyRange.bound(a,u,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let d=Gi();for(const f of l){const m=this.tr(pe.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(Fm(n,m)||i.has(m.key))&&(d=d.insert(m.key,m))}return d})}getAllFromCollectionGroup(e,n,r,i){let s=Gi();const o=JH(n,r),a=JH(n,Es.max());return Nc(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,l,d)=>{const f=this.tr(pe.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(f.key,f),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new fle(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return XH(e).get("remoteDocumentGlobalKey").next(n=>(De(!!n),n))}er(e,n){return XH(e).put("remoteDocumentGlobalKey",n)}tr(e,n){if(n){const r=function Jue(t,e){let n;if(e.document)n=IH(t.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=pe.fromSegments(e.noDocument.path),i=Dc(e.noDocument.readTime);n=_n.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ee();{const r=pe.fromSegments(e.unknownDocument.path),i=Dc(e.unknownDocument.version);n=_n.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Tn(i[0],i[1]);return be.fromTimestamp(s)}(e.readTime)),n}(this.serializer,n);if(!r.isNoDocument()||!r.version.isEqual(be.min()))return r}return _n.newInvalidDocument(e)}}function YH(t){return new hle(t)}class fle extends QH{constructor(e,n){super(),this._r=e,this.trackRemovals=n,this.ar=new za(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Qt((s,o)=>Ze(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.ar.get(s);if(n.push(this._r.removeEntry(e,s,a.readTime)),o.isValidDocument()){const u=bH(this._r.serializer,o);i=i.add(s.path.popLast());const l=hw(u);r+=l-a.size,n.push(this._r.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){const u=bH(this._r.serializer,o.convertToNoDocument(be.min()));n.push(this._r.addEntry(e,s,u))}}),i.forEach(s=>{n.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),n.push(this._r.updateMetadata(e,r)),F.waitFor(n)}getFromCache(e,n){return this._r.nr(e,n).next(r=>(this.ar.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this._r.ir(e,n).next(({documents:r,sr:i})=>(i.forEach((s,o)=>{this.ar.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function XH(t){return br(t,"remoteDocumentGlobal")}function Nc(t){return br(t,"remoteDocumentsV14")}function Xm(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function JH(t,e){const n=e.documentKey.path.toArray();return[t,uw(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function ez(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Ze(n[s],r[s]),i)return i;return i=Ze(n.length,r.length),i||(i=Ze(n[n.length-2],r[r.length-2]),i||Ze(n[n.length-1],r[r.length-1]))}class ple{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class tz{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(null!==r&&jm(r.mutation,i,qi.empty(),Tn.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,rt()).next(()=>r))}getLocalViewOfDocuments(e,n,r=rt()){const i=ta();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Vm();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=ta();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,rt()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Gi();const o=Um(),a=Um();return n.forEach((u,l)=>{const d=r.get(l.key);i.has(l.key)&&(void 0===d||d.mutation instanceof Wa)?s=s.insert(l.key,l):void 0!==d?(o.set(l.key,d.mutation.getFieldMask()),jm(d.mutation,l,d.mutation.getFieldMask(),Tn.now())):o.set(l.key,qi.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((l,d)=>o.set(l,d)),n.forEach((l,d)=>{var f;return a.set(l,new ple(d,null!==(f=o.get(l))&&void 0!==f?f:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Um();let i=new dn((o,a)=>o-a),s=rt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(u=>{const l=n.get(u);if(null===l)return;let d=r.get(u)||qi.empty();d=a.applyToLocalView(l,d),r.set(u,d);const f=(i.get(a.batchId)||rt()).add(u);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),l=u.key,d=u.value,f=q$();d.forEach(m=>{if(!s.has(m)){const _=tH(n.get(m),r.get(m));null!==_&&f.set(m,_),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,f))}return F.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return pe.isDocumentKey((o=n).path)&&null===o.collectionGroup&&0===o.filters.length?this.getDocumentsMatchingDocumentQuery(e,n.path):tR(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i);var o}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):F.resolve(ta());let a=-1,u=s;return o.next(l=>F.forEach(l,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(d)?F.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{u=u.insert(d,m)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,u,l,rt())).next(d=>({batchId:a,changes:W$(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new pe(n)).next(r=>{let i=Vm();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Vm();return this.indexManager.getCollectionParents(e,s).next(a=>F.forEach(a,u=>{const l=(f=n,m=u.child(s),new Ha(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt));var f,m;return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,l)=>{const d=l.getKey();null===o.get(d)&&(o=o.insert(d,_n.newInvalidDocument(d)))});let a=Vm();return o.forEach((u,l)=>{const d=s.get(u);void 0!==d&&jm(d.mutation,l,qi.empty(),Tn.now()),Fm(n,l)&&(a=a.insert(u,l))}),a})}}class gle{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return F.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,{id:(i=n).id,version:i.version,createTime:er(i.createTime)}),F.resolve();var i}getNamedQuery(e,n){return F.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,{name:(i=n).name,query:pR(i.bundledQuery),readTime:er(i.readTime)}),F.resolve();var i}}class mle{constructor(){this.overlays=new dn(pe.comparator),this.lr=new Map}getOverlay(e,n){return F.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ta();return F.forEach(n,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.lt(e,n,s)}),F.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.lr.get(r);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),F.resolve()}getOverlaysForCollection(e,n,r){const i=ta(),s=n.length+1,o=new pe(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,l=u.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return F.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new dn((l,d)=>l-d);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let d=s.get(l.largestBatchId);null===d&&(d=ta(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}const a=ta(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return F.resolve(a)}lt(e,n,r){const i=this.overlays.get(r.key);if(null!==i){const o=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new aR(n,r));let s=this.lr.get(n);void 0===s&&(s=rt(),this.lr.set(n,s)),this.lr.set(n,s.add(r.key))}}class IR{constructor(){this.hr=new Qt(Rr.Pr),this.Ir=new Qt(Rr.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){const r=new Rr(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new Rr(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){const n=new pe(new St([])),r=new Rr(n,e),i=new Rr(n,e+1),s=[];return this.Ir.forEachInRange([r,i],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const n=new pe(new St([])),r=new Rr(n,e),i=new Rr(n,e+1);let s=rt();return this.Ir.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Rr(e,0),r=this.hr.firstAfterOrEqual(n);return null!==r&&e.isEqual(r.key)}}class Rr{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return pe.comparator(e.key,n.key)||Ze(e.gr,n.gr)}static Tr(e,n){return Ze(e.gr,n.gr)||pe.comparator(e.key,n.key)}}class _le{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new Qt(Rr.Pr)}checkEmpty(e){return F.resolve(0===this.mutationQueue.length)}addMutationBatch(e,n,r,i){const s=this.pr;this.pr++;const o=new sR(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.yr=this.yr.add(new Rr(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return F.resolve(o)}lookupMutationBatch(e,n){return F.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){const i=this.Sr(n+1),s=i<0?0:i;return F.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Rr(n,0),i=new Rr(n,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],o=>{const a=this.wr(o.gr);s.push(a)}),F.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Qt(Ze);return n.forEach(i=>{const s=new Rr(i,0),o=new Rr(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{r=r.add(a.gr)})}),F.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;pe.isDocumentKey(s)||(s=s.child(""));const o=new Rr(new pe(s),0);let a=new Qt(Ze);return this.yr.forEachWhile(u=>{const l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(u.gr)),!0)},o),F.resolve(this.br(a))}br(e){const n=[];return e.forEach(r=>{const i=this.wr(r);null!==i&&n.push(i)}),n}removeMutationBatch(e,n){De(0===this.Dr(n.batchId,"removed")),this.mutationQueue.shift();let r=this.yr;return F.forEach(n.mutations,i=>{const s=new Rr(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){const r=new Rr(n,0),i=this.yr.firstAfterOrEqual(r);return F.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return F.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}wr(e){const n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class yle{constructor(e){this.Cr=e,this.docs=new dn(pe.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return F.resolve(r?r.document.mutableCopy():_n.newInvalidDocument(n))}getEntries(e,n){let r=Gi();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():_n.newInvalidDocument(i))}),F.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Gi();const o=n.path,a=new pe(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:l,value:{document:d}}=u.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||Wb(s$(d),r)<=0||(i.has(d.key)||Fm(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return F.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Ee()}vr(e,n){return F.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new vle(this)}getSize(e){return F.resolve(this.size)}}class vle extends QH{constructor(e){super(),this._r=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),F.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}}class Ele{constructor(e){this.persistence=e,this.Fr=new za(n=>wc(n),Om),this.lastRemoteSnapshotVersion=be.min(),this.highestTargetId=0,this.Mr=0,this.Or=new IR,this.targetCount=0,this.Nr=Pc.On()}forEachTarget(e,n){return this.Fr.forEach((r,i)=>n(i)),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),F.resolve()}kn(e){this.Fr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Nr=new Pc(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,F.resolve()}updateTargetData(e,n){return this.kn(n),F.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=n&&null===r.get(a.targetId)&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),F.waitFor(s).next(()=>i)}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,n){const r=this.Fr.get(n)||null;return F.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),F.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),F.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),F.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Or.mr(n);return F.resolve(r)}containsKey(e,n){return F.resolve(this.Or.containsKey(n))}}class wR{constructor(e,n){this.Br={},this.overlays={},this.Lr=new Is(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new Ele(this),this.indexManager=new ole,this.remoteDocumentCache=new yle(r=>this.referenceDelegate.Qr(r)),this.serializer=new AH(n),this.Kr=new gle(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new mle,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new _le(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){re("MemoryPersistence","Starting transaction:",e);const i=new Ile(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,n){return F.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}}class Ile extends a${constructor(e){super(),this.currentSequenceNumber=e}}class gw{constructor(e){this.persistence=e,this.Gr=new IR,this.zr=null}static jr(e){return new gw(e)}get Hr(){if(this.zr)return this.zr;throw Ee()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),F.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),F.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),F.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.Hr,r=>{const i=pe.fromPath(r);return this.Jr(e,i).next(s=>{s||n.removeEntry(i,be.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return F.or([()=>F.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}}class wle{constructor(e){this.serializer=e}N(e,n,r,i){const s=new qI("createOrUpgrade",n);var u;r<1&&i>=1&&(e.createObjectStore("owner"),(u=e).createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",d$,{unique:!0}),u.createObjectStore("documentMutations"),nz(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=F.resolve();return r<3&&i>=3&&(0!==r&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),nz(e)),o=o.next(()=>function(u){const l=u.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:be.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(0!==r&&(o=o.next(()=>function(u,l){return l.store("mutations").W().next(d=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",d$,{unique:!0});const f=l.store("mutations"),m=d.map(_=>f.put(_));return F.waitFor(m)})}(e,s))),o=o.next(()=>{!function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(o=o.next(()=>this.Zr(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(o=o.next(()=>this.ei(s))),r<8&&i>=8&&(o=o.next(()=>this.ti(e,s))),r<9&&i>=9&&(o=o.next(()=>{!function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(o=o.next(()=>this.ni(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{!function(u){const l=u.createObjectStore("documentOverlays",{keyPath:aue});l.createIndex("collectionPathOverlayIndex",uue,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",lue,{unique:!1})}(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){const l=u.createObjectStore("remoteDocumentsV14",{keyPath:Qae});l.createIndex("documentKeyIndex",Yae),l.createIndex("collectionGroupIndex",Xae)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ii(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:rue}).createIndex("sequenceNumberIndex",iue,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:sue}).createIndex("documentKeyIndex",oue,{unique:!1})}(e))),o}Xr(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=hw(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>F.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>F.forEach(a,u=>{De(u.userId===s.userId);const l=Ac(this.serializer,u);return HH(e,s.userId,l).next(()=>{})}))}))}ei(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((o,a)=>{const u=new St(o),l=[0,ai(u)];s.push(n.get(l).next(d=>d?F.resolve():n.put({targetId:0,path:ai(u),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>F.waitFor(s))})}ti(e,n){e.createObjectStore("collectionParents",{keyPath:nue});const r=n.store("collectionParents"),i=new ER,s=o=>{if(i.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:ai(u)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{const u=new St(o);return s(u.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,u],l)=>{const d=Jo(a);return s(d.popLast())}))}ni(e){const n=e.store("targets");return n.Y((r,i)=>{const s=Km(i),o=RH(this.serializer,s);return n.put(o)})}ri(e,n){const r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{const a=n.store("remoteDocumentsV14"),u=(f=o,f.document?new pe(St.fromString(f.document.name).popFirst(5)):f.noDocument?pe.fromSegments(f.noDocument.path):f.unknownDocument?pe.fromSegments(f.unknownDocument.path):Ee()).path.toArray(),l={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};var f;i.push(a.put(l))}).next(()=>F.waitFor(i))}ii(e,n){const r=n.store("mutations"),i=YH(this.serializer),s=new wR(gw.jr,this.serializer.ut);return r.W().next(o=>{const a=new Map;return o.forEach(u=>{var l;let d=null!==(l=a.get(u.userId))&&void 0!==l?l:rt();Ac(this.serializer,u).keys().forEach(f=>d=d.add(f)),a.set(u.userId,d)}),F.forEach(a,(u,l)=>{const d=new Ar(l),f=lw.ct(this.serializer,d),m=s.getIndexManager(d),_=fw.ct(d,this.serializer,m,s.referenceDelegate);return new tz(i,_,f,m).recalculateAndSaveOverlaysForDocumentKeys(new Kb(n,Is._e),u).next()})})}}function nz(t){t.createObjectStore("targetDocuments",{keyPath:eue}).createIndex("documentTargetsIndex",tue,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Jae,{unique:!0}),t.createObjectStore("targetGlobal")}const TR="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class CR{constructor(e,n,r,i,s,o,a,u,l,d,f=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.si=s,this.window=o,this.document=a,this.oi=l,this._i=d,this.ai=f,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=m=>Promise.resolve(),!CR.D())throw new te(z.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new dle(this,i),this.Ii=n+"main",this.serializer=new AH(u),this.Ti=new Eo(this.Ii,this.ai,new wle(this.serializer)),this.qr=new ule(this.referenceDelegate,this.serializer),this.remoteDocumentCache=YH(this.serializer),this.Kr=new ele,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,!1===d&&Jn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new te(z.FAILED_PRECONDITION,TR);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new Is(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){var n=this;return this.Pi=function(){var r=(0,Z.Z)(function*(i){if(n.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(function(){var n=(0,Z.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return n.apply(this,arguments)}}())}setNetworkEnabled(e){var n=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget((0,Z.Z)(function*(){n.started&&(yield n.di())})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>_w(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(n=>{n||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(n=>this.isPrimary&&!n?this.pi(e).next(()=>!1):!!n&&this.yi(e).next(()=>!0))).catch(e=>{if(Vu(e))return re("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return re("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return Jm(e).get("owner").next(n=>F.resolve(this.wi(n)))}Si(e){return _w(e).delete(this.clientId)}bi(){var e=this;return(0,Z.Z)(function*(){if(e.isPrimary&&!e.Di(e.hi,18e5)){e.hi=Date.now();const n=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=br(r,"clientMetadata");return i.W().next(s=>{const o=e.Ci(s,18e5),a=s.filter(u=>-1===o.indexOf(u));return F.forEach(a,u=>i.delete(u.clientId)).next(()=>a)})}).catch(()=>[]);if(e.Ei)for(const r of n)e.Ei.removeItem(e.vi(r.clientId))}})()}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?F.resolve(!0):Jm(e).get("owner").next(n=>{if(null!==n&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)){if(this.wi(n)&&this.networkEnabled)return!0;if(!this.wi(n)){if(!n.allowTabSynchronization)throw new te(z.FAILED_PRECONDITION,TR);return!1}}return!(!this.networkEnabled||!this.inForeground)||_w(e).W().next(r=>void 0===this.Ci(r,5e3).find(i=>!(this.clientId===i.clientId||!(!this.networkEnabled&&i.networkEnabled||!this.inForeground&&i.inForeground&&this.networkEnabled===i.networkEnabled))))}).next(n=>(this.isPrimary!==n&&re("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){var e=this;return(0,Z.Z)(function*(){e.kr=!1,e.Mi(),e.li&&(e.li.cancel(),e.li=null),e.xi(),e.Oi(),yield e.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],n=>{const r=new Kb(n,Is._e);return e.pi(r).next(()=>e.Si(r))}),e.Ti.close(),e.Ni()})()}Ci(e,n){return e.filter(r=>this.Di(r.updateTimeMs,n)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>_w(e).W().next(n=>this.Ci(n,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,n){return fw.ct(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new ale(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return lw.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,n,r){re("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===n?"readonly":"readwrite",s=15===(u=this.ai)?due:14===u?g$:13===u?p$:12===u?cue:11===u?f$:void Ee();var u;let o;return this.Ti.runTransaction(e,i,s,a=>(o=new Kb(a,this.Lr?this.Lr.next():Is._e),"readwrite-primary"===n?this.fi(o).next(u=>!!u||this.gi(o)).next(u=>{if(!u)throw Jn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new te(z.FAILED_PRECONDITION,o$);return r(o)}).next(u=>this.yi(o).next(()=>u)):this.Li(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Li(e){return Jm(e).get("owner").next(n=>{if(null!==n&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)&&!this.wi(n)&&!(this._i||this.allowTabSynchronization&&n.allowTabSynchronization))throw new te(z.FAILED_PRECONDITION,TR)})}yi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Jm(e).put("owner",n)}static D(){return Eo.D()}pi(e){const n=Jm(e);return n.get("owner").next(r=>this.wi(r)?(re("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):F.resolve())}Di(e,n){const r=Date.now();return!(e<r-n||e>r&&(Jn(`Detected an update time that is in the future: ${e} > ${r}`),1))}Ai(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground="visible"===this.document.visibilityState)}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ui=()=>{this.Mi();const n=/(?:Version|Mobile)\/1[456]/;(0,S.G6)()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var n;try{const r=null!==(null===(n=this.Ei)||void 0===n?void 0:n.getItem(this.vi(e)));return re("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Jn("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){Jn("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Jm(t){return br(t,"owner")}function _w(t){return br(t,"clientMetadata")}function SR(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}class DR{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=i}static Qi(e,n){let r=rt(),i=rt();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new DR(e,n.fromCache,r,i)}}class Tle{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class rz{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.zi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new Tle;return this.Hi(e,n,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,n,o,a.size)})}).next(()=>s.result)}Ji(e,n,r,i){return r.documentReadCount<this.Ui?(Zh()<=ys.in.DEBUG&&re("QueryEngine","SDK will not create cache indexes for query:",sf(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),F.resolve()):(Zh()<=ys.in.DEBUG&&re("QueryEngine","Query:",sf(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(Zh()<=ys.in.DEBUG&&re("QueryEngine","The SDK decides to create cache indexes for query:",sf(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,bi(n))):F.resolve())}zi(e,n){if(U$(n))return F.resolve(null);let r=bi(n);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==n.limit&&1===i&&(n=nw(n,null,"F"),r=bi(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=rt(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const l=this.Yi(n,a);return this.Zi(n,l,o,u.readTime)?this.zi(e,nw(n,null,"F")):this.Xi(e,l,n,u)}))})))}ji(e,n,r,i){return U$(n)||i.isEqual(be.min())?F.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const o=this.Yi(n,s);return this.Zi(n,o,r,i)?F.resolve(null):(Zh()<=ys.in.DEBUG&&re("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),sf(n)),this.Xi(e,o,n,i$(i,-1)).next(a=>a))})}Yi(e,n){let r=new Qt(H$(e));return n.forEach((i,s)=>{Fm(e,s)&&(r=r.add(s))}),r}Zi(e,n,r,i){if(null===e.limit)return!1;if(r.size!==n.size)return!0;const s="F"===e.limitType?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,n,r){return Zh()<=ys.in.DEBUG&&re("QueryEngine","Using full collection scan to execute query:",sf(n)),this.Gi.getDocumentsMatchingQuery(e,n,Es.min(),r)}Xi(e,n,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}class Cle{constructor(e,n,r,i){this.persistence=e,this.es=n,this.serializer=i,this.ts=new dn(Ze),this.ns=new za(s=>wc(s),Om),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tz(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}}function iz(t,e,n,r){return new Cle(t,e,n,r)}function sz(t,e){return AR.apply(this,arguments)}function AR(){return AR=(0,Z.Z)(function*(t,e){const n=fe(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let u=rt();for(const l of i){o.push(l.batchId);for(const d of l.mutations)u=u.add(d.key)}for(const l of s){a.push(l.batchId);for(const d of l.mutations)u=u.add(d.key)}return n.localDocuments.getDocuments(r,u).next(l=>({_s:l,removedBatchIds:o,addedBatchIds:a}))})})}),AR.apply(this,arguments)}function oz(t){const e=fe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function az(t,e,n){let r=rt(),i=rt();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Gi();return n.forEach((a,u)=>{const l=s.get(a);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(be.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||0===u.version.compareTo(l.version)&&l.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):re("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",u.version)}),{us:o,cs:i}})}function Ale(t,e){const n=fe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function _f(t,e){const n=fe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.qr.getTargetData(r,e).next(s=>s?(i=s,F.resolve(i)):n.qr.allocateTargetId(r).next(o=>(i=new qa(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.ts.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}function yf(t,e,n){return bR.apply(this,arguments)}function bR(){return bR=(0,Z.Z)(function*(t,e,n){const r=fe(t),i=r.ts.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Vu(o))throw o;re("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}),bR.apply(this,arguments)}function yw(t,e,n){const r=fe(t);let i=be.min(),s=rt();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,l,d){const f=fe(u),m=f.ns.get(d);return void 0!==m?F.resolve(f.ts.get(m)):f.qr.getTargetData(l,d)}(r,o,bi(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.es.getDocumentsMatchingQuery(o,e,n?i:be.min(),n?s:rt())).next(a=>(cz(r,$$(e),a),{documents:a,ls:s})))}function uz(t,e){const n=fe(t),r=fe(n.qr),i=n.ts.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function lz(t,e){const n=fe(t),r=n.rs.get(e)||be.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.ss.getAllFromCollectionGroup(i,e,i$(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(cz(n,e,i),i))}function cz(t,e,n){let r=t.rs.get(e)||be.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.rs.set(e,r)}function RR(){return RR=(0,Z.Z)(function*(t,e,n,r){const i=fe(t);let s=rt(),o=Gi();for(const l of n){const d=e.hs(l.metadata.name);l.document&&(s=s.add(d));const f=e.Ps(l);f.setReadTime(e.Is(l.metadata.readTime)),o=o.insert(d,f)}const a=i.ss.newChangeBuffer({trackRemovals:!0}),u=yield _f(i,(d=r,bi(nf(St.fromString(`__bundle__/docs/${d}`)))));var d;return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>az(l,a,o).next(d=>(a.apply(l),d)).next(d=>i.qr.removeMatchingKeysForTargetId(l,u.targetId).next(()=>i.qr.addMatchingKeys(l,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.us,d.cs)).next(()=>d.us)))}),RR.apply(this,arguments)}function Rle(t,e){return PR.apply(this,arguments)}function PR(){return PR=(0,Z.Z)(function*(t,e,n=rt()){const r=yield _f(t,bi(pR(e.bundledQuery))),i=fe(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=er(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Kr.saveNamedQuery(s,e);const a=r.withResumeToken(_r.EMPTY_BYTE_STRING,o);return i.ts=i.ts.insert(a.targetId,a),i.qr.updateTargetData(s,a).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,n,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}),PR.apply(this,arguments)}function dz(t,e){return`firestore_clients_${t}_${e}`}function hz(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function NR(t,e){return`firestore_targets_${t}_${e}`}class vw{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Ts(e,n,r){const i=JSON.parse(r);let s,o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code,o&&(s=new te(i.error.code,i.error.message))),o?new vw(e,n,i.state,s):(Jn("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class e_{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ts(e,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new te(r.error.code,r.error.message))),s?new e_(e,r.state,i):(Jn("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ew{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ts(e,n){const r=JSON.parse(n);let i="object"==typeof r&&r.activeTargetIds instanceof Array,s=rR();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=l$(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new Ew(e,s):(Jn("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class MR{constructor(e,n){this.clientId=e,this.onlineState=n}static Ts(e){const n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new MR(n.clientId,n.onlineState):(Jn("SharedClientState",`Failed to parse online state: ${e}`),null)}}class xR{constructor(){this.activeTargetIds=rR()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class kR{constructor(e,n,r,i,s){this.window=e,this.si=n,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new dn(Ze),this.started=!1,this.ps=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=dz(this.persistenceKey,this.Rs),this.ws=`firestore_sequence_number_${this.persistenceKey}`,this.gs=this.gs.insert(this.Rs,new xR),this.Ss=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Cs=`firestore_online_state_${this.persistenceKey}`,this.vs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,Z.Z)(function*(){const n=yield e.syncEngine.Bi();for(const i of n){if(i===e.Rs)continue;const s=e.getItem(dz(e.persistenceKey,i));if(s){const o=Ew.Ts(i,s);o&&(e.gs=e.gs.insert(o.clientId,o))}}e.Fs();const r=e.storage.getItem(e.Cs);if(r){const i=e.Ms(r);i&&e.xs(i)}for(const i of e.ps)e.fs(i);e.ps=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let n=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,n,r){this.Ns(e,n,r),this.Bs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(NR(this.persistenceKey,e));if(r){const i=e_.Ts(e,r);i&&(n=i.state)}}return this.Ls.ds(e),this.Fs(),n}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(NR(this.persistenceKey,e))}updateQueryState(e,n,r){this.ks(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return re("SharedClientState","READ",e,n),n}setItem(e,n){re("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){re("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){var n=this;const r=e;if(r.storageArea===this.storage){if(re("SharedClientState","EVENT",r.key,r.newValue),r.key===this.ys)return void Jn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable((0,Z.Z)(function*(){if(n.started){if(null!==r.key)if(n.Ss.test(r.key)){if(null==r.newValue){const i=n.Ks(r.key);return n.$s(i,null)}{const i=n.Us(r.key,r.newValue);if(i)return n.$s(i.clientId,i)}}else if(n.bs.test(r.key)){if(null!==r.newValue){const i=n.Ws(r.key,r.newValue);if(i)return n.Gs(i)}}else if(n.Ds.test(r.key)){if(null!==r.newValue){const i=n.zs(r.key,r.newValue);if(i)return n.js(i)}}else if(r.key===n.Cs){if(null!==r.newValue){const i=n.Ms(r.newValue);if(i)return n.xs(i)}}else if(r.key===n.ws){const i=function(o){let a=Is._e;if(null!=o)try{const u=JSON.parse(o);De("number"==typeof u),a=u}catch(u){Jn("SharedClientState","Failed to read sequence number from WebStorage",u)}return a}(r.newValue);i!==Is._e&&n.sequenceNumberHandler(i)}else if(r.key===n.vs){const i=n.Hs(r.newValue);yield Promise.all(i.map(s=>n.syncEngine.Js(s)))}}else n.ps.push(r)}))}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,n,r){const i=new vw(this.currentUser,e,n,r),s=hz(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const n=hz(this.persistenceKey,this.currentUser,e);this.removeItem(n)}qs(e){this.storage.setItem(this.Cs,JSON.stringify({clientId:this.Rs,onlineState:e}))}ks(e,n,r){const i=NR(this.persistenceKey,e),s=new e_(e,n,r);this.setItem(i,s.Es())}Qs(e){const n=JSON.stringify(Array.from(e));this.setItem(this.vs,n)}Ks(e){const n=this.Ss.exec(e);return n?n[1]:null}Us(e,n){const r=this.Ks(e);return Ew.Ts(r,n)}Ws(e,n){const r=this.bs.exec(e),i=Number(r[1]);return vw.Ts(new Ar(void 0!==r[2]?r[2]:null),i,n)}zs(e,n){const r=this.Ds.exec(e),i=Number(r[1]);return e_.Ts(i,n)}Ms(e){return MR.Ts(e)}Hs(e){return JSON.parse(e)}Gs(e){var n=this;return(0,Z.Z)(function*(){if(e.user.uid===n.currentUser.uid)return n.syncEngine.Ys(e.batchId,e.state,e.error);re("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,n){const r=n?this.gs.insert(e,n):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.Xs(o,a).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let n=rR();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class fz{constructor(){this.eo=new xR,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new xR,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Ple{ro(e){}shutdown(){}}class pz{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){re("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){re("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Iw=null;function OR(){return null===Iw?Iw=268435456+Math.round(2147483648*Math.random()):Iw++,"0x"+Iw.toString(16)}const Nle={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Mle{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}const li="WebChannelConnection";class xle extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+n.host,this.fo=`projects/${i}/databases/${s}`,this.po="(default)"===this.databaseId.database?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(n,r,i,s,o){const a=OR(),u=this.So(n,r);re("RestConnection",`Sending RPC '${n}' ${a}:`,u,i);const l={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(l,s,o),this.Do(n,u,l,i).then(d=>(re("RestConnection",`Received RPC '${n}' ${a}: `,d),d),d=>{throw Wi("RestConnection",`RPC '${n}' ${a} failed with error: `,d,"url: ",u,"request:",i),d})}Co(n,r,i,s,o,a){return this.wo(n,r,i,s,o)}bo(n,r,i){n["X-Goog-Api-Client"]="gl-js/ fire/"+Kh,n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}So(n,r){return`${this.mo}/v1/${r}:${Nle[n]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,n,r,i){const s=OR();return new Promise((o,a)=>{const u=new Pae;u.setWithCredentials(!0),u.listenOnce(bae.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case $b.NO_ERROR:const d=u.getResponseJson();re(li,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case $b.TIMEOUT:re(li,`RPC '${e}' ${s} timed out`),a(new te(z.DEADLINE_EXCEEDED,"Request time out"));break;case $b.HTTP_ERROR:const f=u.getStatus();if(re(li,`RPC '${e}' ${s} failed with status:`,f,"response text:",u.getResponseText()),f>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const _=m?.error;if(_&&_.status&&_.message){const v=function(D){const x=D.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(x)>=0?x:z.UNKNOWN}(_.status);a(new te(v,_.message))}else a(new te(z.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new te(z.UNAVAILABLE,"Connection failed."));break;default:Ee()}}finally{re(li,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(i);re(li,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",l,r,15)})}vo(e,n,r){const i=OR(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Dae(),a=Aae(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.useFetchStreams=!0),this.bo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const d=s.join("");re(li,`Creating RPC '${e}' stream ${i}: ${d}`,u);const f=o.createWebChannel(d,u);let m=!1,_=!1;const v=new Mle({co:D=>{_?re(li,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(m||(re(li,`Opening RPC '${e}' stream ${i} transport.`),f.open(),m=!0),re(li,`RPC '${e}' stream ${i} sending:`,D),f.send(D))},lo:()=>f.close()}),T=(D,x,R)=>{D.listen(x,L=>{try{R(L)}catch(G){setTimeout(()=>{throw G},0)}})};return T(f,WI.EventType.OPEN,()=>{_||re(li,`RPC '${e}' stream ${i} transport opened.`)}),T(f,WI.EventType.CLOSE,()=>{_||(_=!0,re(li,`RPC '${e}' stream ${i} transport closed`),v.Ro())}),T(f,WI.EventType.ERROR,D=>{_||(_=!0,Wi(li,`RPC '${e}' stream ${i} transport errored:`,D),v.Ro(new te(z.UNAVAILABLE,"The operation could not be completed")))}),T(f,WI.EventType.MESSAGE,D=>{var x;if(!_){const R=D.data[0];De(!!R);const G=R.error||(null===(x=R[0])||void 0===x?void 0:x.error);if(G){re(li,`RPC '${e}' stream ${i} received error:`,G);const ae=G.status;let ye=function(Zr){const Zs=sr[Zr];if(void 0!==Zs)return aH(Zs)}(ae),Qe=G.message;void 0===ye&&(ye=z.INTERNAL,Qe="Unknown error status: "+ae+" with message "+G.message),_=!0,v.Ro(new te(ye,Qe)),f.close()}else re(li,`RPC '${e}' stream ${i} received:`,R),v.Vo(R)}}),T(a,Rae.STAT_EVENT,D=>{D.stat===Xj.PROXY?re(li,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===Xj.NOPROXY&&re(li,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.Ao()},0),v}}function gz(){return typeof window<"u"?window:null}function ww(){return typeof document<"u"?document:null}function t_(t){return new Hue(t,!0)}class LR{constructor(e,n,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=n,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const n=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&re("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){null!==this.No&&(this.No.skipDelay(),this.No=null)}cancel(){null!==this.No&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class mz{constructor(e,n,r,i,s,o,a,u){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new LR(e,n)}jo(){return 1===this.state||5===this.state||this.Ho()}Ho(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Jo()}stop(){var e=this;return(0,Z.Z)(function*(){e.jo()&&(yield e.close(0))})()}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&null===this.Wo&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}Xo(){var e=this;return(0,Z.Z)(function*(){if(e.Ho())return e.close(0)})()}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}close(e,n){var r=this;return(0,Z.Z)(function*(){r.t_(),r.n_(),r.zo.cancel(),r.Uo++,4!==e?r.zo.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(Jn(n.toString()),Jn("Using maximum backoff delay to prevent overloading the backend."),r.zo.Lo()):n&&n.code===z.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.r_(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Io(n)})()}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),n=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===n&&this.s_(r,i)},r=>{e(()=>{const i=new te(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,n){const r=this.i_(this.Uo);this.stream=this.__(e,n),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){var e=this;this.state=5,this.zo.ko((0,Z.Z)(function*(){e.state=0,e.start()}))}o_(e){return re("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return n=>{this.si.enqueueAndForget(()=>this.Uo===e?n():(re("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class kle extends mz{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}__(e,n){return this.connection.vo("Listen",e,n)}onMessage(e){this.zo.reset();const n=function que(t,e){let n;if("targetChange"in e){const r="NO_CHANGE"===(l=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===l?1:"REMOVE"===l?2:"CURRENT"===l?3:"RESET"===l?4:Ee(),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(De(void 0===d||"string"==typeof d),_r.fromBase64String(d||"")):(De(void 0===d||d instanceof Uint8Array),_r.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const d=void 0===l.code?z.UNKNOWN:aH(l.code);return new te(d,l.message||"")}(o);n=new hH(r,i,s,a||null)}else if("documentChange"in e){const r=e.documentChange,i=na(t,r.document.name),s=er(r.document.updateTime),o=r.document.createTime?er(r.document.createTime):be.min(),a=new qr({mapValue:{fields:r.document.fields}}),u=_n.newFoundDocument(i,s,o,a);n=new aw(r.targetIds||[],r.removedTargetIds||[],u.key,u)}else if("documentDelete"in e){const r=e.documentDelete,i=na(t,r.document),s=r.readTime?er(r.readTime):be.min(),o=_n.newNoDocument(i,s);n=new aw([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const r=e.documentRemove,i=na(t,r.document);n=new aw([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return Ee();{const r=e.filter,{count:i=0,unchangedNames:s}=r,o=new Fue(i,s);n=new dH(r.targetId,o)}}var l;return n}(this.serializer,e),r=function(s){if(!("targetChange"in s))return be.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?be.min():o.readTime?er(o.readTime):be.min()}(e);return this.listener.a_(n,r)}u_(e){const n={};n.database=qm(this.serializer),n.addTarget=function(s,o){let a;const u=o.target;if(a=ew(u)?{documents:wH(s,u)}:{query:fR(s,u)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=mH(s,o.resumeToken);const l=lR(s,o.expectedCount);null!==l&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(be.min())>0){a.readTime=df(s,o.snapshotVersion.toTimestamp());const l=lR(s,o.expectedCount);null!==l&&(a.expectedCount=l)}return a}(this.serializer,e);const r=function Kue(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ee()}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);r&&(n.labels=r),this.e_(n)}c_(e){const n={};n.database=qm(this.serializer),n.removeTarget=e,this.e_(n)}}class Ole extends mz{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,n){return this.connection.vo("Write",e,n)}onMessage(e){if(De(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const n=function Gue(t,e){return t&&t.length>0?(De(void 0!==e),t.map(n=>function(i,s){let o=er(i.updateTime?i.updateTime:s);return o.isEqual(be.min())&&(o=er(s)),new xue(o,i.transformResults||[])}(n,e))):[]}(e.writeResults,e.commitTime),r=er(e.commitTime);return this.listener.I_(r,n)}return De(!e.writeResults||0===e.writeResults.length),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=qm(this.serializer),this.e_(e)}P_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Gm(this.serializer,r))};this.e_(n)}}class Lle extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new te(z.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,n,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,n,r,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new te(z.UNKNOWN,i.toString())})}Co(e,n,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,n,r,s,o,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new te(z.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class Vle{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){0===this.V_&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){"Online"===this.state?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,"Online"===e&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const n=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(Jn(n),this.f_=!1):re("OnlineStateTracker",n)}S_(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}}class Ule{constructor(e,n,r,i,s){var o=this;this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{r.enqueueAndForget((0,Z.Z)(function*(){var u;Qu(o)&&(re("RemoteStore","Restarting streams for network reachability change."),yield(u=(0,Z.Z)(function*(d){const f=fe(d);f.C_.add(4),yield vf(f),f.M_.set("Unknown"),f.C_.delete(4),yield n_(f)}),function l(d){return u.apply(this,arguments)})(o))}))}),this.M_=new Vle(r,i)}}function n_(t){return VR.apply(this,arguments)}function VR(){return VR=(0,Z.Z)(function*(t){if(Qu(t))for(const e of t.v_)yield e(!0)}),VR.apply(this,arguments)}function vf(t){return UR.apply(this,arguments)}function UR(){return UR=(0,Z.Z)(function*(t){for(const e of t.v_)yield e(!1)}),UR.apply(this,arguments)}function Tw(t,e){const n=fe(t);n.D_.has(e.targetId)||(n.D_.set(e.targetId,e),$R(n)?jR(n):If(n).Ho()&&BR(n,e))}function r_(t,e){const n=fe(t),r=If(n);n.D_.delete(e),r.Ho()&&_z(n,e),0===n.D_.size&&(r.Ho()?r.Zo():Qu(n)&&n.M_.set("Unknown"))}function BR(t,e){if(t.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(be.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}If(t).u_(e)}function _z(t,e){t.x_.Oe(e),If(t).c_(e)}function jR(t){t.x_=new Uue({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.D_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),If(t).start(),t.M_.g_()}function $R(t){return Qu(t)&&!If(t).jo()&&t.D_.size>0}function Qu(t){return 0===fe(t).C_.size}function yz(t){t.x_=void 0}function Ble(t){return HR.apply(this,arguments)}function HR(){return HR=(0,Z.Z)(function*(t){t.D_.forEach((e,n)=>{BR(t,e)})}),HR.apply(this,arguments)}function jle(t,e){return zR.apply(this,arguments)}function zR(){return zR=(0,Z.Z)(function*(t,e){yz(t),$R(t)?(t.M_.w_(e),jR(t)):t.M_.set("Unknown")}),zR.apply(this,arguments)}function $le(t,e,n){return WR.apply(this,arguments)}function WR(){return WR=(0,Z.Z)(function*(t,e,n){if(t.M_.set("Online"),e instanceof hH&&2===e.state&&e.cause)try{yield(r=(0,Z.Z)(function*(s,o){const a=o.cause;for(const u of o.targetIds)s.D_.has(u)&&(yield s.remoteSyncer.rejectListen(u,a),s.D_.delete(u),s.x_.removeTarget(u))}),function i(s,o){return r.apply(this,arguments)})(t,e)}catch(r){re("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Cw(t,r)}else if(e instanceof aw?t.x_.$e(e):e instanceof dH?t.x_.Je(e):t.x_.Ge(e),!n.isEqual(be.min()))try{const r=yield oz(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){const a=s.x_.it(o);return a.targetChanges.forEach((u,l)=>{if(u.resumeToken.approximateByteSize()>0){const d=s.D_.get(l);d&&s.D_.set(l,d.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,l)=>{const d=s.D_.get(u);if(!d)return;s.D_.set(u,d.withResumeToken(_r.EMPTY_BYTE_STRING,d.snapshotVersion)),_z(s,u);const f=new qa(d.target,u,l,d.sequenceNumber);BR(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){re("RemoteStore","Failed to raise snapshot:",r),yield Cw(t,r)}var r}),WR.apply(this,arguments)}function Cw(t,e,n){return qR.apply(this,arguments)}function qR(){return qR=(0,Z.Z)(function*(t,e,n){if(!Vu(e))throw e;t.C_.add(1),yield vf(t),t.M_.set("Offline"),n||(n=()=>oz(t.localStore)),t.asyncQueue.enqueueRetryable((0,Z.Z)(function*(){re("RemoteStore","Retrying IndexedDB access"),yield n(),t.C_.delete(1),yield n_(t)}))}),qR.apply(this,arguments)}function vz(t,e){return e().catch(n=>Cw(t,n,e))}function Ef(t){return GR.apply(this,arguments)}function GR(){return GR=(0,Z.Z)(function*(t){const e=fe(t),n=Yu(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;Hle(e);)try{const i=yield Ale(e.localStore,r);if(null===i){0===e.b_.length&&n.Zo();break}r=i.batchId,zle(e,i)}catch(i){yield Cw(e,i)}Ez(e)&&Iz(e)}),GR.apply(this,arguments)}function Hle(t){return Qu(t)&&t.b_.length<10}function zle(t,e){t.b_.push(e);const n=Yu(t);n.Ho()&&n.h_&&n.P_(e.mutations)}function Ez(t){return Qu(t)&&!Yu(t).jo()&&t.b_.length>0}function Iz(t){Yu(t).start()}function Wle(t){return KR.apply(this,arguments)}function KR(){return KR=(0,Z.Z)(function*(t){Yu(t).E_()}),KR.apply(this,arguments)}function qle(t){return ZR.apply(this,arguments)}function ZR(){return ZR=(0,Z.Z)(function*(t){const e=Yu(t);for(const n of t.b_)e.P_(n.mutations)}),ZR.apply(this,arguments)}function Gle(t,e,n){return QR.apply(this,arguments)}function QR(){return QR=(0,Z.Z)(function*(t,e,n){const r=t.b_.shift(),i=oR.from(r,e,n);yield vz(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield Ef(t)}),QR.apply(this,arguments)}function Kle(t,e){return YR.apply(this,arguments)}function YR(){return YR=(0,Z.Z)(function*(t,e){var n;e&&Yu(t).h_&&(yield(n=(0,Z.Z)(function*(i,s){if(oH(a=s.code)&&a!==z.ABORTED){const o=i.b_.shift();Yu(i).Yo(),yield vz(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield Ef(i)}var a}),function r(i,s){return n.apply(this,arguments)})(t,e)),Ez(t)&&Iz(t)}),YR.apply(this,arguments)}function wz(t,e){return XR.apply(this,arguments)}function XR(){return XR=(0,Z.Z)(function*(t,e){const n=fe(t);n.asyncQueue.verifyOperationInProgress(),re("RemoteStore","RemoteStore received new credentials");const r=Qu(n);n.C_.add(3),yield vf(n),r&&n.M_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.C_.delete(3),yield n_(n)}),XR.apply(this,arguments)}function JR(t,e){return eP.apply(this,arguments)}function eP(){return eP=(0,Z.Z)(function*(t,e){const n=fe(t);e?(n.C_.delete(2),yield n_(n)):e||(n.C_.add(2),yield vf(n),n.M_.set("Unknown"))}),eP.apply(this,arguments)}function If(t){return t.O_||(t.O_=function(n,r,i){const s=fe(n);return s.A_(),new kle(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:Ble.bind(null,t),Io:jle.bind(null,t),a_:$le.bind(null,t)}),t.v_.push(function(){var e=(0,Z.Z)(function*(n){n?(t.O_.Yo(),$R(t)?jR(t):t.M_.set("Unknown")):(yield t.O_.stop(),yz(t))});return function(n){return e.apply(this,arguments)}}())),t.O_}function Yu(t){return t.N_||(t.N_=function(n,r,i){const s=fe(n);return s.A_(),new Ole(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:Wle.bind(null,t),Io:Kle.bind(null,t),T_:qle.bind(null,t),I_:Gle.bind(null,t)}),t.v_.push(function(){var e=(0,Z.Z)(function*(n){n?(t.N_.Yo(),yield Ef(t)):(yield t.N_.stop(),t.b_.length>0&&(re("RemoteStore",`Stopping write stream with ${t.b_.length} pending writes`),t.b_=[]))});return function(n){return e.apply(this,arguments)}}())),t.N_}class tP{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new mr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new tP(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new te(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function wf(t,e){if(Jn("AsyncQueue",`${e}: ${t}`),Vu(t))return new te(z.UNAVAILABLE,`${e}: ${t}`);throw t}class Tf{constructor(e){this.comparator=e?(n,r)=>e(n,r)||pe.comparator(n.key,r.key):(n,r)=>pe.comparator(n.key,r.key),this.keyedMap=Vm(),this.sortedSet=new dn(this.comparator)}static emptySet(e){return new Tf(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Tf)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,n){const r=new Tf;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class Tz{constructor(){this.B_=new dn(pe.comparator)}track(e){const n=e.doc.key,r=this.B_.get(n);r?0!==e.type&&3===r.type?this.B_=this.B_.insert(n,e):3===e.type&&1!==r.type?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.B_=this.B_.remove(n):1===e.type&&2===r.type?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):Ee():this.B_=this.B_.insert(n,e)}L_(){const e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Cf{constructor(e,n,r,i,s,o,a,u,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Cf(e,n,Tf.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Lm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}class Zle{constructor(){this.k_=void 0,this.listeners=[]}}class Qle{constructor(){this.queries=new za(e=>j$(e),Lm),this.onlineState="Unknown",this.q_=new Set}}function nP(t,e){return rP.apply(this,arguments)}function rP(){return rP=(0,Z.Z)(function*(t,e){const n=fe(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new Zle),i)try{s.k_=yield n.onListen(r)}catch(o){const a=wf(o,`Initialization of query '${sf(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.listeners.push(e),e.Q_(n.onlineState),s.k_&&e.K_(s.k_)&&oP(n)}),rP.apply(this,arguments)}function iP(t,e){return sP.apply(this,arguments)}function sP(){return sP=(0,Z.Z)(function*(t,e){const n=fe(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}),sP.apply(this,arguments)}function Yle(t,e){const n=fe(t);let r=!1;for(const i of e){const o=n.queries.get(i.query);if(o){for(const a of o.listeners)a.K_(i)&&(r=!0);o.k_=i}}r&&oP(n)}function Xle(t,e,n){const r=fe(t),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(e)}function oP(t){t.q_.forEach(e=>{e.next()})}class aP{constructor(e,n,r){this.query=e,this.U_=n,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new Cf(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.W_?this.z_(e)&&(this.U_.next(e),n=!0):this.j_(e,this.onlineState)&&(this.H_(e),n=!0),this.G_=e,n}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let n=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),n=!0),n}j_(e,n){return!e.fromCache||(!this.options.J_||!("Offline"!==n))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===n)}z_(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}H_(e){e=Cf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}class Jle{constructor(e,n){this.Y_=e,this.byteLength=n}Z_(){return"metadata"in this.Y_}}class Cz{constructor(e){this.serializer=e}hs(e){return na(this.serializer,e)}Ps(e){return e.metadata.exists?IH(this.serializer,e.document,!1):_n.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return er(e)}}class ece{constructor(e,n,r){this.X_=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Sz(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++n;const r=St.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ta(e){const n=new Map,r=new Cz(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const o of i.metadata.queries){const a=(n.get(o)||rt()).add(s);n.set(o,a)}}return n}complete(){var e=this;return(0,Z.Z)(function*(){const n=yield function ble(t,e,n,r){return RR.apply(this,arguments)}(e.localStore,new Cz(e.serializer),e.documents,e.X_.id),r=e.ta(e.documents);for(const i of e.queries)yield Rle(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,na:e.collectionGroups,ra:n}})()}}function Sz(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}class Dz{constructor(e){this.key=e}}class Az{constructor(e){this.key=e}}class bz{constructor(e,n){this.query=e,this.ia=n,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=rt(),this.mutatedKeys=rt(),this._a=H$(e),this.aa=new Tf(this._a)}get ua(){return this.ia}ca(e,n){const r=n?n.la:new Tz,i=n?n.aa:this.aa;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,f)=>{const m=i.get(d),_=Fm(this.query,f)?f:null,v=!!m&&this.mutatedKeys.has(m.key),T=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let D=!1;m&&_?m.data.isEqual(_.data)?v!==T&&(r.track({type:3,doc:_}),D=!0):this.ha(m,_)||(r.track({type:2,doc:_}),D=!0,(u&&this._a(_,u)>0||l&&this._a(_,l)<0)&&(a=!0)):!m&&_?(r.track({type:0,doc:_}),D=!0):m&&!_&&(r.track({type:1,doc:m}),D=!0,(u||l)&&(a=!0)),D&&(_?(o=o.add(_),s=T?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const d="F"===this.query.limitType?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{aa:o,la:r,Zi:a,mutatedKeys:s}}ha(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const o=e.la.L_();o.sort((d,f)=>function(_,v){const T=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ee()}};return T(_)-T(v)}(d.type,f.type)||this._a(d.doc,f.doc)),this.Pa(r),i=null!=i&&i;const a=n&&!i?this.Ia():[],u=0===this.oa.size&&this.current&&!i?1:0,l=u!==this.sa;return this.sa=u,0!==o.length||l?{snapshot:new Cf(this.query,e.aa,s,o,e.mutatedKeys,0===u,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:a}:{Ta:a}}Q_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({aa:this.aa,la:new Tz,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(n=>this.ia=this.ia.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ia=this.ia.delete(n)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=rt(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const n=[];return e.forEach(r=>{this.oa.has(r)||n.push(new Az(r))}),this.oa.forEach(r=>{e.has(r)||n.push(new Dz(r))}),n}da(e){this.ia=e.ls,this.oa=rt();const n=this.ca(e.documents);return this.applyChanges(n,!0)}Aa(){return Cf.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,0===this.sa,this.hasCachedResults)}}class tce{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class nce{constructor(e){this.key=e,this.Ra=!1}}class rce{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Va={},this.ma=new za(a=>j$(a),Lm),this.fa=new Map,this.ga=new Set,this.pa=new dn(pe.comparator),this.ya=new Map,this.wa=new IR,this.Sa={},this.ba=new Map,this.Da=Pc.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return!0===this.Ca}}function ice(t,e){return uP.apply(this,arguments)}function uP(){return uP=(0,Z.Z)(function*(t,e){const n=NP(t);let r,i;const s=n.ma.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const o=yield _f(n.localStore,bi(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield lP(n,e,r,"current"===a,o.resumeToken),n.isPrimaryClient&&Tw(n.remoteStore,o)}return i}),uP.apply(this,arguments)}function lP(t,e,n,r,i){return cP.apply(this,arguments)}function cP(){return cP=(0,Z.Z)(function*(t,e,n,r,i){t.va=(f,m,_)=>{return(v=(0,Z.Z)(function*(D,x,R,L){let G=x.view.ca(R);G.Zi&&(G=yield yw(D.localStore,x.query,!1).then(({documents:Bt})=>x.view.ca(Bt,G)));const ae=L&&L.targetChanges.get(x.targetId),ye=L&&null!=L.targetMismatches.get(x.targetId),Qe=x.view.applyChanges(G,D.isPrimaryClient,ae,ye);return EP(D,x.targetId,Qe.Ta),Qe.snapshot}),function T(D,x,R,L){return v.apply(this,arguments)})(t,f,m,_);var v};const s=yield yw(t.localStore,e,!0),o=new bz(e,s.ls),a=o.ca(s.documents),u=zm.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState,i),l=o.applyChanges(a,t.isPrimaryClient,u);EP(t,n,l.Ta);const d=new tce(e,n,o);return t.ma.set(e,d),t.fa.has(n)?t.fa.get(n).push(e):t.fa.set(n,[e]),l.snapshot}),cP.apply(this,arguments)}function sce(t,e){return dP.apply(this,arguments)}function dP(){return dP=(0,Z.Z)(function*(t,e){const n=fe(t),r=n.ma.get(e),i=n.fa.get(r.targetId);if(i.length>1)return n.fa.set(r.targetId,i.filter(s=>!Lm(s,e))),void n.ma.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield yf(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),r_(n.remoteStore,r.targetId),Sf(n,r.targetId)}).catch(Fu))):(Sf(n,r.targetId),yield yf(n.localStore,r.targetId,!0))}),dP.apply(this,arguments)}function hP(){return hP=(0,Z.Z)(function*(t,e,n){const r=MP(t);try{const i=yield function(o,a){const u=fe(o),l=Tn.now(),d=a.reduce((_,v)=>_.add(v.key),rt());let f,m;return u.persistence.runTransaction("Locally write mutations","readwrite",_=>{let v=Gi(),T=rt();return u.ss.getEntries(_,d).next(D=>{v=D,v.forEach((x,R)=>{R.isValidDocument()||(T=T.add(x))})}).next(()=>u.localDocuments.getOverlayedDocuments(_,v)).next(D=>{f=D;const x=[];for(const R of a){const L=Oue(R,f.get(R.key).overlayedDocument);null!=L&&x.push(new Wa(R.key,L,D$(L.value.mapValue),Cn.exists(!0)))}return u.mutationQueue.addMutationBatch(_,l,x,a)}).next(D=>{m=D;const x=D.applyToLocalDocumentSet(f,T);return u.documentOverlayCache.saveOverlays(_,D.batchId,x)})}).then(()=>({batchId:m.batchId,changes:W$(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let l=o.Sa[o.currentUser.toKey()];l||(l=new dn(Ze)),l=l.insert(a,u),o.Sa[o.currentUser.toKey()]=l}(r,i.batchId,n),yield Ga(r,i.changes),yield Ef(r.remoteStore)}catch(i){const s=wf(i,"Failed to persist write");n.reject(s)}}),hP.apply(this,arguments)}function Rz(t,e){return fP.apply(this,arguments)}function fP(){return fP=(0,Z.Z)(function*(t,e){const n=fe(t);try{const r=yield function Dle(t,e){const n=fe(t),r=e.snapshotVersion;let i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;const a=[];e.targetChanges.forEach((d,f)=>{const m=i.get(f);if(!m)return;a.push(n.qr.removeMatchingKeys(s,d.removedDocuments,f).next(()=>n.qr.addMatchingKeys(s,d.addedDocuments,f)));let _=m.withSequenceNumber(s.currentSequenceNumber);var T,D,x;null!==e.targetMismatches.get(f)?_=_.withResumeToken(_r.EMPTY_BYTE_STRING,be.min()).withLastLimboFreeSnapshotVersion(be.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),i=i.insert(f,_),D=_,x=d,(0===(T=m).resumeToken.approximateByteSize()||D.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=3e8||x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0)&&a.push(n.qr.updateTargetData(s,_))});let u=Gi(),l=rt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(az(s,o,e.documentUpdates).next(d=>{u=d.us,l=d.cs})),!r.isEqual(be.min())){const d=n.qr.getLastRemoteSnapshotVersion(s).next(f=>n.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return F.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,l)).next(()=>u)}).then(s=>(n.ts=i,s))}(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.ya.get(s);o&&(De(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ra=!0:i.modifiedDocuments.size>0?De(o.Ra):i.removedDocuments.size>0&&(De(o.Ra),o.Ra=!1))}),yield Ga(n,r,e)}catch(r){yield Fu(r)}}),fP.apply(this,arguments)}function Pz(t,e,n){const r=fe(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const i=[];r.ma.forEach((s,o)=>{const a=o.view.Q_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const u=fe(o);u.onlineState=a;let l=!1;u.queries.forEach((d,f)=>{for(const m of f.listeners)m.Q_(a)&&(l=!0)}),l&&oP(u)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function ace(t,e,n){return pP.apply(this,arguments)}function pP(){return pP=(0,Z.Z)(function*(t,e,n){const r=fe(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.ya.get(e),s=i&&i.key;if(s){let o=new dn(pe.comparator);o=o.insert(s,_n.newNoDocument(s,be.min()));const a=rt().add(s),u=new Hm(be.min(),new Map,new dn(Ze),o,a);yield Rz(r,u),r.pa=r.pa.remove(s),r.ya.delete(e),IP(r)}else yield yf(r.localStore,e,!1).then(()=>Sf(r,e,n)).catch(Fu)}),pP.apply(this,arguments)}function uce(t,e){return gP.apply(this,arguments)}function gP(){return gP=(0,Z.Z)(function*(t,e){const n=fe(t),r=e.batch.batchId;try{const i=yield function Sle(t,e){const n=fe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.ss.newChangeBuffer({trackRemovals:!0});return function(a,u,l,d){const f=l.batch,m=f.keys();let _=F.resolve();return m.forEach(v=>{_=_.next(()=>d.getEntry(u,v)).next(T=>{const D=l.docVersions.get(v);De(null!==D),T.version.compareTo(D)<0&&(f.applyToRemoteDocument(T,l),T.isValidDocument()&&(T.setReadTime(l.commitVersion),d.addEntry(T)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(u,f))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=rt();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(u=u.add(a.batch.mutations[l].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}(n.localStore,e);vP(n,r,null),yP(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield Ga(n,i)}catch(i){yield Fu(i)}}),gP.apply(this,arguments)}function lce(t,e,n){return mP.apply(this,arguments)}function mP(){return mP=(0,Z.Z)(function*(t,e,n){const r=fe(t);try{const i=yield function(o,a){const u=fe(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return u.mutationQueue.lookupMutationBatch(l,a).next(f=>(De(null!==f),d=f.keys(),u.mutationQueue.removeMutationBatch(l,f))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>u.localDocuments.getDocuments(l,d))})}(r.localStore,e);vP(r,e,n),yP(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield Ga(r,i)}catch(i){yield Fu(i)}}),mP.apply(this,arguments)}function _P(){return _P=(0,Z.Z)(function*(t,e){const n=fe(t);Qu(n.remoteStore)||re("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(o){const a=fe(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(n.localStore);if(-1===r)return void e.resolve();const i=n.ba.get(r)||[];i.push(e),n.ba.set(r,i)}catch(r){const i=wf(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),_P.apply(this,arguments)}function yP(t,e){(t.ba.get(e)||[]).forEach(n=>{n.resolve()}),t.ba.delete(e)}function vP(t,e,n){const r=fe(t);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function Sf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.fa.get(e))t.ma.delete(r),n&&t.Va.Fa(r,n);t.fa.delete(e),t.isPrimaryClient&&t.wa.Rr(e).forEach(r=>{t.wa.containsKey(r)||Nz(t,r)})}function Nz(t,e){t.ga.delete(e.path.canonicalString());const n=t.pa.get(e);null!==n&&(r_(t.remoteStore,n),t.pa=t.pa.remove(e),t.ya.delete(n),IP(t))}function EP(t,e,n){for(const r of n)r instanceof Dz?(t.wa.addReference(r.key,e),dce(t,r)):r instanceof Az?(re("SyncEngine","Document no longer in limbo: "+r.key),t.wa.removeReference(r.key,e),t.wa.containsKey(r.key)||Nz(t,r.key)):Ee()}function dce(t,e){const n=e.key,r=n.path.canonicalString();t.pa.get(n)||t.ga.has(r)||(re("SyncEngine","New document in limbo: "+n),t.ga.add(r),IP(t))}function IP(t){for(;t.ga.size>0&&t.pa.size<t.maxConcurrentLimboResolutions;){const e=t.ga.values().next().value;t.ga.delete(e);const n=new pe(St.fromString(e)),r=t.Da.next();t.ya.set(r,new nce(n)),t.pa=t.pa.insert(n,r),Tw(t.remoteStore,new qa(bi(nf(n.path)),r,"TargetPurposeLimboResolution",Is._e))}}function Ga(t,e,n){return wP.apply(this,arguments)}function wP(){return wP=(0,Z.Z)(function*(t,e,n){const r=fe(t),i=[],s=[],o=[];var a;r.ma.isEmpty()||(r.ma.forEach((a,u)=>{o.push(r.va(u,e,n).then(l=>{if((l||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,l?.fromCache?"not-current":"current"),l){i.push(l);const d=DR.Qi(u.targetId,l);s.push(d)}}))}),yield Promise.all(o),r.Va.a_(i),yield(a=(0,Z.Z)(function*(l,d){const f=fe(l);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>F.forEach(d,_=>F.forEach(_.ki,v=>f.persistence.referenceDelegate.addReference(m,_.targetId,v)).next(()=>F.forEach(_.qi,v=>f.persistence.referenceDelegate.removeReference(m,_.targetId,v)))))}catch(m){if(!Vu(m))throw m;re("LocalStore","Failed to update sequence numbers: "+m)}for(const m of d){const _=m.targetId;if(!m.fromCache){const v=f.ts.get(_),D=v.withLastLimboFreeSnapshotVersion(v.snapshotVersion);f.ts=f.ts.insert(_,D)}}}),function u(l,d){return a.apply(this,arguments)})(r.localStore,s))}),wP.apply(this,arguments)}function hce(t,e){return TP.apply(this,arguments)}function TP(){return TP=(0,Z.Z)(function*(t,e){const n=fe(t);if(!n.currentUser.isEqual(e)){re("SyncEngine","User change. New user:",e.toKey());const r=yield sz(n.localStore,e);n.currentUser=e,(s=n).ba.forEach(a=>{a.forEach(u=>{u.reject(new te(z.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.ba.clear(),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Ga(n,r._s)}var s}),TP.apply(this,arguments)}function fce(t,e){const n=fe(t),r=n.ya.get(e);if(r&&r.Ra)return rt().add(r.key);{let i=rt();const s=n.fa.get(e);if(!s)return i;for(const o of s){const a=n.ma.get(o);i=i.unionWith(a.view.ua)}return i}}function pce(t,e){return CP.apply(this,arguments)}function CP(){return CP=(0,Z.Z)(function*(t,e){const n=fe(t),r=yield yw(n.localStore,e.query,!0),i=e.view.da(r);return n.isPrimaryClient&&EP(n,e.targetId,i.Ta),i}),CP.apply(this,arguments)}function gce(t,e){return SP.apply(this,arguments)}function SP(){return SP=(0,Z.Z)(function*(t,e){const n=fe(t);return lz(n.localStore,e).then(r=>Ga(n,r))}),SP.apply(this,arguments)}function mce(t,e,n,r){return DP.apply(this,arguments)}function DP(){return DP=(0,Z.Z)(function*(t,e,n,r){const i=fe(t),s=yield function(a,u){const l=fe(a),d=fe(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.Cn(f,u).next(m=>m?l.localDocuments.getDocuments(f,m):F.resolve(null)))}(i.localStore,e);var u;null!==s?("pending"===n?yield Ef(i.remoteStore):"acknowledged"===n||"rejected"===n?(vP(i,e,r||null),yP(i,e),u=e,fe(fe(i.localStore).mutationQueue).Fn(u)):Ee(),yield Ga(i,s)):re("SyncEngine","Cannot apply mutation batch with id: "+e)}),DP.apply(this,arguments)}function AP(){return AP=(0,Z.Z)(function*(t,e){const n=fe(t);if(NP(n),MP(n),!0===e&&!0!==n.Ca){const r=n.sharedClientState.getAllActiveQueryTargets(),i=yield Mz(n,r.toArray());n.Ca=!0,yield JR(n.remoteStore,!0);for(const s of i)Tw(n.remoteStore,s)}else if(!1===e&&!1!==n.Ca){const r=[];let i=Promise.resolve();n.fa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Sf(n,o),yf(n.localStore,o,!0))),r_(n.remoteStore,o)}),yield i,yield Mz(n,r),function(o){const a=fe(o);a.ya.forEach((u,l)=>{r_(a.remoteStore,l)}),a.wa.Vr(),a.ya=new Map,a.pa=new dn(pe.comparator)}(n),n.Ca=!1,yield JR(n.remoteStore,!1)}}),AP.apply(this,arguments)}function Mz(t,e,n){return bP.apply(this,arguments)}function bP(){return bP=(0,Z.Z)(function*(t,e,n){const r=fe(t),i=[],s=[];for(const o of e){let a;const u=r.fa.get(o);if(u&&0!==u.length){a=yield _f(r.localStore,bi(u[0]));for(const l of u){const d=r.ma.get(l),f=yield pce(r,d);f.snapshot&&s.push(f.snapshot)}}else{const l=yield uz(r.localStore,o);a=yield _f(r.localStore,l),yield lP(r,xz(l),o,!1,a.resumeToken)}i.push(a)}return r.Va.a_(s),i}),bP.apply(this,arguments)}function xz(t){return V$(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function yce(t){return n=fe(t).localStore,fe(fe(n).persistence).Bi();var n}function vce(t,e,n,r){return RP.apply(this,arguments)}function RP(){return RP=(0,Z.Z)(function*(t,e,n,r){const i=fe(t);if(i.Ca)return void re("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=yield lz(i.localStore,$$(s[0])),a=Hm.createSynthesizedRemoteEventForCurrentChange(e,"current"===n,_r.EMPTY_BYTE_STRING);yield Ga(i,o,a);break}case"rejected":yield yf(i.localStore,e,!0),Sf(i,e,r);break;default:Ee()}}),RP.apply(this,arguments)}function Ece(t,e,n){return PP.apply(this,arguments)}function PP(){return PP=(0,Z.Z)(function*(t,e,n){const r=NP(t);if(r.Ca){for(const i of e){if(r.fa.has(i)){re("SyncEngine","Adding an already active target "+i);continue}const s=yield uz(r.localStore,i),o=yield _f(r.localStore,s);yield lP(r,xz(s),o.targetId,!1,o.resumeToken),Tw(r.remoteStore,o)}for(const i of n)r.fa.has(i)&&(yield yf(r.localStore,i,!1).then(()=>{r_(r.remoteStore,i),Sf(r,i)}).catch(Fu))}}),PP.apply(this,arguments)}function NP(t){const e=fe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Rz.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=fce.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ace.bind(null,e),e.Va.a_=Yle.bind(null,e.eventManager),e.Va.Fa=Xle.bind(null,e.eventManager),e}function MP(t){const e=fe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=uce.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lce.bind(null,e),e}class i_{constructor(){this.synchronizeTabs=!1}initialize(e){var n=this;return(0,Z.Z)(function*(){n.serializer=t_(e.databaseInfo.databaseId),n.sharedClientState=n.createSharedClientState(e),n.persistence=n.createPersistence(e),yield n.persistence.start(),n.localStore=n.createLocalStore(e),n.gcScheduler=n.createGarbageCollectionScheduler(e,n.localStore),n.indexBackfillerScheduler=n.createIndexBackfillerScheduler(e,n.localStore)})()}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return iz(this.persistence,new rz,e.initialUser,this.serializer)}createPersistence(e){return new wR(gw.jr,this.serializer)}createSharedClientState(e){return new fz}terminate(){var e=this;return(0,Z.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class xP extends i_{constructor(e,n,r){super(),this.xa=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var n=()=>super.initialize,r=this;return(0,Z.Z)(function*(){yield n().call(r,e),yield r.xa.initialize(r,e),yield MP(r.xa.syncEngine),yield Ef(r.xa.remoteStore),yield r.persistence.mi(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return iz(this.persistence,new rz,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){return new KH(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){const r=new Gae(n,this.persistence);return new qae(e.asyncQueue,r)}createPersistence(e){const n=SR(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?ui.withCacheSize(this.cacheSizeBytes):ui.DEFAULT;return new CR(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,gz(),ww(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new fz}}class kz extends xP{constructor(e,n){super(e,n,!1),this.xa=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){var n=()=>super.initialize,r=this;return(0,Z.Z)(function*(){yield n().call(r,e);const i=r.xa.syncEngine;r.sharedClientState instanceof kR&&(r.sharedClientState.syncEngine={Ys:mce.bind(null,i),Zs:vce.bind(null,i),Xs:Ece.bind(null,i),Bi:yce.bind(null,i),Js:gce.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.mi(function(){var s=(0,Z.Z)(function*(o){yield function _ce(t,e){return AP.apply(this,arguments)}(r.xa.syncEngine,o),r.gcScheduler&&(o&&!r.gcScheduler.started?r.gcScheduler.start():o||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(o&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():o||r.indexBackfillerScheduler.stop())});return function(o){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const n=gz();if(!kR.D(n))throw new te(z.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=SR(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new kR(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class Df{initialize(e,n){var r=this;return(0,Z.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(n),r.remoteStore=r.createRemoteStore(n),r.eventManager=r.createEventManager(n),r.syncEngine=r.createSyncEngine(n,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>Pz(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=hce.bind(null,r.syncEngine),yield JR(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new Qle}createDatastore(e){const n=t_(e.databaseInfo.databaseId),r=new xle(e.databaseInfo);return new Lle(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return r=this.localStore,i=this.datastore,s=e.asyncQueue,o=n=>Pz(this.syncEngine,n,0),a=pz.D()?new pz:new Ple,new Ule(r,i,s,o,a);var r,i,s,o,a}createSyncEngine(e,n){return function(i,s,o,a,u,l,d){const f=new rce(i,s,o,a,u,l);return d&&(f.Ca=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return(e=(0,Z.Z)(function*(r){const i=fe(r);re("RemoteStore","RemoteStore shutting down."),i.C_.add(5),yield vf(i),i.F_.shutdown(),i.M_.set("Unknown")}),function n(r){return e.apply(this,arguments)})(this.remoteStore);var e}}function Oz(t,e=10240){let n=0;return{read:()=>(0,Z.Z)(function*(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}})(),cancel:()=>(0,Z.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class Sw{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):Jn("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}class Tce{constructor(e,n){this.Ba=e,this.serializer=n,this.metadata=new mr,this.buffer=new Uint8Array,this.La=new TextDecoder("utf-8"),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}getMetadata(){var e=this;return(0,Z.Z)(function*(){return e.metadata.promise})()}Ma(){var e=this;return(0,Z.Z)(function*(){return yield e.getMetadata(),e.ka()})()}ka(){var e=this;return(0,Z.Z)(function*(){const n=yield e.qa();if(null===n)return null;const r=e.La.decode(n),i=Number(r);isNaN(i)&&e.Qa(`length string (${r}) is not valid number`);const s=yield e.Ka(i);return new Jle(JSON.parse(s),n.length+i)})()}$a(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}qa(){var e=this;return(0,Z.Z)(function*(){for(;e.$a()<0&&!(yield e.Ua()););if(0===e.buffer.length)return null;const n=e.$a();n<0&&e.Qa("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,n);return e.buffer=e.buffer.slice(n),r})()}Ka(e){var n=this;return(0,Z.Z)(function*(){for(;n.buffer.length<e;)(yield n.Ua())&&n.Qa("Reached the end of bundle when more is expected.");const r=n.La.decode(n.buffer.slice(0,e));return n.buffer=n.buffer.slice(e),r})()}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}Ua(){var e=this;return(0,Z.Z)(function*(){const n=yield e.Ba.read();if(!n.done){const r=new Uint8Array(e.buffer.length+n.value.length);r.set(e.buffer),r.set(n.value,e.buffer.length),e.buffer=r}return n.done})()}}class Cce{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var n=this;return(0,Z.Z)(function*(){if(n.ensureCommitNotCalled(),n.mutations.length>0)throw new te(z.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,Z.Z)(function*(o,a){const u=fe(o),l=qm(u.serializer)+"/documents",d={documents:a.map(v=>Wm(u.serializer,v))},f=yield u.Co("BatchGetDocuments",l,d,a.length),m=new Map;f.forEach(v=>{const T=function Wue(t,e){return"found"in e?function(r,i){De(!!i.found);const s=na(r,i.found.name),o=er(i.found.updateTime),a=i.found.createTime?er(i.found.createTime):be.min(),u=new qr({mapValue:{fields:i.found.fields}});return _n.newFoundDocument(s,o,a,u)}(t,e):"missing"in e?function(r,i){De(!!i.missing),De(!!i.readTime);const s=na(r,i.missing),o=er(i.readTime);return _n.newNoDocument(s,o)}(t,e):Ee()}(u.serializer,v);m.set(T.key.toString(),T)});const _=[];return a.forEach(v=>{const T=m.get(v.toString());De(!!T),_.push(T)}),_}),function s(o,a){return i.apply(this,arguments)})(n.datastore,e);var i;return r.forEach(i=>n.recordVersion(i)),r})()}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new cf(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,Z.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const n=e.readVersions;var r;e.mutations.forEach(r=>{n.delete(r.key.toString())}),n.forEach((r,i)=>{const s=pe.fromPath(i);e.mutations.push(new iR(s,e.precondition(s)))}),yield(r=(0,Z.Z)(function*(s,o){const a=fe(s),u=qm(a.serializer)+"/documents",l={writes:o.map(d=>Gm(a.serializer,d))};yield a.wo("Commit",u,l)}),function i(s,o){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw Ee();n=be.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new te(z.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(be.min())?Cn.exists(!1):Cn.updateTime(n):Cn.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(be.min()))throw new te(z.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Cn.updateTime(n)}return Cn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Sce{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new LR(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){var e=this;this.zo.ko((0,Z.Z)(function*(){const n=new Cce(e.datastore),r=e.za(n);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>n.commit().then(()=>{e.deferred.resolve(i)}).catch(s=>{e.ja(s)}))}).catch(i=>{e.ja(i)})}))}za(e){try{const n=this.updateFunction(e);return!bm(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if("FirebaseError"===e.name){const n=e.code;return"aborted"===n||"failed-precondition"===n||"already-exists"===n||!oH(n)}return!1}}class Dce{constructor(e,n,r,i){var s=this;this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Ar.UNAUTHENTICATED,this.clientId=n$.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=(0,Z.Z)(function*(a){re("FirestoreClient","Received user=",a.uid),yield s.authCredentialListener(a),s.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(re("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var e=this;return(0,Z.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new te(z.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const n=new mr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,Z.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),n.resolve()}catch(r){const i=wf(r,"Failed to shutdown persistence");n.reject(i)}})),n.promise}}function Dw(t,e){return kP.apply(this,arguments)}function kP(){return kP=(0,Z.Z)(function*(t,e){t.asyncQueue.verifyOperationInProgress(),re("FirestoreClient","Initializing OfflineComponentProvider");const n=yield t.getConfiguration();yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(function(){var i=(0,Z.Z)(function*(s){r.isEqual(s)||(yield sz(e.localStore,s),r=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}),kP.apply(this,arguments)}function OP(t,e){return LP.apply(this,arguments)}function LP(){return LP=(0,Z.Z)(function*(t,e){t.asyncQueue.verifyOperationInProgress();const n=yield FP(t);re("FirestoreClient","Initializing OnlineComponentProvider");const r=yield t.getConfiguration();yield e.initialize(n,r),t.setCredentialChangeListener(i=>wz(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>wz(e.remoteStore,s)),t._onlineComponents=e}),LP.apply(this,arguments)}function Lz(t){return"FirebaseError"===t.name?t.code===z.FAILED_PRECONDITION||t.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}function FP(t){return VP.apply(this,arguments)}function VP(){return VP=(0,Z.Z)(function*(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){re("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Dw(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!Lz(n))throw n;Wi("Error using user provided cache. Falling back to memory cache: "+n),yield Dw(t,new i_)}}else re("FirestoreClient","Using default OfflineComponentProvider"),yield Dw(t,new i_);return t._offlineComponents}),VP.apply(this,arguments)}function Aw(t){return UP.apply(this,arguments)}function UP(){return UP=(0,Z.Z)(function*(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(re("FirestoreClient","Using user provided OnlineComponentProvider"),yield OP(t,t._uninitializedComponentsProvider._online)):(re("FirestoreClient","Using default OnlineComponentProvider"),yield OP(t,new Df))),t._onlineComponents}),UP.apply(this,arguments)}function Fz(t){return FP(t).then(e=>e.persistence)}function Af(t){return FP(t).then(e=>e.localStore)}function Vz(t){return Aw(t).then(e=>e.remoteStore)}function BP(t){return Aw(t).then(e=>e.syncEngine)}function bf(t){return jP.apply(this,arguments)}function jP(){return jP=(0,Z.Z)(function*(t){const e=yield Aw(t),n=e.eventManager;return n.onListen=ice.bind(null,e.syncEngine),n.onUnlisten=sce.bind(null,e.syncEngine),n}),jP.apply(this,arguments)}function Bz(t,e,n={}){const r=new mr;return t.asyncQueue.enqueueAndForget((0,Z.Z)(function*(){return function(s,o,a,u,l){const d=new Sw({next:m=>{o.enqueueAndForget(()=>iP(s,f));const _=m.docs.has(a);!_&&m.fromCache?l.reject(new te(z.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&u&&"server"===u.source?l.reject(new te(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),f=new aP(nf(a.path),d,{includeMetadataChanges:!0,J_:!0});return nP(s,f)}(yield bf(t),t.asyncQueue,e,n,r)})),r.promise}function jz(t,e,n={}){const r=new mr;return t.asyncQueue.enqueueAndForget((0,Z.Z)(function*(){return function(s,o,a,u,l){const d=new Sw({next:m=>{o.enqueueAndForget(()=>iP(s,f)),m.fromCache&&"server"===u.source?l.reject(new te(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),f=new aP(a,d,{includeMetadataChanges:!0,J_:!0});return nP(s,f)}(yield bf(t),t.asyncQueue,e,n,r)})),r.promise}function $z(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const Hz=new Map;function $P(t,e,n){if(!n)throw new te(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function zz(t,e,n,r){if(!0===e&&!0===r)throw new te(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Wz(t){if(!pe.isDocumentKey(t))throw new te(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function qz(t){if(pe.isDocumentKey(t))throw new te(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function bw(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=(r=t).constructor?r.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var r;return"function"==typeof t?"a function":Ee()}function _t(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new te(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=bw(t);throw new te(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Gz(t,e){if(e<=0)throw new te(z.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}class Kz{constructor(e){var n,r;if(void 0===e.host){if(void 0!==e.ssl)throw new te(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(n=e.ssl)||void 0===n||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new te(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}zz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=$z(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(s){if(void 0!==s.timeoutSeconds){if(isNaN(s.timeoutSeconds))throw new te(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new te(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new te(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class s_{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Kz({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new te(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new te(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Kz(e),void 0!==e.credentials&&(this._authCredentials=function(r){if(!r)return new kae;switch(r.type){case"firstParty":return new Vae(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new te(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Hz.get(n);r&&(re("ComponentProvider","Removing Datastore"),Hz.delete(n),r.terminate())}(this),Promise.resolve()}}class Gr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Gr(this.firestore,e,this._query)}}class yn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ra(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new yn(this.firestore,e,this._key)}}class ra extends Gr{constructor(e,n,r){super(e,n,nf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new yn(this.firestore,null,new pe(e))}withConverter(e){return new ra(this.firestore,e,this._path)}}function Qz(t,e,...n){if(t=(0,S.m9)(t),$P("collection","path",e),t instanceof s_){const r=St.fromString(e,...n);return qz(r),new ra(t,null,r)}{if(!(t instanceof yn||t instanceof ra))throw new te(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(St.fromString(e,...n));return qz(r),new ra(t.firestore,null,r)}}function Rw(t,e,...n){if(t=(0,S.m9)(t),1===arguments.length&&(e=n$.newId()),$P("doc","path",e),t instanceof s_){const r=St.fromString(e,...n);return Wz(r),new yn(t,null,new pe(r))}{if(!(t instanceof yn||t instanceof ra))throw new te(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(St.fromString(e,...n));return Wz(r),new yn(t.firestore,t instanceof ra?t.converter:null,new pe(r))}}function Yz(t,e){return t=(0,S.m9)(t),e=(0,S.m9)(e),(t instanceof yn||t instanceof ra)&&(e instanceof yn||e instanceof ra)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function HP(t,e){return t=(0,S.m9)(t),e=(0,S.m9)(e),t instanceof Gr&&e instanceof Gr&&t.firestore===e.firestore&&Lm(t._query,e._query)&&t.converter===e.converter}class Vce{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new LR(this,"async_queue_retry"),this.iu=()=>{const n=ww();n&&re("AsyncQueue","Visibility state changed to "+n.visibilityState),this.zo.Qo()};const e=ww();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const n=ww();n&&"function"==typeof n.removeEventListener&&n.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const n=new mr;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}_u(){var e=this;return(0,Z.Z)(function*(){if(0!==e.Ya.length){try{yield e.Ya[0](),e.Ya.shift(),e.zo.reset()}catch(n){if(!Vu(n))throw n;re("AsyncQueue","Operation failed with retryable error: "+n)}e.Ya.length>0&&e.zo.ko(()=>e._u())}})()}ou(e){const n=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{throw this.eu=r,this.tu=!1,Jn("INTERNAL UNHANDLED ERROR: ",function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+"\n"+o.stack),a}(r)),r}).then(r=>(this.tu=!1,r))));return this.Ja=n,n}enqueueAfterDelay(e,n,r){this.su(),this.ru.indexOf(e)>-1&&(n=0);const i=tP.createAndSchedule(this,e,n,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&Ee()}verifyOperationInProgress(){}uu(){var e=this;return(0,Z.Z)(function*(){let n;do{n=e.Ja,yield n}while(n!==e.Ja)})()}cu(e){for(const n of this.Xa)if(n.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Xa)if(n.skipDelay(),"all"!==e&&n.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const n=this.Xa.indexOf(e);this.Xa.splice(n,1)}}function zP(t){return function(n,r){if("object"!=typeof n||null===n)return!1;const i=n;for(const s of["next","error","complete"])if(s in i&&"function"==typeof i[s])return!0;return!1}(t)}class Uce{constructor(){this._progressObserver={},this._taskCompletionResolver=new mr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class hn extends s_{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Vce,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Xz(this),this._firestoreClient.terminate()}}function zn(t){return t._firestoreClient||Xz(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Xz(t){var e,n,r;const i=t._freezeSettings(),s=(u=(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",new pue(t._databaseId,u,t._persistenceKey,(d=i).host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,$z(d.experimentalLongPollingOptions),d.useFetchStreams));var u,d;t._firestoreClient=new Dce(t._authCredentials,t._appCheckCredentials,t._queue,s),null!==(n=i.localCache)&&void 0!==n&&n._offlineComponentProvider&&null!==(r=i.localCache)&&void 0!==r&&r._onlineComponentProvider&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function Jz(t,e,n){const r=new mr;return t.asyncQueue.enqueue((0,Z.Z)(function*(){try{yield Dw(t,n),yield OP(t,e),r.resolve()}catch(i){const s=i;if(!Lz(s))throw s;Wi("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function eW(t){if(t._initialized||t._terminated)throw new te(z.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class ia{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ia(_r.fromBase64String(e))}catch(n){throw new te(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ia(_r.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Ka{constructor(...e){for(let n=0;n<e.length;++n)if(0===e[n].length)throw new te(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Mc{constructor(e){this._methodName=e}}class Pw{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new te(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new te(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ze(this._lat,e._lat)||Ze(this._long,e._long)}}const Qce=/^__.*__$/;class Yce{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return null!==this.fieldMask?new Wa(e,this.data,this.fieldMask,n,this.fieldTransforms):new lf(e,this.data,n,this.fieldTransforms)}}class tW{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Wa(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function nW(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ee()}}class Nw{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===s&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new Nw(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var n;const r=null===(n=this.path)||void 0===n?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var n;const r=null===(n=this.path)||void 0===n?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return kw(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return void 0!==this.fieldMask.find(n=>e.isPrefixOf(n))||void 0!==this.fieldTransforms.find(n=>e.isPrefixOf(n.field))}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(0===e.length)throw this.mu("Document fields must not be empty");if(nW(this.Iu)&&Qce.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class Xce{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||t_(e)}pu(e,n,r,i=!1){return new Nw({Iu:e,methodName:n,gu:r,path:mn.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function xc(t){const e=t._freezeSettings(),n=t_(t._databaseId);return new Xce(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Mw(t,e,n,r,i,s={}){const o=t.pu(s.merge||s.mergeFields?2:0,e,n,i);KP("Data must be an object, but it was:",o,r);const a=sW(r,o);let u,l;if(s.merge)u=new qi(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const f of s.mergeFields){const m=u_(e,f,n);if(!o.contains(m))throw new te(z.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);aW(d,m)||d.push(m)}u=new qi(d),l=o.fieldTransforms.filter(f=>u.covers(f.field))}else u=null,l=o.fieldTransforms;return new Yce(new qr(a),u,l)}class a_ extends Mc{_toFieldTransform(e){if(2!==e.Iu)throw e.mu(1===e.Iu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof a_}}function rW(t,e,n){return new Nw({Iu:3,gu:e.settings.gu,methodName:t._methodName,du:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class WP extends Mc{_toFieldTransform(e){return new Bm(e.path,new af)}isEqual(e){return e instanceof WP}}class Jce extends Mc{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){const n=rW(this,e,!0),r=this.yu.map(s=>kc(s,n)),i=new Tc(r);return new Bm(e.path,i)}isEqual(e){return this===e}}class ede extends Mc{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){const n=rW(this,e,!0),r=this.yu.map(s=>kc(s,n)),i=new Cc(r);return new Bm(e.path,i)}isEqual(e){return this===e}}class tde extends Mc{constructor(e,n){super(e),this.wu=n}_toFieldTransform(e){const n=new uf(e.serializer,Z$(e.serializer,this.wu));return new Bm(e.path,n)}isEqual(e){return this===e}}function qP(t,e,n,r){const i=t.pu(1,e,n);KP("Data must be an object, but it was:",i,r);const s=[],o=qr.empty();Uu(r,(u,l)=>{const d=xw(e,u,n);l=(0,S.m9)(l);const f=i.Ru(d);if(l instanceof a_)s.push(d);else{const m=kc(l,f);null!=m&&(s.push(d),o.set(d,m))}});const a=new qi(s);return new tW(o,a,i.fieldTransforms)}function GP(t,e,n,r,i,s){const o=t.pu(1,e,n),a=[u_(e,r,n)],u=[i];if(s.length%2!=0)throw new te(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(u_(e,s[m])),u.push(s[m+1]);const l=[],d=qr.empty();for(let m=a.length-1;m>=0;--m)if(!aW(l,a[m])){const _=a[m];let v=u[m];v=(0,S.m9)(v);const T=o.Ru(_);if(v instanceof a_)l.push(_);else{const D=kc(v,T);null!=D&&(l.push(_),d.set(_,D))}}const f=new qi(l);return new tW(d,f,o.fieldTransforms)}function iW(t,e,n,r=!1){return kc(n,t.pu(r?4:3,e))}function kc(t,e){if(oW(t=(0,S.m9)(t)))return KP("Unsupported field value:",e,t),sW(t,e);if(t instanceof Mc)return function(r,i){if(!nW(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.du&&4!==e.Iu)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let u=kc(a,i.Vu(o));null==u&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if(null===(r=(0,S.m9)(r)))return{nullValue:"NULL_VALUE"};if("number"==typeof r)return Z$(i.serializer,r);if("boolean"==typeof r)return{booleanValue:r};if("string"==typeof r)return{stringValue:r};if(r instanceof Date){const s=Tn.fromDate(r);return{timestampValue:df(i.serializer,s)}}if(r instanceof Tn){const s=new Tn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:df(i.serializer,s)}}if(r instanceof Pw)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ia)return{bytesValue:mH(i.serializer,r._byteString)};if(r instanceof yn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:cR(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${bw(r)}`)}(t,e)}function sW(t,e){const n={};return _$(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Uu(t,(r,i)=>{const s=kc(i,e.Eu(r));null!=s&&(n[r]=s)}),{mapValue:{fields:n}}}function oW(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Tn||t instanceof Pw||t instanceof ia||t instanceof yn||t instanceof Mc)}function KP(t,e,n){if(!oW(n)||"object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const r=bw(n);throw e.mu("an object"===r?t+" a custom object":t+" "+r)}var i}function u_(t,e,n){if((e=(0,S.m9)(e))instanceof Ka)return e._internalPath;if("string"==typeof e)return xw(t,e);throw kw("Field path arguments must be of type string or ",t,!1,void 0,n)}const nde=new RegExp("[~\\*/\\[\\]]");function xw(t,e,n){if(e.search(nde)>=0)throw kw(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ka(...e.split("."))._internalPath}catch{throw kw(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function kw(t,e,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new te(z.INVALID_ARGUMENT,a+t+u)}function aW(t,e){return t.some(n=>n.isEqual(e))}class l_{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new yn(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new rde(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Ow("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n)}}}class rde extends l_{data(){return super.data()}}function Ow(t,e){return"string"==typeof e?xw(t,e):e instanceof Ka?e._internalPath:e._delegate._internalPath}function uW(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new te(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ZP{}class c_ extends ZP{}function Xu(t,e,...n){let r=[];e instanceof ZP&&r.push(e),r=r.concat(n),function(s){const o=s.filter(u=>u instanceof Rf).length,a=s.filter(u=>u instanceof d_).length;if(o>1||o>0&&a>0)throw new te(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class d_ extends c_{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new d_(e,n,r)}_apply(e){const n=this._parse(e);return hW(e._query,n),new Gr(e.firestore,e.converter,nR(e._query,n))}_parse(e){const n=xc(e.firestore);return function(s,o,a,u,l,d,f){let m;if(l.isKeyField()){if("array-contains"===d||"array-contains-any"===d)throw new te(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if("in"===d||"not-in"===d){dW(f,d);const _=[];for(const v of f)_.push(cW(u,s,v));m={arrayValue:{values:_}}}else m=cW(u,s,f)}else"in"!==d&&"not-in"!==d&&"array-contains-any"!==d||dW(f,d),m=iW(a,"where",f,"in"===d||"not-in"===d);return It.create(l,d,m)}(e._query,0,n,e.firestore._databaseId,this._field,this._op,this._value)}}class Rf extends ZP{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Rf(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===n.length?n[0]:zt.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return 0===n.getFilters().length?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const u of a)hW(o,u),o=nR(o,u)}(e._query,n),new Gr(e.firestore,e.converter,nR(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class QP extends c_{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new QP(e,n)}_apply(e){const n=function(i,s,o){if(null!==i.startAt)throw new te(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new te(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new km(s,o)}(e._query,this._field,this._direction);return new Gr(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Ha(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}class Lw extends c_{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Lw(e,n,r)}_apply(e){return new Gr(e.firestore,e.converter,nw(e._query,this._limit,this._limitType))}}class Fw extends c_{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Fw(e,n,r)}_apply(e){const n=lW(e,this.type,this._docOrFields,this._inclusive);return new Gr(e.firestore,e.converter,(s=n,new Ha((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)));var i,s}}class Vw extends c_{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Vw(e,n,r)}_apply(e){const n=lW(e,this.type,this._docOrFields,this._inclusive);return new Gr(e.firestore,e.converter,(s=n,new Ha((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)));var i,s}}function lW(t,e,n,r){if(n[0]=(0,S.m9)(n[0]),n[0]instanceof l_)return function(s,o,a,u,l){if(!u)throw new te(z.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const d=[];for(const f of rf(s))if(f.field.isKeyField())d.push(Ic(o,u.key));else{const m=u.data.field(f.field);if(ZI(m))throw new te(z.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===m){const _=f.field.canonicalString();throw new te(z.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}d.push(m)}return new Wu(d,l)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=xc(t.firestore);return function(o,a,u,l,d,f){const m=o.explicitOrderBy;if(d.length>m.length)throw new te(z.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const _=[];for(let v=0;v<d.length;v++){const T=d[v];if(m[v].field.isKeyField()){if("string"!=typeof T)throw new te(z.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof T}`);if(!tR(o)&&-1!==T.indexOf("/"))throw new te(z.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${T}' contains a slash.`);const D=o.path.child(St.fromString(T));if(!pe.isDocumentKey(D))throw new te(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${D}' is not because it contains an odd number of segments.`);const x=new pe(D);_.push(Ic(a,x))}else{const D=iW(u,l,T);_.push(D)}}return new Wu(_,f)}(t._query,t.firestore._databaseId,i,e,n,r)}}function cW(t,e,n){if("string"==typeof(n=(0,S.m9)(n))){if(""===n)throw new te(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!tR(e)&&-1!==n.indexOf("/"))throw new te(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(St.fromString(n));if(!pe.isDocumentKey(r))throw new te(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ic(t,new pe(r))}if(n instanceof yn)return Ic(t,n._key);throw new te(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bw(n)}.`)}function dW(t,e){if(!Array.isArray(t)||0===t.length)throw new te(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function hW(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw new te(z.INVALID_ARGUMENT,n===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class YP{convertValue(e,n="none"){switch(Hu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Hn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes($a(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw Ee()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Uu(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Pw(Hn(e.latitude),Hn(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=QI(e);return null==r?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Pm(e));default:return null}}convertTimestamp(e){const n=Bu(e);return new Tn(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=St.fromString(e);De(DH(r));const i=new ju(r.get(1),r.get(3)),s=new pe(r.popFirst(5));return i.isEqual(n)||Jn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}function Uw(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class hde extends YP{constructor(e){super(),this.firestore=e}convertBytes(e){return new ia(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new yn(this.firestore,null,n)}}class Oc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Za extends l_{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new h_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Ow("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class h_ extends Za{data(e={}){return super.data(e)}}class Ju{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Oc(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new h_(this._firestore,this._userDataWriter,r.key,r,new Oc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new te(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>({type:"added",doc:new h_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Oc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:o++}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||3!==a.type).map(a=>{const u=new h_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Oc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,d=-1;return 0!==a.type&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),1!==a.type&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:pde(a.type),doc:u,oldIndex:l,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function pde(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ee()}}function pW(t,e){return t instanceof Za&&e instanceof Za?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Ju&&e instanceof Ju&&t._firestore===e._firestore&&HP(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}class el extends YP{constructor(e){super(),this.firestore=e}convertBytes(e){return new ia(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new yn(this.firestore,null,n)}}function gW(t,e,n){t=_t(t,yn);const r=_t(t.firestore,hn),i=Uw(t.converter,e,n);return Pf(r,[Mw(xc(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Cn.none())])}function mW(t,e,n,...r){t=_t(t,yn);const i=_t(t.firestore,hn),s=xc(i);let o;return o="string"==typeof(e=(0,S.m9)(e))||e instanceof Ka?GP(s,"updateDoc",t._key,e,n,r):qP(s,"updateDoc",t._key,e),Pf(i,[o.toMutation(t._key,Cn.exists(!0))])}function _W(t,...e){var n,r,i;t=(0,S.m9)(t);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||zP(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(zP(e[o])){const f=e[o];e[o]=null===(n=f.next)||void 0===n?void 0:n.bind(f),e[o+1]=null===(r=f.error)||void 0===r?void 0:r.bind(f),e[o+2]=null===(i=f.complete)||void 0===i?void 0:i.bind(f)}let u,l,d;if(t instanceof yn)l=_t(t.firestore,hn),d=nf(t._key.path),u={next:f=>{e[o]&&e[o](XP(l,t,f))},error:e[o+1],complete:e[o+2]};else{const f=_t(t,Gr);l=_t(f.firestore,hn),d=f._query;const m=new el(l);u={next:_=>{e[o]&&e[o](new Ju(l,m,f,_))},error:e[o+1],complete:e[o+2]},uW(t._query)}return function(m,_,v,T){const D=new Sw(T),x=new aP(_,D,v);return m.asyncQueue.enqueueAndForget((0,Z.Z)(function*(){return nP(yield bf(m),x)})),()=>{D.Na(),m.asyncQueue.enqueueAndForget((0,Z.Z)(function*(){return iP(yield bf(m),x)}))}}(zn(l),d,a,u)}function Pf(t,e){return function(r,i){const s=new mr;return r.asyncQueue.enqueueAndForget((0,Z.Z)(function*(){return function oce(t,e,n){return hP.apply(this,arguments)}(yield BP(r),i,s)})),s.promise}(zn(t),e)}function XP(t,e,n){const r=n.docs.get(e._key),i=new el(t);return new Za(t,i,e._key,r,new Oc(n.hasPendingWrites,n.fromCache),e.converter)}const Mde={maxAttempts:5};class yW{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=xc(e)}set(e,n,r){this._verifyNotCommitted();const i=tl(e,this._firestore),s=Uw(i.converter,n,r),o=Mw(this._dataReader,"WriteBatch.set",i._key,s,null!==i.converter,r);return this._mutations.push(o.toMutation(i._key,Cn.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=tl(e,this._firestore);let o;return o="string"==typeof(n=(0,S.m9)(n))||n instanceof Ka?GP(this._dataReader,"WriteBatch.update",s._key,n,r,i):qP(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,Cn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=tl(e,this._firestore);return this._mutations=this._mutations.concat(new cf(n._key,Cn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new te(z.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function tl(t,e){if((t=(0,S.m9)(t)).firestore!==e)throw new te(z.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}class xde extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=xc(n)}get(n){const r=tl(n,this._firestore),i=new hde(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||1!==s.length)return Ee();const o=s[0];if(o.isFoundDocument())return new l_(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new l_(this._firestore,i,r._key,null,r.converter);throw Ee()})}set(n,r,i){const s=tl(n,this._firestore),o=Uw(s.converter,r,i),a=Mw(this._dataReader,"Transaction.set",s._key,o,null!==s.converter,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){const o=tl(n,this._firestore);let a;return a="string"==typeof(r=(0,S.m9)(r))||r instanceof Ka?GP(this._dataReader,"Transaction.update",o._key,r,i,s):qP(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){const r=tl(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=tl(e,this._firestore),r=new el(this._firestore);return super.get(e).then(i=>new Za(this._firestore,r,n._key,i._document,new Oc(!1,!1),n.converter))}}function eN(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new te("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function wW(){if(typeof Uint8Array>"u")throw new te("unimplemented","Uint8Arrays are not available in this environment.")}function TW(){if(!function hue(){return typeof atob<"u"}())throw new te("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(e,n=!0){Kh=ri.SDK_VERSION,(0,ri._registerComponent)(new mo.wA("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new hn(new Lae(r.getProvider("auth-internal")),new Uae(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new te(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ju(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),(0,ri.registerVersion)(Jj,"4.4.0",e),(0,ri.registerVersion)(Jj,"4.4.0","esm2017")}();class f_{constructor(e){this._delegate=e}static fromBase64String(e){return TW(),new f_(ia.fromBase64String(e))}static fromUint8Array(e){return wW(),new f_(ia.fromUint8Array(e))}toBase64(){return TW(),this._delegate.toBase64()}toUint8Array(){return wW(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function tN(t){return function Hde(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const r of e)if(r in n&&"function"==typeof n[r])return!0;return!1}(t,["next","error","complete"])}class zde{enableIndexedDbPersistence(e,n){return function jce(t,e){eW(t=_t(t,hn));const n=zn(t);if(n._uninitializedComponentsProvider)throw new te(z.FAILED_PRECONDITION,"SDK cache is already specified.");Wi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings(),i=new Df;return Jz(n,i,new xP(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return function $ce(t){eW(t=_t(t,hn));const e=zn(t);if(e._uninitializedComponentsProvider)throw new te(z.FAILED_PRECONDITION,"SDK cache is already specified.");Wi("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings(),r=new Df;return Jz(e,r,new kz(r,n.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function Hce(t){if(t._initialized&&!t._terminated)throw new te(z.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new mr;return t._queue.enqueueAndForgetEvenWhileRestricted((0,Z.Z)(function*(){try{yield(n=(0,Z.Z)(function*(i){if(!Eo.D())return Promise.resolve();const s=i+"main";yield Eo.delete(s)}),function r(i){return n.apply(this,arguments)})(SR(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}var n})),e.promise}(e._delegate)}}class CW{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof ju||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Wi("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},n),e)).merge,this._delegate._setSettings(e)}useEmulator(e,n,r={}){!function Zz(t,e,n,r={}){var i;const s=(t=_t(t,s_))._getSettings(),o=`${e}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Wi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if("string"==typeof r.mockUserToken)a=r.mockUserToken,u=Ar.MOCK_USER;else{a=(0,S.Sg)(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);const l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new te(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Ar(l)}t._authCredentials=new Oae(new e$(a,u))}}(this._delegate,e,n,r)}enableNetwork(){return function Wce(t){return function Ace(t){return t.asyncQueue.enqueue((0,Z.Z)(function*(){const e=yield Fz(t),n=yield Vz(t);return e.setNetworkEnabled(!0),function(i){const s=fe(i);return s.C_.delete(0),n_(s)}(n)}))}(zn(t=_t(t,hn)))}(this._delegate)}disableNetwork(){return function qce(t){return function bce(t){return t.asyncQueue.enqueue((0,Z.Z)(function*(){const e=yield Fz(t),n=yield Vz(t);return e.setNetworkEnabled(!1),(r=(0,Z.Z)(function*(s){const o=fe(s);o.C_.add(0),yield vf(o),o.M_.set("Offline")}),function i(s){return r.apply(this,arguments)})(n);var r}))}(zn(t=_t(t,hn)))}(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,zz("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function zce(t){return function(n){const r=new mr;return n.asyncQueue.enqueueAndForget((0,Z.Z)(function*(){return function cce(t,e){return _P.apply(this,arguments)}(yield BP(n),r)})),r.promise}(zn(t=_t(t,hn)))}(this._delegate)}onSnapshotsInSync(e){return function Tde(t,e){return function Nce(t,e){const n=new Sw(e);return t.asyncQueue.enqueueAndForget((0,Z.Z)(function*(){return i=yield bf(t),s=n,fe(i).q_.add(s),void s.next();var i,s})),()=>{n.Na(),t.asyncQueue.enqueueAndForget((0,Z.Z)(function*(){return i=yield bf(t),s=n,void fe(i).q_.delete(s);var i,s}))}}(zn(t=_t(t,hn)),zP(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new te("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Nf(this,Qz(this._delegate,e))}catch(n){throw Ri(n,"collection()","Firestore.collection()")}}doc(e){try{return new Ws(this,Rw(this._delegate,e))}catch(n){throw Ri(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Pi(this,function Fce(t,e){if(t=_t(t,s_),$P("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new te(z.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Gr(t,null,(r=e,new Ha(St.emptyPath(),r)));var r}(this._delegate,e))}catch(n){throw Ri(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function kde(t,e,n){t=_t(t,hn);const r=Object.assign(Object.assign({},Mde),n);return function(s){if(s.maxAttempts<1)throw new te(z.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const u=new mr;return s.asyncQueue.enqueueAndForget((0,Z.Z)(function*(){const l=yield function Uz(t){return Aw(t).then(e=>e.datastore)}(s);new Sce(s.asyncQueue,l,a,o,u).run()})),u.promise}(zn(t),i=>e(new xde(t,i)),r)}(this._delegate,n=>e(new SW(this,n)))}batch(){return zn(this._delegate),new DW(new yW(this._delegate,e=>Pf(this._delegate,e)))}loadBundle(e){return function Gce(t,e){const n=zn(t=_t(t,hn)),r=new Uce;return function Mce(t,e,n,r){const i=function(o,a){let u;return u="string"==typeof o?uH().encode(o):o,d=function(d,f){if(d instanceof Uint8Array)return Oz(d,f);if(d instanceof ArrayBuffer)return Oz(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),new Tce(d,a);var d}(n,t_(e));t.asyncQueue.enqueueAndForget((0,Z.Z)(function*(){!function Ice(t,e,n){const r=fe(t);var i;(i=(0,Z.Z)(function*(o,a,u){try{const l=yield a.getMetadata();if(yield function(v,T){const D=fe(v),x=er(T.createTime);return D.persistence.runTransaction("hasNewerBundle","readonly",R=>D.Kr.getBundleMetadata(R,T.id)).then(R=>!!R&&R.createTime.compareTo(x)>=0)}(o.localStore,l))return yield a.close(),u._completeWith({taskState:"Success",documentsLoaded:(v=l).totalDocuments,bytesLoaded:v.totalBytes,totalDocuments:v.totalDocuments,totalBytes:v.totalBytes}),Promise.resolve(new Set);u._updateProgress(Sz(l));const d=new ece(l,o.localStore,a.serializer);let f=yield a.Ma();for(;f;){const _=yield d.ea(f);_&&u._updateProgress(_),f=yield a.Ma()}const m=yield d.complete();return yield Ga(o,m.ra,void 0),yield function(v,T){const D=fe(v);return D.persistence.runTransaction("Save bundle","readwrite",x=>D.Kr.saveBundleMetadata(x,T))}(o.localStore,l),u._completeWith(m.progress),Promise.resolve(m.na)}catch(l){return Wi("SyncEngine",`Loading bundle failed with ${l}`),u._failWith(l),Promise.resolve(new Set)}var v}),function s(o,a,u){return i.apply(this,arguments)})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield BP(t),i,r)}))}(n,t._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function Kce(t,e){return function xce(t,e){return t.asyncQueue.enqueue((0,Z.Z)(function*(){return function(r,i){const s=fe(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Kr.getNamedQuery(o,i))}(yield Af(t),e)}))}(zn(t=_t(t,hn)),e).then(n=>n?new Gr(t,null,n.query):null)}(this._delegate,e).then(n=>n?new Pi(this,n):null)}}class jw extends YP{constructor(e){super(),this.firestore=e}convertBytes(e){return new f_(new ia(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return Ws.forKey(n,this.firestore,null)}}class SW{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new jw(e)}get(e){const n=Fc(e);return this._delegate.get(n).then(r=>new p_(this._firestore,new Za(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const i=Fc(e);return r?(eN("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Fc(e);return 2===arguments.length?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Fc(e);return this._delegate.delete(n),this}}class DW{constructor(e){this._delegate=e}set(e,n,r){const i=Fc(e);return r?(eN("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Fc(e);return 2===arguments.length?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Fc(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class Lc{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new h_(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new g_(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=Lc.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new Lc(e,new jw(e),n),i.set(n,s)),s}}Lc.INSTANCES=new WeakMap;class Ws{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new jw(e)}static forPath(e,n,r){if(e.length%2!=0)throw new te("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Ws(n,new yn(n._delegate,r,new pe(e)))}static forKey(e,n,r){return new Ws(n,new yn(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Nf(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Nf(this.firestore,Qz(this._delegate,e))}catch(n){throw Ri(n,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,S.m9)(e))instanceof yn&&Yz(this._delegate,e)}set(e,n){n=eN("DocumentReference.set",n);try{return n?gW(this._delegate,e,n):gW(this._delegate,e)}catch(r){throw Ri(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return 1===arguments.length?mW(this._delegate,e):mW(this._delegate,e,n,...r)}catch(i){throw Ri(i,"updateDoc()","DocumentReference.update()")}}delete(){return function Ide(t){return Pf(_t(t.firestore,hn),[new cf(t._key,Cn.none())])}(this._delegate)}onSnapshot(...e){const n=AW(e),r=bW(e,i=>new p_(this.firestore,new Za(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return _W(this._delegate,n,r)}get(e){let n;return n="cache"===e?.source?function mde(t){t=_t(t,yn);const e=_t(t.firestore,hn),n=zn(e),r=new el(e);return function Rce(t,e){const n=new mr;return t.asyncQueue.enqueueAndForget((0,Z.Z)(function*(){return(r=(0,Z.Z)(function*(s,o,a){try{const u=yield function(d,f){const m=fe(d);return m.persistence.runTransaction("read document","readonly",_=>m.localDocuments.getDocument(_,f))}(s,o);u.isFoundDocument()?a.resolve(u):u.isNoDocument()?a.resolve(null):a.reject(new te(z.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){const l=wf(u,`Failed to get document '${o} from cache`);a.reject(l)}}),function i(s,o,a){return r.apply(this,arguments)})(yield Af(t),e,n);var r})),n.promise}(n,t._key).then(i=>new Za(e,r,t._key,i,new Oc(null!==i&&i.hasLocalMutations,!0),t.converter))}(this._delegate):"server"===e?.source?function _de(t){t=_t(t,yn);const e=_t(t.firestore,hn);return Bz(zn(e),t._key,{source:"server"}).then(n=>XP(e,t,n))}(this._delegate):function gde(t){t=_t(t,yn);const e=_t(t.firestore,hn);return Bz(zn(e),t._key).then(n=>XP(e,t,n))}(this._delegate),n.then(r=>new p_(this.firestore,new Za(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Ws(this.firestore,this._delegate.withConverter(e?Lc.getInstance(this.firestore,e):null))}}function Ri(t,e,n){return t.message=t.message.replace(e,n),t}function AW(t){for(const e of t)if("object"==typeof e&&!tN(e))return e;return{}}function bW(t,e){var n,r;let i;return i=tN(t[0])?t[0]:tN(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class p_{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Ws(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return pW(this._delegate,e._delegate)}}class g_ extends p_{data(e){const n=this._delegate.data(e);return this._delegate._converter||function xae(t,e){t||Ee()}(void 0!==n),n}}class Pi{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new jw(e)}where(e,n,r){try{return new Pi(this.firestore,Xu(this._delegate,function ide(t,e,n){const r=e,i=Ow("where",t);return d_._create(i,r,n)}(e,n,r)))}catch(i){throw Ri(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new Pi(this.firestore,Xu(this._delegate,function sde(t,e="asc"){const n=e,r=Ow("orderBy",t);return QP._create(r,n)}(e,n)))}catch(r){throw Ri(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Pi(this.firestore,Xu(this._delegate,function ode(t){return Gz("limit",t),Lw._create("limit",t,"F")}(e)))}catch(n){throw Ri(n,"limit()","Query.limit()")}}limitToLast(e){try{return new Pi(this.firestore,Xu(this._delegate,function ade(t){return Gz("limitToLast",t),Lw._create("limitToLast",t,"L")}(e)))}catch(n){throw Ri(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Pi(this.firestore,Xu(this._delegate,function ude(...t){return Fw._create("startAt",t,!0)}(...e)))}catch(n){throw Ri(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Pi(this.firestore,Xu(this._delegate,function lde(...t){return Fw._create("startAfter",t,!1)}(...e)))}catch(n){throw Ri(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Pi(this.firestore,Xu(this._delegate,function cde(...t){return Vw._create("endBefore",t,!1)}(...e)))}catch(n){throw Ri(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Pi(this.firestore,Xu(this._delegate,function dde(...t){return Vw._create("endAt",t,!0)}(...e)))}catch(n){throw Ri(n,"endAt()","Query.endAt()")}}isEqual(e){return HP(this._delegate,e._delegate)}get(e){let n;return n="cache"===e?.source?function vde(t){t=_t(t,Gr);const e=_t(t.firestore,hn),n=zn(e),r=new el(e);return function Pce(t,e){const n=new mr;return t.asyncQueue.enqueueAndForget((0,Z.Z)(function*(){return(r=(0,Z.Z)(function*(s,o,a){try{const u=yield yw(s,o,!0),l=new bz(o,u.ls),d=l.ca(u.documents),f=l.applyChanges(d,!1);a.resolve(f.snapshot)}catch(u){const l=wf(u,`Failed to execute query '${o} against cache`);a.reject(l)}}),function i(s,o,a){return r.apply(this,arguments)})(yield Af(t),e,n);var r})),n.promise}(n,t._query).then(i=>new Ju(e,r,t,i))}(this._delegate):"server"===e?.source?function Ede(t){t=_t(t,Gr);const e=_t(t.firestore,hn),n=zn(e),r=new el(e);return jz(n,t._query,{source:"server"}).then(i=>new Ju(e,r,t,i))}(this._delegate):function yde(t){t=_t(t,Gr);const e=_t(t.firestore,hn),n=zn(e),r=new el(e);return uW(t._query),jz(n,t._query).then(i=>new Ju(e,r,t,i))}(this._delegate),n.then(r=>new nN(this.firestore,new Ju(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=AW(e),r=bW(e,i=>new nN(this.firestore,new Ju(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return _W(this._delegate,n,r)}withConverter(e){return new Pi(this.firestore,this._delegate.withConverter(e?Lc.getInstance(this.firestore,e):null))}}class qde{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new g_(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class nN{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new Pi(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new g_(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new qde(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new g_(this._firestore,r))})}isEqual(e){return pW(this._delegate,e._delegate)}}class Nf extends Pi{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Ws(this.firestore,e):null}doc(e){try{return new Ws(this.firestore,void 0===e?Rw(this._delegate):Rw(this._delegate,e))}catch(n){throw Ri(n,"doc()","CollectionReference.doc()")}}add(e){return function wde(t,e){const n=_t(t.firestore,hn),r=Rw(t),i=Uw(t.converter,e);return Pf(n,[Mw(xc(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Cn.exists(!1))]).then(()=>r)}(this._delegate,e).then(n=>new Ws(this.firestore,n))}isEqual(e){return Yz(this._delegate,e._delegate)}withConverter(e){return new Nf(this.firestore,this._delegate.withConverter(e?Lc.getInstance(this.firestore,e):null))}}function Fc(t){return _t(t,yn)}class rN{constructor(...e){this._delegate=new Ka(...e)}static documentId(){return new rN(mn.keyField().canonicalString())}isEqual(e){return(e=(0,S.m9)(e))instanceof Ka&&this._delegate._internalPath.isEqual(e._internalPath)}}class Vc{constructor(e){this._delegate=e}static serverTimestamp(){const e=function Lde(){return new WP("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Vc(e)}static delete(){const e=function Ode(){return new a_("deleteField")}();return e._methodName="FieldValue.delete",new Vc(e)}static arrayUnion(...e){const n=function Fde(...t){return new Jce("arrayUnion",t)}(...e);return n._methodName="FieldValue.arrayUnion",new Vc(n)}static arrayRemove(...e){const n=function Vde(...t){return new ede("arrayRemove",t)}(...e);return n._methodName="FieldValue.arrayRemove",new Vc(n)}static increment(e){const n=function Ude(t){return new tde("increment",t)}(e);return n._methodName="FieldValue.increment",new Vc(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const Gde={Firestore:CW,GeoPoint:Pw,Timestamp:Tn,Blob:f_,Transaction:SW,WriteBatch:DW,DocumentReference:Ws,DocumentSnapshot:p_,Query:Pi,QueryDocumentSnapshot:g_,QuerySnapshot:nN,CollectionReference:Nf,FieldPath:rN,FieldValue:Vc,setLogLevel:function Wde(t){!function Mae(t){Lu.setLogLevel(t)}(t)},CACHE_SIZE_UNLIMITED:-1};function RW(t,e){return function Qde(t,e=lI){return new Ct(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}(t,e)}function iN(t,e){return RW(t,e).pipe(oe(n=>({payload:n,type:"query"})))}!function Zde(t){(function Kde(t,e){t.INTERNAL.registerComponent(new mo.wA("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},Gde)))})(t,(e,n)=>new CW(e,n,new zde)),t.registerVersion("@firebase/firestore-compat","0.3.23")}(ms.Z);class PW{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){const r=this.ref.collection(e),{ref:i,query:s}=LW(r,n);return new xW(i,s,this.afs)}snapshotChanges(){return function Yde(t,e){return RW(t,e).pipe(qE(void 0),eb(),oe(n=>{const[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(Xn)}valueChanges(e={}){return this.snapshotChanges().pipe(oe(({payload:n})=>e.idField?{...n.data(),[e.idField]:n.id}:n.data()))}get(e){return Kt(this.ref.get(e)).pipe(Xn)}}function $w(t,e){return iN(t,e).pipe(qE(void 0),eb(),oe(n=>{const[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{const l=s.find(f=>f.doc.ref.isEqual(a.ref)),d=r?.payload.docs.find(f=>f.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&d&&JSON.stringify(d.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function NW(t,e,n){return $w(t,n).pipe(Eh((r,i)=>function Xde(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=function Jde(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return sN(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return sN(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return sN(t,e.oldIndex,1)}return t}(t,r))}),t}(r,i.map(s=>s.payload),e),[]),OB(),oe(r=>r.map(i=>({type:i.type,payload:i}))))}function sN(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function MW(t){return(!t||0===t.length)&&(t=["added","removed","modified"]),t}class xW{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=$w(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(oe(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(qE(void 0),eb(),po(([r,i])=>i.length>0||!r),oe(([,r])=>r),Xn)}auditTrail(e){return this.stateChanges(e).pipe(Eh((n,r)=>[...n,...r],[]))}snapshotChanges(e){const n=MW(e);return NW(this.query,n,this.afs.schedulers.outsideAngular).pipe(Xn)}valueChanges(e={}){return iN(this.query,this.afs.schedulers.outsideAngular).pipe(oe(n=>n.payload.docs.map(r=>e.idField?{...r.data(),[e.idField]:r.id}:r.data())),Xn)}get(e){return Kt(this.query.get(e)).pipe(Xn)}add(e){return this.ref.add(e)}doc(e){return new PW(this.ref.doc(e),this.afs)}}class ehe{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return e&&0!==e.length?$w(this.query,this.afs.schedulers.outsideAngular).pipe(oe(n=>n.filter(r=>e.indexOf(r.type)>-1)),po(n=>n.length>0),Xn):$w(this.query,this.afs.schedulers.outsideAngular).pipe(Xn)}auditTrail(e){return this.stateChanges(e).pipe(Eh((n,r)=>[...n,...r],[]))}snapshotChanges(e){const n=MW(e);return NW(this.query,n,this.afs.schedulers.outsideAngular).pipe(Xn)}valueChanges(e={}){return iN(this.query,this.afs.schedulers.outsideAngular).pipe(oe(r=>r.payload.docs.map(i=>e.idField?{[e.idField]:i.id,...i.data()}:i.data())),Xn)}get(e){return Kt(this.query.get(e)).pipe(Xn)}}const kW=new de("angularfire2.enableFirestorePersistence"),OW=new de("angularfire2.firestore.persistenceSettings"),the=new de("angularfire2.firestore.settings"),nhe=new de("angularfire2.firestore.use-emulator");function LW(t,e=(n=>n)){return{query:e(t),ref:t}}let FW=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,u,l,d,f,m,_,v,T,D,x,R){this.schedulers=u;const L=Xg(n,a,r),G=d;f&&jA(L,a,m,v,T,D,_,x),[this.firestore,this.persistenceEnabled$]=hI(`${L.name}.firestore`,"AngularFirestore",L.name,()=>{const ae=a.runOutsideAngular(()=>L.firestore());if(s&&ae.settings(s),G&&ae.useEmulator(...G),i&&!bE(o)){const ye=()=>{try{return Kt(ae.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(Qe){return typeof console<"u"&&console.warn(Qe),Me(!1)}};return[ae,a.runOutsideAngular(ye)]}return[ae,Me(!1)]},[s,G,i])}collection(n,r){let i;i="string"==typeof n?this.firestore.collection(n):n;const{ref:s,query:o}=LW(i,r),a=this.schedulers.ngZone.run(()=>s);return new xW(a,o,this)}collectionGroup(n,r){const i=r||(o=>o),s=this.firestore.collectionGroup(n);return new ehe(i(s),this)}doc(n){let r;r="string"==typeof n?this.firestore.doc(n):n;const i=this.schedulers.ngZone.run(()=>r);return new PW(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(Y(Oh),Y(Lh,8),Y(kW,8),Y(the,8),Y(oo),Y(Et),Y(dI),Y(OW,8),Y(nhe,8),Y(Jg,8),Y(OA,8),Y(LA,8),Y(FA,8),Y(VA,8),Y(UA,8),Y(BA,8),Y(cI,8))};static \u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),rhe=(()=>{class t{constructor(){ms.Z.registerVersion("angularfire",Mh.full,"fst-compat")}static enablePersistence(n){return{ngModule:t,providers:[{provide:kW,useValue:!0},{provide:OW,useValue:n}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Er({type:t});static \u0275inj=ar({providers:[FW]})}return t})();const VW="@firebase/database";let oN="";function aN(t){oN=t}class ohe{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){null==n?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,S.Wl)(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return null==n?null:(0,S.cI)(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class ahe{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){null==n?delete this.cache_[e]:this.cache_[e]=n}get(e){return(0,S.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const BW=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new ohe(e)}}catch{}return new ahe},Uc=BW("localStorage"),uN=BW("sessionStorage"),Mf=new ys.Yd("@firebase/database"),jW=function(){let t=1;return function(){return t++}}(),$W=function(t){const e=(0,S.dS)(t),n=new S.gQ;n.update(e);const r=n.digest();return S.US.encodeByteArray(r)},m_=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=m_.apply(null,r):e+="object"==typeof r?(0,S.Wl)(r):r,e+=" "}return e};let Bc=null,HW=!0;const zW=function(t,e){(0,S.hu)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(Mf.logLevel=ys.in.VERBOSE,Bc=Mf.log.bind(Mf),e&&uN.set("logging_enabled",!0)):"function"==typeof t?Bc=t:(Bc=null,uN.remove("logging_enabled"))},Pr=function(...t){if(!0===HW&&(HW=!1,null===Bc&&!0===uN.get("logging_enabled")&&zW(!0)),Bc){const e=m_.apply(null,t);Bc(e)}},__=function(t){return function(...e){Pr(t,...e)}},lN=function(...t){const e="FIREBASE INTERNAL ERROR: "+m_(...t);Mf.error(e)},sa=function(...t){const e=`FIREBASE FATAL ERROR: ${m_(...t)}`;throw Mf.error(e),new Error(e)},ci=function(...t){const e="FIREBASE WARNING: "+m_(...t);Mf.warn(e)},Hw=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},nl="[MIN_NAME]",Qa="[MAX_NAME]",jc=function(t,e){if(t===e)return 0;if(t===nl||e===Qa)return-1;if(e===nl||t===Qa)return 1;{const n=GW(t),r=GW(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1}},che=function(t,e){return t===e?0:t<e?-1:1},y_=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,S.Wl)(e))},cN=function(t){if("object"!=typeof t||null===t)return(0,S.Wl)(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)0!==r&&(n+=","),n+=(0,S.Wl)(e[r]),n+=":",n+=cN(t[e[r]]);return n+="}",n},WW=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let i=0;i<n;i+=e)r.push(t.substring(i,i+e>n?n:i+e));return r};function Nr(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const qW=function(t){(0,S.hu)(!Hw(t),"Invalid JSON number");const r=1023;let i,s,o,a,u;0===t?(s=0,o=0,i=1/t==-1/0?1:0):(i=t<0,(t=Math.abs(t))>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,52-a)-Math.pow(2,52))):(s=0,o=Math.round(t/Math.pow(2,-1074))));const l=[];for(u=52;u;u-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(u=11;u;u-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();const d=l.join("");let f="";for(u=0;u<64;u+=8){let m=parseInt(d.substr(u,8),2).toString(16);1===m.length&&(m="0"+m),f+=m}return f.toLowerCase()},phe=new RegExp("^-?(0*)\\d{1,10}$"),GW=function(t){if(phe.test(t)){const e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},xf=function(t){try{t()}catch(e){setTimeout(()=>{throw ci("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},v_=function(t,e){const n=setTimeout(t,e);return"number"==typeof n&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class yhe{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;null===(n=this.appCheckProvider)||void 0===n||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){ci(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class vhe{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&"auth/token-not-initialized"===n.code?(Pr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ci(e)}}let E_=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}return t.OWNER="owner",t})();const XW=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,tq="websocket",nq="long_polling";class hN{constructor(e,n,r,i,s=!1,o="",a=!1,u=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Uc.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Uc.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function rq(t,e,n){let r;if((0,S.hu)("string"==typeof e,"typeof type must == string"),(0,S.hu)("object"==typeof n,"typeof params must == object"),e===tq)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==nq)throw new Error("Unknown connection type: "+e);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function Ehe(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);const i=[];return Nr(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}class Ihe{constructor(){this.counters_={}}incrementCounter(e,n=1){(0,S.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return(0,S.p$)(this.counters_)}}const fN={},pN={};function gN(t){const e=t.toString();return fN[e]||(fN[e]=new Ihe),fN[e]}class The{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&xf(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class rl{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=__(e),this.stats_=gN(n),this.urlFn=u=>(this.appCheckToken&&(u.ac=this.appCheckToken),rq(n,nq,u))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new The(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(t){if((0,S.Yr)()||"complete"===document.readyState)t();else{let e=!1;const n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new mN((...s)=>{const[o,a,u,l,d]=s;if(this.incrementIncomingBytes_(s),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===o)this.id=a,this.password=u;else{if("close"!==o)throw new Error("Unrecognized command received: "+o);a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_()}},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&XW.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){rl.forceAllow_=!0}static forceDisallow(){rl.forceDisallow_=!0}static isAvailable(){return!((0,S.Yr)()||!rl.forceAllow_&&(rl.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=(0,S.Wl)(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=(0,S.h$)(n),i=WW(r,1840);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if((0,S.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=(0,S.Wl)(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class mN{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,S.Yr)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=jW(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=mN.createIFrame_();let s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Pr("frame writing exception"),a.stack&&Pr(a.stack),Pr(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Pr("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const o=this.pendingSegs.shift();r=r+"&seg"+i+"="+o.seg+"&ts"+i+"="+o.ts+"&d"+i+"="+o.d,i++}return n+=r,this.addLongPollTag_(n,this.currentSerial),!0}return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,n){(0,S.Yr)()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Pr("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let Ww=null;typeof MozWebSocket<"u"?Ww=MozWebSocket:typeof WebSocket<"u"&&(Ww=WebSocket);let kf=(()=>{class t{constructor(n,r,i,s,o,a,u){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=__(this.connId),this.stats_=gN(r),this.connURL=t.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){const a={v:"5"};return!(0,S.Yr)()&&typeof location<"u"&&location.hostname&&XW.test(location.hostname)&&(a.r="f"),r&&(a.s=r),i&&(a.ls=i),s&&(a.ac=s),o&&(a.p=o),rq(n,tq,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Uc.set("previous_websocket_failure",!0);try{let i;if((0,S.Yr)()){i={headers:{"User-Agent":`Firebase/5/${oN}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const o=process.env,a=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Ww(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&null!==Ww&&!t.forceDisallow_}static previouslyFailed(){return Uc.isInMemoryStorage||!0===Uc.get("previous_websocket_failure")}markConnectionHealthy(){Uc.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,S.cI)(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if((0,S.hu)(null===this.frames,"We already have a frame buffer"),n.length<=6){const r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(null===this.mySock)return;const r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();const r=(0,S.Wl)(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=WW(r,16384);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t})(),cq=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[rl,kf]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){const r=kf&&kf.isAvailable();let i=r&&!kf.previouslyFailed();if(n.webSocketOnly&&(r||ci("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[kf];else{const s=this.transports_=[];for(const o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return t.globalTransportInitialized_=!1,t})();class _q{constructor(e,n,r,i,s,o,a,u,l,d){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=__("c:"+this.id+":"),this.transportManager_=new cq(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=v_(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const n=e.t;"a"===n?this.upgradeIfSecondaryHealthy_():"r"===n?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===n&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=y_("t",e),r=y_("d",e);if("c"===n)this.onSecondaryControl_(r);else{if("d"!==n)throw new Error("Unknown protocol layer: "+n);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=y_("t",e),r=y_("d",e);"c"===n?this.onControl_(r):"d"===n&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=y_("t",e);if("d"in e){const r=e.d;if("h"===n){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if("n"===n){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===n?this.onConnectionShutdown_(r):"r"===n?this.onReset_(r):"e"===n?lN("Server Error: "+r):"o"===n?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):lN("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),"5"!==r&&ci("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),v_(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):v_(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Uc.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class yq{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}class vq{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,S.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context))return void i.splice(s,1)}validateEventType_(e){(0,S.hu)(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}class qw extends vq{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,S.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new qw}getInitialEvent(e){return(0,S.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class Ut{constructor(e,n){if(void 0===n){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)""!==this.pieces_[n]&&(e+="/"+this.pieces_[n]);return e||"/"}}function Mt(){return new Ut("")}function ft(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function il(t){return t.pieces_.length-t.pieceNum_}function rn(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Ut(t.pieces_,e)}function yN(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function I_(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function wq(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Ut(e,0)}function Sn(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Ut)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new Ut(n,0)}function pt(t){return t.pieceNum_>=t.pieces_.length}function Ni(t,e){const n=ft(t),r=ft(e);if(null===n)return e;if(n===r)return Ni(rn(t),rn(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Whe(t,e){const n=I_(t,0),r=I_(e,0);for(let i=0;i<n.length&&i<r.length;i++){const s=jc(n[i],r[i]);if(0!==s)return s}return n.length===r.length?0:n.length<r.length?-1:1}function vN(t,e){if(il(t)!==il(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function qs(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(il(t)>il(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class qhe{constructor(e,n){this.errorPrefix_=n,this.parts_=I_(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,S.ug)(this.parts_[r]);Tq(this)}}function Tq(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+$c(t))}function $c(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}class EN extends vq{constructor(){let e,n;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new EN}getInitialEvent(e){return(0,S.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const w_=1e3;let Kw,Hc=(()=>{class t extends yq{constructor(n,r,i,s,o,a,u,l){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=l,this.id=t.nextPersistentConnectionId_++,this.log_=__("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=w_,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!(0,S.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");EN.getInstance().on("visible",this.onVisible_,this),-1===n.host.indexOf("fblocal")&&qw.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){const s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_((0,S.Wl)(o)),(0,S.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();const r=new S.BH,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{const u=a.d;"ok"===a.s?r.resolve(u):r.reject(u)}};return this.outstandingGets_.push(s),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(n,r,i,s){this.initConnection_();const o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),(0,S.hu)(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,S.hu)(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");const u={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(n){const r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){const r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i};n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest("q",o,u=>{const l=u.d,d=u.s;t.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",u),"ok"!==d&&this.removeListen_(i,s),n.onComplete&&n.onComplete(d,l))})}static warnOnListenWarnings_(n,r){if(n&&"object"==typeof n&&(0,S.r3)(n,"w")){const i=(0,S.DV)(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();ci(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&40===n.length||(0,S.GJ)(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const n=this.authToken_,r=(0,S.w9)(n)?"auth":"gauth",i={cred:n};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{const o=s.s,a=s.d||"error";this.authToken_===n&&("ok"===o?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{const r=n.s,i=n.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){const i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),(0,S.hu)(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);const o={p:n};s&&(o.q=i,o.t=s),this.sendRequest("n",o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){const o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();const a={p:r,d:i};void 0!==o&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(n){const r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){const r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+(0,S.Wl)(n));const r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),"d"===n?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===n?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===n?this.onListenRevoked_(r.p,r.q):"ac"===n?this.onAuthRevoked_(r.s,r.d):"apc"===n?this.onAppCheckRevoked_(r.s,r.d):"sd"===n?this.onSecurityDebugPacket_(r):lN("Unrecognized action received from server: "+(0,S.Wl)(n)+"\nAre you using the latest client?")}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){(0,S.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=w_,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=w_,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=w_),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const n=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var n=this;return(0,Z.Z)(function*(){if(n.shouldReconnect_()){n.log_("Making a connection attempt"),n.lastConnectionAttemptTime_=(new Date).getTime(),n.lastConnectionEstablishedTime_=null;const r=n.onDataMessage_.bind(n),i=n.onReady_.bind(n),s=n.onRealtimeDisconnect_.bind(n),o=n.id+":"+t.nextConnectionId_++,a=n.lastSessionId;let u=!1,l=null;const d=function(){l?l.close():(u=!0,s())};n.realtime_={close:d,sendRequest:function(_){(0,S.hu)(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(_)}};const m=n.forceTokenRefresh_;n.forceTokenRefresh_=!1;try{const[_,v]=yield Promise.all([n.authTokenProvider_.getToken(m),n.appCheckTokenProvider_.getToken(m)]);u?Pr("getToken() completed but was canceled"):(Pr("getToken() completed. Creating connection."),n.authToken_=_&&_.accessToken,n.appCheckToken_=v&&v.token,l=new _q(o,n.repoInfo_,n.applicationId_,n.appCheckToken_,n.authToken_,r,i,s,T=>{ci(T+" ("+n.repoInfo_.toString()+")"),n.interrupt("server_kill")},a))}catch(_){n.log_("Failed to get token: "+_),u||(n.repoInfo_.nodeAdmin&&ci(_),d())}}})()}interrupt(n){Pr("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){Pr("Resuming connection for reason: "+n),delete this.interruptReasons_[n],(0,S.xb)(this.interruptReasons_)&&(this.reconnectDelay_=w_,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){const r=n-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){const r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;i=r?r.map(o=>cN(o)).join("$"):"default";const s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){const i=new Ut(n).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(r),o.delete(r),0===o.size&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){Pr("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===n||"permission_denied"===n)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){Pr("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===n||"permission_denied"===n)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const n of this.listens.values())for(const r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){const n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){const n={};let r="js";(0,S.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),n["sdk."+r+"."+oN.replace(/\./g,"-")]=1,(0,S.uI)()?n["framework.cordova"]=1:(0,S.b$)()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){const n=qw.getInstance().currentlyOnline();return(0,S.xb)(this.interruptReasons_)&&n}}return t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t})();class gt{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new gt(e,n)}}class Gw{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new gt(nl,e),i=new gt(nl,n);return 0!==this.compare(r,i)}minPost(){return gt.MIN}}class Dq extends Gw{static get __EMPTY_NODE(){return Kw}static set __EMPTY_NODE(e){Kw=e}compare(e,n){return jc(e.name,n.name)}isDefinedOn(e){throw(0,S.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return gt.MIN}maxPost(){return new gt(Qa,Kw)}makePost(e,n){return(0,S.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new gt(e,Kw)}toString(){return".key"}}const oa=new Dq;class Zw{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,i&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let n,e=this.nodeStack_.pop();if(n=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let wN,Io=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??Ki.EMPTY_NODE,this.right=o??Ki.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this;const o=i(n,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(n,r,i),null):0===o?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ki.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(n,i.key)){if(i.right.isEmpty())return Ki.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){const n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){const n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){const n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){const n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})();class Ki{constructor(e,n=Ki.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Ki(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Io.BLACK,null,null))}remove(e){return new Ki(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Io.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),0===n)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),0===n){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}n<0?r=r.left:n>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Zw(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Zw(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Zw(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Zw(this.root_,null,this.comparator_,!0,e)}}function efe(t,e){return jc(t.name,e.name)}function IN(t,e){return jc(t,e)}Ki.EMPTY_NODE=new class Jhe{copy(e,n,r,i,s){return this}insert(e,n,r){return new Io(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Aq=function(t){return"number"==typeof t?"number:"+qW(t):"string:"+t},bq=function(t){if(t.isLeafNode()){const e=t.val();(0,S.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,S.r3)(e,".sv"),"Priority must be a string or number.")}else(0,S.hu)(t===wN||t.isEmpty(),"priority of unexpected type.");(0,S.hu)(t===wN||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Rq,Pq,Nq,Of=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,(0,S.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),bq(this.priorityNode_)}static set __childrenNodeConstructor(n){Rq=n}static get __childrenNodeConstructor(){return Rq}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return".priority"===n?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return pt(n)?this:".priority"===ft(n)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return".priority"===n?this.updatePriority(r):r.isEmpty()&&".priority"!==n?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){const i=ft(n);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,S.hu)(".priority"!==i||1===il(n),".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(rn(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+Aq(this.priorityNode_.val())+":");const r=typeof this.value_;n+=r+":",n+="number"===r?qW(this.value_):this.value_,this.lazyHash_=$W(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:((0,S.hu)(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){const r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return(0,S.hu)(s>=0,"Unknown leaf type: "+r),(0,S.hu)(o>=0,"Unknown leaf type: "+i),s===o?"object"===i?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){return n===this||!!n.isLeafNode()&&(this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_))}}return t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t})();const fn=new class ife extends Gw{compare(e,n){const r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return 0===s?jc(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return gt.MIN}maxPost(){return new gt(Qa,new Of("[PRIORITY-POST]",Nq))}makePost(e,n){const r=Pq(e);return new gt(n,new Of("[PRIORITY-POST]",r))}toString(){return".priority"}},sfe=Math.log(2);class ofe{constructor(e){this.count=parseInt(Math.log(e+1)/sfe,10),this.current_=this.count-1;const i=(s=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Qw=function(t,e,n,r){t.sort(e);const i=function(u,l){const d=l-u;let f,m;if(0===d)return null;if(1===d)return f=t[u],m=n?n(f):f,new Io(m,f.node,Io.BLACK,null,null);{const _=parseInt(d/2,10)+u,v=i(u,_),T=i(_+1,l);return f=t[_],m=n?n(f):f,new Io(m,f.node,Io.BLACK,v,T)}},a=function(u){let l=null,d=null,f=t.length;const m=function(v,T){const D=f-v,x=f;f-=v;const R=i(D+1,x),L=t[D],G=n?n(L):L;_(new Io(G,L.node,T,null,R))},_=function(v){l?(l.left=v,l=v):(d=v,l=v)};for(let v=0;v<u.count;++v){const T=u.nextBitIsOne(),D=Math.pow(2,u.count-(v+1));T?m(D,Io.BLACK):(m(D,Io.BLACK),m(D,Io.RED))}return d}(new ofe(t.length));return new Ki(r||e,a)};let TN;const Lf={};class Ya{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return(0,S.hu)(Lf&&fn,"ChildrenNode.ts has not been loaded"),TN=TN||new Ya({".priority":Lf},{".priority":fn}),TN}get(e){const n=(0,S.DV)(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Ki?n:null}hasIndex(e){return(0,S.r3)(this.indexSet_,e.toString())}addIndex(e,n){(0,S.hu)(e!==oa,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=n.getIterator(gt.Wrap);let a,o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();a=i?Qw(r,e.getCompare()):Lf;const u=e.toString(),l=Object.assign({},this.indexSet_);l[u]=e;const d=Object.assign({},this.indexes_);return d[u]=a,new Ya(d,l)}addToIndexes(e,n){const r=(0,S.UI)(this.indexes_,(i,s)=>{const o=(0,S.DV)(this.indexSet_,s);if((0,S.hu)(o,"Missing index implementation for "+s),i===Lf){if(o.isDefinedOn(e.node)){const a=[],u=n.getIterator(gt.Wrap);let l=u.getNext();for(;l;)l.name!==e.name&&a.push(l),l=u.getNext();return a.push(e),Qw(a,o.getCompare())}return Lf}{const a=n.get(e.name);let u=i;return a&&(u=u.remove(new gt(e.name,a))),u.insert(e,e.node)}});return new Ya(r,this.indexSet_)}removeFromIndexes(e,n){const r=(0,S.UI)(this.indexes_,i=>{if(i===Lf)return i;{const s=n.get(e.name);return s?i.remove(new gt(e.name,s)):i}});return new Ya(r,this.indexSet_)}}let T_,tt=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&bq(this.priorityNode_),this.children_.isEmpty()&&(0,S.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return T_||(T_=new t(new Ki(IN),null,Ya.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||T_}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(".priority"===n)return this.getPriority();{const r=this.children_.get(n);return null===r?T_:r}}getChild(n){const r=ft(n);return null===r?this:this.getImmediateChild(r).getChild(rn(n))}hasChild(n){return null!==this.children_.get(n)}updateImmediateChild(n,r){if((0,S.hu)(r,"We should always be passing snapshot nodes"),".priority"===n)return this.updatePriority(r);{const i=new gt(n,r);let s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));const a=s.isEmpty()?T_:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){const i=ft(n);if(null===i)return r;{(0,S.hu)(".priority"!==ft(n)||1===il(n),".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(rn(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;const r={};let i=0,s=0,o=!0;if(this.forEachChild(fn,(a,u)=>{r[a]=u.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){const a=[];for(const u in r)a[u]=r[u];return a}return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let n="";this.getPriority().isEmpty()||(n+="priority:"+Aq(this.getPriority().val())+":"),this.forEachChild(fn,(r,i)=>{const s=i.hash();""!==s&&(n+=":"+r+":"+s)}),this.lazyHash_=""===n?"":$W(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new gt(n,r));return o?o.name:null}return this.children_.getPredecessorKey(n)}getFirstChildName(n){const r=this.resolveIndex_(n);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(n){const r=this.getFirstChildName(n);return r?new gt(r,this.children_.get(r)):null}getLastChildName(n){const r=this.resolveIndex_(n);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(n){const r=this.getLastChildName(n);return r?new gt(r,this.children_.get(r)):null}forEachChild(n,r){const i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{const s=this.children_.getIteratorFrom(n.name,gt.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{const s=this.children_.getReverseIteratorFrom(n.name,gt.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===C_?-1:0}withIndex(n){if(n===oa||this.indexMap_.hasIndex(n))return this;{const r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===oa||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{const r=n;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(fn),s=r.getIterator(fn);let o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return null===o&&null===a}return!1}return!1}}resolveIndex_(n){return n===oa?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})();const C_=new class afe extends tt{constructor(){super(new Ki(IN),tt.EMPTY_NODE,Ya.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return tt.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(gt,{MIN:{value:new gt(nl,tt.EMPTY_NODE)},MAX:{value:new gt(Qa,C_)}}),Dq.__EMPTY_NODE=tt.EMPTY_NODE,Of.__childrenNodeConstructor=tt,function tfe(t){wN=t}(C_),function rfe(t){Nq=t}(C_);const ufe=!0;function On(t,e=null){if(null===t)return tt.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),(0,S.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new Of(t,On(e));if(t instanceof Array||!ufe){let n=tt.EMPTY_NODE;return Nr(t,(r,i)=>{if((0,S.r3)(t,r)&&"."!==r.substring(0,1)){const s=On(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(On(e))}{const n=[];let r=!1;if(Nr(t,(o,a)=>{if("."!==o.substring(0,1)){const u=On(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),n.push(new gt(o,u)))}}),0===n.length)return tt.EMPTY_NODE;const s=Qw(n,efe,o=>o.name,IN);if(r){const o=Qw(n,fn.getCompare());return new tt(s,On(e),new Ya({".priority":o},{".priority":fn}))}return new tt(s,On(e),Ya.Default)}}!function nfe(t){Pq=t}(On);class CN extends Gw{constructor(e){super(),this.indexPath_=e,(0,S.hu)(!pt(e)&&".priority"!==ft(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return 0===s?jc(e.name,n.name):s}makePost(e,n){const r=On(e),i=tt.EMPTY_NODE.updateChild(this.indexPath_,r);return new gt(n,i)}maxPost(){const e=tt.EMPTY_NODE.updateChild(this.indexPath_,C_);return new gt(Qa,e)}toString(){return I_(this.indexPath_,0).join("/")}}const SN=new class lfe extends Gw{compare(e,n){const r=e.node.compareTo(n.node);return 0===r?jc(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return gt.MIN}maxPost(){return gt.MAX}makePost(e,n){const r=On(e);return new gt(n,r)}toString(){return".value"}};function Mq(t){return{type:"value",snapshotNode:t}}function Ff(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function S_(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function D_(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}class DN{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){(0,S.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(null!=o&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(S_(n,a)):(0,S.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Ff(n,r)):o.trackChildChange(D_(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return null!=r&&(e.isLeafNode()||e.forEachChild(fn,(i,s)=>{n.hasChild(i)||r.trackChildChange(S_(i,s))}),n.isLeafNode()||n.forEachChild(fn,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(D_(i,s,o))}else r.trackChildChange(Ff(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?tt.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class A_{constructor(e){this.indexedFilter_=new DN(e.getIndex()),this.index_=e.getIndex(),this.startPost_=A_.getStartPost_(e),this.endPost_=A_.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new gt(n,r))||(r=tt.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=tt.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(tt.EMPTY_NODE);const s=this;return n.forEachChild(fn,(o,a)=>{s.matches(new gt(o,a))||(i=i.updateImmediateChild(o,tt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}return e.getIndex().maxPost()}}class dfe{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new A_(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new gt(n,r))||(r=tt.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=tt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<n.numChildren()&&n.isIndexed(this.index_)){let s;i=tt.EMPTY_NODE.withIndex(this.index_),s=this.reverse_?n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();if(this.withinDirectionalStart(a)){if(!this.withinDirectionalEnd(a))break;i=i.updateImmediateChild(a.name,a.node),o++}}}else{let s;i=n.withIndex(this.index_),i=i.updatePriority(tt.EMPTY_NODE),s=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let o=0;for(;s.hasNext();){const a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,tt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){const f=this.index_.getCompare();o=(m,_)=>f(_,m)}else o=this.index_.getCompare();const a=e;(0,S.hu)(a.numChildren()===this.limit_,"");const u=new gt(n,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(u);if(a.hasChild(n)){const f=a.getImmediateChild(n);let m=i.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=m&&(m.name===n||a.hasChild(m.name));)m=i.getChildAfterChild(this.index_,m,this.reverse_);const _=null==m?1:o(m,u);if(d&&!r.isEmpty()&&_>=0)return s?.trackChildChange(D_(n,r,f)),a.updateImmediateChild(n,r);{s?.trackChildChange(S_(n,f));const T=a.updateImmediateChild(n,tt.EMPTY_NODE);return null!=m&&this.rangedFilter_.matches(m)?(s?.trackChildChange(Ff(m.name,m.node)),T.updateImmediateChild(m.name,m.node)):T}}return r.isEmpty()?e:d&&o(l,u)>=0?(null!=s&&(s.trackChildChange(S_(l.name,l.node)),s.trackChildChange(Ff(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(l.name,tt.EMPTY_NODE)):e}}class Yw{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=fn}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,S.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,S.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:nl}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,S.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,S.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Qa}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,S.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===fn}copy(){const e=new Yw;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function AN(t,e,n){const r=t.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function bN(t,e,n){const r=t.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function Xw(t,e){const n=t.copy();return n.index_=e,n}function xq(t){const e={};if(t.isDefault())return e;let n;if(t.index_===fn?n="$priority":t.index_===SN?n="$value":t.index_===oa?n="$key":((0,S.hu)(t.index_ instanceof CN,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=(0,S.Wl)(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=(0,S.Wl)(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+(0,S.Wl)(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=(0,S.Wl)(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+(0,S.Wl)(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function kq(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==fn&&(e.i=t.index_.toString()),e}class Jw extends yq{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=__("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return void 0!==n?"tag$"+n:((0,S.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=Jw.getListenId_(e,r),a={};this.listens_[o]=a;const u=xq(e._queryParams);this.restRequest_(s+".json",u,(l,d)=>{let f=d;if(404===l&&(f=null,l=null),null===l&&this.onDataUpdate_(s,f,!1,r),(0,S.DV)(this.listens_,o)===a){let m;m=l?401===l?"permission_denied":"rest_error:"+l:"ok",i(m,null)}})}unlisten(e,n){const r=Jw.getListenId_(e,n);delete this.listens_[r]}get(e){const n=xq(e._queryParams),r=e._path.toString(),i=new S.BH;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;404===s&&(a=null,s=null),null===s?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,S.xO)(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=(0,S.cI)(a.responseText)}catch{ci("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else 401!==a.status&&404!==a.status&&ci("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}class _fe{constructor(){this.rootNode_=tt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}function eT(){return{value:null,children:new Map}}function Vf(t,e,n){if(pt(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{const r=ft(e);t.children.has(r)||t.children.set(r,eT()),Vf(t.children.get(r),e=rn(e),n)}}function RN(t,e){if(pt(e))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(fn,(r,i)=>{Vf(t,new Ut(r),i)}),RN(t,e)}}if(t.children.size>0){const n=ft(e);return e=rn(e),t.children.has(n)&&RN(t.children.get(n),e)&&t.children.delete(n),0===t.children.size}return!0}function PN(t,e,n){null!==t.value?n(e,t.value):function yfe(t,e){t.children.forEach((n,r)=>{e(r,n)})}(t,(r,i)=>{PN(i,new Ut(e.toString()+"/"+r),n)})}class vfe{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Nr(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}}class wfe{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new vfe(e);const r=1e4+2e4*Math.random();v_(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;Nr(e,(i,s)=>{s>0&&(0,S.r3)(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),v_(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var aa=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(aa||{});function xN(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}class tT{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=aa.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(pt(this.path)){if(null!=this.affectedTree.value)return(0,S.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Ut(e));return new tT(Mt(),n,this.revert)}}return(0,S.hu)(ft(this.path)===e,"operationForChild called for unrelated child."),new tT(rn(this.path),this.affectedTree,this.revert)}}class b_{constructor(e,n){this.source=e,this.path=n,this.type=aa.LISTEN_COMPLETE}operationForChild(e){return pt(this.path)?new b_(this.source,Mt()):new b_(this.source,rn(this.path))}}class zc{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=aa.OVERWRITE}operationForChild(e){return pt(this.path)?new zc(this.source,Mt(),this.snap.getImmediateChild(e)):new zc(this.source,rn(this.path),this.snap)}}class Uf{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=aa.MERGE}operationForChild(e){if(pt(this.path)){const n=this.children.subtree(new Ut(e));return n.isEmpty()?null:n.value?new zc(this.source,Mt(),n.value):new Uf(this.source,Mt(),n)}return(0,S.hu)(ft(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Uf(this.source,rn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class sl{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(pt(e))return this.isFullyInitialized()&&!this.filtered_;const n=ft(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Tfe{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function R_(t,e,n,r,i,s){const o=r.filter(a=>a.type===n);o.sort((a,u)=>function Dfe(t,e,n){if(null==e.childName||null==n.childName)throw(0,S.g5)("Should only compare child_ events.");const r=new gt(e.childName,e.snapshotNode),i=new gt(n.childName,n.snapshotNode);return t.index_.compare(r,i)}(t,a,u)),o.forEach(a=>{const u=function Sfe(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(u,t.query_))})})}function nT(t,e){return{eventCache:t,serverCache:e}}function P_(t,e,n,r){return nT(new sl(e,n,r),t.serverCache)}function Lq(t,e,n,r){return nT(t.eventCache,new sl(e,n,r))}function rT(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Wc(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}let kN;class pn{constructor(e,n=(()=>(kN||(kN=new Ki(che)),kN))()){this.value=e,this.children=n}static fromObject(e){let n=new pn(null);return Nr(e,(r,i)=>{n=n.set(new Ut(r),i)}),n}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(null!=this.value&&n(this.value))return{path:Mt(),value:this.value};if(pt(e))return null;{const r=ft(e),i=this.children.get(r);if(null!==i){const s=i.findRootMostMatchingPathAndValue(rn(e),n);return null!=s?{path:Sn(new Ut(r),s.path),value:s.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(pt(e))return this;{const n=ft(e),r=this.children.get(n);return null!==r?r.subtree(rn(e)):new pn(null)}}set(e,n){if(pt(e))return new pn(n,this.children);{const r=ft(e),s=(this.children.get(r)||new pn(null)).set(rn(e),n),o=this.children.insert(r,s);return new pn(this.value,o)}}remove(e){if(pt(e))return this.children.isEmpty()?new pn(null):new pn(null,this.children);{const n=ft(e),r=this.children.get(n);if(r){const i=r.remove(rn(e));let s;return s=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&s.isEmpty()?new pn(null):new pn(this.value,s)}return this}}get(e){if(pt(e))return this.value;{const n=ft(e),r=this.children.get(n);return r?r.get(rn(e)):null}}setTree(e,n){if(pt(e))return n;{const r=ft(e),s=(this.children.get(r)||new pn(null)).setTree(rn(e),n);let o;return o=s.isEmpty()?this.children.remove(r):this.children.insert(r,s),new pn(this.value,o)}}fold(e){return this.fold_(Mt(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Sn(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Mt(),n)}findOnPath_(e,n,r){const i=!!this.value&&r(n,this.value);if(i)return i;if(pt(e))return null;{const s=ft(e),o=this.children.get(s);return o?o.findOnPath_(rn(e),Sn(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Mt(),n)}foreachOnPath_(e,n,r){if(pt(e))return this;{this.value&&r(n,this.value);const i=ft(e),s=this.children.get(i);return s?s.foreachOnPath_(rn(e),Sn(n,i),r):new pn(null)}}foreach(e){this.foreach_(Mt(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Sn(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}class wo{constructor(e){this.writeTree_=e}static empty(){return new wo(new pn(null))}}function N_(t,e,n){if(pt(e))return new wo(new pn(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let s=r.value;const o=Ni(i,e);return s=s.updateChild(o,n),new wo(t.writeTree_.set(i,s))}{const i=new pn(n),s=t.writeTree_.setTree(e,i);return new wo(s)}}}function ON(t,e,n){let r=t;return Nr(n,(i,s)=>{r=N_(r,Sn(e,i),s)}),r}function Fq(t,e){if(pt(e))return wo.empty();{const n=t.writeTree_.setTree(e,new pn(null));return new wo(n)}}function LN(t,e){return null!=qc(t,e)}function qc(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(Ni(n.path,e)):null}function Vq(t){const e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(fn,(r,i)=>{e.push(new gt(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new gt(r,i.value))}),e}function ol(t,e){if(pt(e))return t;{const n=qc(t,e);return new wo(null!=n?new pn(n):t.writeTree_.subtree(e))}}function FN(t){return t.writeTree_.isEmpty()}function Bf(t,e){return Uq(Mt(),t.writeTree_,e)}function Uq(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{".priority"===i?((0,S.hu)(null!==s.value,"Priority writes must always be leaf nodes"),r=s.value):n=Uq(Sn(t,i),s,n)}),!n.getChild(t).isEmpty()&&null!==r&&(n=n.updateChild(Sn(t,".priority"),r)),n}}function iT(t,e){return zq(e,t)}function Mfe(t,e){if(t.snap)return qs(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&qs(Sn(t.path,n),e))return!0;return!1}function kfe(t){return t.visible}function Bq(t,e,n){let r=wo.empty();for(let i=0;i<t.length;++i){const s=t[i];if(e(s)){const o=s.path;let a;if(s.snap)qs(n,o)?(a=Ni(n,o),r=N_(r,a,s.snap)):qs(o,n)&&(a=Ni(o,n),r=N_(r,Mt(),s.snap.getChild(a)));else{if(!s.children)throw(0,S.g5)("WriteRecord should have .snap or .children");if(qs(n,o))a=Ni(n,o),r=ON(r,a,s.children);else if(qs(o,n))if(a=Ni(o,n),pt(a))r=ON(r,Mt(),s.children);else{const u=(0,S.DV)(s.children,ft(a));if(u){const l=u.getChild(rn(a));r=N_(r,Mt(),l)}}}}}return r}function jq(t,e,n,r,i){if(r||i){const s=ol(t.visibleWrites,e);return!i&&FN(s)?n:i||null!=n||LN(s,Mt())?Bf(Bq(t.allWrites,function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(qs(l.path,e)||qs(e,l.path))},e),n||tt.EMPTY_NODE):null}{const s=qc(t.visibleWrites,e);if(null!=s)return s;{const o=ol(t.visibleWrites,e);return FN(o)?n:null!=n||LN(o,Mt())?Bf(o,n||tt.EMPTY_NODE):null}}}function sT(t,e,n,r){return jq(t.writeTree,t.treePath,e,n,r)}function VN(t,e){return function Ofe(t,e,n){let r=tt.EMPTY_NODE;const i=qc(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(fn,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){const s=ol(t.visibleWrites,e);return n.forEachChild(fn,(o,a)=>{const u=Bf(ol(s,new Ut(o)),a);r=r.updateImmediateChild(o,u)}),Vq(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}return Vq(ol(t.visibleWrites,e)).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}(t.writeTree,t.treePath,e)}function $q(t,e,n,r){return function Lfe(t,e,n,r,i){(0,S.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Sn(e,n);if(LN(t.visibleWrites,s))return null;{const o=ol(t.visibleWrites,s);return FN(o)?i.getChild(n):Bf(o,i.getChild(n))}}(t.writeTree,t.treePath,e,n,r)}function oT(t,e){return function Vfe(t,e){return qc(t.visibleWrites,e)}(t.writeTree,Sn(t.treePath,e))}function UN(t,e,n){return function Ffe(t,e,n,r){const i=Sn(e,n),s=qc(t.visibleWrites,i);return null!=s?s:r.isCompleteForChild(n)?Bf(ol(t.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function Hq(t,e){return zq(Sn(t.treePath,e),t.writeTree)}function zq(t,e){return{treePath:t,writeTree:e}}class $fe{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;(0,S.hu)("child_added"===n||"child_changed"===n||"child_removed"===n,"Only child changes supported for tracking"),(0,S.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if("child_added"===n&&"child_removed"===s)this.changeMap.set(r,D_(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===n&&"child_added"===s)this.changeMap.delete(r);else if("child_removed"===n&&"child_changed"===s)this.changeMap.set(r,S_(r,i.oldSnap));else if("child_changed"===n&&"child_added"===s)this.changeMap.set(r,Ff(r,e.snapshotNode));else{if("child_changed"!==n||"child_changed"!==s)throw(0,S.g5)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,D_(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const Wq=new class Hfe{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}};class BN{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new sl(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return UN(this.writes_,e,r)}}getChildAfterChild(e,n,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Wc(this.viewCache_),s=function jfe(t,e,n,r,i,s){return function Ufe(t,e,n,r,i,s,o){let a;const u=ol(t.visibleWrites,e),l=qc(u,Mt());if(null!=l)a=l;else{if(null==n)return[];a=Bf(u,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const d=[],f=o.getCompare(),m=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let _=m.getNext();for(;_&&d.length<i;)0!==f(_,r)&&d.push(_),_=m.getNext();return d}}(t.writeTree,t.treePath,e,n,r,i,s)}(this.writes_,i,n,1,r,e);return 0===s.length?null:s[0]}}function qq(t,e,n,r,i,s){const o=e.eventCache;if(null!=oT(r,n))return e;{let a,u;if(pt(n))if((0,S.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const l=Wc(e),f=VN(r,l instanceof tt?l:tt.EMPTY_NODE);a=t.filter.updateFullNode(e.eventCache.getNode(),f,s)}else{const l=sT(r,Wc(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{const l=ft(n);if(".priority"===l){(0,S.hu)(1===il(n),"Can't have a priority with additional path components");const d=o.getNode();u=e.serverCache.getNode();const f=$q(r,n,d,u);a=null!=f?t.filter.updatePriority(d,f):o.getNode()}else{const d=rn(n);let f;if(o.isCompleteForChild(l)){u=e.serverCache.getNode();const m=$q(r,n,o.getNode(),u);f=null!=m?o.getNode().getImmediateChild(l).updateChild(d,m):o.getNode().getImmediateChild(l)}else f=UN(r,l,e.serverCache);a=null!=f?t.filter.updateChild(o.getNode(),l,f,d,i,s):o.getNode()}}return P_(e,a,o.isFullyInitialized()||pt(n),t.filter.filtersNodes())}}function aT(t,e,n,r,i,s,o,a){const u=e.serverCache;let l;const d=o?t.filter:t.filter.getIndexedFilter();if(pt(n))l=d.updateFullNode(u.getNode(),r,null);else if(d.filtersNodes()&&!u.isFiltered()){const _=u.getNode().updateChild(n,r);l=d.updateFullNode(u.getNode(),_,null)}else{const _=ft(n);if(!u.isCompleteForPath(n)&&il(n)>1)return e;const v=rn(n),D=u.getNode().getImmediateChild(_).updateChild(v,r);l=".priority"===_?d.updatePriority(u.getNode(),D):d.updateChild(u.getNode(),_,D,v,Wq,null)}const f=Lq(e,l,u.isFullyInitialized()||pt(n),d.filtersNodes());return qq(t,f,n,i,new BN(i,f,s),a)}function jN(t,e,n,r,i,s,o){const a=e.eventCache;let u,l;const d=new BN(i,e,s);if(pt(n))l=t.filter.updateFullNode(e.eventCache.getNode(),r,o),u=P_(e,l,!0,t.filter.filtersNodes());else{const f=ft(n);if(".priority"===f)l=t.filter.updatePriority(e.eventCache.getNode(),r),u=P_(e,l,a.isFullyInitialized(),a.isFiltered());else{const m=rn(n),_=a.getNode().getImmediateChild(f);let v;if(pt(m))v=r;else{const T=d.getCompleteChild(f);v=null!=T?".priority"===yN(m)&&T.getChild(wq(m)).isEmpty()?T:T.updateChild(m,r):tt.EMPTY_NODE}u=_.equals(v)?e:P_(e,t.filter.updateChild(a.getNode(),f,v,m,d,o),a.isFullyInitialized(),t.filter.filtersNodes())}}return u}function Gq(t,e){return t.eventCache.isCompleteForChild(e)}function Kq(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function $N(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l,u=e;l=pt(n)?r:new pn(null).setTree(n,r);const d=e.serverCache.getNode();return l.children.inorderTraversal((f,m)=>{if(d.hasChild(f)){const v=Kq(0,e.serverCache.getNode().getImmediateChild(f),m);u=aT(t,u,new Ut(f),v,i,s,o,a)}}),l.children.inorderTraversal((f,m)=>{const _=!e.serverCache.isCompleteForChild(f)&&null===m.value;if(!d.hasChild(f)&&!_){const T=Kq(0,e.serverCache.getNode().getImmediateChild(f),m);u=aT(t,u,new Ut(f),T,i,s,o,a)}}),u}class Xfe{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new DN(r.getIndex()),s=function hfe(t){return t.loadsAllData()?new DN(t.getIndex()):t.hasLimit()?new dfe(t):new A_(t)}(r);this.processor_=function zfe(t){return{filter:t}}(s);const o=n.serverCache,a=n.eventCache,u=i.updateFullNode(tt.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(tt.EMPTY_NODE,a.getNode(),null),d=new sl(u,o.isFullyInitialized(),i.filtersNodes()),f=new sl(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=nT(f,d),this.eventGenerator_=new Tfe(this.query_)}get query(){return this.query_}}function tpe(t,e){const n=Wc(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!pt(e)&&!n.getImmediateChild(ft(e)).isEmpty())?n.getChild(e):null}function Zq(t){return 0===t.eventRegistrations_.length}function Qq(t,e,n){const r=[];if(n){(0,S.hu)(null==e,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){const o=t.eventRegistrations_[s];if(o.matches(e)){if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}else i.push(o)}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function Yq(t,e,n,r){e.type===aa.MERGE&&null!==e.source.queryId&&((0,S.hu)(Wc(t.viewCache_),"We should always have a full cache before handling merges"),(0,S.hu)(rT(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,s=function qfe(t,e,n,r,i){const s=new $fe;let o,a;if(n.type===aa.OVERWRITE){const l=n;l.source.fromUser?o=jN(t,e,l.path,l.snap,r,i,s):((0,S.hu)(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!pt(l.path),o=aT(t,e,l.path,l.snap,r,i,a,s))}else if(n.type===aa.MERGE){const l=n;l.source.fromUser?o=function Kfe(t,e,n,r,i,s,o){let a=e;return r.foreach((u,l)=>{const d=Sn(n,u);Gq(e,ft(d))&&(a=jN(t,a,d,l,i,s,o))}),r.foreach((u,l)=>{const d=Sn(n,u);Gq(e,ft(d))||(a=jN(t,a,d,l,i,s,o))}),a}(t,e,l.path,l.children,r,i,s):((0,S.hu)(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=$N(t,e,l.path,l.children,r,i,a,s))}else if(n.type===aa.ACK_USER_WRITE){const l=n;o=l.revert?function Yfe(t,e,n,r,i,s){let o;if(null!=oT(r,n))return e;{const a=new BN(r,e,i),u=e.eventCache.getNode();let l;if(pt(n)||".priority"===ft(n)){let d;if(e.serverCache.isFullyInitialized())d=sT(r,Wc(e));else{const f=e.serverCache.getNode();(0,S.hu)(f instanceof tt,"serverChildren would be complete if leaf node"),d=VN(r,f)}l=t.filter.updateFullNode(u,d,s)}else{const d=ft(n);let f=UN(r,d,e.serverCache);null==f&&e.serverCache.isCompleteForChild(d)&&(f=u.getImmediateChild(d)),l=null!=f?t.filter.updateChild(u,d,f,rn(n),a,s):e.eventCache.getNode().hasChild(d)?t.filter.updateChild(u,d,tt.EMPTY_NODE,rn(n),a,s):u,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=sT(r,Wc(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||null!=oT(r,Mt()),P_(e,l,o,t.filter.filtersNodes())}}(t,e,l.path,r,i,s):function Zfe(t,e,n,r,i,s,o){if(null!=oT(i,n))return e;const a=e.serverCache.isFiltered(),u=e.serverCache;if(null!=r.value){if(pt(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return aT(t,e,n,u.getNode().getChild(n),i,s,a,o);if(pt(n)){let l=new pn(null);return u.getNode().forEachChild(oa,(d,f)=>{l=l.set(new Ut(d),f)}),$N(t,e,n,l,i,s,a,o)}return e}{let l=new pn(null);return r.foreach((d,f)=>{const m=Sn(n,d);u.isCompleteForPath(m)&&(l=l.set(d,u.getNode().getChild(m)))}),$N(t,e,n,l,i,s,a,o)}}(t,e,l.path,l.affectedTree,r,i,s)}else{if(n.type!==aa.LISTEN_COMPLETE)throw(0,S.g5)("Unknown operation type: "+n.type);o=function Qfe(t,e,n,r,i){const s=e.serverCache;return qq(t,Lq(e,s.getNode(),s.isFullyInitialized()||pt(n),s.isFiltered()),n,r,Wq,i)}(t,e,n.path,r,s)}const u=s.getChanges();return function Gfe(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=rT(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(Mq(rT(e)))}}(e,o,u),{viewCache:o,changes:u}}(t.processor_,i,e,n,r);return function Wfe(t,e){(0,S.hu)(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),(0,S.hu)(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}(t.processor_,s.viewCache),(0,S.hu)(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,Xq(t,s.changes,s.viewCache.eventCache.getNode(),null)}function Xq(t,e,n,r){return function Cfe(t,e,n,r){const i=[],s=[];return e.forEach(o=>{"child_changed"===o.type&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(function cfe(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}(o.childName,o.snapshotNode))}),R_(t,i,"child_removed",e,r,n),R_(t,i,"child_added",e,r,n),R_(t,i,"child_moved",s,r,n),R_(t,i,"child_changed",e,r,n),R_(t,i,"value",e,r,n),i}(t.eventGenerator_,e,n,r?[r]:t.eventRegistrations_)}let uT,cT;class Jq{constructor(){this.views=new Map}}function HN(t,e,n,r){const i=e.source.queryId;if(null!==i){const s=t.views.get(i);return(0,S.hu)(null!=s,"SyncTree gave us an op for an invalid query."),Yq(s,e,n,r)}{let s=[];for(const o of t.views.values())s=s.concat(Yq(o,e,n,r));return s}}function e4(t,e,n,r,i){const o=t.views.get(e._queryIdentifier);if(!o){let a=sT(n,i?r:null),u=!1;a?u=!0:r instanceof tt?(a=VN(n,r),u=!1):(a=tt.EMPTY_NODE,u=!1);const l=nT(new sl(a,u,!1),new sl(r,i,!1));return new Xfe(e,l)}return o}function t4(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function al(t,e){let n=null;for(const r of t.views.values())n=n||tpe(r,e);return n}function n4(t,e){return e._queryParams.loadsAllData()?lT(t):t.views.get(e._queryIdentifier)}function r4(t,e){return null!=n4(t,e)}function ul(t){return null!=lT(t)}function lT(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let dpe=1;class i4{constructor(e){this.listenProvider_=e,this.syncPointTree_=new pn(null),this.pendingWriteTree_=function Bfe(){return{visibleWrites:wo.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function zN(t,e,n,r,i){return function bfe(t,e,n,r,i){(0,S.hu)(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=N_(t.visibleWrites,e,n)),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r,i),i?jf(t,new zc({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function ll(t,e,n=!1){const r=function Pfe(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}(t.pendingWriteTree_,e);if(function Nfe(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);(0,S.hu)(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&Mfe(a,r.path)?i=!1:qs(r.path,a.path)&&(s=!0)),o--}return!!i&&(s?(function xfe(t){t.visibleWrites=Bq(t.allWrites,kfe,Mt()),t.lastWriteId=t.allWrites.length>0?t.allWrites[t.allWrites.length-1].writeId:-1}(t),!0):(r.snap?t.visibleWrites=Fq(t.visibleWrites,r.path):Nr(r.children,u=>{t.visibleWrites=Fq(t.visibleWrites,Sn(r.path,u))}),!0))}(t.pendingWriteTree_,e)){let s=new pn(null);return null!=r.snap?s=s.set(Mt(),!0):Nr(r.children,o=>{s=s.set(new Ut(o),!0)}),jf(t,new tT(r.path,s,n))}return[]}function M_(t,e,n){return jf(t,new zc({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function dT(t,e,n,r,i=!1){const s=e._path,o=t.syncPointTree_.get(s);let a=[];if(o&&("default"===e._queryIdentifier||r4(o,e))){const u=function upe(t,e,n,r){const i=e._queryIdentifier,s=[];let o=[];const a=ul(t);if("default"===i)for(const[u,l]of t.views.entries())o=o.concat(Qq(l,n,r)),Zq(l)&&(t.views.delete(u),l.query._queryParams.loadsAllData()||s.push(l.query));else{const u=t.views.get(i);u&&(o=o.concat(Qq(u,n,r)),Zq(u)&&(t.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!ul(t)&&s.push(new(function spe(){return(0,S.hu)(uT,"Reference.ts has not been loaded"),uT}())(e._repo,e._path)),{removed:s,events:o}}(o,e,n,r);(function ope(t){return 0===t.views.size})(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));const l=u.removed;if(a=u.events,!i){const d=-1!==l.findIndex(m=>m._queryParams.loadsAllData()),f=t.syncPointTree_.findOnPath(s,(m,_)=>ul(_));if(d&&!f){const m=t.syncPointTree_.subtree(s);if(!m.isEmpty()){const _=function ype(t){return t.fold((e,n,r)=>{if(n&&ul(n))return[lT(n)];{let i=[];return n&&(i=t4(n)),Nr(r,(s,o)=>{i=i.concat(o)}),i}})}(m);for(let v=0;v<_.length;++v){const T=_[v],D=T.query,x=u4(t,T);t.listenProvider_.startListening(k_(D),x_(t,D),x.hashFn,x.onComplete)}}}!f&&l.length>0&&!r&&(d?t.listenProvider_.stopListening(k_(e),null):l.forEach(m=>{const _=t.queryToTagMap.get(fT(m));t.listenProvider_.stopListening(k_(m),_)}))}!function vpe(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const i=fT(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}(t,l)}return a}function s4(t,e,n,r){const i=qN(t,r);if(null!=i){const s=GN(i),o=s.path,a=s.queryId,u=Ni(o,e);return KN(t,o,new zc(xN(a),u,n))}return[]}function WN(t,e,n,r=!1){const i=e._path;let s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(m,_)=>{const v=Ni(m,i);s=s||al(_,v),o=o||ul(_)});let u,a=t.syncPointTree_.get(i);a?(o=o||ul(a),s=s||al(a,Mt())):(a=new Jq,t.syncPointTree_=t.syncPointTree_.set(i,a)),null!=s?u=!0:(u=!1,s=tt.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((_,v)=>{const T=al(v,Mt());T&&(s=s.updateImmediateChild(_,T))}));const l=r4(a,e);if(!l&&!e._queryParams.loadsAllData()){const m=fT(e);(0,S.hu)(!t.queryToTagMap.has(m),"View does not exist, but we have a tag");const _=function Epe(){return dpe++}();t.queryToTagMap.set(m,_),t.tagToQueryMap.set(_,m)}let f=function ape(t,e,n,r,i,s){const o=e4(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),function npe(t,e){t.eventRegistrations_.push(e)}(o,n),function rpe(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(fn,(s,o)=>{r.push(Ff(s,o))}),n.isFullyInitialized()&&r.push(Mq(n.getNode())),Xq(t,r,n.getNode(),e)}(o,n)}(a,e,n,iT(t.pendingWriteTree_,i),s,u);if(!l&&!o&&!r){const m=n4(a,e);f=f.concat(function Ipe(t,e,n){const r=e._path,i=x_(t,e),s=u4(t,n),o=t.listenProvider_.startListening(k_(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)(0,S.hu)(!ul(a.value),"If we're adding a query, it shouldn't be shadowed");else{const u=a.fold((l,d,f)=>{if(!pt(l)&&d&&ul(d))return[lT(d).query];{let m=[];return d&&(m=m.concat(t4(d).map(_=>_.query))),Nr(f,(_,v)=>{m=m.concat(v)}),m}});for(let l=0;l<u.length;++l){const d=u[l];t.listenProvider_.stopListening(k_(d),x_(t,d))}}return o}(t,e,m))}return f}function hT(t,e,n){const i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=al(a,Ni(o,e));if(l)return l});return jq(i,e,s,n,!0)}function jf(t,e){return o4(e,t.syncPointTree_,null,iT(t.pendingWriteTree_,Mt()))}function o4(t,e,n,r){if(pt(t.path))return a4(t,e,n,r);{const i=e.get(Mt());null==n&&null!=i&&(n=al(i,Mt()));let s=[];const o=ft(t.path),a=t.operationForChild(o),u=e.children.get(o);if(u&&a){const l=n?n.getImmediateChild(o):null,d=Hq(r,o);s=s.concat(o4(a,u,l,d))}return i&&(s=s.concat(HN(i,t,r,n))),s}}function a4(t,e,n,r){const i=e.get(Mt());null==n&&null!=i&&(n=al(i,Mt()));let s=[];return e.children.inorderTraversal((o,a)=>{const u=n?n.getImmediateChild(o):null,l=Hq(r,o),d=t.operationForChild(o);d&&(s=s.concat(a4(d,a,u,l)))}),i&&(s=s.concat(HN(i,t,r,n))),s}function u4(t,e){const n=e.query,r=x_(t,n);return{hashFn:()=>(function Jfe(t){return t.viewCache_.serverCache.getNode()}(e)||tt.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function gpe(t,e,n){const r=qN(t,n);if(r){const i=GN(r),s=i.path,o=i.queryId,a=Ni(s,e);return KN(t,s,new b_(xN(o),a))}return[]}(t,n._path,r):function ppe(t,e){return jf(t,new b_({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);{const s=function fhe(t,e){let n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}(i,n);return dT(t,n,null,s)}}}}function x_(t,e){const n=fT(e);return t.queryToTagMap.get(n)}function fT(t){return t._path.toString()+"$"+t._queryIdentifier}function qN(t,e){return t.tagToQueryMap.get(e)}function GN(t){const e=t.indexOf("$");return(0,S.hu)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Ut(t.substr(0,e))}}function KN(t,e,n){const r=t.syncPointTree_.get(e);return(0,S.hu)(r,"Missing sync point for query tag that we're tracking"),HN(r,n,iT(t.pendingWriteTree_,e),null)}function k_(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(function cpe(){return(0,S.hu)(cT,"Reference.ts has not been loaded"),cT}())(t._repo,t._path):t}class ZN{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new ZN(n)}node(){return this.node_}}class QN{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Sn(this.path_,e);return new QN(this.syncTree_,n)}node(){return hT(this.syncTree_,this.path_)}}const wpe=function(t){return(t=t||{}).timestamp=t.timestamp||(new Date).getTime(),t},l4=function(t,e,n){return t&&"object"==typeof t?((0,S.hu)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?Tpe(t[".sv"],e,n):"object"==typeof t[".sv"]?Cpe(t[".sv"],e):void(0,S.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},Tpe=function(t,e,n){if("timestamp"===t)return n.timestamp;(0,S.hu)(!1,"Unexpected server value: "+t)},Cpe=function(t,e,n){t.hasOwnProperty("increment")||(0,S.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;"number"!=typeof r&&(0,S.hu)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,S.hu)(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return"number"!=typeof o?r:o+r},c4=function(t,e,n,r){return XN(e,new QN(n,t),r)},YN=function(t,e,n){return XN(t,new ZN(e),n)};function XN(t,e,n){const r=t.getPriority().val(),i=l4(r,e.getImmediateChild(".priority"),n);let s;if(t.isLeafNode()){const o=t,a=l4(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new Of(a,On(i)):t}{const o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Of(i))),o.forEachChild(fn,(a,u)=>{const l=XN(u,e.getImmediateChild(a),n);l!==u&&(s=s.updateImmediateChild(a,l))}),s}}class JN{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function pT(t,e){let n=e instanceof Ut?e:new Ut(e),r=t,i=ft(n);for(;null!==i;){const s=(0,S.DV)(r.node.children,i)||{children:{},childCount:0};r=new JN(i,r,s),n=rn(n),i=ft(n)}return r}function Gc(t){return t.node.value}function eM(t,e){t.node.value=e,tM(t)}function d4(t){return t.node.childCount>0}function gT(t,e){Nr(t.node.children,(n,r)=>{e(new JN(n,t,r))})}function h4(t,e,n,r){n&&!r&&e(t),gT(t,i=>{h4(i,e,!0,r)}),n&&r&&e(t)}function O_(t){return new Ut(null===t.parent?t.name:O_(t.parent)+"/"+t.name)}function tM(t){null!==t.parent&&function Ape(t,e,n){const r=function Spe(t){return void 0===Gc(t)&&!d4(t)}(n),i=(0,S.r3)(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,tM(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,tM(t))}(t.parent,t.name,t)}const bpe=/[\[\].#$\/\u0000-\u001F\u007F]/,Rpe=/[\[\].#$\u0000-\u001F\u007F]/,nM=10485760,mT=function(t){return"string"==typeof t&&0!==t.length&&!bpe.test(t)},f4=function(t){return"string"==typeof t&&0!==t.length&&!Rpe.test(t)},L_=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!Hw(t)||t&&"object"==typeof t&&(0,S.r3)(t,".sv")},ua=function(t,e,n,r){r&&void 0===e||F_((0,S.gK)(t,"value"),e,n)},F_=function(t,e,n){const r=n instanceof Ut?new qhe(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+$c(r));if("function"==typeof e)throw new Error(t+"contains a function "+$c(r)+" with contents = "+e.toString());if(Hw(e))throw new Error(t+"contains "+e.toString()+" "+$c(r));if("string"==typeof e&&e.length>nM/3&&(0,S.ug)(e)>nM)throw new Error(t+"contains a string greater than "+nM+" utf8 bytes "+$c(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,s=!1;if(Nr(e,(o,a)=>{if(".value"===o)i=!0;else if(".priority"!==o&&".sv"!==o&&(s=!0,!mT(o)))throw new Error(t+" contains an invalid key ("+o+") "+$c(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function Ghe(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=(0,S.ug)(e),Tq(t)})(r,o),F_(t,a,r),function Khe(t){const e=t.parts_.pop();t.byteLength_-=(0,S.ug)(e),t.parts_.length>0&&(t.byteLength_-=1)}(r)}),i&&s)throw new Error(t+' contains ".value" child '+$c(r)+" in addition to actual children.")}},p4=function(t,e,n,r){if(r&&void 0===e)return;const i=(0,S.gK)(t,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];Nr(e,(o,a)=>{const u=new Ut(o);if(F_(i,a,Sn(n,u)),".priority"===yN(u)&&!L_(a))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const s=I_(r);for(let o=0;o<s.length;o++)if((".priority"!==s[o]||o!==s.length-1)&&!mT(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(Whe);let i=null;for(n=0;n<e.length;n++){if(r=e[n],null!==i&&qs(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)},rM=function(t,e,n){if(!n||void 0!==e){if(Hw(e))throw new Error((0,S.gK)(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!L_(e))throw new Error((0,S.gK)(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},V_=function(t,e,n,r){if(!(r&&void 0===n||mT(n)))throw new Error((0,S.gK)(t,e)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},U_=function(t,e,n,r){if(!(r&&void 0===n||f4(n)))throw new Error((0,S.gK)(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Mpe=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),U_(t,e,n,r)},Gs=function(t,e){if(".info"===ft(e))throw new Error(t+" failed = Can't modify data under /.info/")},g4=function(t,e){const n=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!mT(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),f4(t)}(n))throw new Error((0,S.gK)(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class xpe{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function _T(t,e){let n=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();null!==n&&!vN(s,n.path)&&(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function m4(t,e,n){_T(t,n),_4(t,r=>vN(r,e))}function ws(t,e,n){_T(t,n),_4(t,r=>qs(r,e)||qs(e,r))}function _4(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const i=t.eventLists_[r];i&&(e(i.path)?(kpe(t.eventLists_[r]),t.eventLists_[r]=null):n=!1)}n&&(t.eventLists_=[]),t.recursionDepth_--}function kpe(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(null!==n){t.events[e]=null;const r=n.getEventRunner();Bc&&Pr("event: "+n.toString()),xf(r)}}}const y4="repo_interrupt",Ope=25;class Lpe{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new xpe,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=eT(),this.transactionQueueTree_=new JN,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function v4(t){const n=t.infoData_.getNode(new Ut(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+n}function B_(t){return wpe({timestamp:v4(t)})}function E4(t,e,n,r,i){t.dataUpdateCount++;const s=new Ut(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){const u=(0,S.UI)(n,l=>On(l));o=function mpe(t,e,n,r){const i=qN(t,r);if(i){const s=GN(i),o=s.path,a=s.queryId,u=Ni(o,e),l=pn.fromObject(n);return KN(t,o,new Uf(xN(a),u,l))}return[]}(t.serverSyncTree_,s,u,i)}else{const u=On(n);o=s4(t.serverSyncTree_,s,u,i)}else if(r){const u=(0,S.UI)(n,l=>On(l));o=function fpe(t,e,n){const r=pn.fromObject(n);return jf(t,new Uf({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(t.serverSyncTree_,s,u)}else{const u=On(n);o=M_(t.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=Hf(t,s)),ws(t.eventQueue_,a,o)}function I4(t,e){iM(t,"connected",e),!1===e&&function jpe(t){$f(t,"onDisconnectEvents");const e=B_(t),n=eT();PN(t.onDisconnect_,Mt(),(i,s)=>{const o=c4(i,s,t.serverSyncTree_,e);Vf(n,i,o)});let r=[];PN(n,Mt(),(i,s)=>{r=r.concat(M_(t.serverSyncTree_,i,s));const o=uM(t,i);Hf(t,o)}),t.onDisconnect_=eT(),ws(t.eventQueue_,Mt(),r)}(t)}function iM(t,e,n){const r=new Ut("/.info/"+e),i=On(n);t.infoData_.updateSnapshot(r,i);const s=M_(t.infoSyncTree_,r,i);ws(t.eventQueue_,r,s)}function yT(t){return t.nextWriteId_++}function sM(t,e,n,r,i){$f(t,"set",{path:e.toString(),value:n,priority:r});const s=B_(t),o=On(n,r),a=hT(t.serverSyncTree_,e),u=YN(o,a,s),l=yT(t),d=zN(t.serverSyncTree_,e,u,l,!0);_T(t.eventQueue_,d),t.server_.put(e.toString(),o.val(!0),(m,_)=>{const v="ok"===m;v||ci("set at "+e+" failed: "+m);const T=ll(t.serverSyncTree_,l,!v);ws(t.eventQueue_,e,T),cl(0,i,m,_)});const f=uM(t,e);Hf(t,f),ws(t.eventQueue_,f,[])}function $pe(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{"ok"===r&&RN(t.onDisconnect_,e),cl(0,n,r,i)})}function w4(t,e,n,r){const i=On(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{"ok"===s&&Vf(t.onDisconnect_,e,i),cl(0,r,s,o)})}function oM(t,e,n){let r;r=".info"===ft(e._path)?dT(t.infoSyncTree_,e,n):dT(t.serverSyncTree_,e,n),m4(t.eventQueue_,e._path,r)}function T4(t){t.persistentConnection_&&t.persistentConnection_.interrupt(y4)}function $f(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Pr(n,...e)}function cl(t,e,n,r){e&&xf(()=>{if("ok"===n)e(null);else{const i=(n||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function aM(t,e,n){return hT(t.serverSyncTree_,e,n)||tt.EMPTY_NODE}function vT(t,e=t.transactionQueueTree_){if(e||ET(t,e),Gc(e)){const n=S4(t,e);(0,S.hu)(n.length>0,"Sending zero length transaction queue"),n.every(i=>0===i.status)&&function Kpe(t,e,n){const r=n.map(l=>l.currentWriteId),i=aM(t,e,r);let s=i;const o=i.hash();for(let l=0;l<n.length;l++){const d=n[l];(0,S.hu)(0===d.status,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const f=Ni(e,d.path);s=s.updateChild(f,d.currentOutputSnapshotRaw)}const a=s.val(!0),u=e;t.server_.put(u.toString(),a,l=>{$f(t,"transaction put response",{path:u.toString(),status:l});let d=[];if("ok"===l){const f=[];for(let m=0;m<n.length;m++)n[m].status=2,d=d.concat(ll(t.serverSyncTree_,n[m].currentWriteId)),n[m].onComplete&&f.push(()=>n[m].onComplete(null,!0,n[m].currentOutputSnapshotResolved)),n[m].unwatcher();ET(t,pT(t.transactionQueueTree_,e)),vT(t,t.transactionQueueTree_),ws(t.eventQueue_,e,d);for(let m=0;m<f.length;m++)xf(f[m])}else{if("datastale"===l)for(let f=0;f<n.length;f++)n[f].status=3===n[f].status?4:0;else{ci("transaction at "+u.toString()+" failed: "+l);for(let f=0;f<n.length;f++)n[f].status=4,n[f].abortReason=l}Hf(t,e)}},o)}(t,O_(e),n)}else d4(e)&&gT(e,n=>{vT(t,n)})}function Hf(t,e){const n=C4(t,e),r=O_(n);return function Zpe(t,e,n){if(0===e.length)return;const r=[];let i=[];const o=e.filter(a=>0===a.status).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const u=e[a],l=Ni(n,u.path);let f,d=!1;if((0,S.hu)(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===u.status)d=!0,f=u.abortReason,i=i.concat(ll(t.serverSyncTree_,u.currentWriteId,!0));else if(0===u.status)if(u.retryCount>=Ope)d=!0,f="maxretry",i=i.concat(ll(t.serverSyncTree_,u.currentWriteId,!0));else{const m=aM(t,u.path,o);u.currentInputSnapshot=m;const _=e[a].update(m.val());if(void 0!==_){F_("transaction failed: Data returned ",_,u.path);let v=On(_);"object"==typeof _&&null!=_&&(0,S.r3)(_,".priority")||(v=v.updatePriority(m.getPriority()));const D=u.currentWriteId,x=B_(t),R=YN(v,m,x);u.currentOutputSnapshotRaw=v,u.currentOutputSnapshotResolved=R,u.currentWriteId=yT(t),o.splice(o.indexOf(D),1),i=i.concat(zN(t.serverSyncTree_,u.path,R,u.currentWriteId,u.applyLocally)),i=i.concat(ll(t.serverSyncTree_,D,!0))}else d=!0,f="nodata",i=i.concat(ll(t.serverSyncTree_,u.currentWriteId,!0))}ws(t.eventQueue_,n,i),i=[],d&&(e[a].status=2,setTimeout(e[a].unwatcher,Math.floor(0)),e[a].onComplete&&r.push("nodata"===f?()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot):()=>e[a].onComplete(new Error(f),!1,null)))}ET(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)xf(r[a]);vT(t,t.transactionQueueTree_)}(t,S4(t,n),r),r}function C4(t,e){let n,r=t.transactionQueueTree_;for(n=ft(e);null!==n&&void 0===Gc(r);)r=pT(r,n),n=ft(e=rn(e));return r}function S4(t,e){const n=[];return D4(t,e,n),n.sort((r,i)=>r.order-i.order),n}function D4(t,e,n){const r=Gc(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);gT(e,i=>{D4(t,i,n)})}function ET(t,e){const n=Gc(e);if(n){let r=0;for(let i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,eM(e,n.length>0?n:void 0)}gT(e,r=>{ET(t,r)})}function uM(t,e){const n=O_(C4(t,e)),r=pT(t.transactionQueueTree_,e);return function Dpe(t,e,n){let r=n?t:t.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{lM(t,i)}),lM(t,r),h4(r,i=>{lM(t,i)}),n}function lM(t,e){const n=Gc(e);if(n){const r=[];let i=[],s=-1;for(let o=0;o<n.length;o++)3===n[o].status||(1===n[o].status?((0,S.hu)(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):((0,S.hu)(0===n[o].status,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(ll(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));-1===s?eM(e,void 0):n.length=s+1,ws(t.eventQueue_,O_(e),i);for(let o=0;o<r.length;o++)xf(r[o])}}const cM=function(t,e){const n=Xpe(t),r=n.namespace;return"firebase.com"===n.domain&&sa(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==n.domain&&sa("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&ci("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new hN(n.host,n.secure,r,"ws"===n.scheme||"wss"===n.scheme,e,"",r!==n.subdomain),path:new Ut(n.pathString)}},Xpe=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",u=443;if("string"==typeof t){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let d=t.indexOf("/");-1===d&&(d=t.length);let f=t.indexOf("?");-1===f&&(f=t.length),e=t.substring(0,Math.min(d,f)),d<f&&(i=function Qpe(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}(t.substring(d,f)));const m=function Ype(t){const e={};"?"===t.charAt(0)&&(t=t.substring(1));for(const n of t.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):ci(`Invalid query segment '${n}' in query '${t}'`)}return e}(t.substring(Math.min(t.length,f)));l=e.indexOf(":"),l>=0?(o="https"===a||"wss"===a,u=parseInt(e.substring(l+1),10)):l=e.length;const _=e.slice(0,l);if("localhost"===_.toLowerCase())n="localhost";else if(_.split(".").length<=2)n=_;else{const v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),n=e.substring(v+1),s=r}"ns"in m&&(s=m.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}},A4="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Jpe=function(){let t=0;const e=[];return function(n){const r=n===t;let i;t=n;const s=new Array(8);for(i=7;i>=0;i--)s[i]=A4.charAt(n%64),n=Math.floor(n/64);(0,S.hu)(0===n,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&63===e[i];i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)o+=A4.charAt(e[i]);return(0,S.hu)(20===o.length,"nextPushId: Length should be 20."),o}}();class b4{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,S.Wl)(this.snapshot.exportVal())}}class R4{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class dM{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return(0,S.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class P4{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new S.BH;return $pe(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Gs("OnDisconnect.remove",this._path);const e=new S.BH;return w4(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Gs("OnDisconnect.set",this._path),ua("OnDisconnect.set",e,this._path,!1);const n=new S.BH;return w4(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){Gs("OnDisconnect.setWithPriority",this._path),ua("OnDisconnect.setWithPriority",e,this._path,!1),rM("OnDisconnect.setWithPriority",n,!1);const r=new S.BH;return function Hpe(t,e,n,r,i){const s=On(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{"ok"===o&&Vf(t.onDisconnect_,e,s),cl(0,i,o,a)})}(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){Gs("OnDisconnect.update",this._path),p4("OnDisconnect.update",e,this._path,!1);const n=new S.BH;return function zpe(t,e,n,r){if((0,S.xb)(n))return Pr("onDisconnect().update() called with empty data.  Don't do anything."),void cl(0,r,"ok",void 0);t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{"ok"===i&&Nr(n,(o,a)=>{const u=On(a);Vf(t.onDisconnect_,Sn(e,o),u)}),cl(0,r,i,s)})}(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}class Zi{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return pt(this._path)?null:yN(this._path)}get ref(){return new Ks(this._repo,this._path)}get _queryIdentifier(){const e=kq(this._queryParams),n=cN(e);return"{}"===n?"default":n}get _queryObject(){return kq(this._queryParams)}isEqual(e){if(!((e=(0,S.m9)(e))instanceof Zi))return!1;const n=this._repo===e._repo,r=vN(this._path,e._path);return n&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function zhe(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)}}function IT(t,e){if(!0===t._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function dl(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===oa){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==nl)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==Qa)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===fn){if(null!=e&&!L_(e)||null!=n&&!L_(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,S.hu)(t.getIndex()instanceof CN||t.getIndex()===SN,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function wT(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Ks extends Zi{constructor(e,n){super(e,n,new Yw,!1)}get parent(){const e=wq(this._path);return null===e?null:new Ks(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Kc{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Ut(e),r=Zc(this.ref,e);return new Kc(this._node.getChild(n),r,fn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>e(new Kc(i,Zc(this.ref,r),fn)))}hasChild(e){const n=new Ut(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function N4(t,e){return(t=(0,S.m9)(t))._checkNotDeleted("ref"),void 0!==e?Zc(t._root,e):t._root}function M4(t,e){(t=(0,S.m9)(t))._checkNotDeleted("refFromURL");const n=cM(e,t._repo.repoInfo_.nodeAdmin);g4("refFromURL",n);const r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&sa("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),N4(t,n.path.toString())}function Zc(t,e){return null===ft((t=(0,S.m9)(t))._path)?Mpe("child","path",e,!1):U_("child","path",e,!1),new Ks(t._repo,Sn(t._path,e))}function hM(t,e){t=(0,S.m9)(t),Gs("set",t._path),ua("set",e,t._path,!1);const n=new S.BH;return sM(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function ige(t,e){p4("update",e,t._path,!1);const n=new S.BH;return function Bpe(t,e,n,r){$f(t,"update",{path:e.toString(),value:n});let i=!0;const s=B_(t),o={};if(Nr(n,(a,u)=>{i=!1,o[a]=c4(Sn(e,a),On(u),t.serverSyncTree_,s)}),i)Pr("update() called with empty data.  Don't do anything."),cl(0,r,"ok",void 0);else{const a=yT(t),u=function hpe(t,e,n,r){!function Rfe(t,e,n,r){(0,S.hu)(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=ON(t.visibleWrites,e,n),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r);const i=pn.fromObject(n);return jf(t,new Uf({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(t.serverSyncTree_,e,o,a);_T(t.eventQueue_,u),t.server_.merge(e.toString(),n,(l,d)=>{const f="ok"===l;f||ci("update at "+e+" failed: "+l);const m=ll(t.serverSyncTree_,a,!f),_=m.length>0?Hf(t,e):e;ws(t.eventQueue_,_,m),cl(0,r,l,d)}),Nr(n,l=>{const d=uM(t,Sn(e,l));Hf(t,d)}),ws(t.eventQueue_,e,[])}}(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function sge(t){t=(0,S.m9)(t);const e=new dM(()=>{}),n=new j_(e);return function Upe(t,e,n){const r=function _pe(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(l,d)=>{const f=Ni(l,n);r=r||al(d,f)});let i=t.syncPointTree_.get(n);i?r=r||al(i,Mt()):(i=new Jq,t.syncPointTree_=t.syncPointTree_.set(n,i));const s=null!=r,o=s?new sl(r,!0,!1):null;return function epe(t){return rT(t.viewCache_)}(e4(i,e,iT(t.pendingWriteTree_,e._path),s?o.getNode():tt.EMPTY_NODE,s))}(t.serverSyncTree_,e);return null!=r?Promise.resolve(r):t.server_.get(e).then(i=>{const s=On(i).withIndex(e._queryParams.getIndex());let o;if(WN(t.serverSyncTree_,e,n,!0),e._queryParams.loadsAllData())o=M_(t.serverSyncTree_,e._path,s);else{const a=x_(t.serverSyncTree_,e);o=s4(t.serverSyncTree_,e._path,s,a)}return ws(t.eventQueue_,e._path,o),dT(t.serverSyncTree_,e,n,null,!0),s},i=>($f(t,"get for query "+(0,S.Wl)(e)+" failed: "+i),Promise.reject(new Error(i))))}(t._repo,t,n).then(r=>new Kc(r,new Ks(t._repo,t._path),t._queryParams.getIndex()))}class j_{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,n){const r=n._queryParams.getIndex();return new b4("value",this,new Kc(e.snapshotNode,new Ks(n._repo,n._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new R4(this,e,n):null}matches(e){return e instanceof j_&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class TT{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n="children_added"===e?"child_added":e;return n="children_removed"===n?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new R4(this,e,n):null}createEvent(e,n){(0,S.hu)(null!=e.childName,"Child events should have a childName.");const r=Zc(new Ks(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new b4(e.type,this,new Kc(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof TT&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function $_(t,e,n,r,i){let s;if("object"==typeof r&&(s=void 0,i=r),"function"==typeof r&&(s=r),i&&i.onlyOnce){const u=n,l=(d,f)=>{oM(t._repo,t,a),u(d,f)};l.userCallback=n.userCallback,l.context=n.context,n=l}const o=new dM(n,s||void 0),a="value"===e?new j_(o):new TT(e,o);return function Wpe(t,e,n){let r;r=".info"===ft(e._path)?WN(t.infoSyncTree_,e,n):WN(t.serverSyncTree_,e,n),m4(t.eventQueue_,e._path,r)}(t._repo,t,a),()=>oM(t._repo,t,a)}function fM(t,e,n,r){return $_(t,"value",e,n,r)}function x4(t,e,n,r){return $_(t,"child_added",e,n,r)}function k4(t,e,n,r){return $_(t,"child_changed",e,n,r)}function O4(t,e,n,r){return $_(t,"child_moved",e,n,r)}function L4(t,e,n,r){return $_(t,"child_removed",e,n,r)}function F4(t,e,n){let r=null;const i=n?new dM(n):null;"value"===e?r=new j_(i):e&&(r=new TT(e,i)),oM(t._repo,t,r)}class To{}class V4 extends To{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){ua("endAt",this._value,e._path,!0);const n=bN(e._queryParams,this._value,this._key);if(wT(n),dl(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Zi(e._repo,e._path,n,e._orderByCalled)}}class age extends To{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){ua("endBefore",this._value,e._path,!1);const n=function mfe(t,e,n){let r;return r=bN(t,e,t.index_===oa||n?n:nl),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(wT(n),dl(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Zi(e._repo,e._path,n,e._orderByCalled)}}class U4 extends To{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){ua("startAt",this._value,e._path,!0);const n=AN(e._queryParams,this._value,this._key);if(wT(n),dl(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Zi(e._repo,e._path,n,e._orderByCalled)}}class cge extends To{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){ua("startAfter",this._value,e._path,!1);const n=function gfe(t,e,n){let r;return r=AN(t,e,t.index_===oa||n?n:Qa),r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(wT(n),dl(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Zi(e._repo,e._path,n,e._orderByCalled)}}class hge extends To{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Zi(e._repo,e._path,function ffe(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}class pge extends To{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Zi(e._repo,e._path,function pfe(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}class mge extends To{constructor(e){super(),this._path=e}_apply(e){IT(e,"orderByChild");const n=new Ut(this._path);if(pt(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new CN(n),i=Xw(e._queryParams,r);return dl(i),new Zi(e._repo,e._path,i,!0)}}class yge extends To{_apply(e){IT(e,"orderByKey");const n=Xw(e._queryParams,oa);return dl(n),new Zi(e._repo,e._path,n,!0)}}class Ege extends To{_apply(e){IT(e,"orderByPriority");const n=Xw(e._queryParams,fn);return dl(n),new Zi(e._repo,e._path,n,!0)}}class wge extends To{_apply(e){IT(e,"orderByValue");const n=Xw(e._queryParams,SN);return dl(n),new Zi(e._repo,e._path,n,!0)}}class Cge extends To{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){if(ua("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new V4(this._value,this._key)._apply(new U4(this._value,this._key)._apply(e))}}function Co(t,...e){let n=(0,S.m9)(t);for(const r of e)n=r._apply(n);return n}(function ipe(t){(0,S.hu)(!uT,"__referenceConstructor has already been defined"),uT=t})(Ks),function lpe(t){(0,S.hu)(!cT,"__referenceConstructor has already been defined"),cT=t}(Ks);const pM={};function gM(t,e,n,r,i){let s=r||t.options.databaseURL;void 0===s&&(t.options.projectId||sa("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Pr("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let u,l,o=cM(s,i),a=o.repoInfo;typeof process<"u"&&process.env&&(l=process.env.FIREBASE_DATABASE_EMULATOR_HOST),l?(u=!0,s=`http://${l}?ns=${a.namespace}`,o=cM(s,i),a=o.repoInfo):u=!o.repoInfo.secure;const d=i&&u?new E_(E_.OWNER):new vhe(t.name,t.options,e);g4("Invalid Firebase Database URL",o),pt(o.path)||sa("Database URL must point to the root of a Firebase Database (not including a child path).");const f=function Rge(t,e,n,r){let i=pM[e.name];i||(i={},pM[e.name]=i);let s=i[t.toURLString()];return s&&sa("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Lpe(t,false,n,r),i[t.toURLString()]=s,s}(a,t,d,new yhe(t.name,n));return new Nge(f,t)}class Nge{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function Fpe(t,e,n){if(t.stats_=gN(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new Jw(t.repoInfo_,(r,i,s,o)=>{E4(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>I4(t,!0),0);else{if(typeof n<"u"&&null!==n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,S.Wl)(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Hc(t.repoInfo_,e,(r,i,s,o)=>{E4(t,r,i,s,o)},r=>{I4(t,r)},r=>{!function Vpe(t,e){Nr(e,(n,r)=>{iM(t,n,r)})}(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=function whe(t,e){const n=t.toString();return pN[n]||(pN[n]=e()),pN[n]}(t.repoInfo_,()=>new wfe(t.stats_,t.server_)),t.infoData_=new _fe,t.infoSyncTree_=new i4({startListening:(r,i,s,o)=>{let a=[];const u=t.infoData_.getNode(r._path);return u.isEmpty()||(a=M_(t.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),iM(t,"connected",!1),t.serverSyncTree_=new i4({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,u)=>{const l=o(a,u);ws(t.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ks(this._repo,Mt())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function bge(t,e){const n=pM[e];(!n||n[t.key]!==t)&&sa(`Database ${e}(${t.repoInfo_}) has already been deleted.`),T4(t),delete n[t.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&sa("Cannot call "+e+" on a deleted database.")}}function j4(){cq.IS_TRANSPORT_INITIALIZED&&ci("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function Mge(){j4(),rl.forceDisallow()}function xge(){j4(),kf.forceDisallow(),rl.forceAllow()}function Lge(t,e){zW(t,e)}const Vge={".sv":"timestamp"};class jge{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}Hc.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},Hc.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)},function Fge(t){aN(ri.SDK_VERSION),(0,ri._registerComponent)(new mo.wA("database",(e,{instanceIdentifier:n})=>gM(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n),"PUBLIC").setMultipleInstances(!0)),(0,ri.registerVersion)(VW,"1.0.2",t),(0,ri.registerVersion)(VW,"1.0.2","esm2017")}();const Wge=new ys.Yd("@firebase/database-compat"),H4=function(t){Wge.warn("FIREBASE WARNING: "+t)};class Kge{constructor(e){this._delegate=e}cancel(e){(0,S.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,S.Wj)("OnDisconnect.cancel","onComplete",e,!0);const n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){(0,S.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,S.Wj)("OnDisconnect.remove","onComplete",e,!0);const n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){(0,S.Dv)("OnDisconnect.set",1,2,arguments.length),(0,S.Wj)("OnDisconnect.set","onComplete",n,!0);const r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){(0,S.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,S.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if((0,S.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,H4("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,S.Wj)("OnDisconnect.update","onComplete",n,!0);const r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}}class Zge{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return(0,S.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class hl{constructor(e,n){this._database=e,this._delegate=n}val(){return(0,S.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,S.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,S.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,S.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,S.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),U_("DataSnapshot.child","path",e,!1),new hl(this._database,this._delegate.child(e))}hasChild(e){return(0,S.Dv)("DataSnapshot.hasChild",1,1,arguments.length),U_("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,S.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,S.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,S.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new hl(this._database,n)))}hasChildren(){return(0,S.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,S.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,S.Dv)("DataSnapshot.ref",0,0,arguments.length),new Ts(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Kr{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;(0,S.Dv)("Query.on",2,4,arguments.length),(0,S.Wj)("Query.on","callback",n,!1);const o=Kr.getCancelAndContextArgs_("Query.on",r,i),a=(l,d)=>{n.call(o.context,new hl(this.database,l),d)};a.userCallback=n,a.context=o.context;const u=null===(s=o.cancel)||void 0===s?void 0:s.bind(o.context);switch(e){case"value":return fM(this._delegate,a,u),n;case"child_added":return x4(this._delegate,a,u),n;case"child_removed":return L4(this._delegate,a,u),n;case"child_changed":return k4(this._delegate,a,u),n;case"child_moved":return O4(this._delegate,a,u),n;default:throw new Error((0,S.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if((0,S.Dv)("Query.off",0,3,arguments.length),function(t,e,n){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,S.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,S.Wj)("Query.off","callback",n,!0),(0,S.lb)("Query.off","context",r,!0),n){const i=()=>{};i.userCallback=n,i.context=r,F4(this._delegate,e,i)}else F4(this._delegate,e)}get(){return sge(this._delegate).then(e=>new hl(this.database,e))}once(e,n,r,i){(0,S.Dv)("Query.once",1,4,arguments.length),(0,S.Wj)("Query.once","callback",n,!0);const s=Kr.getCancelAndContextArgs_("Query.once",r,i),o=new S.BH,a=(l,d)=>{const f=new hl(this.database,l);n&&n.call(s.context,f,d),o.resolve(f)};a.userCallback=n,a.context=s.context;const u=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":fM(this._delegate,a,u,{onlyOnce:!0});break;case"child_added":x4(this._delegate,a,u,{onlyOnce:!0});break;case"child_removed":L4(this._delegate,a,u,{onlyOnce:!0});break;case"child_changed":k4(this._delegate,a,u,{onlyOnce:!0});break;case"child_moved":O4(this._delegate,a,u,{onlyOnce:!0});break;default:throw new Error((0,S.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return(0,S.Dv)("Query.limitToFirst",1,1,arguments.length),new Kr(this.database,Co(this._delegate,function fge(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new hge(t)}(e)))}limitToLast(e){return(0,S.Dv)("Query.limitToLast",1,1,arguments.length),new Kr(this.database,Co(this._delegate,function gge(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new pge(t)}(e)))}orderByChild(e){return(0,S.Dv)("Query.orderByChild",1,1,arguments.length),new Kr(this.database,Co(this._delegate,function _ge(t){if("$key"===t)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===t)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===t)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return U_("orderByChild","path",t,!1),new mge(t)}(e)))}orderByKey(){return(0,S.Dv)("Query.orderByKey",0,0,arguments.length),new Kr(this.database,Co(this._delegate,function vge(){return new yge}()))}orderByPriority(){return(0,S.Dv)("Query.orderByPriority",0,0,arguments.length),new Kr(this.database,Co(this._delegate,function Ige(){return new Ege}()))}orderByValue(){return(0,S.Dv)("Query.orderByValue",0,0,arguments.length),new Kr(this.database,Co(this._delegate,function Tge(){return new wge}()))}startAt(e=null,n){return(0,S.Dv)("Query.startAt",0,2,arguments.length),new Kr(this.database,Co(this._delegate,function lge(t=null,e){return V_("startAt","key",e,!0),new U4(t,e)}(e,n)))}startAfter(e=null,n){return(0,S.Dv)("Query.startAfter",0,2,arguments.length),new Kr(this.database,Co(this._delegate,function dge(t,e){return V_("startAfter","key",e,!0),new cge(t,e)}(e,n)))}endAt(e=null,n){return(0,S.Dv)("Query.endAt",0,2,arguments.length),new Kr(this.database,Co(this._delegate,function oge(t,e){return V_("endAt","key",e,!0),new V4(t,e)}(e,n)))}endBefore(e=null,n){return(0,S.Dv)("Query.endBefore",0,2,arguments.length),new Kr(this.database,Co(this._delegate,function uge(t,e){return V_("endBefore","key",e,!0),new age(t,e)}(e,n)))}equalTo(e,n){return(0,S.Dv)("Query.equalTo",1,2,arguments.length),new Kr(this.database,Co(this._delegate,function Sge(t,e){return V_("equalTo","key",e,!0),new Cge(t,e)}(e,n)))}toString(){return(0,S.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,S.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,S.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof Kr))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){const i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,(0,S.Wj)(e,"cancel",i.cancel,!0),i.context=r,(0,S.lb)(e,"context",i.context,!0);else if(n)if("object"==typeof n&&null!==n)i.context=n;else{if("function"!=typeof n)throw new Error((0,S.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=n}return i}get ref(){return new Ts(this.database,new Ks(this._delegate._repo,this._delegate._path))}}class Ts extends Kr{constructor(e,n){super(e,new Zi(n._repo,n._path,new Yw,!1)),this.database=e,this._delegate=n}getKey(){return(0,S.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,S.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new Ts(this.database,Zc(this._delegate,e))}getParent(){(0,S.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Ts(this.database,e):null}getRoot(){return(0,S.Dv)("Reference.root",0,0,arguments.length),new Ts(this.database,this._delegate.root)}set(e,n){(0,S.Dv)("Reference.set",1,2,arguments.length),(0,S.Wj)("Reference.set","onComplete",n,!0);const r=hM(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if((0,S.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,H4("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Gs("Reference.update",this._delegate._path),(0,S.Wj)("Reference.update","onComplete",n,!0);const r=ige(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){(0,S.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,S.Wj)("Reference.setWithPriority","onComplete",r,!0);const i=function rge(t,e,n){if(Gs("setWithPriority",t._path),ua("setWithPriority",e,t._path,!1),rM("setWithPriority",n,!1),".length"===t.key||".keys"===t.key)throw"setWithPriority failed: "+t.key+" is a read-only object.";const r=new S.BH;return sM(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){(0,S.Dv)("Reference.remove",0,1,arguments.length),(0,S.Wj)("Reference.remove","onComplete",e,!0);const n=function tge(t){return Gs("remove",t._path),hM(t,null)}(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){(0,S.Dv)("Reference.transaction",1,3,arguments.length),(0,S.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,S.Wj)("Reference.transaction","onComplete",n,!0),function(t,e,n,r){if(void 0!==n&&"boolean"!=typeof n)throw new Error((0,S.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const i=function $ge(t,e,n){var r;if(t=(0,S.m9)(t),Gs("Reference.transaction",t._path),".length"===t.key||".keys"===t.key)throw"Reference.transaction failed: "+t.key+" is a read-only object.";const i=null===(r=n?.applyLocally)||void 0===r||r,s=new S.BH,a=fM(t,()=>{});return function Gpe(t,e,n,r,i,s){$f(t,"transaction on "+e);const o={path:e,update:n,onComplete:r,status:null,order:jW(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=aM(t,e,void 0);o.currentInputSnapshot=a;const u=o.update(a.val());if(void 0===u)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{F_("transaction failed: Data returned ",u,o.path),o.status=0;const l=pT(t.transactionQueueTree_,e),d=Gc(l)||[];let f;d.push(o),eM(l,d),"object"==typeof u&&null!==u&&(0,S.r3)(u,".priority")?(f=(0,S.DV)(u,".priority"),(0,S.hu)(L_(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(hT(t.serverSyncTree_,e)||tt.EMPTY_NODE).getPriority().val();const m=B_(t),_=On(u,f),v=YN(_,a,m);o.currentOutputSnapshotRaw=_,o.currentOutputSnapshotResolved=v,o.currentWriteId=yT(t);const T=zN(t.serverSyncTree_,e,v,o.currentWriteId,o.applyLocally);ws(t.eventQueue_,e,T),vT(t,t.transactionQueueTree_)}}(t._repo,t._path,e,(u,l,d)=>{let f=null;u?s.reject(u):(f=new Kc(d,new Ks(t._repo,t._path),fn),s.resolve(new jge(l,f)))},a,i),s.promise}(this._delegate,e,{applyLocally:r}).then(s=>new Zge(s.committed,new hl(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){(0,S.Dv)("Reference.setPriority",1,2,arguments.length),(0,S.Wj)("Reference.setPriority","onComplete",n,!0);const r=function nge(t,e){t=(0,S.m9)(t),Gs("setPriority",t._path),rM("setPriority",e,!1);const n=new S.BH;return sM(t._repo,Sn(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){(0,S.Dv)("Reference.push",0,2,arguments.length),(0,S.Wj)("Reference.push","onComplete",n,!0);const r=function ege(t,e){t=(0,S.m9)(t),Gs("push",t._path),ua("push",e,t._path,!0);const n=v4(t._repo),r=Jpe(n),i=Zc(t,r),s=Zc(t,r);let o;return o=null!=e?hM(s,e).then(()=>s):Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}(this._delegate,e),i=r.then(o=>new Ts(this.database,o));n&&i.then(()=>n(null),o=>n(o));const s=new Ts(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return Gs("Reference.onDisconnect",this._delegate._path),new Kge(new P4(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class H_{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:Mge,forceLongPolling:xge}}useEmulator(e,n,r={}){!function $4(t,e,n,r={}){(t=(0,S.m9)(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&sa("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&sa('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new E_(E_.OWNER);else if(r.mockUserToken){const o="string"==typeof r.mockUserToken?r.mockUserToken:(0,S.Sg)(r.mockUserToken,t.app.options.projectId);s=new E_(o)}!function Age(t,e,n,r){t.repoInfo_=new hN(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}(i,e,n,s)}(this._delegate,e,n,r)}ref(e){if((0,S.Dv)("database.ref",0,1,arguments.length),e instanceof Ts){const n=M4(this._delegate,e.toString());return new Ts(this,n)}{const n=N4(this._delegate,e);return new Ts(this,n)}}refFromURL(e){(0,S.Dv)("database.refFromURL",1,1,arguments.length);const r=M4(this._delegate,e);return new Ts(this,r)}goOffline(){return(0,S.Dv)("database.goOffline",0,0,arguments.length),function kge(t){(t=(0,S.m9)(t))._checkNotDeleted("goOffline"),T4(t._repo)}(this._delegate)}goOnline(){return(0,S.Dv)("database.goOnline",0,0,arguments.length),function Oge(t){(t=(0,S.m9)(t))._checkNotDeleted("goOnline"),function qpe(t){t.persistentConnection_&&t.persistentConnection_.resume(y4)}(t._repo)}(this._delegate)}}H_.ServerValue={TIMESTAMP:function Uge(){return Vge}(),increment:t=>function Bge(t){return{".sv":{increment:t}}}(t)};var Yge=Object.freeze({__proto__:null,initStandalone:function Qge({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){aN(n);const a=new mo.H0("database-standalone"),u=new mo.zt("auth-internal",a);let l;return u.setComponent(new mo.wA("auth-internal",()=>r,"PRIVATE")),i&&(l=new mo.zt("app-check-internal",a),l.setComponent(new mo.wA("app-check-internal",()=>i,"PRIVATE"))),{instance:new H_(gM(t,u,l,e,o),t),namespace:s}}});const Xge=H_.ServerValue;function z_(t,e,n="on",r=lI){return new Ct(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),"once"===n&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),"on"===n?{unsubscribe(){null!=s&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(oe(i=>{const{snapshot:s,prevKey:o}=i;let a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),q2())}function z4(t){return null==t}function W4(t){return"function"==typeof t.set}function q4(t,e){return W4(e)?e:t.ref(e)}function G4(t,e){if(function eme(t){return"string"==typeof t}(t))return e.stringCase();if(W4(t))return e.firebaseCase();if(function tme(t){return"function"==typeof t.exportVal}(t))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof t)}function K4(t){return(z4(t)||0===t.length)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function Z4(t,e,n){return xA(...(e=K4(e)).map(i=>z_(t,i,"on",n)))}function Q4(t,e){return function(r,i){return G4(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function sme(t){return function(n){return n?G4(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function Y4(t,e){const n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function ume(t,e){const{payload:n,prevKey:r,key:i}=e,s=Y4(t,i),o=function ame(t,e){if(z4(e))return 0;{const n=Y4(t,e);return-1===n?t.length:n+1}}(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(u=>{const l={payload:u,type:"value",prevKey:a,key:u.key};return a=u.key,t=[...t,l],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(u=>u.payload.key!==n.key)).splice(o,0,e);else{if(null==r)return[e,...t];(t=t.slice()).splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){const a=t.splice(s,1)[0];return(t=t.slice()).splice(o,0,a),t}return t;default:return t}}function X4(t,e,n){return function ome(t,e,n){return z_(t,"value","once",n).pipe(Yn(r=>{const i=[Me(r)];return e.forEach(s=>i.push(z_(t,s,"on",n))),xA(...i).pipe(Eh(ume,[]))}),OB())}(t,e=K4(e),n)}function J4(t,e){return function(){return z_(t,"value","on",e)}}!function Jge(t){t.INTERNAL.registerComponent(new mo.wA("database-compat",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new H_(i,r)},"PUBLIC").setServiceProps({Reference:Ts,Query:Kr,Database:H_,DataSnapshot:hl,enableLogging:Lge,INTERNAL:Yge,ServerValue:Xge}).setMultipleInstances(!0)),t.registerVersion("@firebase/database-compat","1.0.2")}(ms.Z);const dme=new de("angularfire2.realtimeDatabaseURL"),hme=new de("angularfire2.database.use-emulator");let fme=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,u,l,d,f,m,_,v,T,D){this.schedulers=a;const x=u,R=Xg(n,o,r);l&&jA(R,o,d,m,_,v,f,T),this.database=hI(`${R.name}.database.${i}`,"AngularFireDatabase",R.name,()=>{const L=o.runOutsideAngular(()=>R.database(i||void 0));return x&&L.useEmulator(...x),L},[x])}list(n,r){const i=this.schedulers.ngZone.runOutsideAngular(()=>q4(this.database,n));let s=i;return r&&(s=r(i)),function lme(t,e){const n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:Q4(r,"update"),set:Q4(r,"set"),push:i=>r.push(i),remove:sme(r),snapshotChanges:i=>X4(t,i,n).pipe(Xn),stateChanges:i=>Z4(t,i,n).pipe(Xn),auditTrail:i=>function nme(t,e,n){return function ime(t,e,n){return function rme(t,e){return z_(t,"value","on",e).pipe(oe(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}(t,n).pipe(function ihe(...t){const e=kU(t);return U((n,r)=>{const i=t.length,s=new Array(i);let o=t.map(()=>!1),a=!1;for(let u=0;u<i;u++)ps(t[u]).subscribe(ce(r,l=>{s[u]=l,!a&&!o[u]&&(o[u]=!0,(a=o.every(tr))&&(o=null))},Xr));n.subscribe(ce(r,u=>{if(a){const l=[u,...s];r.next(e?e(...l):l)}}))})}(e),oe(([i,s])=>{const o=i.lastKeyToLoad,a=s.map(u=>u.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),function she(t){return U((e,n)=>{let r=!1,i=0;e.subscribe(ce(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}(i=>-1===i.loadedKeys.indexOf(i.lastKeyToLoad)),oe(i=>i.actions))}(t,Z4(t,e).pipe(Eh((i,s)=>[...i,s],[])),n)}(t,i,n).pipe(Xn),valueChanges:(i,s)=>X4(t,i,n).pipe(oe(a=>a.map(u=>s&&s.idField?{...u.payload.val(),[s.idField]:u.key}:u.payload.val())),Xn)}}(s,this)}object(n){return function cme(t,e){return{query:t,snapshotChanges:()=>J4(t,e.schedulers.outsideAngular)().pipe(Xn),update:n=>t.ref.update(n),set:n=>t.ref.set(n),remove:()=>t.ref.remove(),valueChanges:()=>J4(t,e.schedulers.outsideAngular)().pipe(Xn,oe(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>q4(this.database,n)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(Y(Oh),Y(Lh,8),Y(dme,8),Y(oo),Y(Et),Y(dI),Y(hme,8),Y(Jg,8),Y(OA,8),Y(LA,8),Y(FA,8),Y(VA,8),Y(UA,8),Y(BA,8),Y(cI,8))};static \u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),pme=(()=>{class t{constructor(){ms.Z.registerVersion("angularfire",Mh.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Er({type:t});static \u0275inj=ar({providers:[fme]})}return t})(),gme=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=vr({type:t,selectors:[["app-home"]],decls:2,vars:0,template:function(r,i){1&r&&(xt(0,"p"),xn(1,"home works!"),$t())}})}return t})();var _M=xe(217);function eG(t){return new Ct(function(e){return{unsubscribe:(0,_M.w)(t,e.next.bind(e),e.error.bind(e),e.complete.bind(e))}})}const Cme=Iie(eG,!0);let ST=(()=>{class t{constructor(n,r,i){this.afAuth=n,this.router=r,this.afs=i,this.afAuth.authState.subscribe(s=>{s?(this.userData=s,localStorage.setItem("user",JSON.stringify(this.userData)),JSON.parse(localStorage.getItem("user")),console.log(s)):(localStorage.setItem("user","null"),JSON.parse(localStorage.getItem("user")))}),this.theUser$=n.authState}SetUserData(n){return this.afs.doc(`users/${n.uid}`).set({uid:n.uid,email:n.email,displayName:n.displayName,photoURL:n.photoURL,emailVerified:n.emailVerified},{merge:!0})}GoogleAuth(){return this.AuthLogin(new _M.X).then(n=>{let r=localStorage.getItem("returnUrl");this.router.navigateByUrl(r??"/")})}googleSignIn(){return this.afAuth.signInWithPopup(new _M.X).then(n=>{localStorage.setItem("token",JSON.stringify(n.user))},n=>{alert(n.message)})}AuthLogin(n){return this.afAuth.signInWithPopup(n).then(r=>{this.SetUserData(r.user),alert(this.userData.displayName),localStorage.setItem("logged",JSON.stringify(this.userData)),console.table(Cme)}).catch(r=>{console.log(r)})}logout(){this.afAuth.signOut().then(()=>{localStorage.removeItem("token"),localStorage.removeItem("logged"),this.router.navigate(["/login"])},n=>{alert(n.message)})}static#e=this.\u0275fac=function(r){return new(r||t)(Y(Jg),Y(gs),Y(FW))};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),zf=(()=>{class t{constructor(n,r,i){this.auth=n,this.router=r,this.route=i}canActivate(n,r){return this.auth.theUser$.pipe(oe(i=>{if(i)return!0;let s=r.url;return localStorage.setItem("returnUrl",s),console.log(s),this.router.navigate(["/login"],{queryParams:{returnUrl:r.url}}),!1}))}static#e=this.\u0275fac=function(r){return new(r||t)(Y(ST),Y(gs),Y(dc))};static#t=this.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const nG=oe(t=>!!t);let bme=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=vr({type:t,selectors:[["app-manage-products"]],decls:2,vars:0,template:function(r,i){1&r&&(xt(0,"p"),xn(1,"manage-products works!"),$t())}})}return t})(),Rme=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=vr({type:t,selectors:[["app-my-orders"]],decls:2,vars:0,template:function(r,i){1&r&&(xt(0,"p"),xn(1,"my-orders works!"),$t())}})}return t})(),Pme=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=vr({type:t,selectors:[["app-no-access"]],decls:2,vars:0,template:function(r,i){1&r&&(xt(0,"p"),xn(1,"no-access works!"),$t())}})}return t})(),Nme=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=vr({type:t,selectors:[["app-shopping-cart"]],decls:2,vars:0,template:function(r,i){1&r&&(xt(0,"p"),xn(1,"shopping-cart works!"),$t())}})}return t})(),Mme=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=vr({type:t,selectors:[["app-check-out"]],decls:2,vars:0,template:function(r,i){1&r&&(xt(0,"p"),xn(1,"check-out works!"),$t())}})}return t})(),xme=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=vr({type:t,selectors:[["app-order-success"]],decls:2,vars:0,template:function(r,i){1&r&&(xt(0,"p"),xn(1,"order-success works!"),$t())}})}return t})(),kme=(()=>{class t{constructor(n){this.AuthService=n}signInWithGoogle(){this.AuthService.GoogleAuth()}static#e=this.\u0275fac=function(r){return new(r||t)(Ve(ST))};static#t=this.\u0275cmp=vr({type:t,selectors:[["app-login"]],decls:26,vars:0,consts:[[1,"container"],[1,"row"],[1,"col-sm-9","col-md-7","col-lg-5","mx-auto"],[1,"card","border-0","shadow","rounded-3","my-5"],[1,"card-body","p-4","p-sm-5"],[1,"card-title","text-center","mb-5","fw-light","fs-5"],[1,"form-floating","mb-3"],["type","email","id","floatingInput","placeholder","name@example.com",1,"form-control"],["for","floatingInput"],["type","password","id","floatingPassword","placeholder","Password",1,"form-control"],["for","floatingPassword"],[1,"d-grid"],["type","submit",1,"btn","btn-primary","btn-login","text-uppercase","fw-bold"],[1,"my-4"],[1,"d-grid","mb-2"],[1,"btn","btn-google","btn-login","text-uppercase","fw-bold",3,"click"],["src","../../../assets/google.png","alt","","height","24px","width","24px"]],template:function(r,i){1&r&&(xt(0,"body")(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"h5",5),xn(7,"Login"),$t(),xt(8,"form")(9,"div",6),cs(10,"input",7),xt(11,"label",8),xn(12,"Email address"),$t()(),xt(13,"div",6),cs(14,"input",9),xt(15,"label",10),xn(16,"Password"),$t()(),xt(17,"div",11)(18,"button",12),xn(19,"Sign in"),$t()(),cs(20,"hr",13),xt(21,"div",14)(22,"button",15),_g("click",function(){return i.signInWithGoogle()}),cs(23,"img",16),xn(24," sign In With Google "),$t(),cs(25,"br"),$t()()()()()()()())},styles:[".container[_ngcontent-%COMP%]{padding-top:5%}.btn-login[_ngcontent-%COMP%]{font-size:.9rem;letter-spacing:.05rem;padding:.75rem 1rem}.btn-google[_ngcontent-%COMP%]{color:#fff!important;background-color:#ea4335}.btn-facebook[_ngcontent-%COMP%]{color:#fff!important;background-color:#3b5998}"]})}return t})(),Ome=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=vr({type:t,selectors:[["app-admin-products"]],decls:2,vars:0,template:function(r,i){1&r&&(xt(0,"p"),xn(1,"admin-products works!"),$t())}})}return t})(),Lme=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=vr({type:t,selectors:[["app-admin-orders"]],decls:2,vars:0,template:function(r,i){1&r&&(xt(0,"p"),xn(1,"admin-orders works!"),$t())}})}return t})();const W_=()=>(t=>Jr(nG,oe(e=>e||t)))(["login"]),Fme=[{path:"",component:gme},{path:"shopping-cart",component:Nme},{path:"manage-products",component:bme},{path:"login",component:kme},{path:"admin/products",component:Ome,canActivate:[zf],data:{authGuardPipe:W_}},{path:"admin/orders",component:Lme,canActivate:[zf],data:{authGuardPipe:W_}},{path:"check-out",component:Mme,canActivate:[zf],data:{authGuardPipe:W_}},{path:"order-success",component:xme,canActivate:[zf],data:{authGuardPipe:W_}},{path:"my-orders",component:Rme,canActivate:[zf],data:{authGuardPipe:W_}},{path:"no-access",component:Pme},{path:"**",redirectTo:""}];let Vme=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=Er({type:t});static#n=this.\u0275inj=ar({imports:[NA.forRoot(Fme),NA]})}return t})();const EM=()=>["active"];function Ume(t,e){1&t&&(xt(0,"li",20)(1,"a",21),xn(2,"Login"),$t()()),2&t&&(Gl(1),Xl("routerLinkActive",iE(1,EM)))}function Bme(t,e){if(1&t&&(xt(0,"a",22),xn(1),$t()),2&t){const n=e.ngIf;Gl(1),hS(n.displayName?n.displayName:"User")}}function jme(t,e){if(1&t&&cs(0,"img",23),2&t){const n=e.ngIf;tE("src",n.photoURL,r0),tE("alt",n.displayName)}}let $me=(()=>{class t{constructor(n){this.authService=n,this.user$=this.authService.theUser$}static#e=this.\u0275fac=function(r){return new(r||t)(Ve(ST))};static#t=this.\u0275cmp=vr({type:t,selectors:[["navbar"]],decls:34,vars:11,consts:[["data-bs-theme","bg-primary ",1,"navbar","bg-light","border-bottom","border-body"],["routerLink","/",1,"navbar-brand"],["src","/assets/logo.png","width","50","height","50","routerLink","/",1,"bi","me-2","rounded-circle",3,"routerLinkActive"],[1,"nav","nav-tabs","navflex"],[1,"nav-item","nav-item2"],["aria-current","page","routerLink","/shopping-cart",1,"nav-link",3,"routerLinkActive"],["anonymousUser",""],["role","search",1,"d-flex"],["type","search","placeholder","Search Product \u{1f6d2}","aria-label","Search",1,"form-control","me-2"],["type","submit",1,"btn","btn-outline-success"],[1,"drop"],[1,"nav-item","dropdown"],["class","nav-link dropdown-toggle drop","data-bs-toggle","dropdown","role","button","aria-expanded","true",4,"ngIf","ngIfElse"],[1,"dropdown-menu"],["routerLink","/my-orders",1,"dropdown-item"],["routerLink","/admin/orders",1,"dropdown-item"],["routerLink","/admin/products",1,"dropdown-item"],[1,"dropdown-divider"],[1,"dropdown-item",3,"click"],["class","bi me-2 rounded-circle","width","45","height","45",3,"src","alt",4,"ngIf"],[1,"nav-item"],["aria-current","page","routerLink","/login",1,"nav-link",3,"routerLinkActive"],["data-bs-toggle","dropdown","role","button","aria-expanded","true",1,"nav-link","dropdown-toggle","drop"],["width","45","height","45",1,"bi","me-2","rounded-circle",3,"src","alt"]],template:function(r,i){if(1&r&&(xt(0,"nav",0)(1,"a",1),cs(2,"img",2),$t(),xt(3,"ul",3)(4,"li",4)(5,"a",5),xn(6,"shopping cart"),$t()(),Du(7,Ume,3,2,"ng-template",null,6,XL),xt(9,"form",7),cs(10,"input",8),xt(11,"button",9),xn(12,"Search"),$t()(),xt(13,"div",10)(14,"li",11),Du(15,Bme,2,1,"a",12),wS(16,"async"),xt(17,"ul",13)(18,"li")(19,"a",14),xn(20,"my-orders"),$t()(),xt(21,"li")(22,"a",15),xn(23,"manage Orders"),$t()(),xt(24,"li")(25,"a",16),xn(26,"manage Products"),$t()(),xt(27,"li"),cs(28,"hr",17),$t(),xt(29,"li")(30,"a",18),_g("click",function(){return i.authService.logout()}),xn(31,"logout"),$t()()()(),Du(32,jme,1,2,"img",19),wS(33,"async"),$t()()()),2&r){const s=function lL(t){return au(function rC(){return Be.lFrame.contextLView}(),ze+t)}(8);Gl(2),Xl("routerLinkActive",iE(9,EM)),Gl(3),Xl("routerLinkActive",iE(10,EM)),Gl(10),Xl("ngIf",TS(16,5,i.user$))("ngIfElse",s),Gl(17),Xl("ngIf",TS(33,7,i.user$))}},dependencies:[mV,aI,P2,vV],styles:[".drop[_ngcontent-%COMP%]{display:flex}"]})}return t})(),Hme=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=vr({type:t,selectors:[["app-root"]],decls:2,vars:0,template:function(r,i){1&r&&cs(0,"navbar")(1,"router-outlet")},dependencies:[vA,$me]})}return t})(),zme=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=Er({type:t,bootstrap:[Hme]});static#n=this.\u0275inj=ar({providers:[ST,zf],imports:[FV,Vme,ote,NA,Rie.initializeApp(uie_firebaseConfig),kie,rhe,Coe,pme]})}return t})();iJ().bootstrapModule(zme).catch(t=>console.error(t))},106:(Ss,Wn,xe)=>{xe.d(Wn,{Z:()=>Dn});var A=xe(58),$=xe(537),k=xe(534),Te=xe(879);class sn{constructor(et,Ge){this._delegate=et,this.firebase=Ge,(0,k._addComponent)(et,new $.wA("app-compat",()=>this,"PUBLIC")),this.container=et.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(et){this._delegate.automaticDataCollectionEnabled=et}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(et=>{this._delegate.checkDestroyed(),et()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,k.deleteApp)(this._delegate)))}_getService(et,Ge=k._DEFAULT_ENTRY_NAME){var Fn;this._delegate.checkDestroyed();const An=this._delegate.container.getProvider(et);return!An.isInitialized()&&"EXPLICIT"===(null===(Fn=An.getComponent())||void 0===Fn?void 0:Fn.instantiationMode)&&An.initialize(),An.getImmediate({identifier:Ge})}_removeServiceInstance(et,Ge=k._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(et).clearInstance(Ge)}_addComponent(et){(0,k._addComponent)(this._delegate,et)}_addOrOverwriteComponent(et){(0,k._addOrOverwriteComponent)(this._delegate,et)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const qn=new A.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),X=function jt(){const mt=function Wt(mt){const et={},Ge={__esModule:!0,initializeApp:function lt(ct,se={}){const Tt=k.initializeApp(ct,se);if((0,A.r3)(et,Tt.name))return et[Tt.name];const on=new mt(Tt,Ge);return et[Tt.name]=on,on},app:An,registerVersion:k.registerVersion,setLogLevel:k.setLogLevel,onLog:k.onLog,apps:null,SDK_VERSION:k.SDK_VERSION,INTERNAL:{registerComponent:function or(ct){const se=ct.name,Tt=se.replace("-compat","");if(k._registerComponent(ct)&&"PUBLIC"===ct.type){const on=(Vn=An())=>{if("function"!=typeof Vn[Tt])throw qn.create("invalid-app-argument",{appName:se});return Vn[Tt]()};void 0!==ct.serviceProps&&(0,A.ZB)(on,ct.serviceProps),Ge[Tt]=on,mt.prototype[Tt]=function(...Vn){return this._getService.bind(this,se).apply(this,ct.multipleInstances?Vn:[])}}return"PUBLIC"===ct.type?Ge[Tt]:null},removeApp:function Fn(ct){delete et[ct]},useAsService:function bn(ct,se){return"serverAuth"===se?null:se},modularAPIs:k}};function An(ct){if(!(0,A.r3)(et,ct=ct||k._DEFAULT_ENTRY_NAME))throw qn.create("no-app",{appName:ct});return et[ct]}return Ge.default=Ge,Object.defineProperty(Ge,"apps",{get:function Rt(){return Object.keys(et).map(ct=>et[ct])}}),An.App=mt,Ge}(sn);return mt.INTERNAL=Object.assign(Object.assign({},mt.INTERNAL),{createFirebaseNamespace:jt,extendNamespace:function et(Ge){(0,A.ZB)(mt,Ge)},createSubscribe:A.ne,ErrorFactory:A.LL,deepExtend:A.ZB}),mt}(),ie=new Te.Yd("@firebase/app-compat");if((0,A.jU)()&&void 0!==self.firebase){ie.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const mt=self.firebase.SDK_VERSION;mt&&mt.indexOf("LITE")>=0&&ie.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const Dn=X;!function yt(mt){(0,k.registerVersion)("@firebase/app-compat","0.2.25",mt)}()},534:(Ss,Wn,xe)=>{xe.r(Wn),xe.d(Wn,{FirebaseError:()=>Te.ZR,SDK_VERSION:()=>ki,_DEFAULT_ENTRY_NAME:()=>Xr,_addComponent:()=>xr,_addOrOverwriteComponent:()=>Ji,_apps:()=>yr,_clearComponents:()=>mi,_components:()=>pi,_getProvider:()=>gi,_registerComponent:()=>Un,_removeServiceInstance:()=>es,deleteApp:()=>kr,getApp:()=>Ys,getApps:()=>Kn,initializeApp:()=>bs,onLog:()=>ca,registerVersion:()=>Jr,setLogLevel:()=>Ct});var A=xe(861),$=xe(537),k=xe(879),Te=xe(58);const sn=(q,M)=>M.some(ne=>q instanceof ne);let We,qn;const X=new WeakMap,ie=new WeakMap,Se=new WeakMap,qe=new WeakMap,yt=new WeakMap;let et={get(q,M,ne){if(q instanceof IDBTransaction){if("done"===M)return ie.get(q);if("objectStoreNames"===M)return q.objectStoreNames||Se.get(q);if("store"===M)return ne.objectStoreNames[1]?void 0:ne.objectStore(ne.objectStoreNames[0])}return lt(q[M])},set:(q,M,ne)=>(q[M]=ne,!0),has:(q,M)=>q instanceof IDBTransaction&&("done"===M||"store"===M)||M in q};function An(q){return"function"==typeof q?function Fn(q){return q!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function jt(){return qn||(qn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(q)?function(...M){return q.apply(Rt(this),M),lt(X.get(this))}:function(...M){return lt(q.apply(Rt(this),M))}:function(M,...ne){const me=q.call(Rt(this),M,...ne);return Se.set(me,M.sort?M.sort():[M]),lt(me)}}(q):(q instanceof IDBTransaction&&function mt(q){if(ie.has(q))return;const M=new Promise((ne,me)=>{const st=()=>{q.removeEventListener("complete",dt),q.removeEventListener("error",V),q.removeEventListener("abort",V)},dt=()=>{ne(),st()},V=()=>{me(q.error||new DOMException("AbortError","AbortError")),st()};q.addEventListener("complete",dt),q.addEventListener("error",V),q.addEventListener("abort",V)});ie.set(q,M)}(q),sn(q,function Wt(){return We||(We=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(q,et):q)}function lt(q){if(q instanceof IDBRequest)return function Dn(q){const M=new Promise((ne,me)=>{const st=()=>{q.removeEventListener("success",dt),q.removeEventListener("error",V)},dt=()=>{ne(lt(q.result)),st()},V=()=>{me(q.error),st()};q.addEventListener("success",dt),q.addEventListener("error",V)});return M.then(ne=>{ne instanceof IDBCursor&&X.set(ne,q)}).catch(()=>{}),yt.set(M,q),M}(q);if(qe.has(q))return qe.get(q);const M=An(q);return M!==q&&(qe.set(q,M),yt.set(M,q)),M}const Rt=q=>yt.get(q),ct=["get","getKey","getAll","getAllKeys","count"],se=["put","add","delete","clear"],Tt=new Map;function on(q,M){if(!(q instanceof IDBDatabase)||M in q||"string"!=typeof M)return;if(Tt.get(M))return Tt.get(M);const ne=M.replace(/FromIndex$/,""),me=M!==ne,st=se.includes(ne);if(!(ne in(me?IDBIndex:IDBObjectStore).prototype)||!st&&!ct.includes(ne))return;const dt=function(){var V=(0,A.Z)(function*(Xt,...Jt){const Oi=this.transaction(Xt,st?"readwrite":"readonly");let ha=Oi.store;return me&&(ha=ha.index(Jt.shift())),(yield Promise.all([ha[ne](...Jt),st&&Oi.done]))[0]});return function(Jt){return V.apply(this,arguments)}}();return Tt.set(M,dt),dt}!function Ge(q){et=q(et)}(q=>({...q,get:(M,ne,me)=>on(M,ne)||q.get(M,ne,me),has:(M,ne)=>!!on(M,ne)||q.has(M,ne)}));class Vn{constructor(M){this.container=M}getPlatformInfoString(){return this.container.getProviders().map(ne=>{if(function Qr(q){const M=q.getComponent();return"VERSION"===M?.type}(ne)){const me=ne.getImmediate();return`${me.library}/${me.version}`}return null}).filter(ne=>ne).join(" ")}}const Ds="@firebase/app",Gn=new k.Yd("@firebase/app"),Xr="[DEFAULT]",Xi={[Ds]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},yr=new Map,pi=new Map;function xr(q,M){try{q.container.addComponent(M)}catch(ne){Gn.debug(`Component ${M.name} failed to register with FirebaseApp ${q.name}`,ne)}}function Ji(q,M){q.container.addOrOverwriteComponent(M)}function Un(q){const M=q.name;if(pi.has(M))return Gn.debug(`There were multiple attempts to register component ${M}.`),!1;pi.set(M,q);for(const ne of yr.values())xr(ne,q);return!0}function gi(q,M){const ne=q.container.getProvider("heartbeat").getImmediate({optional:!0});return ne&&ne.triggerHeartbeat(),q.container.getProvider(M)}function es(q,M,ne=Xr){gi(q,M).clearInstance(ne)}function mi(){pi.clear()}const an=new Te.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class qt{constructor(M,ne,me){this._isDeleted=!1,this._options=Object.assign({},M),this._config=Object.assign({},ne),this._name=ne.name,this._automaticDataCollectionEnabled=ne.automaticDataCollectionEnabled,this._container=me,this.container.addComponent(new $.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(M){this.checkDestroyed(),this._automaticDataCollectionEnabled=M}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(M){this._isDeleted=M}checkDestroyed(){if(this.isDeleted)throw an.create("app-deleted",{appName:this._name})}}const ki="10.7.1";function bs(q,M={}){let ne=q;"object"!=typeof M&&(M={name:M});const me=Object.assign({name:Xr,automaticDataCollectionEnabled:!1},M),st=me.name;if("string"!=typeof st||!st)throw an.create("bad-app-name",{appName:String(st)});if(ne||(ne=(0,Te.aH)()),!ne)throw an.create("no-options");const dt=yr.get(st);if(dt){if((0,Te.vZ)(ne,dt.options)&&(0,Te.vZ)(me,dt.config))return dt;throw an.create("duplicate-app",{appName:st})}const V=new $.H0(st);for(const Jt of pi.values())V.addComponent(Jt);const Xt=new qt(ne,me,V);return yr.set(st,Xt),Xt}function Ys(q=Xr){const M=yr.get(q);if(!M&&q===Xr&&(0,Te.aH)())return bs();if(!M)throw an.create("no-app",{appName:q});return M}function Kn(){return Array.from(yr.values())}function kr(q){return tr.apply(this,arguments)}function tr(){return(tr=(0,A.Z)(function*(q){const M=q.name;yr.has(M)&&(yr.delete(M),yield Promise.all(q.container.getProviders().map(ne=>ne.delete())),q.isDeleted=!0)})).apply(this,arguments)}function Jr(q,M,ne){var me;let st=null!==(me=Xi[q])&&void 0!==me?me:q;ne&&(st+=`-${ne}`);const dt=st.match(/\s|\//),V=M.match(/\s|\//);if(dt||V){const Xt=[`Unable to register library "${st}" with version "${M}":`];return dt&&Xt.push(`library name "${st}" contains illegal characters (whitespace or "/")`),dt&&V&&Xt.push("and"),V&&Xt.push(`version name "${M}" contains illegal characters (whitespace or "/")`),void Gn.warn(Xt.join(" "))}Un(new $.wA(`${st}-version`,()=>({library:st,version:M}),"VERSION"))}function ca(q,M){if(null!==q&&"function"!=typeof q)throw an.create("invalid-log-argument");(0,k.Am)(q,M)}function Ct(q){(0,k.Ub)(q)}const Do="firebase-heartbeat-database",Xs=1,P="firebase-heartbeat-store";let b=null;function I(){return b||(b=function or(q,M,{blocked:ne,upgrade:me,blocking:st,terminated:dt}={}){const V=indexedDB.open(q,M),Xt=lt(V);return me&&V.addEventListener("upgradeneeded",Jt=>{me(lt(V.result),Jt.oldVersion,Jt.newVersion,lt(V.transaction),Jt)}),ne&&V.addEventListener("blocked",Jt=>ne(Jt.oldVersion,Jt.newVersion,Jt)),Xt.then(Jt=>{dt&&Jt.addEventListener("close",()=>dt()),st&&Jt.addEventListener("versionchange",Oi=>st(Oi.oldVersion,Oi.newVersion,Oi))}).catch(()=>{}),Xt}(Do,Xs,{upgrade:(q,M)=>{0===M&&q.createObjectStore(P)}}).catch(q=>{throw an.create("idb-open",{originalErrorMessage:q.message})})),b}function E(){return(E=(0,A.Z)(function*(q){try{return yield(yield I()).transaction(P).objectStore(P).get(ce(q))}catch(M){if(M instanceof Te.ZR)Gn.warn(M.message);else{const ne=an.create("idb-get",{originalErrorMessage:M?.message});Gn.warn(ne.message)}}})).apply(this,arguments)}function O(q,M){return U.apply(this,arguments)}function U(){return(U=(0,A.Z)(function*(q,M){try{const me=(yield I()).transaction(P,"readwrite");yield me.objectStore(P).put(M,ce(q)),yield me.done}catch(ne){if(ne instanceof Te.ZR)Gn.warn(ne.message);else{const me=an.create("idb-set",{originalErrorMessage:ne?.message});Gn.warn(me.message)}}})).apply(this,arguments)}function ce(q){return`${q.name}!${q.options.appId}`}class we{constructor(M){this.container=M,this._heartbeatsCache=null;const ne=this.container.getProvider("app").getImmediate();this._storage=new Ye(ne),this._heartbeatsCachePromise=this._storage.read().then(me=>(this._heartbeatsCache=me,me))}triggerHeartbeat(){var M=this;return(0,A.Z)(function*(){var ne,me;const dt=M.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),V=Le();if((null!=(null===(ne=M._heartbeatsCache)||void 0===ne?void 0:ne.heartbeats)||(M._heartbeatsCache=yield M._heartbeatsCachePromise,null!=(null===(me=M._heartbeatsCache)||void 0===me?void 0:me.heartbeats)))&&M._heartbeatsCache.lastSentHeartbeatDate!==V&&!M._heartbeatsCache.heartbeats.some(Xt=>Xt.date===V))return M._heartbeatsCache.heartbeats.push({date:V,agent:dt}),M._heartbeatsCache.heartbeats=M._heartbeatsCache.heartbeats.filter(Xt=>{const Jt=new Date(Xt.date).valueOf();return Date.now()-Jt<=2592e6}),M._storage.overwrite(M._heartbeatsCache)})()}getHeartbeatsHeader(){var M=this;return(0,A.Z)(function*(){var ne;if(null===M._heartbeatsCache&&(yield M._heartbeatsCachePromise),null==(null===(ne=M._heartbeatsCache)||void 0===ne?void 0:ne.heartbeats)||0===M._heartbeatsCache.heartbeats.length)return"";const me=Le(),{heartbeatsToSend:st,unsentEntries:dt}=function Ke(q,M=1024){const ne=[];let me=q.slice();for(const st of q){const dt=ne.find(V=>V.agent===st.agent);if(dt){if(dt.dates.push(st.date),Or(ne)>M){dt.dates.pop();break}}else if(ne.push({agent:st.agent,dates:[st.date]}),Or(ne)>M){ne.pop();break}me=me.slice(1)}return{heartbeatsToSend:ne,unsentEntries:me}}(M._heartbeatsCache.heartbeats),V=(0,Te.L)(JSON.stringify({version:2,heartbeats:st}));return M._heartbeatsCache.lastSentHeartbeatDate=me,dt.length>0?(M._heartbeatsCache.heartbeats=dt,yield M._storage.overwrite(M._heartbeatsCache)):(M._heartbeatsCache.heartbeats=[],M._storage.overwrite(M._heartbeatsCache)),V})()}}function Le(){return(new Date).toISOString().substring(0,10)}class Ye{constructor(M){this.app=M,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,A.Z)(function*(){return!!(0,Te.hl)()&&(0,Te.eu)().then(()=>!0).catch(()=>!1)})()}read(){var M=this;return(0,A.Z)(function*(){if(yield M._canUseIndexedDBPromise){const me=yield function C(q){return E.apply(this,arguments)}(M.app);return me?.heartbeats?me:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(M){var ne=this;return(0,A.Z)(function*(){var me;if(yield ne._canUseIndexedDBPromise){const dt=yield ne.read();return O(ne.app,{lastSentHeartbeatDate:null!==(me=M.lastSentHeartbeatDate)&&void 0!==me?me:dt.lastSentHeartbeatDate,heartbeats:M.heartbeats})}})()}add(M){var ne=this;return(0,A.Z)(function*(){var me;if(yield ne._canUseIndexedDBPromise){const dt=yield ne.read();return O(ne.app,{lastSentHeartbeatDate:null!==(me=M.lastSentHeartbeatDate)&&void 0!==me?me:dt.lastSentHeartbeatDate,heartbeats:[...dt.heartbeats,...M.heartbeats]})}})()}}function Or(q){return(0,Te.L)(JSON.stringify({version:2,heartbeats:q})).length}!function da(q){Un(new $.wA("platform-logger",M=>new Vn(M),"PRIVATE")),Un(new $.wA("heartbeat",M=>new we(M),"PRIVATE")),Jr(Ds,"0.9.25",q),Jr(Ds,"0.9.25","esm2017"),Jr("fire-js","")}("")},537:(Ss,Wn,xe)=>{xe.d(Wn,{H0:()=>Wt,wA:()=>k,zt:()=>sn});var A=xe(861),$=xe(58);class k{constructor(X,ie,Se){this.name=X,this.instanceFactory=ie,this.type=Se,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(X){return this.instantiationMode=X,this}setMultipleInstances(X){return this.multipleInstances=X,this}setServiceProps(X){return this.serviceProps=X,this}setInstanceCreatedCallback(X){return this.onInstanceCreated=X,this}}const Te="[DEFAULT]";class sn{constructor(X,ie){this.name=X,this.container=ie,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(X){const ie=this.normalizeInstanceIdentifier(X);if(!this.instancesDeferred.has(ie)){const Se=new $.BH;if(this.instancesDeferred.set(ie,Se),this.isInitialized(ie)||this.shouldAutoInitialize())try{const qe=this.getOrInitializeService({instanceIdentifier:ie});qe&&Se.resolve(qe)}catch{}}return this.instancesDeferred.get(ie).promise}getImmediate(X){var ie;const Se=this.normalizeInstanceIdentifier(X?.identifier),qe=null!==(ie=X?.optional)&&void 0!==ie&&ie;if(!this.isInitialized(Se)&&!this.shouldAutoInitialize()){if(qe)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:Se})}catch(yt){if(qe)return null;throw yt}}getComponent(){return this.component}setComponent(X){if(X.name!==this.name)throw Error(`Mismatching Component ${X.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=X,this.shouldAutoInitialize()){if(function qn(jt){return"EAGER"===jt.instantiationMode}(X))try{this.getOrInitializeService({instanceIdentifier:Te})}catch{}for(const[ie,Se]of this.instancesDeferred.entries()){const qe=this.normalizeInstanceIdentifier(ie);try{const yt=this.getOrInitializeService({instanceIdentifier:qe});Se.resolve(yt)}catch{}}}}clearInstance(X=Te){this.instancesDeferred.delete(X),this.instancesOptions.delete(X),this.instances.delete(X)}delete(){var X=this;return(0,A.Z)(function*(){const ie=Array.from(X.instances.values());yield Promise.all([...ie.filter(Se=>"INTERNAL"in Se).map(Se=>Se.INTERNAL.delete()),...ie.filter(Se=>"_delete"in Se).map(Se=>Se._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(X=Te){return this.instances.has(X)}getOptions(X=Te){return this.instancesOptions.get(X)||{}}initialize(X={}){const{options:ie={}}=X,Se=this.normalizeInstanceIdentifier(X.instanceIdentifier);if(this.isInitialized(Se))throw Error(`${this.name}(${Se}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const qe=this.getOrInitializeService({instanceIdentifier:Se,options:ie});for(const[yt,Dn]of this.instancesDeferred.entries())Se===this.normalizeInstanceIdentifier(yt)&&Dn.resolve(qe);return qe}onInit(X,ie){var Se;const qe=this.normalizeInstanceIdentifier(ie),yt=null!==(Se=this.onInitCallbacks.get(qe))&&void 0!==Se?Se:new Set;yt.add(X),this.onInitCallbacks.set(qe,yt);const Dn=this.instances.get(qe);return Dn&&X(Dn,qe),()=>{yt.delete(X)}}invokeOnInitCallbacks(X,ie){const Se=this.onInitCallbacks.get(ie);if(Se)for(const qe of Se)try{qe(X,ie)}catch{}}getOrInitializeService({instanceIdentifier:X,options:ie={}}){let Se=this.instances.get(X);if(!Se&&this.component&&(Se=this.component.instanceFactory(this.container,{instanceIdentifier:(jt=X,jt===Te?void 0:jt),options:ie}),this.instances.set(X,Se),this.instancesOptions.set(X,ie),this.invokeOnInitCallbacks(Se,X),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,X,Se)}catch{}var jt;return Se||null}normalizeInstanceIdentifier(X=Te){return this.component?this.component.multipleInstances?X:Te:X}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Wt{constructor(X){this.name=X,this.providers=new Map}addComponent(X){const ie=this.getProvider(X.name);if(ie.isComponentSet())throw new Error(`Component ${X.name} has already been registered with ${this.name}`);ie.setComponent(X)}addOrOverwriteComponent(X){this.getProvider(X.name).isComponentSet()&&this.providers.delete(X.name),this.addComponent(X)}getProvider(X){if(this.providers.has(X))return this.providers.get(X);const ie=new sn(X,this);return this.providers.set(X,ie),ie}getProviders(){return Array.from(this.providers.values())}}},879:(Ss,Wn,xe)=>{xe.d(Wn,{Am:()=>jt,Ub:()=>Wt,Yd:()=>qn,in:()=>$});const A=[];var $=function(X){return X[X.DEBUG=0]="DEBUG",X[X.VERBOSE=1]="VERBOSE",X[X.INFO=2]="INFO",X[X.WARN=3]="WARN",X[X.ERROR=4]="ERROR",X[X.SILENT=5]="SILENT",X}($||{});const k={debug:$.DEBUG,verbose:$.VERBOSE,info:$.INFO,warn:$.WARN,error:$.ERROR,silent:$.SILENT},Te=$.INFO,sn={[$.DEBUG]:"log",[$.VERBOSE]:"log",[$.INFO]:"info",[$.WARN]:"warn",[$.ERROR]:"error"},We=(X,ie,...Se)=>{if(ie<X.logLevel)return;const qe=(new Date).toISOString(),yt=sn[ie];if(!yt)throw new Error(`Attempted to log a message with an invalid logType (value: ${ie})`);console[yt](`[${qe}]  ${X.name}:`,...Se)};class qn{constructor(ie){this.name=ie,this._logLevel=Te,this._logHandler=We,this._userLogHandler=null,A.push(this)}get logLevel(){return this._logLevel}set logLevel(ie){if(!(ie in $))throw new TypeError(`Invalid value "${ie}" assigned to \`logLevel\``);this._logLevel=ie}setLogLevel(ie){this._logLevel="string"==typeof ie?k[ie]:ie}get logHandler(){return this._logHandler}set logHandler(ie){if("function"!=typeof ie)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=ie}get userLogHandler(){return this._userLogHandler}set userLogHandler(ie){this._userLogHandler=ie}debug(...ie){this._userLogHandler&&this._userLogHandler(this,$.DEBUG,...ie),this._logHandler(this,$.DEBUG,...ie)}log(...ie){this._userLogHandler&&this._userLogHandler(this,$.VERBOSE,...ie),this._logHandler(this,$.VERBOSE,...ie)}info(...ie){this._userLogHandler&&this._userLogHandler(this,$.INFO,...ie),this._logHandler(this,$.INFO,...ie)}warn(...ie){this._userLogHandler&&this._userLogHandler(this,$.WARN,...ie),this._logHandler(this,$.WARN,...ie)}error(...ie){this._userLogHandler&&this._userLogHandler(this,$.ERROR,...ie),this._logHandler(this,$.ERROR,...ie)}}function Wt(X){A.forEach(ie=>{ie.setLogLevel(X)})}function jt(X,ie){for(const Se of A){let qe=null;ie&&ie.level&&(qe=k[ie.level]),Se.userLogHandler=null===X?null:(yt,Dn,...mt)=>{const et=mt.map(Ge=>{if(null==Ge)return null;if("string"==typeof Ge)return Ge;if("number"==typeof Ge||"boolean"==typeof Ge)return Ge.toString();if(Ge instanceof Error)return Ge.message;try{return JSON.stringify(Ge)}catch{return null}}).filter(Ge=>Ge).join(" ");Dn>=(qe??yt.logLevel)&&X({level:$[Dn].toLowerCase(),message:et,args:mt,type:yt.name})}}}},365:(Ss,Wn,xe)=>{xe.r(Wn);var A=xe(861),$=xe(106),k=xe(217),Te=xe(58),qn=(xe(534),xe(879),xe(537));function Wt(){return window}function ie(){return ie=(0,A.Z)(function*(I,C,E){var O;const{BuildInfo:U}=Wt();(0,k.au)(C.sessionId,"AuthEvent did not contain a session ID");const ce=yield function Ge(I){return Fn.apply(this,arguments)}(C.sessionId),Ue={};return(0,k.av)()?Ue.ibi=U.packageName:(0,k.aw)()?Ue.apn=U.packageName:(0,k.ax)(I,"operation-not-supported-in-this-environment"),U.displayName&&(Ue.appDisplayName=U.displayName),Ue.sessionId=ce,(0,k.ay)(I,E,C.type,void 0,null!==(O=C.eventId)&&void 0!==O?O:void 0,Ue)}),ie.apply(this,arguments)}function qe(){return(qe=(0,A.Z)(function*(I){const{BuildInfo:C}=Wt(),E={};(0,k.av)()?E.iosBundleId=C.packageName:(0,k.aw)()?E.androidPackageName=C.packageName:(0,k.ax)(I,"operation-not-supported-in-this-environment"),yield(0,k.az)(I,E)})).apply(this,arguments)}function mt(){return(mt=(0,A.Z)(function*(I,C,E){const{cordova:O}=Wt();let U=()=>{};try{yield new Promise((ce,Ue)=>{let oe=null;function we(){var Ye;ce();const Or=null===(Ye=O.plugins.browsertab)||void 0===Ye?void 0:Ye.close;"function"==typeof Or&&Or(),"function"==typeof E?.close&&E.close()}function Le(){oe||(oe=window.setTimeout(()=>{Ue((0,k.aB)(I,"redirect-cancelled-by-user"))},2e3))}function Ke(){"visible"===document?.visibilityState&&Le()}C.addPassiveListener(we),document.addEventListener("resume",Le,!1),(0,k.aw)()&&document.addEventListener("visibilitychange",Ke,!1),U=()=>{C.removePassiveListener(we),document.removeEventListener("resume",Le,!1),document.removeEventListener("visibilitychange",Ke,!1),oe&&window.clearTimeout(oe)}})}finally{U()}})).apply(this,arguments)}function Fn(){return(Fn=(0,A.Z)(function*(I){const C=function An(I){if((0,k.au)(/[0-9a-zA-Z]+/.test(I),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(I);const C=new ArrayBuffer(I.length),E=new Uint8Array(C);for(let O=0;O<I.length;O++)E[O]=I.charCodeAt(O);return E}(I),E=yield crypto.subtle.digest("SHA-256",C);return Array.from(new Uint8Array(E)).map(U=>U.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class Rt extends k.aD{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(C=>{this.resolveInialized=C})}addPassiveListener(C){this.passiveListeners.add(C)}removePassiveListener(C){this.passiveListeners.delete(C)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(C){return this.resolveInialized(),this.passiveListeners.forEach(E=>E(C)),super.onEvent(C)}initialized(){var C=this;return(0,A.Z)(function*(){yield C.initPromise})()}}function ct(I){return se.apply(this,arguments)}function se(){return(se=(0,A.Z)(function*(I){const C=yield Vn()._get(Qr(I));return C&&(yield Vn()._remove(Qr(I))),C})).apply(this,arguments)}function on(){const I=[];for(let E=0;E<20;E++){const O=Math.floor(62*Math.random());I.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(O))}return I.join("")}function Vn(){return(0,k.aE)(k.b)}function Qr(I){return(0,k.aF)("authEvent",I.config.apiKey,I.name)}function Gn(I){if(!I?.includes("?"))return{};const[C,...E]=I.split("?");return(0,Te.zd)(E.join("?"))}const H=class Mi{constructor(){this._redirectPersistence=k.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=k.aG,this._overrideRedirectResult=k.aH}_initialize(C){var E=this;return(0,A.Z)(function*(){const O=C._key();let U=E.eventManagers.get(O);return U||(U=new Rt(C),E.eventManagers.set(O,U),E.attachCallbackListeners(C,U)),U})()}_openPopup(C){(0,k.ax)(C,"operation-not-supported-in-this-environment")}_openRedirect(C,E,O,U){var ce=this;return(0,A.Z)(function*(){!function et(I){var C,E,O,U,ce,Ue,oe,we,Le,Ke;const Ye=Wt();(0,k.aC)("function"==typeof(null===(C=Ye?.universalLinks)||void 0===C?void 0:C.subscribe),I,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,k.aC)(typeof(null===(E=Ye?.BuildInfo)||void 0===E?void 0:E.packageName)<"u",I,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,k.aC)("function"==typeof(null===(ce=null===(U=null===(O=Ye?.cordova)||void 0===O?void 0:O.plugins)||void 0===U?void 0:U.browsertab)||void 0===ce?void 0:ce.openUrl),I,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,k.aC)("function"==typeof(null===(we=null===(oe=null===(Ue=Ye?.cordova)||void 0===Ue?void 0:Ue.plugins)||void 0===oe?void 0:oe.browsertab)||void 0===we?void 0:we.isAvailable),I,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,k.aC)("function"==typeof(null===(Ke=null===(Le=Ye?.cordova)||void 0===Le?void 0:Le.InAppBrowser)||void 0===Ke?void 0:Ke.open),I,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(C);const Ue=yield ce._initialize(C);yield Ue.initialized(),Ue.resetRedirect(),(0,k.aI)(),yield ce._originValidation(C);const oe=function or(I,C,E=null){return{type:C,eventId:E,urlResponse:null,sessionId:on(),postBody:null,tenantId:I.tenantId,error:(0,k.aB)(I,"no-auth-event")}}(C,O,U);yield function bn(I,C){return Vn()._set(Qr(I),C)}(C,oe);const we=yield function X(I,C,E){return ie.apply(this,arguments)}(C,oe,E),Le=yield function yt(I){const{cordova:C}=Wt();return new Promise(E=>{C.plugins.browsertab.isAvailable(O=>{let U=null;O?C.plugins.browsertab.openUrl(I):U=C.InAppBrowser.open(I,(0,k.aA)()?"_blank":"_system","location=yes"),E(U)})})}(we);return function Dn(I,C,E){return mt.apply(this,arguments)}(C,Ue,Le)})()}_isIframeWebStorageSupported(C,E){throw new Error("Method not implemented.")}_originValidation(C){const E=C._key();return this.originValidationPromises[E]||(this.originValidationPromises[E]=function Se(I){return qe.apply(this,arguments)}(C)),this.originValidationPromises[E]}attachCallbackListeners(C,E){const{universalLinks:O,handleOpenURL:U,BuildInfo:ce}=Wt(),Ue=setTimeout((0,A.Z)(function*(){yield ct(C),E.onEvent(W())}),500),oe=function(){var Ke=(0,A.Z)(function*(Ye){clearTimeout(Ue);const Or=yield ct(C);let da=null;Or&&Ye?.url&&(da=function Tt(I,C){var E,O;const U=function Qi(I){const C=Gn(I),E=C.link?decodeURIComponent(C.link):void 0,O=Gn(E).link,U=C.deep_link_id?decodeURIComponent(C.deep_link_id):void 0;return Gn(U).link||U||O||E||I}(C);if(U.includes("/__/auth/callback")){const ce=Gn(U),Ue=ce.firebaseError?function Ds(I){try{return JSON.parse(I)}catch{return null}}(decodeURIComponent(ce.firebaseError)):null,oe=null===(O=null===(E=Ue?.code)||void 0===E?void 0:E.split("auth/"))||void 0===O?void 0:O[1],we=oe?(0,k.aB)(oe):null;return we?{type:I.type,eventId:I.eventId,tenantId:I.tenantId,error:we,urlResponse:null,sessionId:null,postBody:null}:{type:I.type,eventId:I.eventId,tenantId:I.tenantId,sessionId:I.sessionId,urlResponse:U,postBody:null}}return null}(Or,Ye.url)),E.onEvent(da||W())});return function(Or){return Ke.apply(this,arguments)}}();typeof O<"u"&&"function"==typeof O.subscribe&&O.subscribe(null,oe);const we=U,Le=`${ce.packageName.toLowerCase()}://`;Wt().handleOpenURL=function(){var Ke=(0,A.Z)(function*(Ye){if(Ye.toLowerCase().startsWith(Le)&&oe({url:Ye}),"function"==typeof we)try{we(Ye)}catch(Or){console.error(Or)}});return function(Ye){return Ke.apply(this,arguments)}}()}};function W(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,k.aB)("no-auth-event")}}function Ae(){var I;return(null===(I=self?.location)||void 0===I?void 0:I.protocol)||null}function Pt(I=(0,Te.z$)()){return!("file:"!==Ae()&&"ionic:"!==Ae()&&"capacitor:"!==Ae()||!I.toLowerCase().match(/iphone|ipad|ipod|android/))}function Yt(){try{const I=self.localStorage,C=k.aN();if(I)return I.setItem(C,"1"),I.removeItem(C),!function ke(I=(0,Te.z$)()){return function wt(){return(0,Te.w1)()&&11===document?.documentMode}()||function vn(I=(0,Te.z$)()){return/Edge\/\d+/.test(I)}(I)}()||(0,Te.hl)()}catch{return Rn()&&(0,Te.hl)()}return!1}function Rn(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function En(){return(function it(){return"http:"===Ae()||"https:"===Ae()}()||(0,Te.ru)()||Pt())&&!function Pe(){return(0,Te.b$)()||(0,Te.UG)()}()&&Yt()&&!Rn()}function At(){return Pt()&&typeof document<"u"}function xi(){return(xi=(0,A.Z)(function*(){return!!At()&&new Promise(I=>{const C=setTimeout(()=>{I(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(C),I(!0)})})})).apply(this,arguments)}const Lt={LOCAL:"local",NONE:"none",SESSION:"session"},fi=k.aC,Yi="persistence";function Xi(I){return yr.apply(this,arguments)}function yr(){return(yr=(0,A.Z)(function*(I){yield I._initializationPromise;const C=xr(),E=k.aF(Yi,I.config.apiKey,I.name);C&&C.setItem(E,I._getPersistence())})).apply(this,arguments)}function xr(){var I;try{return(null===(I=function As(){return typeof window<"u"?window:null}())||void 0===I?void 0:I.sessionStorage)||null}catch{return null}}const Ji=k.aC;class Un{constructor(){this.browserResolver=k.aE(k.k),this.cordovaResolver=k.aE(H),this.underlyingResolver=null,this._redirectPersistence=k.a,this._completeRedirectFn=k.aG,this._overrideRedirectResult=k.aH}_initialize(C){var E=this;return(0,A.Z)(function*(){return yield E.selectUnderlyingResolver(),E.assertedUnderlyingResolver._initialize(C)})()}_openPopup(C,E,O,U){var ce=this;return(0,A.Z)(function*(){return yield ce.selectUnderlyingResolver(),ce.assertedUnderlyingResolver._openPopup(C,E,O,U)})()}_openRedirect(C,E,O,U){var ce=this;return(0,A.Z)(function*(){return yield ce.selectUnderlyingResolver(),ce.assertedUnderlyingResolver._openRedirect(C,E,O,U)})()}_isIframeWebStorageSupported(C,E){this.assertedUnderlyingResolver._isIframeWebStorageSupported(C,E)}_originValidation(C){return this.assertedUnderlyingResolver._originValidation(C)}get _shouldInitProactively(){return At()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Ji(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var C=this;return(0,A.Z)(function*(){if(C.underlyingResolver)return;const E=yield function Yr(){return xi.apply(this,arguments)}();C.underlyingResolver=E?C.cordovaResolver:C.browserResolver})()}}function gi(I){return I.unwrap()}function mi(I){return an(I)}function an(I){const{_tokenResponse:C}=I instanceof Te.ZR?I.customData:I;if(!C)return null;if(!(I instanceof Te.ZR)&&"temporaryProof"in C&&"phoneNumber"in C)return k.P.credentialFromResult(I);const E=C.providerId;if(!E||E===k.p.PASSWORD)return null;let O;switch(E){case k.p.GOOGLE:O=k.X;break;case k.p.FACEBOOK:O=k.W;break;case k.p.GITHUB:O=k.Y;break;case k.p.TWITTER:O=k.$;break;default:const{oauthIdToken:U,oauthAccessToken:ce,oauthTokenSecret:Ue,pendingToken:oe,nonce:we}=C;return ce||Ue||U||oe?oe?E.startsWith("saml.")?k.aQ._create(E,oe):k.N._fromParams({providerId:E,signInMethod:E,pendingToken:oe,idToken:U,accessToken:ce}):new k.Z(E).credential({idToken:U,accessToken:ce,rawNonce:we}):null}return I instanceof Te.ZR?O.credentialFromError(I):O.credentialFromResult(I)}function qt(I,C){return C.catch(E=>{throw E instanceof Te.ZR&&function So(I,C){var E;const O=null===(E=C.customData)||void 0===E?void 0:E._tokenResponse;if("auth/multi-factor-auth-required"===C?.code)C.resolver=new Ys(I,k.as(I,C));else if(O){const U=an(C),ce=C;U&&(ce.credential=U,ce.tenantId=O.tenantId||void 0,ce.email=O.email||void 0,ce.phoneNumber=O.phoneNumber||void 0)}}(I,E),E}).then(E=>{const U=E.user;return{operationType:E.operationType,credential:mi(E),additionalUserInfo:k.aq(E),user:Kn.getOrCreate(U)}})}function ki(I,C){return bs.apply(this,arguments)}function bs(){return(bs=(0,A.Z)(function*(I,C){const E=yield C;return{verificationId:E.verificationId,confirm:O=>qt(I,E.confirm(O))}})).apply(this,arguments)}class Ys{constructor(C,E){this.resolver=E,this.auth=function es(I){return I.wrapped()}(C)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(C){return qt(gi(this.auth),this.resolver.resolveSignIn(C))}}class Kn{constructor(C){this._delegate=C,this.multiFactor=k.at(C)}static getOrCreate(C){return Kn.USER_MAP.has(C)||Kn.USER_MAP.set(C,new Kn(C)),Kn.USER_MAP.get(C)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(C){return this._delegate.getIdTokenResult(C)}getIdToken(C){return this._delegate.getIdToken(C)}linkAndRetrieveDataWithCredential(C){return this.linkWithCredential(C)}linkWithCredential(C){var E=this;return(0,A.Z)(function*(){return qt(E.auth,k.a2(E._delegate,C))})()}linkWithPhoneNumber(C,E){var O=this;return(0,A.Z)(function*(){return ki(O.auth,k.l(O._delegate,C,E))})()}linkWithPopup(C){var E=this;return(0,A.Z)(function*(){return qt(E.auth,k.d(E._delegate,C,Un))})()}linkWithRedirect(C){var E=this;return(0,A.Z)(function*(){return yield Xi(k.aJ(E.auth)),k.g(E._delegate,C,Un)})()}reauthenticateAndRetrieveDataWithCredential(C){return this.reauthenticateWithCredential(C)}reauthenticateWithCredential(C){var E=this;return(0,A.Z)(function*(){return qt(E.auth,k.a3(E._delegate,C))})()}reauthenticateWithPhoneNumber(C,E){return ki(this.auth,k.r(this._delegate,C,E))}reauthenticateWithPopup(C){return qt(this.auth,k.e(this._delegate,C,Un))}reauthenticateWithRedirect(C){var E=this;return(0,A.Z)(function*(){return yield Xi(k.aJ(E.auth)),k.h(E._delegate,C,Un)})()}sendEmailVerification(C){return k.ag(this._delegate,C)}unlink(C){var E=this;return(0,A.Z)(function*(){return yield k.ap(E._delegate,C),E})()}updateEmail(C){return k.al(this._delegate,C)}updatePassword(C){return k.am(this._delegate,C)}updatePhoneNumber(C){return k.u(this._delegate,C)}updateProfile(C){return k.ak(this._delegate,C)}verifyBeforeUpdateEmail(C,E){return k.ah(this._delegate,C,E)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Kn.USER_MAP=new WeakMap;const kr=k.aC;let tr=(()=>{class I{constructor(E,O){if(this.app=E,O.isInitialized())return this._delegate=O.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:U}=E.options;kr(U,"invalid-api-key",{appName:E.name}),kr(U,"invalid-api-key",{appName:E.name});const ce=typeof window<"u"?Un:void 0;this._delegate=O.initialize({options:{persistence:ca(U,E.name),popupRedirectResolver:ce}}),this._delegate._updateErrorMap(k.G),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Kn.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(E){this._delegate.languageCode=E}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(E){this._delegate.tenantId=E}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(E,O){k.K(this._delegate,E,O)}applyActionCode(E){return k.a7(this._delegate,E)}checkActionCode(E){return k.a8(this._delegate,E)}confirmPasswordReset(E,O){return k.a6(this._delegate,E,O)}createUserWithEmailAndPassword(E,O){var U=this;return(0,A.Z)(function*(){return qt(U._delegate,k.aa(U._delegate,E,O))})()}fetchProvidersForEmail(E){return this.fetchSignInMethodsForEmail(E)}fetchSignInMethodsForEmail(E){return k.af(this._delegate,E)}isSignInWithEmailLink(E){return k.ad(this._delegate,E)}getRedirectResult(){var E=this;return(0,A.Z)(function*(){kr(En(),E._delegate,"operation-not-supported-in-this-environment");const O=yield k.j(E._delegate,Un);return O?qt(E._delegate,Promise.resolve(O)):{credential:null,user:null}})()}addFrameworkForLogging(E){!function Q(I,C){(0,k.aJ)(I)._logFramework(C)}(this._delegate,E)}onAuthStateChanged(E,O,U){const{next:ce,error:Ue,complete:oe}=Jr(E,O,U);return this._delegate.onAuthStateChanged(ce,Ue,oe)}onIdTokenChanged(E,O,U){const{next:ce,error:Ue,complete:oe}=Jr(E,O,U);return this._delegate.onIdTokenChanged(ce,Ue,oe)}sendSignInLinkToEmail(E,O){return k.ac(this._delegate,E,O)}sendPasswordResetEmail(E,O){return k.a5(this._delegate,E,O||void 0)}setPersistence(E){var O=this;return(0,A.Z)(function*(){let U;switch(function Xr(I,C){fi(Object.values(Lt).includes(C),I,"invalid-persistence-type"),(0,Te.b$)()?fi(C!==Lt.SESSION,I,"unsupported-persistence-type"):(0,Te.UG)()?fi(C===Lt.NONE,I,"unsupported-persistence-type"):Rn()?fi(C===Lt.NONE||C===Lt.LOCAL&&(0,Te.hl)(),I,"unsupported-persistence-type"):fi(C===Lt.NONE||Yt(),I,"unsupported-persistence-type")}(O._delegate,E),E){case Lt.SESSION:U=k.a;break;case Lt.LOCAL:U=(yield k.aE(k.i)._isAvailable())?k.i:k.b;break;case Lt.NONE:U=k.U;break;default:return k.ax("argument-error",{appName:O._delegate.name})}return O._delegate.setPersistence(U)})()}signInAndRetrieveDataWithCredential(E){return this.signInWithCredential(E)}signInAnonymously(){return qt(this._delegate,k.a0(this._delegate))}signInWithCredential(E){return qt(this._delegate,k.a1(this._delegate,E))}signInWithCustomToken(E){return qt(this._delegate,k.a4(this._delegate,E))}signInWithEmailAndPassword(E,O){return qt(this._delegate,k.ab(this._delegate,E,O))}signInWithEmailLink(E,O){return qt(this._delegate,k.ae(this._delegate,E,O))}signInWithPhoneNumber(E,O){return ki(this._delegate,k.s(this._delegate,E,O))}signInWithPopup(E){var O=this;return(0,A.Z)(function*(){return kr(En(),O._delegate,"operation-not-supported-in-this-environment"),qt(O._delegate,k.c(O._delegate,E,Un))})()}signInWithRedirect(E){var O=this;return(0,A.Z)(function*(){return kr(En(),O._delegate,"operation-not-supported-in-this-environment"),yield Xi(O._delegate),k.f(O._delegate,E,Un)})()}updateCurrentUser(E){return this._delegate.updateCurrentUser(E)}verifyPasswordResetCode(E){return k.a9(this._delegate,E)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return I.Persistence=Lt,I})();function Jr(I,C,E){let O=I;"function"!=typeof I&&({next:O,error:C,complete:E}=I);const U=O;return{next:Ue=>U(Ue&&Kn.getOrCreate(Ue)),error:C,complete:E}}function ca(I,C){const E=function pi(I,C){const E=xr();if(!E)return[];const O=k.aF(Yi,I,C);switch(E.getItem(O)){case Lt.NONE:return[k.U];case Lt.LOCAL:return[k.i,k.a];case Lt.SESSION:return[k.a];default:return[]}}(I,C);if(typeof self<"u"&&!E.includes(k.i)&&E.push(k.i),typeof window<"u")for(const O of[k.b,k.a])E.includes(O)||E.push(O);return E.includes(k.U)||E.push(k.U),E}class Ct{constructor(){this.providerId="phone",this._delegate=new k.P(gi($.Z.auth()))}static credential(C,E){return k.P.credential(C,E)}verifyPhoneNumber(C,E){return this._delegate.verifyPhoneNumber(C,E)}unwrap(){return this._delegate}}Ct.PHONE_SIGN_IN_METHOD=k.P.PHONE_SIGN_IN_METHOD,Ct.PROVIDER_ID=k.P.PROVIDER_ID;const Do=k.aC;class Xs{constructor(C,E,O=$.Z.app()){var U;Do(null===(U=O.options)||void 0===U?void 0:U.apiKey,"invalid-api-key",{appName:O.name}),this._delegate=new k.R(O.auth(),C,E),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function b(I){I.INTERNAL.registerComponent(new qn.wA("auth-compat",C=>{const E=C.getProvider("app-compat").getImmediate(),O=C.getProvider("auth");return new tr(E,O)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:k.A.EMAIL_SIGNIN,PASSWORD_RESET:k.A.PASSWORD_RESET,RECOVER_EMAIL:k.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:k.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:k.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:k.A.VERIFY_EMAIL}},EmailAuthProvider:k.V,FacebookAuthProvider:k.W,GithubAuthProvider:k.Y,GoogleAuthProvider:k.X,OAuthProvider:k.Z,SAMLAuthProvider:k._,PhoneAuthProvider:Ct,PhoneMultiFactorGenerator:k.m,RecaptchaVerifier:Xs,TwitterAuthProvider:k.$,Auth:tr,AuthCredential:k.L,Error:Te.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),I.registerVersion("@firebase/auth-compat","0.5.1")}($.Z)},861:(Ss,Wn,xe)=>{function A(k,Te,sn,We,qn,Wt,jt){try{var X=k[Wt](jt),ie=X.value}catch(Se){return void sn(Se)}X.done?Te(ie):Promise.resolve(ie).then(We,qn)}function $(k){return function(){var Te=this,sn=arguments;return new Promise(function(We,qn){var Wt=k.apply(Te,sn);function jt(ie){A(Wt,We,qn,jt,X,"next",ie)}function X(ie){A(Wt,We,qn,jt,X,"throw",ie)}jt(void 0)})}}xe.d(Wn,{Z:()=>$})},582:(Ss,Wn,xe)=>{function Te(H,W){var Q={};for(var B in H)Object.prototype.hasOwnProperty.call(H,B)&&W.indexOf(B)<0&&(Q[B]=H[B]);if(null!=H&&"function"==typeof Object.getOwnPropertySymbols){var J=0;for(B=Object.getOwnPropertySymbols(H);J<B.length;J++)W.indexOf(B[J])<0&&Object.prototype.propertyIsEnumerable.call(H,B[J])&&(Q[B[J]]=H[B[J]])}return Q}function Se(H,W,Q,B){return new(Q||(Q=Promise))(function(ue,Ae){function it(wt){try{Pe(B.next(wt))}catch(vn){Ae(vn)}}function Pt(wt){try{Pe(B.throw(wt))}catch(vn){Ae(vn)}}function Pe(wt){wt.done?ue(wt.value):function J(ue){return ue instanceof Q?ue:new Q(function(Ae){Ae(ue)})}(wt.value).then(it,Pt)}Pe((B=B.apply(H,W||[])).next())})}function lt(H){return this instanceof lt?(this.v=H,this):new lt(H)}function Rt(H,W,Q){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var J,B=Q.apply(H,W||[]),ue=[];return J={},Ae("next"),Ae("throw"),Ae("return"),J[Symbol.asyncIterator]=function(){return this},J;function Ae(ke){B[ke]&&(J[ke]=function(Yt){return new Promise(function(Rn,En){ue.push([ke,Yt,Rn,En])>1||it(ke,Yt)})})}function it(ke,Yt){try{!function Pt(ke){ke.value instanceof lt?Promise.resolve(ke.value.v).then(Pe,wt):vn(ue[0][2],ke)}(B[ke](Yt))}catch(Rn){vn(ue[0][3],Rn)}}function Pe(ke){it("next",ke)}function wt(ke){it("throw",ke)}function vn(ke,Yt){ke(Yt),ue.shift(),ue.length&&it(ue[0][0],ue[0][1])}}function bn(H){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Q,W=H[Symbol.asyncIterator];return W?W.call(H):(H=function mt(H){var W="function"==typeof Symbol&&Symbol.iterator,Q=W&&H[W],B=0;if(Q)return Q.call(H);if(H&&"number"==typeof H.length)return{next:function(){return H&&B>=H.length&&(H=void 0),{value:H&&H[B++],done:!H}}};throw new TypeError(W?"Object is not iterable.":"Symbol.iterator is not defined.")}(H),Q={},B("next"),B("throw"),B("return"),Q[Symbol.asyncIterator]=function(){return this},Q);function B(ue){Q[ue]=H[ue]&&function(Ae){return new Promise(function(it,Pt){!function J(ue,Ae,it,Pt){Promise.resolve(Pt).then(function(Pe){ue({value:Pe,done:it})},Ae)}(it,Pt,(Ae=H[ue](Ae)).done,Ae.value)})}}}xe.d(Wn,{FC:()=>Rt,KL:()=>bn,_T:()=>Te,mG:()=>Se,qq:()=>lt}),"function"==typeof SuppressedError&&SuppressedError}},Ss=>{Ss(Ss.s=621)}]);