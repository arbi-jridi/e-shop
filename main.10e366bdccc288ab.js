"use strict";(self.webpackChunke_shop=self.webpackChunke_shop||[]).push([[179],{58:($s,nr,We)=>{We.d(nr,{BH:()=>St,DV:()=>Pt,Dv:()=>Gs,G6:()=>Ai,GJ:()=>Pn,L:()=>Tt,LL:()=>Q,Pz:()=>mt,Sg:()=>br,UG:()=>Y,UI:()=>eu,US:()=>$e,Wj:()=>ci,Wl:()=>be,Yr:()=>la,ZB:()=>we,ZR:()=>J,aH:()=>zt,b$:()=>bi,cI:()=>En,dS:()=>vs,eu:()=>B,g5:()=>U,gK:()=>ys,gQ:()=>Hr,h$:()=>rr,hl:()=>F,hu:()=>Ee,jU:()=>fn,lb:()=>sr,m9:()=>Nl,ne:()=>Ws,p$:()=>re,pd:()=>Pl,r3:()=>Gn,ru:()=>pn,tV:()=>X,uI:()=>ir,ug:()=>nu,vZ:()=>zs,w1:()=>gs,w9:()=>Wn,xO:()=>tu,xb:()=>ui,z$:()=>rt,zd:()=>$r});const C={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},Ee=function(A,S){if(!A)throw U(S)},U=function(A){return new Error("Firebase Database ("+C.SDK_VERSION+") INTERNAL ASSERT FAILED: "+A)},Le=function(A){const S=[];let P=0;for(let G=0;G<A.length;G++){let x=A.charCodeAt(G);x<128?S[P++]=x:x<2048?(S[P++]=x>>6|192,S[P++]=63&x|128):55296==(64512&x)&&G+1<A.length&&56320==(64512&A.charCodeAt(G+1))?(x=65536+((1023&x)<<10)+(1023&A.charCodeAt(++G)),S[P++]=x>>18|240,S[P++]=x>>12&63|128,S[P++]=x>>6&63|128,S[P++]=63&x|128):(S[P++]=x>>12|224,S[P++]=x>>6&63|128,S[P++]=63&x|128)}return S},$e={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(A,S){if(!Array.isArray(A))throw Error("encodeByteArray takes an array as a parameter");this.init_();const P=S?this.byteToCharMapWebSafe_:this.byteToCharMap_,G=[];for(let x=0;x<A.length;x+=3){const he=A[x],ge=x+1<A.length,Te=ge?A[x+1]:0,qr=x+2<A.length,fe=qr?A[x+2]:0;let gt=(15&Te)<<2|fe>>6,qi=63&fe;qr||(qi=64,ge||(gt=64)),G.push(P[he>>2],P[(3&he)<<4|Te>>4],P[gt],P[qi])}return G.join("")},encodeString(A,S){return this.HAS_NATIVE_SUPPORT&&!S?btoa(A):this.encodeByteArray(Le(A),S)},decodeString(A,S){return this.HAS_NATIVE_SUPPORT&&!S?atob(A):function(A){const S=[];let P=0,G=0;for(;P<A.length;){const x=A[P++];if(x<128)S[G++]=String.fromCharCode(x);else if(x>191&&x<224){const he=A[P++];S[G++]=String.fromCharCode((31&x)<<6|63&he)}else if(x>239&&x<365){const qr=((7&x)<<18|(63&A[P++])<<12|(63&A[P++])<<6|63&A[P++])-65536;S[G++]=String.fromCharCode(55296+(qr>>10)),S[G++]=String.fromCharCode(56320+(1023&qr))}else{const he=A[P++],ge=A[P++];S[G++]=String.fromCharCode((15&x)<<12|(63&he)<<6|63&ge)}}return S.join("")}(this.decodeStringToByteArray(A,S))},decodeStringToByteArray(A,S){this.init_();const P=S?this.charToByteMapWebSafe_:this.charToByteMap_,G=[];for(let x=0;x<A.length;){const he=P[A.charAt(x++)],Te=x<A.length?P[A.charAt(x)]:0;++x;const fe=x<A.length?P[A.charAt(x)]:64;++x;const Qe=x<A.length?P[A.charAt(x)]:64;if(++x,null==he||null==Te||null==fe||null==Qe)throw new Rn;G.push(he<<2|Te>>4),64!==fe&&(G.push(Te<<4&240|fe>>2),64!==Qe&&G.push(fe<<6&192|Qe))}return G},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let A=0;A<this.ENCODED_VALS.length;A++)this.byteToCharMap_[A]=this.ENCODED_VALS.charAt(A),this.charToByteMap_[this.byteToCharMap_[A]]=A,this.byteToCharMapWebSafe_[A]=this.ENCODED_VALS_WEBSAFE.charAt(A),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[A]]=A,A>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(A)]=A,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(A)]=A)}}};class Rn extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const rr=function(A){const S=Le(A);return $e.encodeByteArray(S,!0)},Tt=function(A){return rr(A).replace(/\./g,"")},X=function(A){try{return $e.decodeString(A,!0)}catch(S){console.error("base64Decode failed: ",S)}return null};function re(A){return we(void 0,A)}function we(A,S){if(!(S instanceof Object))return S;switch(S.constructor){case Date:return new Date(S.getTime());case Object:void 0===A&&(A={});break;case Array:A=[];break;default:return S}for(const P in S)!S.hasOwnProperty(P)||!et(P)||(A[P]=we(A[P],S[P]));return A}function et(A){return"__proto__"!==A}const nt=()=>{try{return function pt(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const A=process.env.__FIREBASE_DEFAULTS__;return A?JSON.parse(A):void 0})()||(()=>{if(typeof document>"u")return;let A;try{A=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const S=A&&X(A[1]);return S&&JSON.parse(S)})()}catch(A){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${A}`)}},zt=()=>{var A;return null===(A=nt())||void 0===A?void 0:A.config},mt=A=>{var S;return null===(S=nt())||void 0===S?void 0:S[`_${A}`]};class St{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((S,P)=>{this.resolve=S,this.reject=P})}wrapCallback(S){return(P,G)=>{P?this.reject(P):this.resolve(G),"function"==typeof S&&(this.promise.catch(()=>{}),1===S.length?S(P):S(P,G))}}}function br(A,S){if(A.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const G=S||"demo-project",x=A.iat||0,he=A.sub||A.user_id;if(!he)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const ge=Object.assign({iss:`https://securetoken.google.com/${G}`,aud:G,iat:x,exp:x+3600,auth_time:x,sub:he,user_id:he,firebase:{sign_in_provider:"custom",identities:{}}},A);return[Tt(JSON.stringify({alg:"none",type:"JWT"})),Tt(JSON.stringify(ge)),""].join(".")}function rt(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function ir(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(rt())}function Y(){var A;const S=null===(A=nt())||void 0===A?void 0:A.forceEnvironment;if("node"===S)return!0;if("browser"===S)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function fn(){return"object"==typeof self&&self.self===self}function pn(){const A="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof A&&void 0!==A.id}function bi(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function gs(){const A=rt();return A.indexOf("MSIE ")>=0||A.indexOf("Trident/")>=0}function la(){return!0===C.NODE_CLIENT||!0===C.NODE_ADMIN}function Ai(){return!Y()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function F(){try{return"object"==typeof indexedDB}catch{return!1}}function B(){return new Promise((A,S)=>{try{let P=!0;const G="validate-browser-context-for-indexeddb-analytics-module",x=self.indexedDB.open(G);x.onsuccess=()=>{x.result.close(),P||self.indexedDB.deleteDatabase(G),A(!0)},x.onupgradeneeded=()=>{P=!1},x.onerror=()=>{var he;S((null===(he=x.error)||void 0===he?void 0:he.message)||"")}}catch(P){S(P)}})}class J extends Error{constructor(S,P,G){super(P),this.code=S,this.customData=G,this.name="FirebaseError",Object.setPrototypeOf(this,J.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Q.prototype.create)}}class Q{constructor(S,P,G){this.service=S,this.serviceName=P,this.errors=G}create(S,...P){const G=P[0]||{},x=`${this.service}/${S}`,he=this.errors[S],ge=he?function Pe(A,S){return A.replace(ut,(P,G)=>{const x=S[G];return null!=x?String(x):`<${G}?>`})}(he,G):"Error";return new J(x,`${this.serviceName}: ${ge} (${x}).`,G)}}const ut=/\{\$([^}]+)}/g;function En(A){return JSON.parse(A)}function be(A){return JSON.stringify(A)}const _t=function(A){let S={},P={},G={},x="";try{const he=A.split(".");S=En(X(he[0])||""),P=En(X(he[1])||""),x=he[2],G=P.d||{},delete P.d}catch{}return{header:S,claims:P,data:G,signature:x}},Wn=function(A){const P=_t(A).claims;return!!P&&"object"==typeof P&&P.hasOwnProperty("iat")},Pn=function(A){const S=_t(A).claims;return"object"==typeof S&&!0===S.admin};function Gn(A,S){return Object.prototype.hasOwnProperty.call(A,S)}function Pt(A,S){if(Object.prototype.hasOwnProperty.call(A,S))return A[S]}function ui(A){for(const S in A)if(Object.prototype.hasOwnProperty.call(A,S))return!1;return!0}function eu(A,S,P){const G={};for(const x in A)Object.prototype.hasOwnProperty.call(A,x)&&(G[x]=S.call(P,A[x],x,A));return G}function zs(A,S){if(A===S)return!0;const P=Object.keys(A),G=Object.keys(S);for(const x of P){if(!G.includes(x))return!1;const he=A[x],ge=S[x];if(li(he)&&li(ge)){if(!zs(he,ge))return!1}else if(he!==ge)return!1}for(const x of G)if(!P.includes(x))return!1;return!0}function li(A){return null!==A&&"object"==typeof A}function tu(A){const S=[];for(const[P,G]of Object.entries(A))Array.isArray(G)?G.forEach(x=>{S.push(encodeURIComponent(P)+"="+encodeURIComponent(x))}):S.push(encodeURIComponent(P)+"="+encodeURIComponent(G));return S.length?"&"+S.join("&"):""}function $r(A){const S={};return A.replace(/^\?/,"").split("&").forEach(G=>{if(G){const[x,he]=G.split("=");S[decodeURIComponent(x)]=decodeURIComponent(he)}}),S}function Pl(A){const S=A.indexOf("?");if(!S)return"";const P=A.indexOf("#",S);return A.substring(S,P>0?P:void 0)}class Hr{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let S=1;S<this.blockSize;++S)this.pad_[S]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(S,P){P||(P=0);const G=this.W_;if("string"==typeof S)for(let Qe=0;Qe<16;Qe++)G[Qe]=S.charCodeAt(P)<<24|S.charCodeAt(P+1)<<16|S.charCodeAt(P+2)<<8|S.charCodeAt(P+3),P+=4;else for(let Qe=0;Qe<16;Qe++)G[Qe]=S[P]<<24|S[P+1]<<16|S[P+2]<<8|S[P+3],P+=4;for(let Qe=16;Qe<80;Qe++){const gt=G[Qe-3]^G[Qe-8]^G[Qe-14]^G[Qe-16];G[Qe]=4294967295&(gt<<1|gt>>>31)}let fe,Ue,x=this.chain_[0],he=this.chain_[1],ge=this.chain_[2],Te=this.chain_[3],qr=this.chain_[4];for(let Qe=0;Qe<80;Qe++){Qe<40?Qe<20?(fe=Te^he&(ge^Te),Ue=1518500249):(fe=he^ge^Te,Ue=1859775393):Qe<60?(fe=he&ge|Te&(he|ge),Ue=2400959708):(fe=he^ge^Te,Ue=3395469782);const gt=(x<<5|x>>>27)+fe+qr+Ue+G[Qe]&4294967295;qr=Te,Te=ge,ge=4294967295&(he<<30|he>>>2),he=x,x=gt}this.chain_[0]=this.chain_[0]+x&4294967295,this.chain_[1]=this.chain_[1]+he&4294967295,this.chain_[2]=this.chain_[2]+ge&4294967295,this.chain_[3]=this.chain_[3]+Te&4294967295,this.chain_[4]=this.chain_[4]+qr&4294967295}update(S,P){if(null==S)return;void 0===P&&(P=S.length);const G=P-this.blockSize;let x=0;const he=this.buf_;let ge=this.inbuf_;for(;x<P;){if(0===ge)for(;x<=G;)this.compress_(S,x),x+=this.blockSize;if("string"==typeof S){for(;x<P;)if(he[ge]=S.charCodeAt(x),++ge,++x,ge===this.blockSize){this.compress_(he),ge=0;break}}else for(;x<P;)if(he[ge]=S[x],++ge,++x,ge===this.blockSize){this.compress_(he),ge=0;break}}this.inbuf_=ge,this.total_+=P}digest(){const S=[];let P=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let x=this.blockSize-1;x>=56;x--)this.buf_[x]=255&P,P/=256;this.compress_(this.buf_);let G=0;for(let x=0;x<5;x++)for(let he=24;he>=0;he-=8)S[G]=this.chain_[x]>>he&255,++G;return S}}function Ws(A,S){const P=new ms(A,S);return P.subscribe.bind(P)}class ms{constructor(S,P){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=P,this.task.then(()=>{S(this)}).catch(G=>{this.error(G)})}next(S){this.forEachObserver(P=>{P.next(S)})}error(S){this.forEachObserver(P=>{P.error(S)}),this.close(S)}complete(){this.forEachObserver(S=>{S.complete()}),this.close()}subscribe(S,P,G){let x;if(void 0===S&&void 0===P&&void 0===G)throw new Error("Missing Observer.");x=function _s(A,S){if("object"!=typeof A||null===A)return!1;for(const P of S)if(P in A&&"function"==typeof A[P])return!0;return!1}(S,["next","error","complete"])?S:{next:S,error:P,complete:G},void 0===x.next&&(x.next=Eo),void 0===x.error&&(x.error=Eo),void 0===x.complete&&(x.complete=Eo);const he=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?x.error(this.finalError):x.complete()}catch{}}),this.observers.push(x),he}unsubscribeOne(S){void 0===this.observers||void 0===this.observers[S]||(delete this.observers[S],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(S){if(!this.finalized)for(let P=0;P<this.observers.length;P++)this.sendOne(P,S)}sendOne(S,P){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[S])try{P(this.observers[S])}catch(G){typeof console<"u"&&console.error&&console.error(G)}})}close(S){this.finalized||(this.finalized=!0,void 0!==S&&(this.finalError=S),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Eo(){}const Gs=function(A,S,P,G){let x;if(G<S?x="at least "+S:G>P&&(x=0===P?"none":"no more than "+P),x)throw new Error(A+" failed: Was called with "+G+(1===G?" argument.":" arguments.")+" Expects "+x+".")};function ys(A,S){return`${A} failed: ${S} argument `}function ci(A,S,P,G){if((!G||P)&&"function"!=typeof P)throw new Error(ys(A,S)+"must be a valid function.")}function sr(A,S,P,G){if((!G||P)&&("object"!=typeof P||null===P))throw new Error(ys(A,S)+"must be a valid context object.")}const vs=function(A){const S=[];let P=0;for(let G=0;G<A.length;G++){let x=A.charCodeAt(G);if(x>=55296&&x<=56319){const he=x-55296;G++,Ee(G<A.length,"Surrogate pair missing trail surrogate."),x=65536+(he<<10)+(A.charCodeAt(G)-56320)}x<128?S[P++]=x:x<2048?(S[P++]=x>>6|192,S[P++]=63&x|128):x<65536?(S[P++]=x>>12|224,S[P++]=x>>6&63|128,S[P++]=63&x|128):(S[P++]=x>>18|240,S[P++]=x>>12&63|128,S[P++]=x>>6&63|128,S[P++]=63&x|128)}return S},nu=function(A){let S=0;for(let P=0;P<A.length;P++){const G=A.charCodeAt(P);G<128?S++:G<2048?S+=2:G>=55296&&G<=56319?(S+=4,P++):S+=3}return S};function Nl(A){return A&&A._delegate?A._delegate:A}},421:($s,nr,We)=>{let Ee=null,Le=1;function $e(t){const e=Ee;return Ee=t,e}function et(t){if((!St(t)||t.dirty)&&(t.dirty||t.lastCleanEpoch!==Le)){if(!t.producerMustRecompute(t)&&!Ln(t))return t.dirty=!1,void(t.lastCleanEpoch=Le);t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=Le}}function Ln(t){br(t);for(let e=0;e<t.producerNode.length;e++){const n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(et(n),r!==n.version))return!0}return!1}function mt(t,e){if(function rt(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}(t),br(t),1===t.liveConsumerNode.length)for(let r=0;r<t.producerNode.length;r++)mt(t.producerNode[r],t.producerIndexOfThis[r]);const n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){const r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];br(i),i.producerIndexOfThis[r]=e}}function St(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function br(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}let gs=null;function xe(t){return"function"==typeof t}function Wn(t){const n=t(r=>{Error.call(r),r.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const Pn=Wn(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function Gn(t,e){if(t){const n=t.indexOf(e);0<=n&&t.splice(n,1)}}class Pt{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const s of n)s.remove(this);else n.remove(this);const{initialTeardown:r}=this;if(xe(r))try{r()}catch(s){e=s instanceof Pn?s.errors:[s]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const s of i)try{zs(s)}catch(o){e=e??[],o instanceof Pn?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Pn(e)}}add(e){var n;if(e&&e!==this)if(this.closed)zs(e);else{if(e instanceof Pt){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(e)}}_hasParent(e){const{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){const{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&Gn(n,e)}remove(e){const{_finalizers:n}=this;n&&Gn(n,e),e instanceof Pt&&e._removeParent(this)}}Pt.EMPTY=(()=>{const t=new Pt;return t.closed=!0,t})();const ui=Pt.EMPTY;function eu(t){return t instanceof Pt||t&&"closed"in t&&xe(t.remove)&&xe(t.add)&&xe(t.unsubscribe)}function zs(t){xe(t)?t():t.unsubscribe()}const li={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},qs={setTimeout(t,e,...n){const{delegate:r}=qs;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){const{delegate:e}=qs;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function tu(t){qs.setTimeout(()=>{const{onUnhandledError:e}=li;if(!e)throw t;e(t)})}function $r(){}const Pl=ms("C",void 0,void 0);function ms(t,e,n){return{kind:t,value:e,error:n}}let zr=null;function _s(t){if(li.useDeprecatedSynchronousErrorHandling){const e=!zr;if(e&&(zr={errorThrown:!1,error:null}),t(),e){const{errorThrown:n,error:r}=zr;if(zr=null,n)throw r}}else t()}class Gs extends Pt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,eu(e)&&e.add(this)):this.destination=iu}static create(e,n,r){return new sr(e,n,r)}next(e){this.isStopped?ru(function Ws(t){return ms("N",t,void 0)}(e),this):this._next(e)}error(e){this.isStopped?ru(function Hr(t){return ms("E",void 0,t)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?ru(Pl,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const ys=Function.prototype.bind;function Ks(t,e){return ys.call(t,e)}class ci{constructor(e){this.partialObserver=e}next(e){const{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){vs(r)}}error(e){const{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){vs(r)}else vs(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){vs(n)}}}class sr extends Gs{constructor(e,n,r){let i;if(super(),xe(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&li.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Ks(e.next,s),error:e.error&&Ks(e.error,s),complete:e.complete&&Ks(e.complete,s)}):i=e}this.destination=new ci(i)}}function vs(t){li.useDeprecatedSynchronousErrorHandling?function Eo(t){li.useDeprecatedSynchronousErrorHandling&&zr&&(zr.errorThrown=!0,zr.error=t)}(t):tu(t)}function ru(t,e){const{onStoppedNotification:n}=li;n&&qs.setTimeout(()=>n(t,e))}const iu={closed:!0,next:$r,error:function nu(t){throw t},complete:$r},zi="function"==typeof Symbol&&Symbol.observable||"@@observable";function or(t){return t}function ca(t){return 0===t.length?or:1===t.length?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}let qt=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){const r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){const s=function A(t){return t&&t instanceof Gs||function Nl(t){return t&&xe(t.next)&&xe(t.error)&&xe(t.complete)}(t)&&eu(t)}(n)?n:new sr(n,r,i);return _s(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return new(r=su(r))((i,s)=>{const o=new sr({next:a=>{try{n(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(n)}[zi](){return this}pipe(...n){return ca(n)(this)}toPromise(n){return new(n=su(n))((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function su(t){var e;return null!==(e=t??li.Promise)&&void 0!==e?e:Promise}const S=Wn(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let P=(()=>{class t extends qt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const r=new G(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new S}next(n){_s(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(n)}})}error(n){_s(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){_s(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:r,isStopped:i,observers:s}=this;return r||i?ui:(this.currentObservers=null,s.push(n),new Pt(()=>{this.currentObservers=null,Gn(s,n)}))}_checkFinalizedStatuses(n){const{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){const n=new qt;return n.source=this,n}}return t.create=(e,n)=>new G(e,n),t})();class G extends P{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===r||r.call(n,e)}error(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===r||r.call(n,e)}complete(){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===n||n.call(e)}_subscribe(e){var n,r;return null!==(r=null===(n=this.source)||void 0===n?void 0:n.subscribe(e))&&void 0!==r?r:ui}}class x extends P{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){const{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}function he(t){return xe(t?.lift)}function ge(t){return e=>{if(he(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Te(t,e,n,r,i){return new qr(t,e,n,r,i)}class qr extends Gs{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function fe(t,e){return ge((n,r)=>{let i=0;n.subscribe(Te(r,s=>{r.next(t.call(e,s,i++))}))})}function Ue(t){for(let e in t)if(t[e]===Ue)return e;throw Error("Could not find renamed property on target object.")}function gt(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(gt).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function qi(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const pd=Ue({__forward_ref__:Ue});function j(t){return t.__forward_ref__=j,t.toString=function(){return gt(this())},t}function R(t){return te(t)?t():t}function te(t){return"function"==typeof t&&t.hasOwnProperty(pd)&&t.__forward_ref__===j}function ye(t){return t&&!!t.\u0275providers}const it="https://g.co/ng/security#xss";class L extends Error{constructor(e,n){super(function Zt(t,e){return`NG0${Math.abs(t)}${e?": "+e:""}`}(e,n)),this.code=e}}const Vt=Ue({\u0275cmp:Ue}),Wi=Ue({\u0275dir:Ue}),wo=Ue({\u0275pipe:Ue}),My=Ue({\u0275mod:Ue}),Zs=Ue({\u0275fac:Ue}),ha=Ue({__NG_ELEMENT_ID__:Ue}),xy=Ue({__NG_ENV_ID__:Ue});function Be(t){return"string"==typeof t?t:null==t?"":String(t)}function yp(t,e){throw new L(-201,!1)}function Wr(t,e){null==t&&function Me(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(null==r?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}(e,t,null,"!=")}function Ie(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Ar(t){return{providers:t.providers||[],imports:t.imports||[]}}function ou(t){return md(t,fa)||md(t,Hy)}function md(t,e){return t.hasOwnProperty(e)?t[e]:null}function au(t){return t&&(t.hasOwnProperty(xl)||t.hasOwnProperty(vp))?t[xl]:null}const fa=Ue({\u0275prov:Ue}),xl=Ue({\u0275inj:Ue}),Hy=Ue({ngInjectableDef:Ue}),vp=Ue({ngInjectorDef:Ue});var st=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(st||{});let kl;function zy(){return kl}function gr(t){const e=kl;return kl=t,e}function qy(t,e,n){const r=ou(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&st.Optional?null:void 0!==e?e:void yp(gt(t))}const Ut=globalThis;class ue{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Ie({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Ol={},wp="__NG_DI_FLAG__",uu="ngTempTokenPath",EC=/\n/gm,lu="__source";let Ll;function mr(t){const e=Ll;return Ll=t,e}function cu(t,e=st.Default){if(void 0===Ll)throw new L(-203,!1);return null===Ll?qy(t,void 0,e):Ll.get(t,e&st.Optional?null:void 0,e)}function K(t,e=st.Default){return(zy()||cu)(R(t),e)}function oe(t,e=st.Default){return K(t,Fl(e))}function Fl(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Sp(t){const e=[];for(let n=0;n<t.length;n++){const r=R(t[n]);if(Array.isArray(r)){if(0===r.length)throw new L(900,!1);let i,s=st.Default;for(let o=0;o<r.length;o++){const a=r[o],u=wC(a);"number"==typeof u?-1===u?i=a.token:s|=u:i=a}e.push(K(i,s))}else e.push(K(r))}return e}function ws(t,e){return t[wp]=e,t.prototype[wp]=e,t}function wC(t){return t[wp]}function Ts(t){return{toString:t}.toString()}var du=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(du||{}),gn=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(gn||{});const Ki={},yt=[];function vd(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function hu(t,e,n){let r=0;for(;r<n.length;){const i=n[r];if("number"==typeof i){if(0!==i)break;r++;const s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{const s=i,o=n[++r];bp(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function Dp(t){return 3===t||4===t||6===t}function bp(t){return 64===t.charCodeAt(0)}function Vl(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||Ed(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function Ed(t,e,n,r,i){let s=0,o=t.length;if(-1===e)o=-1;else for(;s<t.length;){const a=t[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<t.length;){const a=t[s];if("number"==typeof a)break;if(a===n){if(null===r)return void(null!==i&&(t[s+1]=i));if(r===t[s+1])return void(t[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),null!==r&&t.splice(s++,0,r),null!==i&&t.splice(s++,0,i)}const Id="ng-template";function Ap(t,e,n){let r=0,i=!0;for(;r<t.length;){let s=t[r++];if("string"==typeof s&&i){const o=t[r++];if(n&&"class"===s&&-1!==vd(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;r<t.length&&"string"==typeof(s=t[r++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(i=!1)}}return!1}function Ul(t){return 4===t.type&&t.value!==Id}function Rp(t,e,n){return e===(4!==t.type||n?t.value:Id)}function Xy(t,e,n){let r=4;const i=t.attrs||[],s=function Pp(t){for(let e=0;e<t.length;e++)if(Dp(t[e]))return e;return t.length}(i);let o=!1;for(let a=0;a<e.length;a++){const u=e[a];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!Rp(t,u,n)||""===u&&1===e.length){if(hi(r))return!1;o=!0}}else{const l=8&r?u:e[++a];if(8&r&&null!==t.attrs){if(!Ap(t.attrs,l,n)){if(hi(r))return!1;o=!0}continue}const p=Jy(8&r?"class":u,i,Ul(t),n);if(-1===p){if(hi(r))return!1;o=!0;continue}if(""!==l){let m;m=p>s?"":i[p+1].toLowerCase();const _=8&r?m:null;if(_&&-1!==vd(_,l,0)||2&r&&l!==m){if(hi(r))return!1;o=!0}}}}else{if(!o&&!hi(r)&&!hi(u))return!1;if(o&&hi(u))continue;o=!1,r=u|1&r}}return hi(r)||o}function hi(t){return 0==(1&t)}function Jy(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){const o=e[i];if(o===t)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function ev(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function wd(t,e,n=!1){for(let r=0;r<e.length;r++)if(Xy(t,e[r],n))return!0;return!1}function Mp(t,e){return t?":not("+e.trim()+")":e}function xp(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if("string"==typeof o)if(2&r){const a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!hi(o)&&(e+=Mp(s,i),i=""),r=o,s=s||!hi(r);n++}return""!==i&&(e+=Mp(s,i)),e}function Gr(t){return Ts(()=>{const e=tv(t),n={...e,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===du.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||gn.Emulated,styles:t.styles||yt,_:null,schemas:t.schemas||null,tView:null,id:""};Sd(n);const r=t.dependencies;return n.directiveDefs=jl(r,!1),n.pipeDefs=jl(r,!0),n.id=function CC(t){let e=0;const n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(const i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(n),n})}function Op(t){return Ye(t)||Fn(t)}function Bl(t){return null!==t}function _r(t){return Ts(()=>({type:t.type,bootstrap:t.bootstrap||yt,declarations:t.declarations||yt,imports:t.imports||yt,exports:t.exports||yt,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function Cd(t,e){if(null==t)return Ki;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),n[i]=r,e&&(e[i]=s)}return n}function Kn(t){return Ts(()=>{const e=tv(t);return Sd(e),e})}function Ye(t){return t[Vt]||null}function Fn(t){return t[Wi]||null}function Vn(t){return t[wo]||null}function Zn(t,e){const n=t[My]||null;if(!n&&!0===e)throw new Error(`Type ${gt(t)} does not have '\u0275mod' property.`);return n}function tv(t){const e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Ki,exportAs:t.exportAs||null,standalone:!0===t.standalone,signals:!0===t.signals,selectors:t.selectors||yt,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Cd(t.inputs,e),outputs:Cd(t.outputs),debugInfo:null}}function Sd(t){t.features?.forEach(e=>e(t))}function jl(t,e){if(!t)return null;const n=e?Vn:Op;return()=>("function"==typeof t?t():t).map(r=>n(r)).filter(Bl)}const Yt=0,se=1,De=2,Xt=3,Zi=4,Qn=5,Qi=6,fu=7,Nt=8,Rr=9,Yi=10,je=11,ma=12,nv=13,Co=14,an=15,_a=16,pu=17,Ri=18,$l=19,Dd=20,So=21,bd=22,Do=23,Fe=25,Fp=1,Xi=7,gu=9,wn=10;var mu=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t[t.HasChildViewsToRefresh=4]="HasChildViewsToRefresh",t}(mu||{});function ar(t){return Array.isArray(t)&&"object"==typeof t[Fp]}function ur(t){return Array.isArray(t)&&!0===t[Fp]}function rv(t){return 0!=(4&t.flags)}function _u(t){return t.componentOffset>-1}function yu(t){return 1==(1&t.flags)}function Ji(t){return!!t.template}function Vp(t){return 0!=(512&t[De])}function Ss(t,e){return t.hasOwnProperty(Zs)?t[Zs]:null}class mx{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function Kr(){return cv}function cv(t){return t.type.prototype.ngOnChanges&&(t.setInput=zl),DC}function DC(){const t=Tn(this),e=t?.current;if(e){const n=t.previous;if(n===Ki)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function zl(t,e,n,r){const i=this.declaredInputs[n],s=Tn(t)||function bC(t,e){return t[dv]=e}(t,{previous:Ki,current:null}),o=s.current||(s.current={}),a=s.previous,u=a[i];o[i]=new mx(u&&u.currentValue,e,a===Ki),t[r]=e}Kr.ngInherit=!0;const dv="__ngSimpleChanges__";function Tn(t){return t[dv]||null}const Pi=function(t,e,n){};let Bp=!1;function Ot(t){for(;Array.isArray(t);)t=t[Yt];return t}function Pr(t,e){return Ot(e[t.index])}function Eu(t,e){return t.data[e]}function fi(t,e){const n=e[t];return ar(n)?n:n[Yt]}function Rd(t){return 128==(128&t[De])}function Ds(t,e){return null==e?null:t[e]}function NC(t){t[pu]=0}function Iu(t){1024&t[De]||(t[De]|=1024,Rd(t)&&Wl(t))}function gv(t){return 9216&t[De]||t[Do]?.dirty}function zp(t){gv(t)?Wl(t):64&t[De]&&(function RC(){return Bp}()?(t[De]|=1024,Wl(t)):t[Yi].changeDetectionScheduler?.notify())}function Wl(t){t[Yi].changeDetectionScheduler?.notify();let e=t[Xt];for(;null!==e&&!(ur(e)&&e[De]&mu.HasChildViewsToRefresh||ar(e)&&8192&e[De]);){if(ur(e))e[De]|=mu.HasChildViewsToRefresh;else if(e[De]|=8192,!Rd(e))break;e=e[Xt]}}function Pd(t,e){if(256==(256&t[De]))throw new L(911,!1);null===t[So]&&(t[So]=[]),t[So].push(e)}const ke={lFrame:Dv(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function _v(){return ke.bindingsEnabled}function H(){return ke.lFrame.lView}function ct(){return ke.lFrame.tView}function Dt(){let t=vv();for(;null!==t&&64===t.type;)t=t.parent;return t}function vv(){return ke.lFrame.currentTNode}function pi(t,e){const n=ke.lFrame;n.currentTNode=t,n.isParent=e}function Gl(){return ke.lFrame.isParent}function bs(){return ke.lFrame.bindingIndex++}function UC(t,e){const n=ke.lFrame;n.bindingIndex=n.bindingRootIndex=t,Qp(e)}function Qp(t){ke.lFrame.currentDirectiveIndex=t}function Tv(){return ke.lFrame.currentQueryIndex}function Zl(t){ke.lFrame.currentQueryIndex=t}function Yp(t){const e=t[se];return 2===e.type?e.declTNode:1===e.type?t[Qn]:null}function Cv(t,e,n){if(n&st.SkipSelf){let i=e,s=t;for(;!(i=i.parent,null!==i||n&st.Host||(i=Yp(s),null===i||(s=s[Co],10&i.type))););if(null===i)return!1;e=i,t=s}const r=ke.lFrame=Sv();return r.currentTNode=e,r.lView=t,!0}function Ea(t){const e=Sv(),n=t[se];ke.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function Sv(){const t=ke.lFrame,e=null===t?null:t.child;return null===e?Dv(t):e}function Dv(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function Md(){const t=ke.lFrame;return ke.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const xd=Md;function Ql(){const t=Md();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Yn(){return ke.lFrame.selectedIndex}function Po(t){ke.lFrame.selectedIndex=t}function Bt(){const t=ke.lFrame;return Eu(t.tView,t.selectedIndex)}let kd=!0;function Od(){return kd}function No(t){kd=t}function Ld(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:h}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),u&&(t.viewHooks??=[]).push(-n,u),l&&((t.viewHooks??=[]).push(n,l),(t.viewCheckHooks??=[]).push(n,l)),null!=h&&(t.destroyHooks??=[]).push(n,h)}}function Cu(t,e,n){eg(t,e,3,n)}function Ia(t,e,n,r){(3&t[De])===n&&eg(t,e,n,r)}function Yl(t,e){let n=t[De];(3&n)===e&&(n&=16383,n+=1,t[De]=n)}function eg(t,e,n,r){const s=r??-1,o=e.length-1;let a=0;for(let u=void 0!==r?65535&t[pu]:0;u<o;u++)if("number"==typeof e[u+1]){if(a=e[u],null!=r&&a>=r)break}else e[u]<0&&(t[pu]+=65536),(a<s||-1==s)&&(zC(t,n,e,u),t[pu]=(4294901760&t[pu])+u+2),u++}function Fd(t,e){Pi(4,t,e);const n=$e(null);try{e.call(t)}finally{$e(n),Pi(5,t,e)}}function zC(t,e,n,r){const i=n[r]<0,s=n[r+1],a=t[i?-n[r]:n[r]];i?t[De]>>14<t[pu]>>16&&(3&t[De])===e&&(t[De]+=16384,Fd(a,s)):Fd(a,s)}const wa=-1;class Su{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function Xl(t){return t!==wa}function Jl(t){return 32767&t}function Du(t,e){let n=function WC(t){return t>>16}(t),r=e;for(;n>0;)r=r[Co],n--;return r}let rg=!0;function Ta(t){const e=rg;return rg=t,e}const Pv=255,Nv=5;let GC=0;const As={};function Vd(t,e){const n=Ud(t,e);if(-1!==n)return n;const r=e[se];r.firstCreatePass&&(t.injectorIndex=e.length,ig(r.data,t),ig(e,null),ig(r.blueprint,null));const i=Bd(t,e),s=t.injectorIndex;if(Xl(i)){const o=Jl(i),a=Du(i,e),u=a[se].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|u[o+l]}return e[s+8]=i,s}function ig(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Ud(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function Bd(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;null!==i;){if(r=JC(i),null===r)return wa;if(n++,i=i[Co],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return wa}function sg(t,e,n){!function KC(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(ha)&&(r=n[ha]),null==r&&(r=n[ha]=GC++);const i=r&Pv;e.data[t+(i>>Nv)]|=1<<i}(t,e,n)}function Mv(t,e,n){if(n&st.Optional||void 0!==t)return t;yp()}function xv(t,e,n,r){if(n&st.Optional&&void 0===r&&(r=null),!(n&(st.Self|st.Host))){const i=t[Rr],s=gr(void 0);try{return i?i.get(e,r,n&st.Optional):qy(e,r,n&st.Optional)}finally{gr(s)}}return Mv(r,0,n)}function og(t,e,n,r=st.Default,i){if(null!==t){if(2048&e[De]&&!(r&st.Self)){const o=function XC(t,e,n,r,i){let s=t,o=e;for(;null!==s&&null!==o&&2048&o[De]&&!(512&o[De]);){const a=kv(s,o,n,r|st.Self,As);if(a!==As)return a;let u=s.parent;if(!u){const l=o[Dd];if(l){const h=l.get(n,As,r);if(h!==As)return h}u=JC(o),o=o[Co]}s=u}return i}(t,e,n,r,As);if(o!==As)return o}const s=kv(t,e,n,r,As);if(s!==As)return s}return xv(e,n,r,i)}function kv(t,e,n,r,i){const s=function YC(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(ha)?t[ha]:void 0;return"number"==typeof e?e>=0?e&Pv:Ov:e}(n);if("function"==typeof s){if(!Cv(e,t,r))return r&st.Host?Mv(i,0,r):xv(e,n,r,i);try{let o;if(o=s(r),null!=o||r&st.Optional)return o;yp()}finally{xd()}}else if("number"==typeof s){let o=null,a=Ud(t,e),u=wa,l=r&st.Host?e[an][Qn]:null;for((-1===a||r&st.SkipSelf)&&(u=-1===a?Bd(t,e):e[a+8],u!==wa&&Hd(r,!1)?(o=e[se],a=Jl(u),e=Du(u,e)):a=-1);-1!==a;){const h=e[se];if($d(s,a,h.data)){const p=QC(a,e,n,o,r,l);if(p!==As)return p}u=e[a+8],u!==wa&&Hd(r,e[se].data[a+8]===l)&&$d(s,a,e)?(o=h,a=Jl(u),e=Du(u,e)):a=-1}}return i}function QC(t,e,n,r,i,s){const o=e[se],a=o.data[t+8],h=jd(a,o,n,null==r?_u(a)&&rg:r!=o&&0!=(3&a.type),i&st.Host&&s===a);return null!==h?Ca(e,o,h,a):As}function jd(t,e,n,r,i){const s=t.providerIndexes,o=e.data,a=1048575&s,u=t.directiveStart,h=s>>20,m=i?a+h:t.directiveEnd;for(let _=r?a:a+h;_<m;_++){const v=o[_];if(_<u&&n===v||_>=u&&v.type===n)return _}if(i){const _=o[u];if(_&&Ji(_)&&_.type===n)return u}return null}function Ca(t,e,n,r){let i=t[n];const s=e.data;if(function Av(t){return t instanceof Su}(i)){const o=i;o.resolving&&function fC(t,e){const n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new L(-200,`Circular dependency in DI detected for ${t}${n}`)}(function It(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():Be(t)}(s[n]));const a=Ta(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?gr(o.injectImpl):null;Cv(t,r,st.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&function Jp(t,e,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){const o=cv(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}(n,s[n],e)}finally{null!==l&&gr(l),Ta(a),o.resolving=!1,xd()}}return i}function $d(t,e,n){return!!(n[e+(t>>Nv)]&1<<t)}function Hd(t,e){return!(t&st.Self||t&st.Host&&e)}class Un{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return og(this._tNode,this._lView,e,Fl(r),n)}}function Ov(){return new Un(Dt(),H())}function ag(t){return Ts(()=>{const e=t.prototype.constructor,n=e[Zs]||ec(e),r=Object.prototype;let i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){const s=i[Zs]||ec(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function ec(t){return te(t)?()=>{const e=ec(R(t));return e&&e()}:Ss(t)}function JC(t){const e=t[se],n=e.type;return 2===n?e.declTNode:1===n?t[Qn]:null}const Ys="__parameters__";function Ru(t,e,n){return Ts(()=>{const r=function lg(t){return function(...n){if(t){const r=t(...n);for(const i in r)this[i]=r[i]}}}(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(u,l,h){const p=u.hasOwnProperty(Ys)?u[Ys]:Object.defineProperty(u,Ys,{value:[]})[Ys];for(;p.length<=h;)p.push(null);return(p[h]=p[h]||[]).push(o),u}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}function Mu(t,e){t.forEach(n=>Array.isArray(n)?Mu(n,e):e(n))}function zd(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function qd(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}const rc=ws(Ru("Optional"),8),xo=ws(Ru("SkipSelf"),4),Xs=new ue("ENVIRONMENT_INITIALIZER"),Xd=new ue("INJECTOR",-1),mg=new ue("INJECTOR_DEF_TYPES");class sc{get(e,n=Ol){if(n===Ol){const r=new Error(`NullInjectorError: No provider for ${gt(e)}!`);throw r.name="NullInjectorError",r}return n}}function Oo(...t){return{\u0275providers:_g(0,t),\u0275fromNgModule:!0}}function _g(t,...e){const n=[],r=new Set;let i;const s=o=>{n.push(o)};return Mu(e,o=>{const a=o;Jd(a,s,[],r)&&(i||=[],i.push(a))}),void 0!==i&&Hv(i,s),n}function Hv(t,e){for(let n=0;n<t.length;n++){const{ngModule:r,providers:i}=t[n];eh(i,s=>{e(s,r)})}}function Jd(t,e,n,r){if(!(t=R(t)))return!1;let i=null,s=au(t);const o=!s&&Ye(t);if(s||o){if(o&&!o.standalone)return!1;i=t}else{const u=t.ngModule;if(s=au(u),!s)return!1;i=u}const a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){const u="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of u)Jd(l,e,n,r)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;r.add(i);try{Mu(s.imports,h=>{Jd(h,e,n,r)&&(l||=[],l.push(h))})}finally{}void 0!==l&&Hv(l,e)}if(!a){const l=Ss(i)||(()=>new i);e({provide:i,useFactory:l,deps:yt},i),e({provide:mg,useValue:i,multi:!0},i),e({provide:Xs,useValue:()=>K(i),multi:!0},i)}const u=s.providers;if(null!=u&&!a){const l=t;eh(u,h=>{e(h,l)})}}}return i!==t&&void 0!==t.providers}function eh(t,e){for(let n of t)ye(n)&&(n=n.\u0275providers),Array.isArray(n)?eh(n,e):e(n)}const Qr=Ue({provide:String,useValue:Ue});function oc(t){return null!==t&&"object"==typeof t&&Qr in t}function Mr(t){return"function"==typeof t}const nh=new ue("Set Injector scope."),uc={},_0={};let lc;function rh(){return void 0===lc&&(lc=new sc),lc}class Mi{}class ku extends Mi{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,M(e,o=>this.processProvider(o)),this.records.set(Xd,g(void 0,this)),i.has("environment")&&this.records.set(Mi,g(void 0,this));const s=this.records.get(nh);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(mg,yt,st.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const n=mr(this),r=gr(void 0);try{return e()}finally{mr(n),gr(r)}}get(e,n=Ol,r=st.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(xy))return e[xy](this);r=Fl(r);const s=mr(this),o=gr(void 0);try{if(!(r&st.SkipSelf)){let u=this.records.get(e);if(void 0===u){const l=function D(t){return"function"==typeof t||"object"==typeof t&&t instanceof ue}(e)&&ou(e);u=l&&this.injectableDefInScope(l)?g(yg(e),uc):null,this.records.set(e,u)}if(null!=u)return this.hydrate(e,u)}return(r&st.Self?rh():this.parent).get(e,n=r&st.Optional&&n===Ol?null:n)}catch(a){if("NullInjectorError"===a.name){if((a[uu]=a[uu]||[]).unshift(gt(e)),s)throw a;return function yd(t,e,n,r){const i=t[uu];throw e[lu]&&i.unshift(e[lu]),t.message=function Yy(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let i=gt(e);if(Array.isArray(e))i=e.map(gt).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):gt(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(EC,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t[uu]=null,t}(a,e,"R3InjectorError",this.source)}throw a}finally{gr(o),mr(s)}}resolveInjectorInitializers(){const e=mr(this),n=gr(void 0);try{const i=this.get(Xs,yt,st.Self);for(const s of i)s()}finally{mr(e),gr(n)}}toString(){const e=[],n=this.records;for(const r of n.keys())e.push(gt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new L(205,!1)}processProvider(e){let n=Mr(e=R(e))?e:R(e&&e.provide);const r=function c(t){return oc(t)?g(void 0,t.useValue):g(function d(t,e,n){let r;if(Mr(t)){const i=R(t);return Ss(i)||yg(i)}if(oc(t))r=()=>R(t.useValue);else if(function zv(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...Sp(t.deps||[]));else if(function th(t){return!(!t||!t.useExisting)}(t))r=()=>K(R(t.useExisting));else{const i=R(t&&(t.useClass||t.provide));if(!function y(t){return!!t.deps}(t))return Ss(i)||yg(i);r=()=>new i(...Sp(t.deps))}return r}(t),uc)}(e);if(Mr(e)||!0!==e.multi)this.records.get(n);else{let i=this.records.get(n);i||(i=g(void 0,uc,!0),i.factory=()=>Sp(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){return n.value===uc&&(n.value=_0,n.value=n.factory()),"object"==typeof n.value&&n.value&&function E(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;const n=R(e.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){const n=this._onDestroyHooks.indexOf(e);-1!==n&&this._onDestroyHooks.splice(n,1)}}function yg(t){const e=ou(t),n=null!==e?e.factory:Ss(t);if(null!==n)return n;if(t instanceof ue)throw new L(204,!1);if(t instanceof Function)return function f(t){const e=t.length;if(e>0)throw function nc(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}(e,"?"),new L(204,!1);const n=function vC(t){return t&&(t[fa]||t[Hy])||null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new L(204,!1)}function g(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function M(t,e){for(const n of t)Array.isArray(n)?M(n,e):n&&ye(n)?M(n.\u0275providers,e):e(n)}function z(t,e){t instanceof ku&&t.assertNotDestroyed();const r=mr(t),i=gr(void 0);try{return e()}finally{mr(r),gr(i)}}function sh(t,e=null,n=null,r){const i=Ig(t,e,n,r);return i.resolveInjectorInitializers(),i}function Ig(t,e=null,n=null,r,i=new Set){const s=[n||yt,Oo(t)];return r=r||("object"==typeof t?void 0:gt(t)),new ku(s,e||rh(),r||null,i)}let v0,Yr=(()=>{class t{static#e=this.THROW_IF_NOT_FOUND=Ol;static#t=this.NULL=new sc;static create(n,r){if(Array.isArray(n))return sh({name:""},r,n,"");{const i=n.name??"";return sh({name:i},n.parent,n.providers,i)}}static#n=this.\u0275prov=Ie({token:t,providedIn:"any",factory:()=>K(Xd)});static#r=this.__NG_ELEMENT_ID__=-1}return t})();const Wv=new ue("AppId",{providedIn:"root",factory:()=>bG}),bG="ng",Ax=new ue("Platform Initializer"),eo=new ue("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Rx=new ue("AnimationModuleType"),Px=new ue("CSP nonce",{providedIn:"root",factory:()=>function Ou(){if(void 0!==v0)return v0;if(typeof document<"u")return document;throw new L(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function ts(t){return t instanceof Function?t():t}function Qv(t){return 128==(128&t.flags)}var Vu=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Vu||{});const C0=new Map;let BG=0;const D0="__ngContext__";function Xr(t,e){ar(e)?(t[D0]=e[$l],function $G(t){C0.set(t[$l],t)}(e)):t[D0]=e}let b0;function A0(t,e){return b0(t,e)}function Sg(t){const e=t[Xt];return ur(e)?e[Xt]:e}function Kx(t){return Qx(t[ma])}function Zx(t){return Qx(t[Zi])}function Qx(t){for(;null!==t&&!ur(t);)t=t[Zi];return t}function lh(t,e,n,r,i){if(null!=r){let s,o=!1;ur(r)?s=r:ar(r)&&(o=!0,r=r[Yt]);const a=Ot(r);0===t&&null!==n?null==i?ek(e,n,a):hc(e,n,a,i||null,!0):1===t&&null!==n?hc(e,n,a,i||null,!0):2===t?function rE(t,e,n){const r=tE(t,e);r&&function a3(t,e,n,r){t.removeChild(e,n,r)}(t,r,e,n)}(e,a,o):3===t&&e.destroyNode(a),null!=s&&function c3(t,e,n,r,i){const s=n[Xi];s!==Ot(n)&&lh(e,t,r,s,i);for(let a=wn;a<n.length;a++){const u=n[a];Ag(u[se],u,t,e,r,s)}}(e,t,s,n,i)}}function Jv(t,e,n){return t.createElement(e,n)}function Xx(t,e){const n=t[gu],r=n.indexOf(e);n.splice(r,1)}function Dg(t,e){if(t.length<=wn)return;const n=wn+e,r=t[n];if(r){const i=r[_a];null!==i&&i!==t&&Xx(i,r),e>0&&(t[n-1][Zi]=r[Zi]);const s=qd(t,wn+e);!function JG(t,e){Ag(t,e,e[je],2,null,null),e[Yt]=null,e[Qn]=null}(r[se],r);const o=s[Ri];null!==o&&o.detachView(s[se]),r[Xt]=null,r[Zi]=null,r[De]&=-129}return r}function eE(t,e){if(!(256&e[De])){const n=e[je];n.destroyNode&&Ag(t,e,n,3,null,null),function n3(t){let e=t[ma];if(!e)return P0(t[se],t);for(;e;){let n=null;if(ar(e))n=e[ma];else{const r=e[wn];r&&(n=r)}if(!n){for(;e&&!e[Zi]&&e!==t;)ar(e)&&P0(e[se],e),e=e[Xt];null===e&&(e=t),ar(e)&&P0(e[se],e),n=e&&e[Zi]}e=n}}(e)}}function P0(t,e){if(!(256&e[De])){e[De]&=-129,e[De]|=256,e[Do]&&function pr(t){if(br(t),St(t))for(let e=0;e<t.producerNode.length;e++)mt(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}(e[Do]),function o3(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const i=e[n[r]];if(!(i instanceof Su)){const s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],u=s[o+1];Pi(4,a,u);try{u.call(a)}finally{Pi(5,a,u)}}else{Pi(4,i,s);try{s.call(i)}finally{Pi(5,i,s)}}}}}(t,e),function s3(t,e){const n=t.cleanup,r=e[fu];if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else n[s].call(r[n[s+1]]);null!==r&&(e[fu]=null);const i=e[So];if(null!==i){e[So]=null;for(let s=0;s<i.length;s++)(0,i[s])()}}(t,e),1===e[se].type&&e[je].destroy();const n=e[_a];if(null!==n&&ur(e[Xt])){n!==e[Xt]&&Xx(n,e);const r=e[Ri];null!==r&&r.detachView(t)}!function HG(t){C0.delete(t[$l])}(e)}}function N0(t,e,n){return function Jx(t,e,n){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return n[Yt];{const{componentOffset:i}=r;if(i>-1){const{encapsulation:s}=t.data[r.directiveStart+i];if(s===gn.None||s===gn.Emulated)return null}return Pr(r,n)}}(t,e.parent,n)}function hc(t,e,n,r,i){t.insertBefore(e,n,r,i)}function ek(t,e,n){t.appendChild(e,n)}function tk(t,e,n,r,i){null!==r?hc(t,e,n,r,i):ek(t,e,n)}function tE(t,e){return t.parentNode(e)}let M0,sE,ik=function rk(t,e,n){return 40&t.type?Pr(t,n):null};function nE(t,e,n,r){const i=N0(t,r,e),s=e[je],a=function nk(t,e,n){return ik(t,e,n)}(r.parent||e[Qn],r,e);if(null!=i)if(Array.isArray(n))for(let u=0;u<n.length;u++)tk(s,i,n[u],a,!1);else tk(s,i,n,a,!1);void 0!==M0&&M0(s,r,e,n,i)}function bg(t,e){if(null!==e){const n=e.type;if(3&n)return Pr(e,t);if(4&n)return x0(-1,t[e.index]);if(8&n){const r=e.child;if(null!==r)return bg(t,r);{const i=t[e.index];return ur(i)?x0(-1,i):Ot(i)}}if(32&n)return A0(e,t)()||Ot(t[e.index]);{const r=ok(t,e);return null!==r?Array.isArray(r)?r[0]:bg(Sg(t[an]),r):bg(t,e.next)}}return null}function ok(t,e){return null!==e?t[an][Qn].projection[e.projection]:null}function x0(t,e){const n=wn+t+1;if(n<e.length){const r=e[n],i=r[se].firstChild;if(null!==i)return bg(r,i)}return e[Xi]}function k0(t,e,n,r,i,s,o){for(;null!=n;){const a=r[n.index],u=n.type;if(o&&0===e&&(a&&Xr(Ot(a),r),n.flags|=2),32!=(32&n.flags))if(8&u)k0(t,e,n.child,r,i,s,!1),lh(e,t,i,a,s);else if(32&u){const l=A0(n,r);let h;for(;h=l();)lh(e,t,i,h,s);lh(e,t,i,a,s)}else 16&u?uk(t,e,r,n,i,s):lh(e,t,i,a,s);n=o?n.projectionNext:n.next}}function Ag(t,e,n,r,i,s){k0(n,r,t.firstChild,e,i,s,!1)}function uk(t,e,n,r,i,s){const o=n[an],u=o[Qn].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++)lh(e,t,i,u[l],s);else{let l=u;const h=o[Xt];Qv(r)&&(l.flags|=128),k0(t,e,l,h,i,s,!0)}}function lk(t,e,n){""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function ck(t,e,n){const{mergedAttrs:r,classes:i,styles:s}=n;null!==r&&hu(t,e,r),null!==i&&lk(t,e,i),null!==s&&function h3(t,e,n){t.setAttribute(e,"style",n)}(t,e,s)}function fk(t){return function L0(){if(void 0===sE&&(sE=null,Ut.trustedTypes))try{sE=Ut.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return sE}()?.createScriptURL(t)||t}class pk{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${it})`}}function Uu(t){return t instanceof pk?t.changingThisBreaksApplicationSecurity:t}function Rg(t,e){const n=function I3(t){return t instanceof pk&&t.getTypeName()||null}(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${it})`)}return n===e}const S3=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var dh=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(dh||{});function Ik(t){const e=Ng();return e?e.sanitize(dh.URL,t)||"":Rg(t,"URL")?Uu(t):function F0(t){return(t=String(t)).match(S3)?t:"unsafe:"+t}(Be(t))}function wk(t){const e=Ng();if(e)return fk(e.sanitize(dh.RESOURCE_URL,t)||"");if(Rg(t,"ResourceURL"))return fk(Uu(t));throw new L(904,!1)}function Ng(){const t=H();return t&&t[Yi].sanitizer}class V3{}let Ck=(t,e,n)=>null;function K0(t,e,n=!1){return Ck(t,e,n)}class G3{}class bk{}class Z3{resolveComponentFactory(e){throw function K3(t){const e=Error(`No component factory found for ${gt(t)}.`);return e.ngComponent=t,e}(e)}}let hE=(()=>{class t{static#e=this.NULL=new Z3}return t})();function Q3(){return ph(Dt(),H())}function ph(t,e){return new Bu(Pr(t,e))}let Bu=(()=>{class t{constructor(n){this.nativeElement=n}static#e=this.__NG_ELEMENT_ID__=Q3}return t})();function Y3(t){return t instanceof Bu?t.nativeElement:t}class Y0{}let fE=(()=>{class t{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function X3(){const t=H(),n=fi(Dt().index,t);return(ar(n)?n:t)[je]}()}return t})(),J3=(()=>{class t{static#e=this.\u0275prov=Ie({token:t,providedIn:"root",factory:()=>null})}return t})();const X0={};function Og(t,e,n,r,i=!1){for(;null!==n;){const s=e[n.index];null!==s&&r.push(Ot(s)),ur(s)&&Lk(s,r);const o=n.type;if(8&o)Og(t,e,n.child,r);else if(32&o){const a=A0(n,e);let u;for(;u=a();)r.push(u)}else if(16&o){const a=ok(e,n);if(Array.isArray(a))r.push(...a);else{const u=Sg(e[an]);Og(u[se],u,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function Lk(t,e){for(let n=wn;n<t.length;n++){const r=t[n],i=r[se].firstChild;null!==i&&Og(r[se],r,i,e)}t[Xi]!==t[Yt]&&e.push(t[Xi])}let Fk=[];const f9={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{},consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Wl(t.lView)},consumerOnSignalRead(){this.lView[Do]=this}};function eS(t){return t.ngOriginalError}class Ra{constructor(){this._console=console}handleError(e){const n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&eS(e);for(;n&&eS(n);)n=eS(n);return n||null}}const Uk=new ue("",{providedIn:"root",factory:()=>oe(Ra).handleError.bind(void 0)}),jk=new ue("",{providedIn:"root",factory:()=>!1}),Ke={};function _E(t){qk(ct(),H(),Yn()+t,!1)}function qk(t,e,n,r){if(!r)if(3==(3&e[De])){const s=t.preOrderCheckHooks;null!==s&&Cu(e,s,n)}else{const s=t.preOrderHooks;null!==s&&Ia(e,s,0,n)}Po(n)}function Oe(t,e=st.Default){const n=H();return null===n?K(t,e):og(Dt(),n,R(t),e)}function yE(t,e,n,r,i,s,o,a,u,l,h){const p=e.blueprint.slice();return p[Yt]=i,p[De]=204|r,(null!==l||t&&2048&t[De])&&(p[De]|=2048),NC(p),p[Xt]=p[Co]=t,p[Nt]=n,p[Yi]=o||t&&t[Yi],p[je]=a||t&&t[je],p[Rr]=u||t&&t[Rr]||null,p[Qn]=s,p[$l]=function jG(){return BG++}(),p[Qi]=h,p[Dd]=l,p[an]=2==e.type?t[an]:p,p}function gh(t,e,n,r,i){let s=t.data[e];if(null===s)s=function tS(t,e,n,r,i){const s=vv(),o=Gl(),u=t.data[e]=function D9(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return function Tu(){return null!==ke.skipHydrationRootTNode}()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,e,r,i);return null===t.firstChild&&(t.firstChild=u),null!==s&&(o?null==s.child&&null!==u.parent&&(s.child=u):null===s.next&&(s.next=u,u.prev=s)),u}(t,e,n,r,i),function Iv(){return ke.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=n,s.value=r,s.attrs=i;const o=function va(){const t=ke.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return pi(s,!0),s}function Lg(t,e,n,r){if(0===n)return-1;const i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function Gk(t,e,n,r,i){const s=Yn(),o=2&r;try{Po(-1),o&&e.length>Fe&&qk(t,e,Fe,!1),Pi(o?2:0,i),n(r,i)}finally{Po(s),Pi(o?3:1,i)}}function nS(t,e,n){if(rv(e)){const r=$e(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=t.data[o];a.contentQueries&&a.contentQueries(1,n[o],o)}}finally{$e(r)}}}function Kk(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=sS(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function sS(t,e,n,r,i,s,o,a,u,l,h){const p=Fe+r,m=p+i,_=function E9(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:Ke);return n}(p,m),v="function"==typeof l?l():l;return _[se]={type:t,blueprint:_,template:n,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:v,incompleteFirstPass:!1,ssrId:h}}let Zk=t=>null;function Qk(t,e,n,r){for(let i in t)if(t.hasOwnProperty(i)){n=null===n?{}:n;const s=t[i];null===r?Yk(n,e,i,s):r.hasOwnProperty(i)&&Yk(n,e,r[i],s)}return n}function Yk(t,e,n,r){t.hasOwnProperty(n)?t[n].push(e,r):t[n]=[e,r]}function Xk(t,e,n,r,i,s){for(let l=0;l<r.length;l++)sg(Vd(n,e),t,r[l].type);!function V9(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}(n,t.data.length,r.length);for(let l=0;l<r.length;l++){const h=r[l];h.providersResolver&&h.providersResolver(h)}let o=!1,a=!1,u=Lg(t,e,r.length,null);for(let l=0;l<r.length;l++){const h=r[l];n.mergedAttrs=Vl(n.mergedAttrs,h.hostAttrs),U9(t,n,e,u,h),F9(u,h,i),null!==h.contentQueries&&(n.flags|=4),(null!==h.hostBindings||null!==h.hostAttrs||0!==h.hostVars)&&(n.flags|=64);const p=h.type.prototype;!o&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(p.ngOnChanges||p.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),u++}!function b9(t,e,n){const i=e.directiveEnd,s=t.data,o=e.attrs,a=[];let u=null,l=null;for(let h=e.directiveStart;h<i;h++){const p=s[h],m=n?n.get(p):null,v=m?m.outputs:null;u=Qk(p.inputs,h,u,m?m.inputs:null),l=Qk(p.outputs,h,l,v);const I=null===u||null===o||Ul(e)?null:$9(u,h,o);a.push(I)}null!==u&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=l}(t,n,s)}function Jk(t,e,n){const r=n.directiveStart,i=n.directiveEnd,s=n.index,o=function Zp(){return ke.lFrame.currentDirectiveIndex}();try{Po(s);for(let a=r;a<i;a++){const u=t.data[a],l=e[a];Qp(a),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&k9(u,l)}}finally{Po(-1),Qp(o)}}function k9(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function aS(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function F9(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Ji(e)&&(n[""]=t)}}function U9(t,e,n,r,i){t.data[r]=i;const s=i.factory||(i.factory=Ss(i.type)),o=new Su(s,Ji(i),Oe);t.blueprint[r]=o,n[r]=o,function N9(t,e,n,r,i){const s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;null===o&&(o=t.hostBindingOpCodes=[]);const a=~e.index;(function M9(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(o)!=a&&o.push(a),o.push(n,r,s)}}(t,e,r,Lg(t,n,i.hostVars,Ke),i)}function Lo(t,e,n,r,i,s){const o=Pr(t,e);!function uS(t,e,n,r,i,s,o){if(null==s)t.removeAttribute(e,i,n);else{const a=null==o?Be(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}(e[je],o,s,t.value,n,r,i)}function j9(t,e,n,r,i,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)eO(r,n,o[a++],o[a++],o[a++])}function eO(t,e,n,r,i){const s=$e(null);try{const o=t.inputTransforms;null!==o&&o.hasOwnProperty(r)&&(i=o[r].call(e,i)),null!==t.setInput?t.setInput(e,i,n,r):e[r]=i}finally{$e(s)}}function $9(t,e,n){let r=null,i=0;for(;i<n.length;){const s=n[i];if(0!==s)if(5!==s){if("number"==typeof s)break;if(t.hasOwnProperty(s)){null===r&&(r=[]);const o=t[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){r.push(s,o[a+1],n[i+1]);break}}i+=2}else i+=2;else i+=4}return r}function nO(t,e){const n=t.contentQueries;if(null!==n){const r=$e(null);try{for(let i=0;i<n.length;i+=2){const o=n[i+1];if(-1!==o){const a=t.data[o];Zl(n[i]),a.contentQueries(2,e[o],o)}}}finally{$e(r)}}}function vE(t,e){return t[ma]?t[nv][Zi]=e:t[ma]=e,t[nv]=e,e}function lS(t,e,n){Zl(0);const r=$e(null);try{e(t,n)}finally{$e(r)}}function rO(t){return t[fu]||(t[fu]=[])}function iO(t){return t.cleanup||(t.cleanup=[])}function EE(t,e){const n=t[Rr],r=n?n.get(Ra,null):null;r&&r.handleError(e)}function cS(t,e,n,r,i){for(let s=0;s<n.length;){const o=n[s++],a=n[s++];eO(t.data[o],e[o],r,a,i)}}function q9(t,e,n,r){const i=e[De];if(256==(256&i))return;e[Yi].inlineEffectRunner?.flush(),Ea(e);let o=null,a=null;(function W9(t){return 2!==t.type})(t)&&(a=function c9(t){return t[Do]??function d9(t){const e=Fk.pop()??Object.create(f9);return e.lView=t,e}(t)}(e),o=function Ze(t){return t&&(t.nextProducerIndex=0),$e(t)}(a));try{NC(e),function Ev(t){return ke.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&Gk(t,e,n,2,r);const u=3==(3&i);if(u){const p=t.preOrderCheckHooks;null!==p&&Cu(e,p,null)}else{const p=t.preOrderHooks;null!==p&&Ia(e,p,0,null),Yl(e,0)}if(function G9(t){for(let e=Kx(t);null!==e;e=Zx(e)){if(!(e[De]&mu.HasTransplantedViews))continue;const n=e[gu];for(let r=0;r<n.length;r++){Iu(n[r])}}}(e),oO(e,0),null!==t.contentQueries&&nO(t,e),u){const p=t.contentCheckHooks;null!==p&&Cu(e,p)}else{const p=t.contentHooks;null!==p&&Ia(e,p,1),Yl(e,1)}!function v9(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let r=0;r<n.length;r++){const i=n[r];if(i<0)Po(~i);else{const s=i,o=n[++r],a=n[++r];UC(o,s),a(2,e[s])}}}finally{Po(-1)}}(t,e);const l=t.components;null!==l&&uO(e,l,0);const h=t.viewQuery;if(null!==h&&lS(2,h,r),u){const p=t.viewCheckHooks;null!==p&&Cu(e,p)}else{const p=t.viewHooks;null!==p&&Ia(e,p,2),Yl(e,2)}if(!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),e[bd]){for(const p of e[bd])p();e[bd]=null}e[De]&=-73}catch(u){throw Wl(e),u}finally{null!==a&&(function nt(t,e){if($e(e),t&&void 0!==t.producerNode&&void 0!==t.producerIndexOfThis&&void 0!==t.producerLastReadVersion){if(St(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)mt(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}(a,o),function h9(t){t.lView[Do]!==t&&(t.lView=null,Fk.push(t))}(a)),Ql()}}function oO(t,e){for(let n=Kx(t);null!==n;n=Zx(n)){n[De]&=~mu.HasChildViewsToRefresh;for(let r=wn;r<n.length;r++)aO(n[r],e)}}function K9(t,e,n){aO(fi(e,t),n)}function aO(t,e){Rd(t)&&hS(t,e)}function hS(t,e){const r=t[se],i=t[De],s=t[Do];let o=!!(0===e&&16&i);if(o||=!!(64&i&&0===e),o||=!!(1024&i),o||=!(!s?.dirty||!Ln(s)),s&&(s.dirty=!1),t[De]&=-9217,o)q9(r,t,r.template,t[Nt]);else if(8192&i){oO(t,1);const a=r.components;null!==a&&uO(t,a,1)}}function uO(t,e,n){for(let r=0;r<e.length;r++)K9(t,e[r],n)}function Fg(t){for(t[Yi].changeDetectionScheduler?.notify();t;){t[De]|=64;const e=Sg(t);if(Vp(t)&&!e)return t;t=e}return null}class Vg{get rootNodes(){const e=this._lView,n=e[se];return Og(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Nt]}set context(e){this._lView[Nt]=e}get destroyed(){return 256==(256&this._lView[De])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Xt];if(ur(e)){const n=e[8],r=n?n.indexOf(this):-1;r>-1&&(Dg(e,r),qd(n,r))}this._attachedToViewContainer=!1}eE(this._lView[se],this._lView)}onDestroy(e){Pd(this._lView,e)}markForCheck(){Fg(this._cdRefInjectingView||this._lView)}detach(){this._lView[De]&=-129}reattach(){zp(this._lView),this._lView[De]|=128}detectChanges(){this._lView[De]|=1024,function dS(t,e=!0){const n=t[Yi],r=n.rendererFactory,i=n.afterRenderEventManager;r.begin?.(),i?.begin();try{!function z9(t){hS(t,0);let e=0;for(;gv(t);){if(100===e)throw new L(103,!1);e++,hS(t,1)}}(t)}catch(o){throw e&&EE(t,o),o}finally{r.end?.(),n.inlineEffectRunner?.flush(),i?.end()}}(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new L(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function t3(t,e){Ag(t,e,e[je],2,null,null)}(this._lView[se],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new L(902,!1);this._appRef=e,zp(this._lView)}}let IE=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=Z9}return t})();function Z9(t){return function Q9(t,e,n){if(_u(t)&&!n){const r=fi(t.index,e);return new Vg(r,r)}return 47&t.type?new Vg(e[an],e):null}(Dt(),H(),16==(16&t))}let wE=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=e6;static#t=this.__NG_ENV_ID__=n=>n}return t})();class J9 extends wE{constructor(e){super(),this._lView=e}onDestroy(e){return Pd(this._lView,e),()=>function wu(t,e){if(null===t[So])return;const n=t[So].indexOf(e);-1!==n&&t[So].splice(n,1)}(this._lView,e)}}function e6(){return new J9(H())}const lO=new Set;function fc(t){lO.has(t)||(lO.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function fS(t){return e=>{setTimeout(t,void 0,e)}}const gi=class a6 extends P{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&"object"==typeof e){const u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=fS(s),i&&(i=fS(i)),o&&(o=fS(o)));const a=super.subscribe({next:i,error:s,complete:o});return e instanceof Pt&&e.add(a),a}};function cO(...t){}class ht{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new gi(!1),this.onMicrotaskEmpty=new gi(!1),this.onStable=new gi(!1),this.onError=new gi(!1),typeof Zone>"u")throw new L(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function u6(){const t="function"==typeof Ut.requestAnimationFrame;let e=Ut[t?"requestAnimationFrame":"setTimeout"],n=Ut[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function d6(t){const e=()=>{!function c6(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Ut,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,gS(t),t.isCheckStableRunning=!0,pS(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),gS(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(function f6(t){return!(!Array.isArray(t)||1!==t.length)&&!0===t[0].data?.__ignore_ng_zone__}(a))return n.invokeTask(i,s,o,a);try{return dO(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&e(),hO(t)}},onInvoke:(n,r,i,s,o,a,u)=>{try{return dO(t),n.invoke(i,s,o,a,u)}finally{t.shouldCoalesceRunChangeDetection&&e(),hO(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,gS(t),pS(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!ht.isInAngularZone())throw new L(909,!1)}static assertNotInAngularZone(){if(ht.isInAngularZone())throw new L(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,l6,cO,cO);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}}const l6={};function pS(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function gS(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function dO(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function hO(t){t._nesting--,pS(t)}class h6{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new gi,this.onMicrotaskEmpty=new gi,this.onStable=new gi,this.onError=new gi}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}}var pc=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(pc||{});const fO={destroy(){}};function gO(t,e){!e&&function ae(t){if(!zy()&&!function Tp(){return Ll}())throw new L(-203,!1)}();const n=e?.injector??oe(Yr);if(!function Lu(t){return"browser"===(t??oe(Yr)).get(eo)}(n))return fO;fc("NgAfterNextRender");const r=n.get(TE),i=r.handler??=new _O,s=e?.phase??pc.MixedReadWrite,o=()=>{i.unregister(u),a()},a=n.get(wE).onDestroy(o),u=new mO(n,s,()=>{o(),t()});return i.register(u),{destroy:o}}class mO{constructor(e,n,r){this.phase=n,this.callbackFn=r,this.zone=e.get(ht),this.errorHandler=e.get(Ra,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}}class _O{constructor(){this.executingCallbacks=!1,this.buckets={[pc.EarlyRead]:new Set,[pc.Write]:new Set,[pc.MixedReadWrite]:new Set,[pc.Read]:new Set},this.deferredCallbacks=new Set}validateBegin(){if(this.executingCallbacks)throw new L(102,!1)}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(const e of Object.values(this.buckets))for(const n of e)n.invoke();this.executingCallbacks=!1;for(const e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(const e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}}let TE=(()=>{class t{constructor(){this.renderDepth=0,this.handler=null,this.internalCallbacks=[]}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth){for(const n of this.internalCallbacks)n();this.internalCallbacks.length=0,this.handler?.execute()}}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static#e=this.\u0275prov=Ie({token:t,providedIn:"root",factory:()=>new t})}return t})();function m6(t,e){const n=fi(e,t),r=n[se];!function _6(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(r,n);const i=n[Yt];null!==i&&null===n[Qi]&&(n[Qi]=K0(i,n[Rr])),mS(r,n,n[Nt])}function mS(t,e,n){Ea(e);try{const r=t.viewQuery;null!==r&&lS(1,r,n);const i=t.template;null!==i&&Gk(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&nO(t,e),t.staticViewQueries&&lS(2,t.viewQuery,n);const s=t.components;null!==s&&function y6(t,e){for(let n=0;n<e.length;n++)m6(t,e[n])}(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[De]&=-5,Ql()}}function CE(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=qi(i,a):2==s&&(r=qi(r,a+": "+e[++o]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}class yO extends hE{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=Ye(e);return new Ug(n,this.ngModule)}}function vO(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}class E6{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=Fl(r);const i=this.injector.get(e,X0,r);return i!==X0||n===X0?i:this.parentInjector.get(e,n,r)}}class Ug extends bk{get inputs(){const e=this.componentDef,n=e.inputTransforms,r=vO(e.inputs);if(null!==n)for(const i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return vO(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function TC(t){return t.map(xp).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=(i=i||this.ngModule)instanceof Mi?i:i?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new E6(e,s):e,a=o.get(Y0,null);if(null===a)throw new L(407,!1);const p={rendererFactory:a,sanitizer:o.get(J3,null),inlineEffectRunner:null,afterRenderEventManager:o.get(TE,null),changeDetectionScheduler:o.get(V3,null)},m=a.createRenderer(null,this.componentDef),_=this.componentDef.selectors[0][0]||"div",v=r?function I9(t,e,n,r){const s=r.get(jk,!1)||n===gn.ShadowDom,o=t.selectRootElement(e,s);return function w9(t){Zk(t)}(o),o}(m,r,this.componentDef.encapsulation,o):Jv(m,_,function v6(t){const e=t.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(_));let I=512;this.componentDef.signals?I|=4096:this.componentDef.onPush||(I|=16);let T=null;null!==v&&(T=K0(v,o,!0));const N=sS(0,null,null,1,0,null,null,null,null,null,null),b=yE(null,N,null,I,null,null,p,m,o,null,T);let k,$;Ea(b);try{const ie=this.componentDef;let pe,qe=null;ie.findHostDirectiveDefs?(pe=[],qe=new Map,ie.findHostDirectiveDefs(ie,pe,qe),pe.push(ie)):pe=[ie];const kt=function w6(t,e){const n=t[se],r=Fe;return t[r]=e,gh(n,r,2,"#host",null)}(b,v),Br=function T6(t,e,n,r,i,s,o){const a=i[se];!function C6(t,e,n,r){for(const i of t)e.mergedAttrs=Vl(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&(CE(e,e.mergedAttrs,!0),null!==n&&ck(r,n,e))}(r,t,e,o);let u=null;null!==e&&(u=K0(e,i[Rr]));const l=s.rendererFactory.createRenderer(e,n);let h=16;n.signals?h=4096:n.onPush&&(h=64);const p=yE(i,Kk(n),null,h,i[t.index],t,s,l,null,null,u);return a.firstCreatePass&&aS(a,t,r.length-1),vE(i,p),i[t.index]=p}(kt,v,ie,pe,b,p,m);$=Eu(N,Fe),v&&function D6(t,e,n,r){if(r)hu(t,n,["ng-version","17.0.8"]);else{const{attrs:i,classes:s}=function kp(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let s=t[r];if("string"==typeof s)2===i?""!==s&&e.push(s,t[++r]):8===i&&n.push(s);else{if(!hi(i))break;i=s}r++}return{attrs:e,classes:n}}(e.selectors[0]);i&&hu(t,n,i),s&&s.length>0&&lk(t,n,s.join(" "))}}(m,ie,v,r),void 0!==n&&function b6(t,e,n){const r=t.projection=[];for(let i=0;i<e.length;i++){const s=n[i];r.push(null!=s?Array.from(s):null)}}($,this.ngContentSelectors,n),k=function S6(t,e,n,r,i,s){const o=Dt(),a=i[se],u=Pr(o,i);Xk(a,i,o,n,null,r);for(let h=0;h<n.length;h++)Xr(Ca(i,a,o.directiveStart+h,o),i);Jk(a,i,o),u&&Xr(u,i);const l=Ca(i,a,o.directiveStart+o.componentOffset,o);if(t[Nt]=i[Nt]=l,null!==s)for(const h of s)h(l,e);return nS(a,o,t),l}(Br,ie,pe,qe,b,[A6]),mS(N,b,null)}finally{Ql()}return new I6(this.componentType,k,ph($,b),b,$)}}class I6 extends G3{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Vg(i,void 0,!1),this.componentType=e}setInput(e,n){const r=this._tNode.inputs;let i;if(null!==r&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;const s=this._rootLView;cS(s[se],s,i,e,n),this.previousInputValues.set(e,n),Fg(fi(this._tNode.index,s))}}get injector(){return new Un(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function A6(){const t=Dt();Ld(H()[se],t)}function SO(t){const e=t.inputConfig,n={};for(const r in e)if(e.hasOwnProperty(r)){const i=e[r];Array.isArray(i)&&i[2]&&(n[r]=i[2])}t.inputTransforms=n}function Xn(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function _S(t,e,n,r){const i=H();return Xn(i,bs(),e)&&(ct(),Lo(Bt(),i,t,e,n,r)),_S}function jg(t,e,n){const r=H();return Xn(r,bs(),e)&&function ns(t,e,n,r,i,s,o,a){const u=Pr(e,n);let h,l=e.inputs;!a&&null!=l&&(h=l[r])?(cS(t,n,h,r,i),_u(e)&&function R9(t,e){const n=fi(e,t);16&n[De]||(n[De]|=64)}(n,e.index)):3&e.type&&(r=function A9(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),i=null!=o?o(i,e.value||"",r):i,s.setProperty(u,r,i))}(ct(),Bt(),r,t,e,r[je],n,!1),jg}function IS(t,e,n,r,i){const o=i?"class":"style";cS(t,n,e.inputs[o],o,r)}function bh(t,e){return!e||null===e.firstChild||Qv(t)}function Kg(t,e,n,r=!0){const i=e[se];if(function r3(t,e,n,r){const i=wn+r,s=n.length;r>0&&(n[i-1][Zi]=e),r<s-wn?(e[Zi]=n[i],zd(n,wn+r,e)):(n.push(e),e[Zi]=null),e[Xt]=n;const o=e[_a];null!==o&&n!==o&&function i3(t,e){const n=t[gu];e[an]!==e[Xt][Xt][an]&&(t[De]|=mu.HasTransplantedViews),null===n?t[gu]=[e]:n.push(e)}(o,e);const a=e[Ri];null!==a&&a.insertView(t),zp(e),e[De]|=128}(i,e,t,n),r){const o=x0(n,t),a=e[je],u=tE(a,t[Xi]);null!==u&&function e3(t,e,n,r,i,s){r[Yt]=i,r[Qn]=e,Ag(t,r,n,1,i,s)}(i,t[Qn],a,e,u,o)}const s=e[Qi];null!==s&&null!==s.firstChild&&(s.firstChild=null)}let ro=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=U5}return t})();function U5(){return u1(Dt(),H())}const B5=ro,o1=class extends B5{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return ph(this._hostTNode,this._hostLView)}get injector(){return new Un(this._hostTNode,this._hostLView)}get parentInjector(){const e=Bd(this._hostTNode,this._hostLView);if(Xl(e)){const n=Du(e,this._hostLView),r=Jl(e);return new Un(n[se].data[r+8],n)}return new Un(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const n=a1(this._lContainer);return null!==n&&n[e]||null}get length(){return this._lContainer.length-wn}createEmbeddedView(e,n,r){let i,s;"number"==typeof r?i=r:null!=r&&(i=r.index,s=r.injector);const a=e.createEmbeddedViewImpl(n||{},s,null);return this.insertImpl(a,i,bh(this._hostTNode,null)),a}createComponent(e,n,r,i,s){const o=e&&!function tc(t){return"function"==typeof t}(e);let a;if(o)a=n;else{const v=n||{};a=v.index,r=v.injector,i=v.projectableNodes,s=v.environmentInjector||v.ngModuleRef}const u=o?e:new Ug(Ye(e)),l=r||this.parentInjector;if(!s&&null==u.ngModule){const I=(o?l:this.parentInjector).get(Mi,null);I&&(s=I)}Ye(u.componentType??{});const _=u.create(l,i,null,s);return this.insertImpl(_.hostView,a,bh(this._hostTNode,null)),_}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){const i=e._lView;if(function PC(t){return ur(t[Xt])}(i)){const a=this.indexOf(e);if(-1!==a)this.detach(a);else{const u=i[Xt],l=new o1(u,u[Qn],u[Xt]);l.detach(l.indexOf(e))}}const s=this._adjustIndex(n),o=this._lContainer;return Kg(o,i,s,r),e.attachToViewContainerRef(),zd(NS(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){const n=a1(this._lContainer);return null!==n?n.indexOf(e):-1}remove(e){const n=this._adjustIndex(e,-1),r=Dg(this._lContainer,n);r&&(qd(NS(this._lContainer),n),eE(r[se],r))}detach(e){const n=this._adjustIndex(e,-1),r=Dg(this._lContainer,n);return r&&null!=qd(NS(this._lContainer),n)?new Vg(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function a1(t){return t[8]}function NS(t){return t[8]||(t[8]=[])}function u1(t,e){let n;const r=e[t.index];return ur(r)?n=r:(n=function tO(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}(r,e,null,t),e[t.index]=n,vE(e,n)),l1(n,e,t,r),new o1(n,t,e)}let l1=function d1(t,e,n,r){if(t[Xi])return;let i;i=8&n.type?Ot(r):function j5(t,e){const n=t[je],r=n.createComment(""),i=Pr(e,t);return hc(n,tE(n,i),r,function u3(t,e){return t.nextSibling(e)}(n,i),!1),r}(e,n),t[Xi]=i};function Mt(t,e,n,r){const i=H(),s=ct(),o=Fe+t,a=i[je],u=s.firstCreatePass?function k8(t,e,n,r,i,s){const o=e.consts,u=gh(e,t,2,r,Ds(o,i));return function oS(t,e,n,r){if(_v()){const i=null===r?null:{"":-1},s=function O9(t,e){const n=t.directiveRegistry;let r=null,i=null;if(n)for(let s=0;s<n.length;s++){const o=n[s];if(wd(e,o.selectors,!1))if(r||(r=[]),Ji(o))if(null!==o.findHostDirectiveDefs){const a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o),aS(t,e,a.length)}else r.unshift(o),aS(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return null===r?null:[r,i]}(t,n);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&Xk(t,e,n,o,i,a),i&&function L9(t,e,n){if(e){const r=t.localNames=[];for(let i=0;i<e.length;i+=2){const s=n[e[i+1]];if(null==s)throw new L(-301,!1);r.push(e[i],s)}}}(n,r,i)}n.mergedAttrs=Vl(n.mergedAttrs,n.attrs)}(e,n,u,Ds(o,s)),null!==u.attrs&&CE(u,u.attrs,!1),null!==u.mergedAttrs&&CE(u,u.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,u),u}(o,s,i,e,n,r):s.data[o],l=L1(s,i,u,a,e,t);i[o]=l;const h=yu(u);return pi(u,!0),ck(a,l,u),32!=(32&u.flags)&&Od()&&nE(s,i,l,u),0===function qp(){return ke.lFrame.elementDepthCount}()&&Xr(l,i),function MC(){ke.lFrame.elementDepthCount++}(),h&&(function rS(t,e,n){_v()&&(function x9(t,e,n,r){const i=n.directiveStart,s=n.directiveEnd;_u(n)&&function B9(t,e,n){const r=Pr(e,t),i=Kk(n);let o=16;n.signals?o=4096:n.onPush&&(o=64);const a=vE(t,yE(t,i,null,o,r,e,null,t[Yi].rendererFactory.createRenderer(r,n),null,null,null));t[e.index]=a}(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||Vd(n,e),Xr(r,e);const o=n.initialInputs;for(let a=i;a<s;a++){const u=t.data[a],l=Ca(e,t,a,n);Xr(l,e),null!==o&&j9(0,a-i,l,u,0,o),Ji(u)&&(fi(n.index,e)[Nt]=Ca(e,t,a,n))}}(t,e,n,Pr(n,e)),64==(64&n.flags)&&Jk(t,e,n))}(s,i,u),nS(s,u,i)),null!==r&&function iS(t,e,n=Pr){const r=e.localNames;if(null!==r){let i=e.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?n(e,t):t[o];t[i++]=a}}}(i,u),Mt}function Wt(){let t=Dt();Gl()?function Gp(){ke.lFrame.isParent=!1}():(t=t.parent,pi(t,!1));const e=t;(function kC(t){return ke.skipHydrationRootTNode===t})(e)&&function FC(){ke.skipHydrationRootTNode=null}(),function xC(){ke.lFrame.elementDepthCount--}();const n=ct();return n.firstCreatePass&&(Ld(n,t),rv(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function ng(t){return 0!=(8&t.flags)}(e)&&IS(n,e,H(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function qC(t){return 0!=(16&t.flags)}(e)&&IS(n,e,H(),e.stylesWithoutHost,!1),Wt}function io(t,e,n,r){return Mt(t,e,n,r),Wt(),io}let L1=(t,e,n,r,i,s)=>(No(!0),Jv(r,i,function bv(){return ke.lFrame.currentNamespace}()));const Oh="en-US";let H1=Oh;function $E(t){return!!t&&"function"==typeof t.then}function pL(t){return!!t&&"function"==typeof t.subscribe}function HE(t,e,n,r){const i=H(),s=ct(),o=Dt();return function mL(t,e,n,r,i,s,o){const a=yu(r),l=t.firstCreatePass&&iO(t),h=e[Nt],p=rO(e);let m=!0;if(3&r.type||o){const I=Pr(r,e),T=o?o(I):I,N=p.length,b=o?$=>o(Ot($[r.index])):r.index;let k=null;if(!o&&a&&(k=function FK(t,e,n,r){const i=t.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===n&&i[s+1]===r){const a=e[fu],u=i[s+2];return a.length>u?a[u]:null}"string"==typeof o&&(s+=2)}return null}(t,e,i,r.index)),null!==k)(k.__ngLastListenerFn__||k).__ngNextListenerFn__=s,k.__ngLastListenerFn__=s,m=!1;else{s=yL(r,e,h,s,!1);const $=n.listen(T,i,s);p.push(s,$),l&&l.push(i,b,N,N+1)}}else s=yL(r,e,h,s,!1);const _=r.outputs;let v;if(m&&null!==_&&(v=_[i])){const I=v.length;if(I)for(let T=0;T<I;T+=2){const ie=e[v[T]][v[T+1]].subscribe(s),pe=p.length;p.push(s,ie),l&&l.push(i,r.index,pe,-(pe+1))}}}(s,i,i[je],o,t,e,r),HE}function _L(t,e,n,r){try{return Pi(6,e,n),!1!==n(r)}catch(i){return EE(t,i),!1}finally{Pi(7,e,n)}}function yL(t,e,n,r,i){return function s(o){if(o===Function)return r;Fg(t.componentOffset>-1?fi(t.index,e):e);let u=_L(e,n,r,o),l=s.__ngNextListenerFn__;for(;l;)u=_L(e,n,l,o)&&u,l=l.__ngNextListenerFn__;return i&&!1===u&&o.preventDefault(),u}}function Sn(t,e=""){const n=H(),r=ct(),i=t+Fe,s=r.firstCreatePass?gh(r,i,1,e,null):r.data[i],o=FL(r,n,s,e,t);n[i]=o,Od()&&nE(r,n,o,s),pi(s,!1)}let FL=(t,e,n,r,i)=>(No(!0),function Xv(t,e){return t.createText(e)}(e[je],r));class vc{}class KL{}class JS extends vc{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new yO(this);const i=Zn(e);this._bootstrapComponents=ts(i.bootstrap),this._r3Injector=Ig(e,n,[{provide:vc,useValue:this},{provide:hE,useValue:this.componentFactoryResolver},...r],gt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class eD extends KL{constructor(e){super(),this.moduleType=e}create(e){return new JS(this.moduleType,e,[])}}class ZL extends vc{constructor(e){super(),this.componentFactoryResolver=new yO(this),this.instance=null;const n=new ku([...e.providers,{provide:vc,useValue:this},{provide:hE,useValue:this.componentFactoryResolver}],e.parent||rh(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function tD(t,e,n=null){return new ZL({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}let u7=(()=>{class t{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const r=_g(0,n.type),i=r.length>0?tD([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,i)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=Ie({token:t,providedIn:"environment",factory:()=>new t(K(Mi))})}return t})();function QL(t){fc("NgStandalone"),t.getStandaloneInjector=e=>e.get(u7).getOrCreateStandaloneInjector(t)}function WE(t,e,n){const r=function lr(){const t=ke.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}()+t,i=H();return i[r]===Ke?function Fo(t,e,n){return t[e]=n}(i,r,n?e.call(n):e()):function Bg(t,e){return t[e]}(i,r)}function O7(){return this._results[Symbol.iterator]()}class rD{static#e=Symbol.iterator;get changes(){return this._changes??=new gi}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const n=rD.prototype;n[Symbol.iterator]||(n[Symbol.iterator]=O7)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,n){return this._results.reduce(e,n)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,n){this.dirty=!1;const r=function Zr(t){return t.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function dg(t,e,n){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++){let i=t[r],s=e[r];if(n&&(i=n(i),s=n(s)),s!==i)return!1}return!0}(this._results,r,n))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}let Na=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=V7}return t})();const L7=Na,F7=class extends L7{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){const i=function Gg(t,e,n,r){const i=e.tView,a=yE(t,i,n,4096&t[De]?4096:16,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null);a[_a]=t[e.index];const l=t[Ri];return null!==l&&(a[Ri]=l.createEmbeddedView(i)),mS(i,a,n),a}(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new Vg(i)}};function V7(){return GE(Dt(),H())}function GE(t,e){return 4&t.type?new F7(e,t,ph(t,e)):null}class iD{constructor(e){this.queryList=e,this.matches=null}clone(){return new iD(this.queryList)}setDirty(){this.queryList.setDirty()}}class sD{constructor(e=[]){this.queries=e}createEmbeddedView(e){const n=e.queries;if(null!==n){const r=null!==e.contentQueries?e.contentQueries[0]:n.length,i=[];for(let s=0;s<r;s++){const o=n.getByIndex(s);i.push(this.queries[o.indexInDeclarationView].clone())}return new sD(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let n=0;n<this.queries.length;n++)null!==mF(e,n).matches&&this.queries[n].setDirty()}}class lF{constructor(e,n,r=null){this.predicate=e,this.flags=n,this.read=r}}class oD{constructor(e=[]){this.queries=e}elementStart(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,n)}elementEnd(e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(e)}embeddedTView(e){let n=null;for(let r=0;r<this.length;r++){const i=null!==n?n.length:0,s=this.getByIndex(r).embeddedTView(e,i);s&&(s.indexInDeclarationView=r,null!==n?n.push(s):n=[s])}return null!==n?new oD(n):null}template(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,n)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class aD{constructor(e,n=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(e,n){this.isApplyingToNode(n)&&this.matchTNode(e,n)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,n){this.elementStart(e,n)}embeddedTView(e,n){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,n),new aD(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let r=e.parent;for(;null!==r&&8&r.type&&r.index!==n;)r=r.parent;return n===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(e,n){const r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){const s=r[i];this.matchTNodeWithReadOption(e,n,U7(n,s)),this.matchTNodeWithReadOption(e,n,jd(n,e,s,!1,!1))}else r===Na?4&n.type&&this.matchTNodeWithReadOption(e,n,-1):this.matchTNodeWithReadOption(e,n,jd(n,e,r,!1,!1))}matchTNodeWithReadOption(e,n,r){if(null!==r){const i=this.metadata.read;if(null!==i)if(i===Bu||i===ro||i===Na&&4&n.type)this.addMatch(n.index,-2);else{const s=jd(n,e,i,!1,!1);null!==s&&this.addMatch(n.index,s)}else this.addMatch(n.index,r)}}addMatch(e,n){null===this.matches?this.matches=[e,n]:this.matches.push(e,n)}}function U7(t,e){const n=t.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===e)return n[r+1];return null}function j7(t,e,n,r){return-1===n?function B7(t,e){return 11&t.type?ph(t,e):4&t.type?GE(t,e):null}(e,t):-2===n?function $7(t,e,n){return n===Bu?ph(e,t):n===Na?GE(e,t):n===ro?u1(e,t):void 0}(t,e,r):Ca(t,t[se],n,e)}function cF(t,e,n,r){const i=e[Ri].queries[r];if(null===i.matches){const s=t.data,o=n.matches,a=[];for(let u=0;u<o.length;u+=2){const l=o[u];a.push(l<0?null:j7(e,s[l],o[u+1],n.metadata.read))}i.matches=a}return i.matches}function uD(t,e,n,r){const i=t.queries.getByIndex(n),s=i.matches;if(null!==s){const o=cF(t,e,i,n);for(let a=0;a<s.length;a+=2){const u=s[a];if(u>0)r.push(o[a/2]);else{const l=s[a+1],h=e[-u];for(let p=wn;p<h.length;p++){const m=h[p];m[_a]===m[Xt]&&uD(m[se],m,l,r)}if(null!==h[gu]){const p=h[gu];for(let m=0;m<p.length;m++){const _=p[m];uD(_[se],_,l,r)}}}}}return r}function dF(t){const e=H(),n=ct(),r=Tv();Zl(r+1);const i=mF(n,r);if(t.dirty&&function Hp(t){return 4==(4&t[De])}(e)===(2==(2&i.metadata.flags))){if(null===i.matches)t.reset([]);else{const s=i.crossesNgTemplate?uD(n,e,r,[]):cF(n,e,i,r);t.reset(s,Y3),t.notifyOnChanges()}return!0}return!1}function hF(t,e,n,r){const i=ct();if(i.firstCreatePass){const s=Dt();(function gF(t,e,n){null===t.queries&&(t.queries=new oD),t.queries.track(new aD(e,n))})(i,new lF(e,n,r),s.index),function q7(t,e){const n=t.contentQueries||(t.contentQueries=[]);e!==(n.length?n[n.length-1]:-1)&&n.push(t.queries.length-1,e)}(i,t),2==(2&n)&&(i.staticContentQueries=!0)}!function pF(t,e,n){const r=new rD(4==(4&n));(function S9(t,e,n,r){const i=rO(e);i.push(n),t.firstCreatePass&&iO(t).push(r,i.length-1)})(t,e,r,r.destroy),null===e[Ri]&&(e[Ri]=new sD),e[Ri].queries.push(new iD(r))}(i,H(),n)}function mF(t,e){return t.queries.getByIndex(e)}class am{constructor(e){this.full=e;const n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}}const pZ=new am("17.0.8");let MF=(()=>{class t{log(n){console.log(n)}warn(n){console.warn(n)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();class gZ{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}}let xF=(()=>{class t{compileModuleSync(n){return new eD(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const r=this.compileModuleSync(n),s=ts(Zn(n).declarations).reduce((o,a)=>{const u=Ye(a);return u&&o.push(new Ug(u)),o},[]);return new gZ(r,s)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),fD=(()=>{class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new x(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const VF=new ue(""),QE=new ue("");let _D,gD=(()=>{class t{constructor(n,r,i){this._ngZone=n,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,_D||(function BZ(t){_D=t}(i),i.addToWindow(r)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ht.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(n)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,i){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),n(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:n,timeoutId:s,updateCb:i})}whenStable(n,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,r,i){return[]}static#e=this.\u0275fac=function(r){return new(r||t)(K(ht),K(mD),K(QE))};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac})}return t})(),mD=(()=>{class t{constructor(){this._applications=new Map}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return _D?.findTestabilityInTree(this,n,r)??null}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();const yD=new ue("Application Initializer");let vD=(()=>{class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r}),this.appInits=oe(yD,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const i of this.appInits){const s=i();if($E(s))n.push(s);else if(pL(s)){const o=new Promise((a,u)=>{s.subscribe({complete:a,error:u})});n.push(o)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(i=>{this.reject(i)}),0===n.length&&r(),this.initialized=!0}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const ED=new ue("appBootstrapListener");function jF(t,e){return Array.isArray(e)?e.reduce(jF,t):{...t,...e}}let Ec=(()=>{class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=oe(Uk),this.componentTypes=[],this.components=[],this.isStable=oe(fD).hasPendingTasks.pipe(fe(n=>!n)),this._injector=oe(Mi)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,r){const i=n instanceof bk;if(!this._injector.get(vD).done)throw!i&&function To(t){const e=Ye(t)||Fn(t)||Vn(t);return null!==e&&e.standalone}(n),new L(405,!1);let o;o=i?n:this._injector.get(hE).resolveComponentFactory(n),this.componentTypes.push(o.componentType);const a=function $Z(t){return t.isBoundToModule}(o)?void 0:this._injector.get(vc),l=o.create(Yr.NULL,[],r||o.selector,a),h=l.location.nativeElement,p=l.injector.get(VF,null);return p?.registerApplication(h),l.onDestroy(()=>{this.detachView(l.hostView),YE(this.components,l),p?.unregisterApplication(h)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new L(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;YE(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const r=this._injector.get(ED,[]);[...this._bootstrapListeners,...r].forEach(i=>i(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>YE(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new L(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function YE(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}let zZ=(()=>{class t{constructor(){this.zone=oe(ht),this.applicationRef=oe(Ec)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function qZ(){const t=oe(ht),e=oe(Ra);return n=>t.runOutsideAngular(()=>e.handleError(n))}let GZ=(()=>{class t{constructor(){this.subscription=new Pt,this.initialized=!1,this.zone=oe(ht),this.pendingTasks=oe(fD)}initialize(){if(this.initialized)return;this.initialized=!0;let n=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(n=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{ht.assertNotInAngularZone(),queueMicrotask(()=>{null!==n&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(n),n=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{ht.assertInAngularZone(),n??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Ma=new ue("LocaleId",{providedIn:"root",factory:()=>oe(Ma,st.Optional|st.SkipSelf)||function KZ(){return typeof $localize<"u"&&$localize.locale||Oh}()}),ID=new ue("PlatformDestroyListeners");let qF=(()=>{class t{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,r){const i=function p6(t="zone.js",e){return"noop"===t?new h6:"zone.js"===t?new ht(e):t}(r?.ngZone,function zF(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing}));return i.run(()=>{const s=function a7(t,e,n){return new JS(t,e,n)}(n.moduleType,this.injector,function HF(t){return[{provide:ht,useFactory:t},{provide:Xs,multi:!0,useFactory:()=>{const e=oe(zZ,{optional:!0});return()=>e.initialize()}},{provide:Xs,multi:!0,useFactory:()=>{const e=oe(GZ);return()=>{e.initialize()}}},{provide:Uk,useFactory:qZ}]}(()=>i)),o=s.injector.get(Ra,null);return i.runOutsideAngular(()=>{const a=i.onError.subscribe({next:u=>{o.handleError(u)}});s.onDestroy(()=>{YE(this._modules,s),a.unsubscribe()})}),function BF(t,e,n){try{const r=n();return $E(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(o,i,()=>{const a=s.injector.get(vD);return a.runInitializers(),a.donePromise.then(()=>(function z1(t){Wr(t,"Expected localeId to be defined"),"string"==typeof t&&(H1=t.toLowerCase().replace(/_/g,"-"))}(s.injector.get(Ma,Oh)||Oh),this._moduleDoBootstrap(s),s))})})}bootstrapModule(n,r=[]){const i=jF({},r);return function jZ(t,e,n){const r=new eD(n);return Promise.resolve(r)}(0,0,n).then(s=>this.bootstrapModuleFactory(s,i))}_moduleDoBootstrap(n){const r=n.injector.get(Ec);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!n.instance.ngDoBootstrap)throw new L(-403,!1);n.instance.ngDoBootstrap(r)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new L(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const n=this._injector.get(ID,null);n&&(n.forEach(r=>r()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(r){return new(r||t)(K(Yr))};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})(),Hu=null;const WF=new ue("AllowMultipleToken");function GF(t,e,n=[]){const r=`Platform: ${e}`,i=new ue(r);return(s=[])=>{let o=wD();if(!o||o.injector.get(WF,!1)){const a=[...n,...s,{provide:i,useValue:!0}];t?t(a):function YZ(t){if(Hu&&!Hu.get(WF,!1))throw new L(400,!1);(function UF(){!function la(t){gs=t}(()=>{throw new L(600,!1)})})(),Hu=t;const e=t.get(qF);(function ZF(t){t.get(Ax,null)?.forEach(n=>n())})(t)}(function KF(t=[],e){return Yr.create({name:e,providers:[{provide:nh,useValue:"platform"},{provide:ID,useValue:new Set([()=>Hu=null])},...t]})}(a,r))}return function XZ(t){const e=wD();if(!e)throw new L(401,!1);return e}()}}function wD(){return Hu?.get(qF)??null}const iQ=GF(null,"core",[]);let sQ=(()=>{class t{constructor(n){}static#e=this.\u0275fac=function(r){return new(r||t)(K(Ec))};static#t=this.\u0275mod=_r({type:t});static#n=this.\u0275inj=Ar({})}return t})();function ND(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}let MD=null;function Uh(){return MD}class xQ{}const Li=new ue("DocumentToken");let xD=(()=>{class t{historyGo(n){throw new Error("Not implemented")}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:()=>oe(OQ),providedIn:"platform"})}return t})();const kQ=new ue("Location Initialized");let OQ=(()=>{class t extends xD{constructor(){super(),this._doc=oe(Li),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Uh().getBaseHref(this._doc)}onPopState(n){const r=Uh().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){const r=Uh().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,r,i){this._history.pushState(n,r,i)}replaceState(n,r,i){this._history.replaceState(n,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:()=>new t,providedIn:"platform"})}return t})();function kD(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function vV(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function xa(t){return t&&"?"!==t[0]?"?"+t:t}let wc=(()=>{class t{historyGo(n){throw new Error("Not implemented")}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:()=>oe(IV),providedIn:"root"})}return t})();const EV=new ue("appBaseHref");let IV=(()=>{class t extends wc{constructor(n,r){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??oe(Li).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return kD(this._baseHref,n)}path(n=!1){const r=this._platformLocation.pathname+xa(this._platformLocation.search),i=this._platformLocation.hash;return i&&n?`${r}${i}`:r}pushState(n,r,i,s){const o=this.prepareExternalUrl(i+xa(s));this._platformLocation.pushState(n,r,o)}replaceState(n,r,i,s){const o=this.prepareExternalUrl(i+xa(s));this._platformLocation.replaceState(n,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static#e=this.\u0275fac=function(r){return new(r||t)(K(xD),K(EV,8))};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),LQ=(()=>{class t extends wc{constructor(n,r){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(n){const r=kD(this._baseHref,n);return r.length>0?"#"+r:r}pushState(n,r,i,s){let o=this.prepareExternalUrl(i+xa(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(n,r,o)}replaceState(n,r,i,s){let o=this.prepareExternalUrl(i+xa(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(n,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static#e=this.\u0275fac=function(r){return new(r||t)(K(xD),K(EV,8))};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac})}return t})(),dm=(()=>{class t{constructor(n){this._subject=new gi,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const r=this._locationStrategy.getBaseHref();this._basePath=function UQ(t){if(new RegExp("^(https?:)?//").test(t)){const[,n]=t.split(/\/\/[^\/]+/);return n}return t}(vV(wV(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+xa(r))}normalize(n){return t.stripTrailingSlash(function VQ(t,e){if(!t||!e.startsWith(t))return e;const n=e.substring(t.length);return""===n||["/",";","?","#"].includes(n[0])?n:e}(this._basePath,wV(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",i=null){this._locationStrategy.pushState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+xa(r)),i)}replaceState(n,r="",i=null){this._locationStrategy.replaceState(i,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+xa(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(i=>i(n,r))}subscribe(n,r,i){return this._subject.subscribe({next:n,error:r,complete:i})}static#e=this.normalizeQueryParams=xa;static#t=this.joinWithSlash=kD;static#n=this.stripTrailingSlash=vV;static#r=this.\u0275fac=function(r){return new(r||t)(K(wc))};static#i=this.\u0275prov=Ie({token:t,factory:()=>function FQ(){return new dm(K(wc))}(),providedIn:"root"})}return t})();function wV(t){return t.replace(/\/index.html$/,"")}let tX=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=_r({type:t});static#n=this.\u0275inj=Ar({})}return t})();function mI(t){return"server"===t}let sX=(()=>{class t{static#e=this.\u0275prov=Ie({token:t,providedIn:"root",factory:()=>new oX(K(Li),window)})}return t})();class oX{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const n=function aX(t,e){const n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if("function"==typeof t.createTreeWalker&&t.body&&"function"==typeof t.body.attachShadow){const r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const s=i.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class NX extends xQ{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class YD extends NX{static makeCurrent(){!function MQ(t){MD||(MD=t)}(new YD)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=function MX(){return gm=gm||document.querySelector("base"),gm?gm.getAttribute("href"):null}();return null==n?null:function xX(t){return new URL(t,document.baseURI).pathname}(n)}resetBaseElement(){gm=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function TY(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const r=n.indexOf("="),[i,s]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let gm=null,OX=(()=>{class t{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac})}return t})();const XD=new ue("EventManagerPlugins");let jV=(()=>{class t{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(i=>{i.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,r,i){return this._findPluginFor(r).addEventListener(n,r,i)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(s=>s.supports(n)),!r)throw new L(5101,!1);return this._eventNameToPlugin.set(n,r),r}static#e=this.\u0275fac=function(r){return new(r||t)(K(XD),K(ht))};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac})}return t})();class $V{constructor(e){this._doc=e}}const JD="ng-app-id";let HV=(()=>{class t{constructor(n,r,i,s={}){this.doc=n,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=mI(s),this.resetHostNodes()}addStyles(n){for(const r of n)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(n){for(const r of n)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(r=>r.remove()),n.clear());for(const r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const r of this.getAllStyles())this.addStyleToHost(n,r)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const r of this.hostNodes)this.addStyleToHost(r,n)}onStyleRemoved(n){const r=this.styleRef;r.get(n)?.elements?.forEach(i=>i.remove()),r.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${JD}="${this.appId}"]`);if(n?.length){const r=new Map;return n.forEach(i=>{null!=i.textContent&&r.set(i.textContent,i)}),r}return null}changeUsageCount(n,r){const i=this.styleRef;if(i.has(n)){const s=i.get(n);return s.usage+=r,s.usage}return i.set(n,{usage:r,elements:[]}),r}getStyleElement(n,r){const i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===n)return i.delete(r),s.removeAttribute(JD),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=r,this.platformIsServer&&o.setAttribute(JD,this.appId),n.appendChild(o),o}}addStyleToHost(n,r){const i=this.getStyleElement(n,r),s=this.styleRef,o=s.get(r)?.elements;o?o.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}static#e=this.\u0275fac=function(r){return new(r||t)(K(Li),K(Wv),K(Px,8),K(eo))};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac})}return t})();const eb={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},tb=/%COMP%/g,UX=new ue("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!0});function qV(t,e){return e.map(n=>n.replace(tb,t))}let nb=(()=>{class t{constructor(n,r,i,s,o,a,u,l=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=u,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=mI(a),this.defaultRenderer=new rb(n,o,u,this.platformIsServer)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===gn.ShadowDom&&(r={...r,encapsulation:gn.Emulated});const i=this.getOrCreateRenderer(n,r);return i instanceof GV?i.applyToHost(n):i instanceof ib&&i.applyStyles(),i}getOrCreateRenderer(n,r){const i=this.rendererByCompId;let s=i.get(r.id);if(!s){const o=this.doc,a=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(r.encapsulation){case gn.Emulated:s=new GV(u,l,r,this.appId,h,o,a,p);break;case gn.ShadowDom:return new HX(u,l,n,r,o,a,this.nonce,p);default:s=new ib(u,l,r,h,o,a,p)}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(r){return new(r||t)(K(jV),K(HV),K(Wv),K(UX),K(Li),K(eo),K(ht),K(Px))};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac})}return t})();class rb{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(eb[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(WV(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(WV(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r="string"==typeof e?this.doc.querySelector(e):e;if(!r)throw new L(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;const s=eb[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){const i=eb[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Vu.DashCase|Vu.Important)?e.style.setProperty(n,r,i&Vu.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Vu.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){null!=e&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if("string"==typeof e&&!(e=Uh().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if("__ngUnwrap__"===n)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))&&n.preventDefault()}}}function WV(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class HX extends rb{constructor(e,n,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=qV(i.id,i.styles);for(const h of l){const p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=h,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class ib extends rb{constructor(e,n,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=u?qV(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class GV extends ib{constructor(e,n,r,i,s,o,a,u){const l=i+"-"+r.id;super(e,n,r,s,o,a,u,l),this.contentAttr=function BX(t){return"_ngcontent-%COMP%".replace(tb,t)}(l),this.hostAttr=function jX(t){return"_nghost-%COMP%".replace(tb,t)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){const r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}}let zX=(()=>{class t extends $V{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,i){return n.addEventListener(r,i,!1),()=>this.removeEventListener(n,r,i)}removeEventListener(n,r,i){return n.removeEventListener(r,i)}static#e=this.\u0275fac=function(r){return new(r||t)(K(Li))};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac})}return t})();const KV=["alt","control","meta","shift"],qX={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},WX={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let GX=(()=>{class t extends $V{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,r,i){const s=t.parseEventName(r),o=t.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Uh().onAndCancel(n,s.domEventName,o))}static parseEventName(n){const r=n.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const s=t._normalizeKey(r.pop());let o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),KV.forEach(l=>{const h=r.indexOf(l);h>-1&&(r.splice(h,1),o+=l+".")}),o+=s,0!=r.length||0===s.length)return null;const u={};return u.domEventName=i,u.fullKey=o,u}static matchEventFullKeyCode(n,r){let i=qX[n.key]||n.key,s="";return r.indexOf("code.")>-1&&(i=n.code,s="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),KV.forEach(o=>{o!==i&&(0,WX[o])(n)&&(s+=o+".")}),s+=i,s===r)}static eventCallback(n,r,i){return s=>{t.matchEventFullKeyCode(s,n)&&i.runGuarded(()=>r(s))}}static _normalizeKey(n){return"esc"===n?"escape":n}static#e=this.\u0275fac=function(r){return new(r||t)(K(Li))};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac})}return t})();const QV=[{provide:eo,useValue:"browser"},{provide:Ax,useValue:function KX(){YD.makeCurrent()},multi:!0},{provide:Li,useFactory:function QX(){return function DG(t){v0=t}(document),document},deps:[]}],YX=GF(iQ,"browser",QV),XX=new ue(""),YV=[{provide:QE,useClass:class kX{addToWindow(e){Ut.getAngularTestability=(r,i=!0)=>{const s=e.findTestabilityInTree(r,i);if(null==s)throw new L(5103,!1);return s},Ut.getAllAngularTestabilities=()=>e.getAllTestabilities(),Ut.getAllAngularRootElements=()=>e.getAllRootElements(),Ut.frameworkStabilizers||(Ut.frameworkStabilizers=[]),Ut.frameworkStabilizers.push(r=>{const i=Ut.getAllAngularTestabilities();let s=i.length,o=!1;const a=function(u){o=o||u,s--,0==s&&r(o)};i.forEach(u=>{u.whenStable(a)})})}findTestabilityInTree(e,n,r){return null==n?null:e.getTestability(n)??(r?Uh().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},deps:[]},{provide:VF,useClass:gD,deps:[ht,mD,QE]},{provide:gD,useClass:gD,deps:[ht,mD,QE]}],XV=[{provide:nh,useValue:"root"},{provide:Ra,useFactory:function ZX(){return new Ra},deps:[]},{provide:XD,useClass:zX,multi:!0,deps:[Li,ht,eo]},{provide:XD,useClass:GX,multi:!0,deps:[Li]},nb,HV,jV,{provide:Y0,useExisting:nb},{provide:class uX{},useClass:OX,deps:[]},[]];let JV=(()=>{class t{constructor(n){}static withServerTransition(n){return{ngModule:t,providers:[{provide:Wv,useValue:n.appId}]}}static#e=this.\u0275fac=function(r){return new(r||t)(K(XX,12))};static#t=this.\u0275mod=_r({type:t});static#n=this.\u0275inj=Ar({providers:[...XV,...YV],imports:[tX,sQ]})}return t})(),e2=(()=>{class t{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static#e=this.\u0275fac=function(r){return new(r||t)(K(Li))};static#t=this.\u0275prov=Ie({token:t,factory:function(r){let i=null;return i=r?new r:function eJ(){return new e2(K(Li))}(),i},providedIn:"root"})}return t})();typeof window<"u"&&window;const La="*";function i2(t){return{type:6,styles:t,offset:null}}class mm{constructor(e=0,n=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+n}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const n="start"==e?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}}class s2{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let n=0,r=0,i=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++n==s&&this._onFinish()}),o.onDestroy(()=>{++r==s&&this._onDestroy()}),o.onStart(()=>{++i==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const n=e*this.totalTime;this.players.forEach(r=>{const i=r.totalTime?Math.min(1,n/r.totalTime):1;r.setPosition(i)})}getPosition(){const e=this.players.reduce((n,r)=>null===n||r.totalTime>n.totalTime?r:n,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const n="start"==e?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}}function o2(t){return new L(3e3,!1)}function qu(t){switch(t.length){case 0:return new mm;case 1:return t[0];default:return new s2(t)}}function a2(t,e,n=new Map,r=new Map){const i=[],s=[];let o=-1,a=null;if(e.forEach(u=>{const l=u.get("offset"),h=l==o,p=h&&a||new Map;u.forEach((m,_)=>{let v=_,I=m;if("offset"!==_)switch(v=t.normalizePropertyName(v,i),I){case"!":I=n.get(_);break;case La:I=r.get(_);break;default:I=t.normalizeStyleValue(_,v,I,i)}p.set(v,I)}),h||s.push(p),a=p,o=l}),i.length)throw function NJ(t){return new L(3502,!1)}();return s}function ab(t,e,n,r){switch(e){case"start":t.onStart(()=>r(n&&ub(n,"start",t)));break;case"done":t.onDone(()=>r(n&&ub(n,"done",t)));break;case"destroy":t.onDestroy(()=>r(n&&ub(n,"destroy",t)))}}function ub(t,e,n){const s=lb(t.element,t.triggerName,t.fromState,t.toState,e||t.phaseName,n.totalTime??t.totalTime,!!n.disabled),o=t._data;return null!=o&&(s._data=o),s}function lb(t,e,n,r,i="",s=0,o){return{element:t,triggerName:e,fromState:n,toState:r,phaseName:i,totalTime:s,disabled:!!o}}function is(t,e,n){let r=t.get(e);return r||t.set(e,r=n),r}function u2(t){const e=t.indexOf(":");return[t.substring(1,e),t.slice(e+1)]}const HJ=(()=>typeof document>"u"?null:document.documentElement)();function cb(t){const e=t.parentNode||t.host||null;return e===HJ?null:e}let Tc=null,l2=!1;function c2(t,e){for(;e;){if(e===t)return!0;e=cb(e)}return!1}function d2(t,e,n){if(n)return Array.from(t.querySelectorAll(e));const r=t.querySelector(e);return r?[r]:[]}let db=(()=>{class t{validateStyleProperty(n){return function qJ(t){Tc||(Tc=function WJ(){return typeof document<"u"?document.body:null}()||{},l2=!!Tc.style&&"WebkitAppearance"in Tc.style);let e=!0;return Tc.style&&!function zJ(t){return"ebkit"==t.substring(1,6)}(t)&&(e=t in Tc.style,!e&&l2&&(e="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in Tc.style)),e}(n)}matchesElement(n,r){return!1}containsElement(n,r){return c2(n,r)}getParentElement(n){return cb(n)}query(n,r,i){return d2(n,r,i)}computeStyle(n,r,i){return i||""}animate(n,r,i,s,o,a=[],u){return new mm(i,s)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac})}return t})(),hb=(()=>{class t{static#e=this.NOOP=new db}return t})();class fb{}const KJ=1e3,pb="ng-enter",vI="ng-leave",EI="ng-trigger",II=".ng-trigger",f2="ng-animating",gb=".ng-animating";function Fa(t){if("number"==typeof t)return t;const e=t.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:mb(parseFloat(e[1]),e[2])}function mb(t,e){return"s"===e?t*KJ:t}function wI(t,e,n){return t.hasOwnProperty("duration")?t:function QJ(t,e,n){let i,s=0,o="";if("string"==typeof t){const a=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(o2()),{duration:0,delay:0,easing:""};i=mb(parseFloat(a[1]),a[2]);const u=a[3];null!=u&&(s=mb(parseFloat(u),a[4]));const l=a[5];l&&(o=l)}else i=t;if(!n){let a=!1,u=e.length;i<0&&(e.push(function lJ(){return new L(3100,!1)}()),a=!0),s<0&&(e.push(function cJ(){return new L(3101,!1)}()),a=!0),a&&e.splice(u,0,o2())}return{duration:i,delay:s,easing:o}}(t,e,n)}function _m(t,e={}){return Object.keys(t).forEach(n=>{e[n]=t[n]}),e}function p2(t){const e=new Map;return Object.keys(t).forEach(n=>{e.set(n,t[n])}),e}function Wu(t,e=new Map,n){if(n)for(let[r,i]of n)e.set(r,i);for(let[r,i]of t)e.set(r,i);return e}function Bo(t,e,n){e.forEach((r,i)=>{const s=yb(i);n&&!n.has(i)&&n.set(i,t.style[s]),t.style[s]=r})}function Cc(t,e){e.forEach((n,r)=>{const i=yb(r);t.style[i]=""})}function ym(t){return Array.isArray(t)?1==t.length?t[0]:function sJ(t,e=null){return{type:2,steps:t,options:e}}(t):t}const _b=new RegExp("{{\\s*(.+?)\\s*}}","g");function m2(t){let e=[];if("string"==typeof t){let n;for(;n=_b.exec(t);)e.push(n[1]);_b.lastIndex=0}return e}function vm(t,e,n){const r=t.toString(),i=r.replace(_b,(s,o)=>{let a=e[o];return null==a&&(n.push(function hJ(t){return new L(3003,!1)}()),a=""),a.toString()});return i==r?t:i}function TI(t){const e=[];let n=t.next();for(;!n.done;)e.push(n.value),n=t.next();return e}const JJ=/-+([a-z0-9])/g;function yb(t){return t.replace(JJ,(...e)=>e[1].toUpperCase())}function ss(t,e,n){switch(e.type){case 7:return t.visitTrigger(e,n);case 0:return t.visitState(e,n);case 1:return t.visitTransition(e,n);case 2:return t.visitSequence(e,n);case 3:return t.visitGroup(e,n);case 4:return t.visitAnimate(e,n);case 5:return t.visitKeyframes(e,n);case 6:return t.visitStyle(e,n);case 8:return t.visitReference(e,n);case 9:return t.visitAnimateChild(e,n);case 10:return t.visitAnimateRef(e,n);case 11:return t.visitQuery(e,n);case 12:return t.visitStagger(e,n);default:throw function fJ(t){return new L(3004,!1)}()}}function _2(t,e){return window.getComputedStyle(t)[e]}const nee=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class y2 extends fb{normalizePropertyName(e,n){return yb(e)}normalizeStyleValue(e,n,r,i){let s="";const o=r.toString().trim();if(nee.has(n)&&0!==r&&"0"!==r)if("number"==typeof r)s="px";else{const a=r.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&i.push(function pJ(t,e){return new L(3005,!1)}())}return o+s}}const CI="*";function ree(t,e){const n=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(r=>function iee(t,e,n){if(":"==t[0]){const u=function see(t,e){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(n,r)=>parseFloat(r)>parseFloat(n);case":decrement":return(n,r)=>parseFloat(r)<parseFloat(n);default:return e.push(function bJ(t){return new L(3016,!1)}()),"* => *"}}(t,n);if("function"==typeof u)return void e.push(u);t=u}const r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return n.push(function DJ(t){return new L(3015,!1)}()),e;const i=r[1],s=r[2],o=r[3];e.push(v2(i,o));"<"==s[0]&&!(i==CI&&o==CI)&&e.push(v2(o,i))}(r,n,e)):n.push(t),n}const SI=new Set(["true","1"]),DI=new Set(["false","0"]);function v2(t,e){const n=SI.has(t)||DI.has(t),r=SI.has(e)||DI.has(e);return(i,s)=>{let o=t==CI||t==i,a=e==CI||e==s;return!o&&n&&"boolean"==typeof i&&(o=i?SI.has(t):DI.has(t)),!a&&r&&"boolean"==typeof s&&(a=s?SI.has(e):DI.has(e)),o&&a}}const oee=new RegExp("s*:selfs*,?","g");function vb(t,e,n,r){return new aee(t).build(e,n,r)}class aee{constructor(e){this._driver=e}build(e,n,r){const i=new cee(n);return this._resetContextStyleTimingState(i),ss(this,ym(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,n){let r=n.queryCount=0,i=n.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&n.errors.push(function gJ(){return new L(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(n),0==a.type){const u=a,l=u.name;l.toString().split(/\s*,\s*/).forEach(h=>{u.name=h,s.push(this.visitState(u,n))}),u.name=l}else if(1==a.type){const u=this.visitTransition(a,n);r+=u.queryCount,i+=u.depCount,o.push(u)}else n.errors.push(function mJ(){return new L(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:r,depCount:i,options:null}}visitState(e,n){const r=this.visitStyle(e.styles,n),i=e.options&&e.options.params||null;if(r.containsDynamicStyles){const s=new Set,o=i||{};r.styles.forEach(a=>{a instanceof Map&&a.forEach(u=>{m2(u).forEach(l=>{o.hasOwnProperty(l)||s.add(l)})})}),s.size&&(TI(s.values()),n.errors.push(function _J(t,e){return new L(3008,!1)}()))}return{type:0,name:e.name,style:r,options:i?{params:i}:null}}visitTransition(e,n){n.queryCount=0,n.depCount=0;const r=ss(this,ym(e.animation),n);return{type:1,matchers:ree(e.expr,n.errors),animation:r,queryCount:n.queryCount,depCount:n.depCount,options:Sc(e.options)}}visitSequence(e,n){return{type:2,steps:e.steps.map(r=>ss(this,r,n)),options:Sc(e.options)}}visitGroup(e,n){const r=n.currentTime;let i=0;const s=e.steps.map(o=>{n.currentTime=r;const a=ss(this,o,n);return i=Math.max(i,n.currentTime),a});return n.currentTime=i,{type:3,steps:s,options:Sc(e.options)}}visitAnimate(e,n){const r=function hee(t,e){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return Eb(wI(t,e).duration,0,"");const n=t;if(n.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=Eb(0,0,"");return s.dynamic=!0,s.strValue=n,s}const i=wI(n,e);return Eb(i.duration,i.delay,i.easing)}(e.timings,n.errors);n.currentAnimateTimings=r;let i,s=e.styles?e.styles:i2({});if(5==s.type)i=this.visitKeyframes(s,n);else{let o=e.styles,a=!1;if(!o){a=!0;const l={};r.easing&&(l.easing=r.easing),o=i2(l)}n.currentTime+=r.duration+r.delay;const u=this.visitStyle(o,n);u.isEmptyStep=a,i=u}return n.currentAnimateTimings=null,{type:4,timings:r,style:i,options:null}}visitStyle(e,n){const r=this._makeStyleAst(e,n);return this._validateStyleAst(r,n),r}_makeStyleAst(e,n){const r=[],i=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of i)"string"==typeof a?a===La?r.push(a):n.errors.push(new L(3002,!1)):r.push(p2(a));let s=!1,o=null;return r.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let u of a.values())if(u.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:r,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,n){const r=n.currentAnimateTimings;let i=n.currentTime,s=n.currentTime;r&&s>0&&(s-=r.duration+r.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,u)=>{const l=n.collectedStyles.get(n.currentQuerySelector),h=l.get(u);let p=!0;h&&(s!=i&&s>=h.startTime&&i<=h.endTime&&(n.errors.push(function vJ(t,e,n,r,i){return new L(3010,!1)}()),p=!1),s=h.startTime),p&&l.set(u,{startTime:s,endTime:i}),n.options&&function XJ(t,e,n){const r=e.params||{},i=m2(t);i.length&&i.forEach(s=>{r.hasOwnProperty(s)||n.push(function dJ(t){return new L(3001,!1)}())})}(a,n.options,n.errors)})})}visitKeyframes(e,n){const r={type:5,styles:[],options:null};if(!n.currentAnimateTimings)return n.errors.push(function EJ(){return new L(3011,!1)}()),r;let s=0;const o=[];let a=!1,u=!1,l=0;const h=e.steps.map(N=>{const b=this._makeStyleAst(N,n);let k=null!=b.offset?b.offset:function dee(t){if("string"==typeof t)return null;let e=null;if(Array.isArray(t))t.forEach(n=>{if(n instanceof Map&&n.has("offset")){const r=n;e=parseFloat(r.get("offset")),r.delete("offset")}});else if(t instanceof Map&&t.has("offset")){const n=t;e=parseFloat(n.get("offset")),n.delete("offset")}return e}(b.styles),$=0;return null!=k&&(s++,$=b.offset=k),u=u||$<0||$>1,a=a||$<l,l=$,o.push($),b});u&&n.errors.push(function IJ(){return new L(3012,!1)}()),a&&n.errors.push(function wJ(){return new L(3200,!1)}());const p=e.steps.length;let m=0;s>0&&s<p?n.errors.push(function TJ(){return new L(3202,!1)}()):0==s&&(m=1/(p-1));const _=p-1,v=n.currentTime,I=n.currentAnimateTimings,T=I.duration;return h.forEach((N,b)=>{const k=m>0?b==_?1:m*b:o[b],$=k*T;n.currentTime=v+I.delay+$,I.duration=$,this._validateStyleAst(N,n),N.offset=k,r.styles.push(N)}),r}visitReference(e,n){return{type:8,animation:ss(this,ym(e.animation),n),options:Sc(e.options)}}visitAnimateChild(e,n){return n.depCount++,{type:9,options:Sc(e.options)}}visitAnimateRef(e,n){return{type:10,animation:this.visitReference(e.animation,n),options:Sc(e.options)}}visitQuery(e,n){const r=n.currentQuerySelector,i=e.options||{};n.queryCount++,n.currentQuery=e;const[s,o]=function uee(t){const e=!!t.split(/\s*,\s*/).find(n=>":self"==n);return e&&(t=t.replace(oee,"")),t=t.replace(/@\*/g,II).replace(/@\w+/g,n=>II+"-"+n.slice(1)).replace(/:animating/g,gb),[t,e]}(e.selector);n.currentQuerySelector=r.length?r+" "+s:s,is(n.collectedStyles,n.currentQuerySelector,new Map);const a=ss(this,ym(e.animation),n);return n.currentQuery=null,n.currentQuerySelector=r,{type:11,selector:s,limit:i.limit||0,optional:!!i.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:Sc(e.options)}}visitStagger(e,n){n.currentQuery||n.errors.push(function CJ(){return new L(3013,!1)}());const r="full"===e.timings?{duration:0,delay:0,easing:"full"}:wI(e.timings,n.errors,!0);return{type:12,animation:ss(this,ym(e.animation),n),timings:r,options:null}}}class cee{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Sc(t){return t?(t=_m(t)).params&&(t.params=function lee(t){return t?_m(t):null}(t.params)):t={},t}function Eb(t,e,n){return{duration:t,delay:e,easing:n}}function Ib(t,e,n,r,i,s,o=null,a=!1){return{type:1,element:t,keyframes:e,preStyleProps:n,postStyleProps:r,duration:i,delay:s,totalTime:i+s,easing:o,subTimeline:a}}class bI{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,n){let r=this._map.get(e);r||this._map.set(e,r=[]),r.push(...n)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const gee=new RegExp(":enter","g"),_ee=new RegExp(":leave","g");function wb(t,e,n,r,i,s=new Map,o=new Map,a,u,l=[]){return(new yee).buildKeyframes(t,e,n,r,i,s,o,a,u,l)}class yee{buildKeyframes(e,n,r,i,s,o,a,u,l,h=[]){l=l||new bI;const p=new Tb(e,n,l,i,s,h,[]);p.options=u;const m=u.delay?Fa(u.delay):0;p.currentTimeline.delayNextStep(m),p.currentTimeline.setStyles([o],null,p.errors,u),ss(this,r,p);const _=p.timelines.filter(v=>v.containsAnimation());if(_.length&&a.size){let v;for(let I=_.length-1;I>=0;I--){const T=_[I];if(T.element===n){v=T;break}}v&&!v.allowOnlyTimelineStyles()&&v.setStyles([a],null,p.errors,u)}return _.length?_.map(v=>v.buildKeyframes()):[Ib(n,[],[],[],0,m,"",!1)]}visitTrigger(e,n){}visitState(e,n){}visitTransition(e,n){}visitAnimateChild(e,n){const r=n.subInstructions.get(n.element);if(r){const i=n.createSubContext(e.options),s=n.currentTimeline.currentTime,o=this._visitSubInstructions(r,i,i.options);s!=o&&n.transformIntoNewTimeline(o)}n.previousNode=e}visitAnimateRef(e,n){const r=n.createSubContext(e.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],n,r),this.visitReference(e.animation,r),n.transformIntoNewTimeline(r.currentTimeline.currentTime),n.previousNode=e}_applyAnimationRefDelays(e,n,r){for(const i of e){const s=i?.delay;if(s){const o="number"==typeof s?s:Fa(vm(s,i?.params??{},n.errors));r.delayNextStep(o)}}}_visitSubInstructions(e,n,r){let s=n.currentTimeline.currentTime;const o=null!=r.duration?Fa(r.duration):null,a=null!=r.delay?Fa(r.delay):null;return 0!==o&&e.forEach(u=>{const l=n.appendInstructionToTimeline(u,o,a);s=Math.max(s,l.duration+l.delay)}),s}visitReference(e,n){n.updateOptions(e.options,!0),ss(this,e.animation,n),n.previousNode=e}visitSequence(e,n){const r=n.subContextCount;let i=n;const s=e.options;if(s&&(s.params||s.delay)&&(i=n.createSubContext(s),i.transformIntoNewTimeline(),null!=s.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=AI);const o=Fa(s.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>ss(this,o,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),n.previousNode=e}visitGroup(e,n){const r=[];let i=n.currentTimeline.currentTime;const s=e.options&&e.options.delay?Fa(e.options.delay):0;e.steps.forEach(o=>{const a=n.createSubContext(e.options);s&&a.delayNextStep(s),ss(this,o,a),i=Math.max(i,a.currentTimeline.currentTime),r.push(a.currentTimeline)}),r.forEach(o=>n.currentTimeline.mergeTimelineCollectedStyles(o)),n.transformIntoNewTimeline(i),n.previousNode=e}_visitTiming(e,n){if(e.dynamic){const r=e.strValue;return wI(n.params?vm(r,n.params,n.errors):r,n.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,n){const r=n.currentAnimateTimings=this._visitTiming(e.timings,n),i=n.currentTimeline;r.delay&&(n.incrementTime(r.delay),i.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,n):(n.incrementTime(r.duration),this.visitStyle(s,n),i.applyStylesToKeyframe()),n.currentAnimateTimings=null,n.previousNode=e}visitStyle(e,n){const r=n.currentTimeline,i=n.currentAnimateTimings;!i&&r.hasCurrentStyleProperties()&&r.forwardFrame();const s=i&&i.easing||e.easing;e.isEmptyStep?r.applyEmptyStep(s):r.setStyles(e.styles,s,n.errors,n.options),n.previousNode=e}visitKeyframes(e,n){const r=n.currentAnimateTimings,i=n.currentTimeline.duration,s=r.duration,a=n.createSubContext().currentTimeline;a.easing=r.easing,e.styles.forEach(u=>{a.forwardTime((u.offset||0)*s),a.setStyles(u.styles,u.easing,n.errors,n.options),a.applyStylesToKeyframe()}),n.currentTimeline.mergeTimelineCollectedStyles(a),n.transformIntoNewTimeline(i+s),n.previousNode=e}visitQuery(e,n){const r=n.currentTimeline.currentTime,i=e.options||{},s=i.delay?Fa(i.delay):0;s&&(6===n.previousNode.type||0==r&&n.currentTimeline.hasCurrentStyleProperties())&&(n.currentTimeline.snapshotCurrentStyles(),n.previousNode=AI);let o=r;const a=n.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,n.errors);n.currentQueryTotal=a.length;let u=null;a.forEach((l,h)=>{n.currentQueryIndex=h;const p=n.createSubContext(e.options,l);s&&p.delayNextStep(s),l===n.element&&(u=p.currentTimeline),ss(this,e.animation,p),p.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,p.currentTimeline.currentTime)}),n.currentQueryIndex=0,n.currentQueryTotal=0,n.transformIntoNewTimeline(o),u&&(n.currentTimeline.mergeTimelineCollectedStyles(u),n.currentTimeline.snapshotCurrentStyles()),n.previousNode=e}visitStagger(e,n){const r=n.parentContext,i=n.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(n.currentQueryTotal-1);let u=o*n.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":u=a-u;break;case"full":u=r.currentStaggerTime}const h=n.currentTimeline;u&&h.delayNextStep(u);const p=h.currentTime;ss(this,e.animation,n),n.previousNode=e,r.currentStaggerTime=i.currentTime-p+(i.startTime-r.currentTimeline.startTime)}}const AI={};class Tb{constructor(e,n,r,i,s,o,a,u){this._driver=e,this.element=n,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=AI,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new RI(this._driver,n,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,n){if(!e)return;const r=e;let i=this.options;null!=r.duration&&(i.duration=Fa(r.duration)),null!=r.delay&&(i.delay=Fa(r.delay));const s=r.params;if(s){let o=i.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!n||!o.hasOwnProperty(a))&&(o[a]=vm(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const n=this.options.params;if(n){const r=e.params={};Object.keys(n).forEach(i=>{r[i]=n[i]})}}return e}createSubContext(e=null,n,r){const i=n||this.element,s=new Tb(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=AI,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,n,r){const i={duration:n??e.duration,delay:this.currentTimeline.currentTime+(r??0)+e.delay,easing:""},s=new vee(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(s),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,n,r,i,s,o){let a=[];if(i&&a.push(this.element),e.length>0){e=(e=e.replace(gee,"."+this._enterClassName)).replace(_ee,"."+this._leaveClassName);let l=this._driver.query(this.element,e,1!=r);0!==r&&(l=r<0?l.slice(l.length+r,l.length):l.slice(0,r)),a.push(...l)}return!s&&0==a.length&&o.push(function SJ(t){return new L(3014,!1)}()),a}}class RI{constructor(e,n,r,i){this._driver=e,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const n=1===this._keyframes.size&&this._pendingStyles.size;this.duration||n?(this.forwardTime(this.currentTime+e),n&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,n){return this.applyStylesToKeyframe(),new RI(this._driver,e,n||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,n){this._localTimelineStyles.set(e,n),this._globalTimelineStyles.set(e,n),this._styleSummary.set(e,{time:this.currentTime,value:n})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[n,r]of this._globalTimelineStyles)this._backFill.set(n,r||La),this._currentKeyframe.set(n,La);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,n,r,i){n&&this._previousKeyframe.set("easing",n);const s=i&&i.params||{},o=function Eee(t,e){const n=new Map;let r;return t.forEach(i=>{if("*"===i){r=r||e.keys();for(let s of r)n.set(s,La)}else Wu(i,n)}),n}(e,this._globalTimelineStyles);for(let[a,u]of o){const l=vm(u,s,r);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??La),this._updateStyle(a,l)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,n)=>{this._currentKeyframe.set(n,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,n)=>{this._currentKeyframe.has(n)||this._currentKeyframe.set(n,e)}))}snapshotCurrentStyles(){for(let[e,n]of this._localTimelineStyles)this._pendingStyles.set(e,n),this._updateStyle(e,n)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let n in this._currentKeyframe)e.push(n);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((n,r)=>{const i=this._styleSummary.get(r);(!i||n.time>i.time)&&this._updateStyle(r,n.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,n=new Set,r=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((a,u)=>{const l=Wu(a,new Map,this._backFill);l.forEach((h,p)=>{"!"===h?e.add(p):h===La&&n.add(p)}),r||l.set("offset",u/this.duration),i.push(l)});const s=e.size?TI(e.values()):[],o=n.size?TI(n.values()):[];if(r){const a=i[0],u=new Map(a);a.set("offset",0),u.set("offset",1),i=[a,u]}return Ib(this.element,i,s,o,this.duration,this.startTime,this.easing,!1)}}class vee extends RI{constructor(e,n,r,i,s,o,a=!1){super(e,n,o.delay),this.keyframes=r,this.preStyleProps=i,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:n,duration:r,easing:i}=this.timings;if(this._stretchStartingKeyframe&&n){const s=[],o=r+n,a=n/o,u=Wu(e[0]);u.set("offset",0),s.push(u);const l=Wu(e[0]);l.set("offset",w2(a)),s.push(l);const h=e.length-1;for(let p=1;p<=h;p++){let m=Wu(e[p]);const _=m.get("offset");m.set("offset",w2((n+_*r)/o)),s.push(m)}r=o,n=0,i="",e=s}return Ib(this.element,e,this.preStyleProps,this.postStyleProps,r,n,i,!0)}}function w2(t,e=3){const n=Math.pow(10,e-1);return Math.round(t*n)/n}function T2(t,e,n,r,i,s,o,a,u,l,h,p,m){return{type:0,element:t,triggerName:e,isRemovalTransition:i,fromState:n,fromStyles:s,toState:r,toStyles:o,timelines:a,queriedElements:u,preStyleProps:l,postStyleProps:h,totalTime:p,errors:m}}const Cb={};class C2{constructor(e,n,r){this._triggerName=e,this.ast=n,this._stateStyles=r}match(e,n,r,i){return function Iee(t,e,n,r,i){return t.some(s=>s(e,n,r,i))}(this.ast.matchers,e,n,r,i)}buildStyles(e,n,r){let i=this._stateStyles.get("*");return void 0!==e&&(i=this._stateStyles.get(e?.toString())||i),i?i.buildStyles(n,r):new Map}build(e,n,r,i,s,o,a,u,l,h){const p=[],m=this.ast.options&&this.ast.options.params||Cb,v=this.buildStyles(r,a&&a.params||Cb,p),I=u&&u.params||Cb,T=this.buildStyles(i,I,p),N=new Set,b=new Map,k=new Map,$="void"===i,ie={params:wee(I,m),delay:this.ast.options?.delay},pe=h?[]:wb(e,n,this.ast.animation,s,o,v,T,ie,l,p);let qe=0;if(pe.forEach(Br=>{qe=Math.max(Br.duration+Br.delay,qe)}),p.length)return T2(n,this._triggerName,r,i,$,v,T,[],[],b,k,qe,p);pe.forEach(Br=>{const Bs=Br.element,_G=is(b,Bs,new Set);Br.preStyleProps.forEach(hd=>_G.add(hd));const Ny=is(k,Bs,new Set);Br.postStyleProps.forEach(hd=>Ny.add(hd)),Bs!==n&&N.add(Bs)});const kt=TI(N.values());return T2(n,this._triggerName,r,i,$,v,T,pe,kt,b,k,qe)}}function wee(t,e){const n=_m(e);for(const r in t)t.hasOwnProperty(r)&&null!=t[r]&&(n[r]=t[r]);return n}class Tee{constructor(e,n,r){this.styles=e,this.defaultParams=n,this.normalizer=r}buildStyles(e,n){const r=new Map,i=_m(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(i[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=vm(o,i,n));const u=this.normalizer.normalizePropertyName(a,n);o=this.normalizer.normalizeStyleValue(a,u,o,n),r.set(a,o)})}),r}}class See{constructor(e,n,r){this.name=e,this.ast=n,this._normalizer=r,this.transitionFactories=[],this.states=new Map,n.states.forEach(i=>{this.states.set(i.name,new Tee(i.style,i.options&&i.options.params||{},r))}),S2(this.states,"true","1"),S2(this.states,"false","0"),n.transitions.forEach(i=>{this.transitionFactories.push(new C2(e,i,this.states))}),this.fallbackTransition=function Dee(t,e,n){return new C2(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,n,r,i){return this.transitionFactories.find(o=>o.match(e,n,r,i))||null}matchStyles(e,n,r){return this.fallbackTransition.buildStyles(e,n,r)}}function S2(t,e,n){t.has(e)?t.has(n)||t.set(n,t.get(e)):t.has(n)&&t.set(e,t.get(n))}const bee=new bI;class Aee{constructor(e,n,r){this.bodyNode=e,this._driver=n,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,n){const r=[],s=vb(this._driver,n,r,[]);if(r.length)throw function MJ(t){return new L(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,n,r){const i=e.element,s=a2(this._normalizer,e.keyframes,n,r);return this._driver.animate(i,s,e.duration,e.delay,e.easing,[],!0)}create(e,n,r={}){const i=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=wb(this._driver,n,s,pb,vI,new Map,new Map,r,bee,i),o.forEach(h=>{const p=is(a,h.element,new Map);h.postStyleProps.forEach(m=>p.set(m,null))})):(i.push(function xJ(){return new L(3300,!1)}()),o=[]),i.length)throw function kJ(t){return new L(3504,!1)}();a.forEach((h,p)=>{h.forEach((m,_)=>{h.set(_,this._driver.computeStyle(p,_,La))})});const l=qu(o.map(h=>{const p=a.get(h.element);return this._buildPlayer(h,new Map,p)}));return this._playersById.set(e,l),l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){const n=this._getPlayer(e);n.destroy(),this._playersById.delete(e);const r=this.players.indexOf(n);r>=0&&this.players.splice(r,1)}_getPlayer(e){const n=this._playersById.get(e);if(!n)throw function OJ(t){return new L(3301,!1)}();return n}listen(e,n,r,i){const s=lb(n,"","","");return ab(this._getPlayer(e),r,s,i),()=>{}}command(e,n,r,i){if("register"==r)return void this.register(e,i[0]);if("create"==r)return void this.create(e,n,i[0]||{});const s=this._getPlayer(e);switch(r){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e)}}}const D2="ng-animate-queued",Sb="ng-animate-disabled",xee=[],b2={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},kee={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ao="__ng_removed";class Db{get params(){return this.options.params}constructor(e,n=""){this.namespaceId=n;const r=e&&e.hasOwnProperty("value");if(this.value=function Vee(t){return t??null}(r?e.value:e),r){const s=_m(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const n=e.params;if(n){const r=this.options.params;Object.keys(n).forEach(i=>{null==r[i]&&(r[i]=n[i])})}}}const Em="void",bb=new Db(Em);class Oee{constructor(e,n,r){this.id=e,this.hostElement=n,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,xs(n,this._hostClassName)}listen(e,n,r,i){if(!this._triggers.has(n))throw function LJ(t,e){return new L(3302,!1)}();if(null==r||0==r.length)throw function FJ(t){return new L(3303,!1)}();if(!function Uee(t){return"start"==t||"done"==t}(r))throw function VJ(t,e){return new L(3400,!1)}();const s=is(this._elementListeners,e,[]),o={name:n,phase:r,callback:i};s.push(o);const a=is(this._engine.statesByElement,e,new Map);return a.has(n)||(xs(e,EI),xs(e,EI+"-"+n),a.set(n,bb)),()=>{this._engine.afterFlush(()=>{const u=s.indexOf(o);u>=0&&s.splice(u,1),this._triggers.has(n)||a.delete(n)})}}register(e,n){return!this._triggers.has(e)&&(this._triggers.set(e,n),!0)}_getTrigger(e){const n=this._triggers.get(e);if(!n)throw function UJ(t){return new L(3401,!1)}();return n}trigger(e,n,r,i=!0){const s=this._getTrigger(n),o=new Ab(this.id,n,e);let a=this._engine.statesByElement.get(e);a||(xs(e,EI),xs(e,EI+"-"+n),this._engine.statesByElement.set(e,a=new Map));let u=a.get(n);const l=new Db(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&u&&l.absorbOptions(u.options),a.set(n,l),u||(u=bb),l.value!==Em&&u.value===l.value){if(!function $ee(t,e){const n=Object.keys(t),r=Object.keys(e);if(n.length!=r.length)return!1;for(let i=0;i<n.length;i++){const s=n[i];if(!e.hasOwnProperty(s)||t[s]!==e[s])return!1}return!0}(u.params,l.params)){const I=[],T=s.matchStyles(u.value,u.params,I),N=s.matchStyles(l.value,l.params,I);I.length?this._engine.reportError(I):this._engine.afterFlush(()=>{Cc(e,T),Bo(e,N)})}return}const m=is(this._engine.playersByElement,e,[]);m.forEach(I=>{I.namespaceId==this.id&&I.triggerName==n&&I.queued&&I.destroy()});let _=s.matchTransition(u.value,l.value,e,l.params),v=!1;if(!_){if(!i)return;_=s.fallbackTransition,v=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:n,transition:_,fromState:u,toState:l,player:o,isFallbackTransition:v}),v||(xs(e,D2),o.onStart(()=>{jh(e,D2)})),o.onDone(()=>{let I=this.players.indexOf(o);I>=0&&this.players.splice(I,1);const T=this._engine.playersByElement.get(e);if(T){let N=T.indexOf(o);N>=0&&T.splice(N,1)}}),this.players.push(o),m.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(n=>n.delete(e)),this._elementListeners.forEach((n,r)=>{this._elementListeners.set(r,n.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const n=this._engine.playersByElement.get(e);n&&(n.forEach(r=>r.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,n){const r=this._engine.driver.query(e,II,!0);r.forEach(i=>{if(i[ao])return;const s=this._engine.fetchNamespacesByElement(i);s.size?s.forEach(o=>o.triggerLeaveAnimation(i,n,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,n,r,i){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((u,l)=>{if(o.set(l,u.value),this._triggers.has(l)){const h=this.trigger(e,l,Em,i);h&&a.push(h)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,n,o),r&&qu(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const n=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(n&&r){const i=new Set;n.forEach(s=>{const o=s.name;if(i.has(o))return;i.add(o);const u=this._triggers.get(o).fallbackTransition,l=r.get(o)||bb,h=new Db(Em),p=new Ab(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:u,fromState:l,toState:h,player:p,isFallbackTransition:!0})})}}removeNode(e,n){const r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,n),this.triggerLeaveAnimation(e,n,!0))return;let i=!1;if(r.totalAnimations){const s=r.players.length?r.playersByQueriedElement.get(e):[];if(s&&s.length)i=!0;else{let o=e;for(;o=o.parentNode;)if(r.statesByElement.get(o)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,n);else{const s=e[ao];(!s||s===b2)&&(r.afterFlush(()=>this.clearElementCache(e)),r.destroyInnerAnimations(e),r._onRemovalComplete(e,n))}}insertNode(e,n){xs(e,this._hostClassName)}drainQueuedTransitions(e){const n=[];return this._queue.forEach(r=>{const i=r.player;if(i.destroyed)return;const s=r.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==r.triggerName){const u=lb(s,r.triggerName,r.fromState.value,r.toState.value);u._data=e,ab(r.player,a.phase,u,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):n.push(r)}),this._queue=[],n.sort((r,i)=>{const s=r.transition.ast.depCount,o=i.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(r.element,i.element)?1:-1})}destroy(e){this.players.forEach(n=>n.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class Lee{_onRemovalComplete(e,n){this.onRemovalComplete(e,n)}constructor(e,n,r){this.bodyNode=e,this.driver=n,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(n=>{n.players.forEach(r=>{r.queued&&e.push(r)})}),e}createNamespace(e,n){const r=new Oee(e,n,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,n)?this._balanceNamespaceList(r,n):(this.newHostElements.set(n,r),this.collectEnterElement(n)),this._namespaceLookup[e]=r}_balanceNamespaceList(e,n){const r=this._namespaceList,i=this.namespacesByHostElement;if(r.length-1>=0){let o=!1,a=this.driver.getParentElement(n);for(;a;){const u=i.get(a);if(u){const l=r.indexOf(u);r.splice(l+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||r.unshift(e)}else r.push(e);return i.set(n,e),e}register(e,n){let r=this._namespaceLookup[e];return r||(r=this.createNamespace(e,n)),r}registerTrigger(e,n,r){let i=this._namespaceLookup[e];i&&i.register(n,r)&&this.totalAnimations++}destroy(e,n){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const r=this._fetchNamespace(e);this.namespacesByHostElement.delete(r.hostElement);const i=this._namespaceList.indexOf(r);i>=0&&this._namespaceList.splice(i,1),r.destroy(n),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const n=new Set,r=this.statesByElement.get(e);if(r)for(let i of r.values())if(i.namespaceId){const s=this._fetchNamespace(i.namespaceId);s&&n.add(s)}return n}trigger(e,n,r,i){if(PI(n)){const s=this._fetchNamespace(e);if(s)return s.trigger(n,r,i),!0}return!1}insertNode(e,n,r,i){if(!PI(n))return;const s=n[ao];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(n);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(n,r)}i&&this.collectEnterElement(n)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,n){n?this.disabledNodes.has(e)||(this.disabledNodes.add(e),xs(e,Sb)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),jh(e,Sb))}removeNode(e,n,r){if(PI(n)){const i=e?this._fetchNamespace(e):null;i?i.removeNode(n,r):this.markElementAsRemoved(e,n,!1,r);const s=this.namespacesByHostElement.get(n);s&&s.id!==e&&s.removeNode(n,r)}else this._onRemovalComplete(n,r)}markElementAsRemoved(e,n,r,i,s){this.collectedLeaveElements.push(n),n[ao]={namespaceId:e,setForRemoval:i,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,n,r,i,s){return PI(n)?this._fetchNamespace(e).listen(n,r,i,s):()=>{}}_buildInstruction(e,n,r,i,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,r,i,e.fromState.options,e.toState.options,n,s)}destroyInnerAnimations(e){let n=this.driver.query(e,II,!0);n.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(n=this.driver.query(e,gb,!0),n.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(e){const n=this.playersByElement.get(e);n&&n.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(e){const n=this.playersByQueriedElement.get(e);n&&n.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return qu(this.players).onDone(()=>e());e()})}processLeaveNode(e){const n=e[ao];if(n&&n.setForRemoval){if(e[ao]=b2,n.namespaceId){this.destroyInnerAnimations(e);const r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}e.classList?.contains(Sb)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(e=-1){let n=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,i)=>this._balanceNamespaceList(r,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)xs(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{n=this._flushAnimations(r,e)}finally{for(let i=0;i<r.length;i++)r[i]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],n.length?qu(n).onDone(()=>{r.forEach(i=>i())}):r.forEach(i=>i())}}reportError(e){throw function BJ(t){return new L(3402,!1)}()}_flushAnimations(e,n){const r=new bI,i=[],s=new Map,o=[],a=new Map,u=new Map,l=new Map,h=new Set;this.disabledNodes.forEach(Ce=>{h.add(Ce);const Ne=this.driver.query(Ce,".ng-animate-queued",!0);for(let Ve=0;Ve<Ne.length;Ve++)h.add(Ne[Ve])});const p=this.bodyNode,m=Array.from(this.statesByElement.keys()),_=P2(m,this.collectedEnterElements),v=new Map;let I=0;_.forEach((Ce,Ne)=>{const Ve=pb+I++;v.set(Ne,Ve),Ce.forEach(wt=>xs(wt,Ve))});const T=[],N=new Set,b=new Set;for(let Ce=0;Ce<this.collectedLeaveElements.length;Ce++){const Ne=this.collectedLeaveElements[Ce],Ve=Ne[ao];Ve&&Ve.setForRemoval&&(T.push(Ne),N.add(Ne),Ve.hasAnimation?this.driver.query(Ne,".ng-star-inserted",!0).forEach(wt=>N.add(wt)):b.add(Ne))}const k=new Map,$=P2(m,Array.from(N));$.forEach((Ce,Ne)=>{const Ve=vI+I++;k.set(Ne,Ve),Ce.forEach(wt=>xs(wt,Ve))}),e.push(()=>{_.forEach((Ce,Ne)=>{const Ve=v.get(Ne);Ce.forEach(wt=>jh(wt,Ve))}),$.forEach((Ce,Ne)=>{const Ve=k.get(Ne);Ce.forEach(wt=>jh(wt,Ve))}),T.forEach(Ce=>{this.processLeaveNode(Ce)})});const ie=[],pe=[];for(let Ce=this._namespaceList.length-1;Ce>=0;Ce--)this._namespaceList[Ce].drainQueuedTransitions(n).forEach(Ve=>{const wt=Ve.player,Dr=Ve.element;if(ie.push(wt),this.collectedEnterElements.length){const ai=Dr[ao];if(ai&&ai.setForMove){if(ai.previousTriggersValues&&ai.previousTriggersValues.has(Ve.triggerName)){const fd=ai.previousTriggersValues.get(Ve.triggerName),js=this.statesByElement.get(Ve.element);if(js&&js.has(Ve.triggerName)){const hC=js.get(Ve.triggerName);hC.value=fd,js.set(Ve.triggerName,hC)}}return void wt.destroy()}}const ua=!p||!this.driver.containsElement(p,Dr),ps=k.get(Dr),Rl=v.get(Dr),An=this._buildInstruction(Ve,r,Rl,ps,ua);if(An.errors&&An.errors.length)return void pe.push(An);if(ua)return wt.onStart(()=>Cc(Dr,An.fromStyles)),wt.onDestroy(()=>Bo(Dr,An.toStyles)),void i.push(wt);if(Ve.isFallbackTransition)return wt.onStart(()=>Cc(Dr,An.fromStyles)),wt.onDestroy(()=>Bo(Dr,An.toStyles)),void i.push(wt);const EG=[];An.timelines.forEach(ai=>{ai.stretchStartingKeyframe=!0,this.disabledNodes.has(ai.element)||EG.push(ai)}),An.timelines=EG,r.append(Dr,An.timelines),o.push({instruction:An,player:wt,element:Dr}),An.queriedElements.forEach(ai=>is(a,ai,[]).push(wt)),An.preStyleProps.forEach((ai,fd)=>{if(ai.size){let js=u.get(fd);js||u.set(fd,js=new Set),ai.forEach((hC,QM)=>js.add(QM))}}),An.postStyleProps.forEach((ai,fd)=>{let js=l.get(fd);js||l.set(fd,js=new Set),ai.forEach((hC,QM)=>js.add(QM))})});if(pe.length){const Ce=[];pe.forEach(Ne=>{Ce.push(function jJ(t,e){return new L(3505,!1)}())}),ie.forEach(Ne=>Ne.destroy()),this.reportError(Ce)}const qe=new Map,kt=new Map;o.forEach(Ce=>{const Ne=Ce.element;r.has(Ne)&&(kt.set(Ne,Ne),this._beforeAnimationBuild(Ce.player.namespaceId,Ce.instruction,qe))}),i.forEach(Ce=>{const Ne=Ce.element;this._getPreviousPlayers(Ne,!1,Ce.namespaceId,Ce.triggerName,null).forEach(wt=>{is(qe,Ne,[]).push(wt),wt.destroy()})});const Br=T.filter(Ce=>M2(Ce,u,l)),Bs=new Map;R2(Bs,this.driver,b,l,La).forEach(Ce=>{M2(Ce,u,l)&&Br.push(Ce)});const Ny=new Map;_.forEach((Ce,Ne)=>{R2(Ny,this.driver,new Set(Ce),u,"!")}),Br.forEach(Ce=>{const Ne=Bs.get(Ce),Ve=Ny.get(Ce);Bs.set(Ce,new Map([...Ne?.entries()??[],...Ve?.entries()??[]]))});const hd=[],yG=[],vG={};o.forEach(Ce=>{const{element:Ne,player:Ve,instruction:wt}=Ce;if(r.has(Ne)){if(h.has(Ne))return Ve.onDestroy(()=>Bo(Ne,wt.toStyles)),Ve.disabled=!0,Ve.overrideTotalTime(wt.totalTime),void i.push(Ve);let Dr=vG;if(kt.size>1){let ps=Ne;const Rl=[];for(;ps=ps.parentNode;){const An=kt.get(ps);if(An){Dr=An;break}Rl.push(ps)}Rl.forEach(An=>kt.set(An,Dr))}const ua=this._buildAnimation(Ve.namespaceId,wt,qe,s,Ny,Bs);if(Ve.setRealPlayer(ua),Dr===vG)hd.push(Ve);else{const ps=this.playersByElement.get(Dr);ps&&ps.length&&(Ve.parentPlayer=qu(ps)),i.push(Ve)}}else Cc(Ne,wt.fromStyles),Ve.onDestroy(()=>Bo(Ne,wt.toStyles)),yG.push(Ve),h.has(Ne)&&i.push(Ve)}),yG.forEach(Ce=>{const Ne=s.get(Ce.element);if(Ne&&Ne.length){const Ve=qu(Ne);Ce.setRealPlayer(Ve)}}),i.forEach(Ce=>{Ce.parentPlayer?Ce.syncPlayerEvents(Ce.parentPlayer):Ce.destroy()});for(let Ce=0;Ce<T.length;Ce++){const Ne=T[Ce],Ve=Ne[ao];if(jh(Ne,vI),Ve&&Ve.hasAnimation)continue;let wt=[];if(a.size){let ua=a.get(Ne);ua&&ua.length&&wt.push(...ua);let ps=this.driver.query(Ne,gb,!0);for(let Rl=0;Rl<ps.length;Rl++){let An=a.get(ps[Rl]);An&&An.length&&wt.push(...An)}}const Dr=wt.filter(ua=>!ua.destroyed);Dr.length?Bee(this,Ne,Dr):this.processLeaveNode(Ne)}return T.length=0,hd.forEach(Ce=>{this.players.push(Ce),Ce.onDone(()=>{Ce.destroy();const Ne=this.players.indexOf(Ce);this.players.splice(Ne,1)}),Ce.play()}),hd}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,n,r,i,s){let o=[];if(n){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const u=!s||s==Em;a.forEach(l=>{l.queued||!u&&l.triggerName!=i||o.push(l)})}}return(r||i)&&(o=o.filter(a=>!(r&&r!=a.namespaceId||i&&i!=a.triggerName))),o}_beforeAnimationBuild(e,n,r){const s=n.element,o=n.isRemovalTransition?void 0:e,a=n.isRemovalTransition?void 0:n.triggerName;for(const u of n.timelines){const l=u.element,h=l!==s,p=is(r,l,[]);this._getPreviousPlayers(l,h,o,a,n.toState).forEach(_=>{const v=_.getRealPlayer();v.beforeDestroy&&v.beforeDestroy(),_.destroy(),p.push(_)})}Cc(s,n.fromStyles)}_buildAnimation(e,n,r,i,s,o){const a=n.triggerName,u=n.element,l=[],h=new Set,p=new Set,m=n.timelines.map(v=>{const I=v.element;h.add(I);const T=I[ao];if(T&&T.removedBeforeQueried)return new mm(v.duration,v.delay);const N=I!==u,b=function jee(t){const e=[];return N2(t,e),e}((r.get(I)||xee).map(qe=>qe.getRealPlayer())).filter(qe=>!!qe.element&&qe.element===I),k=s.get(I),$=o.get(I),ie=a2(this._normalizer,v.keyframes,k,$),pe=this._buildPlayer(v,ie,b);if(v.subTimeline&&i&&p.add(I),N){const qe=new Ab(e,a,I);qe.setRealPlayer(pe),l.push(qe)}return pe});l.forEach(v=>{is(this.playersByQueriedElement,v.element,[]).push(v),v.onDone(()=>function Fee(t,e,n){let r=t.get(e);if(r){if(r.length){const i=r.indexOf(n);r.splice(i,1)}0==r.length&&t.delete(e)}return r}(this.playersByQueriedElement,v.element,v))}),h.forEach(v=>xs(v,f2));const _=qu(m);return _.onDestroy(()=>{h.forEach(v=>jh(v,f2)),Bo(u,n.toStyles)}),p.forEach(v=>{is(i,v,[]).push(_)}),_}_buildPlayer(e,n,r){return n.length>0?this.driver.animate(e.element,n,e.duration,e.delay,e.easing,r):new mm(e.duration,e.delay)}}class Ab{constructor(e,n,r){this.namespaceId=e,this.triggerName=n,this.element=r,this._player=new mm,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((n,r)=>{n.forEach(i=>ab(e,r,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const n=this._player;n.triggerCallback&&e.onStart(()=>n.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,n){is(this._queuedCallbacks,e,[]).push(n)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const n=this._player;n.triggerCallback&&n.triggerCallback(e)}}function PI(t){return t&&1===t.nodeType}function A2(t,e){const n=t.style.display;return t.style.display=e??"none",n}function R2(t,e,n,r,i){const s=[];n.forEach(u=>s.push(A2(u)));const o=[];r.forEach((u,l)=>{const h=new Map;u.forEach(p=>{const m=e.computeStyle(l,p,i);h.set(p,m),(!m||0==m.length)&&(l[ao]=kee,o.push(l))}),t.set(l,h)});let a=0;return n.forEach(u=>A2(u,s[a++])),o}function P2(t,e){const n=new Map;if(t.forEach(a=>n.set(a,[])),0==e.length)return n;const i=new Set(e),s=new Map;function o(a){if(!a)return 1;let u=s.get(a);if(u)return u;const l=a.parentNode;return u=n.has(l)?l:i.has(l)?1:o(l),s.set(a,u),u}return e.forEach(a=>{const u=o(a);1!==u&&n.get(u).push(a)}),n}function xs(t,e){t.classList?.add(e)}function jh(t,e){t.classList?.remove(e)}function Bee(t,e,n){qu(n).onDone(()=>t.processLeaveNode(e))}function N2(t,e){for(let n=0;n<t.length;n++){const r=t[n];r instanceof s2?N2(r.players,e):e.push(r)}}function M2(t,e,n){const r=n.get(t);if(!r)return!1;let i=e.get(t);return i?r.forEach(s=>i.add(s)):e.set(t,r),n.delete(t),!0}class Im{constructor(e,n,r){this._driver=n,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(i,s)=>{},this._transitionEngine=new Lee(e.body,n,r),this._timelineEngine=new Aee(e.body,n,r),this._transitionEngine.onRemovalComplete=(i,s)=>this.onRemovalComplete(i,s)}registerTrigger(e,n,r,i,s){const o=e+"-"+i;let a=this._triggerCache[o];if(!a){const u=[],h=vb(this._driver,s,u,[]);if(u.length)throw function PJ(t,e){return new L(3404,!1)}();a=function Cee(t,e,n){return new See(t,e,n)}(i,h,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(n,i,a)}register(e,n){this._transitionEngine.register(e,n)}destroy(e,n){this._transitionEngine.destroy(e,n)}onInsert(e,n,r,i){this._transitionEngine.insertNode(e,n,r,i)}onRemove(e,n,r){this._transitionEngine.removeNode(e,n,r)}disableAnimations(e,n){this._transitionEngine.markElementAsDisabled(e,n)}process(e,n,r,i){if("@"==r.charAt(0)){const[s,o]=u2(r);this._timelineEngine.command(s,n,o,i)}else this._transitionEngine.trigger(e,n,r,i)}listen(e,n,r,i,s){if("@"==r.charAt(0)){const[o,a]=u2(r);return this._timelineEngine.listen(o,n,a,s)}return this._transitionEngine.listen(e,n,r,i,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let zee=(()=>{class t{static#e=this.initialStylesByElement=new WeakMap;constructor(n,r,i){this._element=n,this._startStyles=r,this._endStyles=i,this._state=0;let s=t.initialStylesByElement.get(n);s||t.initialStylesByElement.set(n,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&Bo(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Bo(this._element,this._initialStyles),this._endStyles&&(Bo(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(Cc(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Cc(this._element,this._endStyles),this._endStyles=null),Bo(this._element,this._initialStyles),this._state=3)}}return t})();function Rb(t){let e=null;return t.forEach((n,r)=>{(function qee(t){return"display"===t||"position"===t})(r)&&(e=e||new Map,e.set(r,n))}),e}class x2{constructor(e,n,r,i){this.element=e,this.keyframes=n,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;const n=()=>this._onFinish();this.domPlayer.addEventListener("finish",n),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",n)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const n=[];return e.forEach(r=>{n.push(Object.fromEntries(r))}),n}_triggerWebAnimation(e,n,r){return e.animate(this._convertKeyframesToObject(n),r)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,i)=>{"offset"!==i&&e.set(i,this._finished?r:_2(this.element,i))}),this.currentSnapshot=e}triggerCallback(e){const n="start"===e?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}}class k2{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,n){return!1}containsElement(e,n){return c2(e,n)}getParentElement(e){return cb(e)}query(e,n,r){return d2(e,n,r)}computeStyle(e,n,r){return window.getComputedStyle(e)[n]}animate(e,n,r,i,s,o=[]){const u={duration:r,delay:i,fill:0==i?"both":"forwards"};s&&(u.easing=s);const l=new Map,h=o.filter(_=>_ instanceof x2);(function eee(t,e){return 0===t||0===e})(r,i)&&h.forEach(_=>{_.currentSnapshot.forEach((v,I)=>l.set(I,v))});let p=function YJ(t){return t.length?t[0]instanceof Map?t:t.map(e=>p2(e)):[]}(n).map(_=>Wu(_));p=function tee(t,e,n){if(n.size&&e.length){let r=e[0],i=[];if(n.forEach((s,o)=>{r.has(o)||i.push(o),r.set(o,s)}),i.length)for(let s=1;s<e.length;s++){let o=e[s];i.forEach(a=>o.set(a,_2(t,a)))}}return e}(e,p,l);const m=function Hee(t,e){let n=null,r=null;return Array.isArray(e)&&e.length?(n=Rb(e[0]),e.length>1&&(r=Rb(e[e.length-1]))):e instanceof Map&&(n=Rb(e)),n||r?new zee(t,n,r):null}(e,p);return new x2(e,p,u,m)}}const O2="@.disabled";class L2{constructor(e,n,r,i){this.namespaceId=e,this.delegate=n,this.engine=r,this._onDestroy=i,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,n){return this.delegate.createElement(e,n)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,n){this.delegate.appendChild(e,n),this.engine.onInsert(this.namespaceId,n,e,!1)}insertBefore(e,n,r,i=!0){this.delegate.insertBefore(e,n,r),this.engine.onInsert(this.namespaceId,n,e,i)}removeChild(e,n,r){this.engine.onRemove(this.namespaceId,n,this.delegate)}selectRootElement(e,n){return this.delegate.selectRootElement(e,n)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,n,r,i){this.delegate.setAttribute(e,n,r,i)}removeAttribute(e,n,r){this.delegate.removeAttribute(e,n,r)}addClass(e,n){this.delegate.addClass(e,n)}removeClass(e,n){this.delegate.removeClass(e,n)}setStyle(e,n,r,i){this.delegate.setStyle(e,n,r,i)}removeStyle(e,n,r){this.delegate.removeStyle(e,n,r)}setProperty(e,n,r){"@"==n.charAt(0)&&n==O2?this.disableAnimations(e,!!r):this.delegate.setProperty(e,n,r)}setValue(e,n){this.delegate.setValue(e,n)}listen(e,n,r){return this.delegate.listen(e,n,r)}disableAnimations(e,n){this.engine.disableAnimations(e,n)}}class Wee extends L2{constructor(e,n,r,i,s){super(n,r,i,s),this.factory=e,this.namespaceId=n}setProperty(e,n,r){"@"==n.charAt(0)?"."==n.charAt(1)&&n==O2?this.disableAnimations(e,r=void 0===r||!!r):this.engine.process(this.namespaceId,e,n.slice(1),r):this.delegate.setProperty(e,n,r)}listen(e,n,r){if("@"==n.charAt(0)){const i=function Gee(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(e);let s=n.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function Kee(t){const e=t.indexOf(".");return[t.substring(0,e),t.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,i,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,r,a)})}return this.delegate.listen(e,n,r)}}class Zee{constructor(e,n,r){this.delegate=e,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,n.onRemovalComplete=(i,s)=>{const o=s?.parentNode(i);o&&s.removeChild(o,i)}}createRenderer(e,n){const i=this.delegate.createRenderer(e,n);if(!e||!n?.data?.animation){const l=this._rendererCache;let h=l.get(i);return h||(h=new L2("",i,this.engine,()=>l.delete(i)),l.set(i,h)),h}const s=n.id,o=n.id+"-"+this._currentId;this._currentId++,this.engine.register(o,e);const a=l=>{Array.isArray(l)?l.forEach(a):this.engine.registerTrigger(s,o,e,l.name,l)};return n.data.animation.forEach(a),new Wee(this,o,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,n,r){if(e>=0&&e<this._microtaskId)return void this._zone.run(()=>n(r));const i=this._animationCallbacksBuffer;0==i.length&&queueMicrotask(()=>{this._zone.run(()=>{i.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),i.push([n,r])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}let Qee=(()=>{class t extends Im{constructor(n,r,i,s){super(n,r,i)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(r){return new(r||t)(K(Li),K(hb),K(fb),K(Ec))};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac})}return t})();const F2=[{provide:fb,useFactory:function Yee(){return new y2}},{provide:Im,useClass:Qee},{provide:Y0,useFactory:function Xee(t,e,n){return new Zee(t,e,n)},deps:[nb,Im,ht]}],Pb=[{provide:hb,useFactory:()=>new k2},{provide:Rx,useValue:"BrowserAnimations"},...F2],V2=[{provide:hb,useClass:db},{provide:Rx,useValue:"NoopAnimations"},...F2];let Jee=(()=>{class t{static withConfig(n){return{ngModule:t,providers:n.disableAnimations?V2:Pb}}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=_r({type:t});static#n=this.\u0275inj=Ar({providers:Pb,imports:[JV]})}return t})();var $h=We(582);const U2=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function B2(t){return xe(t?.then)}function j2(t){return xe(t[zi])}function $2(t){return Symbol.asyncIterator&&xe(t?.[Symbol.asyncIterator])}function H2(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const z2=function tte(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function q2(t){return xe(t?.[z2])}function W2(t){return(0,$h.FC)(this,arguments,function*(){const n=t.getReader();try{for(;;){const{value:r,done:i}=yield(0,$h.qq)(n.read());if(i)return yield(0,$h.qq)(void 0);yield yield(0,$h.qq)(r)}}finally{n.releaseLock()}})}function G2(t){return xe(t?.getReader)}function os(t){if(t instanceof qt)return t;if(null!=t){if(j2(t))return function nte(t){return new qt(e=>{const n=t[zi]();if(xe(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(U2(t))return function rte(t){return new qt(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}(t);if(B2(t))return function ite(t){return new qt(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,tu)})}(t);if($2(t))return K2(t);if(q2(t))return function ste(t){return new qt(e=>{for(const n of t)if(e.next(n),e.closed)return;e.complete()})}(t);if(G2(t))return function ote(t){return K2(W2(t))}(t)}throw H2(t)}function K2(t){return new qt(e=>{(function ate(t,e){var n,r,i,s;return(0,$h.mG)(this,void 0,void 0,function*(){try{for(n=(0,$h.KL)(t);!(r=yield n.next()).done;)if(e.next(r.value),e.closed)return}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})})(t,e).catch(n=>e.error(n))})}function Va(t,e,n,r=0,i=!1){const s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function Gu(t,e=0){return ge((n,r)=>{n.subscribe(Te(r,i=>Va(r,t,()=>r.next(i),e),()=>Va(r,t,()=>r.complete(),e),i=>Va(r,t,()=>r.error(i),e)))})}function Hh(t,e=0){return ge((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function Z2(t,e){if(!t)throw new Error("Iterable cannot be null");return new qt(n=>{Va(n,e,()=>{const r=t[Symbol.asyncIterator]();Va(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function jt(t,e){return e?function fte(t,e){if(null!=t){if(j2(t))return function ute(t,e){return os(t).pipe(Hh(e),Gu(e))}(t,e);if(U2(t))return function cte(t,e){return new qt(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}(t,e);if(B2(t))return function lte(t,e){return os(t).pipe(Hh(e),Gu(e))}(t,e);if($2(t))return Z2(t,e);if(q2(t))return function dte(t,e){return new qt(n=>{let r;return Va(n,e,()=>{r=t[z2](),Va(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){return void n.error(o)}s?n.complete():n.next(i)},0,!0)}),()=>xe(r?.return)&&r.return()})}(t,e);if(G2(t))return function hte(t,e){return Z2(W2(t),e)}(t,e)}throw H2(t)}(t,e):os(t)}function Nb(t){return t[t.length-1]}function Q2(t){return xe(Nb(t))?t.pop():void 0}function wm(t){return function pte(t){return t&&xe(t.schedule)}(Nb(t))?t.pop():void 0}function Re(...t){return jt(t,wm(t))}const{isArray:mte}=Array,{getPrototypeOf:_te,prototype:yte,keys:vte}=Object;const{isArray:wte}=Array;function Mb(...t){const e=wm(t),n=Q2(t),{args:r,keys:i}=function Ete(t){if(1===t.length){const e=t[0];if(mte(e))return{args:e,keys:null};if(function Ite(t){return t&&"object"==typeof t&&_te(t)===yte}(e)){const n=vte(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}(t);if(0===r.length)return jt([],e);const s=new qt(function Dte(t,e,n=or){return r=>{Y2(e,()=>{const{length:i}=t,s=new Array(i);let o=i,a=i;for(let u=0;u<i;u++)Y2(e,()=>{const l=jt(t[u],e);let h=!1;l.subscribe(Te(r,p=>{s[u]=p,h||(h=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,e,i?o=>function Ste(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}(i,o):or));return n?s.pipe(function Cte(t){return fe(e=>function Tte(t,e){return wte(e)?t(...e):t(e)}(t,e))}(n)):s}function Y2(t,e,n){t?Va(n,t,e):e()}const MI=Wn(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function Jr(t,e,n=1/0){return xe(e)?Jr((r,i)=>fe((s,o)=>e(r,s,i,o))(os(t(r,i))),n):("number"==typeof e&&(n=e),ge((r,i)=>function bte(t,e,n,r,i,s,o,a){const u=[];let l=0,h=0,p=!1;const m=()=>{p&&!u.length&&!l&&e.complete()},_=I=>l<r?v(I):u.push(I),v=I=>{s&&e.next(I),l++;let T=!1;os(n(I,h++)).subscribe(Te(e,N=>{i?.(N),s?_(N):e.next(N)},()=>{T=!0},void 0,()=>{if(T)try{for(l--;u.length&&l<r;){const N=u.shift();o?Va(e,o,()=>v(N)):v(N)}m()}catch(N){e.error(N)}}))};return t.subscribe(Te(e,_,()=>{p=!0,m()})),()=>{a?.()}}(r,i,t,n)))}function zh(t=1/0){return Jr(or,t)}function xb(...t){return function Ate(){return zh(1)}()(jt(t,wm(t)))}function X2(t){return new qt(e=>{os(t()).subscribe(e)})}function xI(t,e){const n=xe(t)?t:()=>t,r=i=>i.error(n());return new qt(e?i=>e.schedule(r,0,i):r)}const jo=new qt(t=>t.complete());function kb(){return ge((t,e)=>{let n=null;t._refCount++;const r=Te(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(n=null);const i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}class J2 extends qt{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,he(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Pt;const n=this.getSubject();e.add(this.source.subscribe(Te(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Pt.EMPTY)}return e}refCount(){return kb()(this)}}function $n(t,e){return ge((n,r)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&r.complete();n.subscribe(Te(r,u=>{i?.unsubscribe();let l=0;const h=s++;os(t(u,h)).subscribe(i=Te(r,p=>r.next(e?e(u,p,h,l++):p),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function qh(t){return t<=0?()=>jo:ge((e,n)=>{let r=0;e.subscribe(Te(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function kI(...t){const e=wm(t);return ge((n,r)=>{(e?xb(t,n,e):xb(t,n)).subscribe(r)})}function uo(t,e){return ge((n,r)=>{let i=0;n.subscribe(Te(r,s=>t.call(e,s,i++)&&r.next(s)))})}function OI(t){return ge((e,n)=>{let r=!1;e.subscribe(Te(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function eU(t=Pte){return ge((e,n)=>{let r=!1;e.subscribe(Te(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function Pte(){return new MI}function Ku(t,e){const n=arguments.length>=2;return r=>r.pipe(t?uo((i,s)=>t(i,s,r)):or,qh(1),n?OI(e):eU(()=>new MI))}function Tm(t,e){return xe(e)?Jr(t,e,1):Jr(t,1)}function xr(t,e,n){const r=xe(t)||e||n?{next:t,error:e,complete:n}:t;return r?ge((i,s)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let a=!0;i.subscribe(Te(s,u=>{var l;null===(l=r.next)||void 0===l||l.call(r,u),s.next(u)},()=>{var u;a=!1,null===(u=r.complete)||void 0===u||u.call(r),s.complete()},u=>{var l;a=!1,null===(l=r.error)||void 0===l||l.call(r,u),s.error(u)},()=>{var u,l;a&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(l=r.finalize)||void 0===l||l.call(r)}))}):or}function Wh(t){return ge((e,n)=>{let s,r=null,i=!1;r=e.subscribe(Te(n,void 0,void 0,o=>{s=os(t(o,Wh(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function Gh(t,e){return ge(function Nte(t,e,n,r,i){return(s,o)=>{let a=n,u=e,l=0;s.subscribe(Te(o,h=>{const p=l++;u=a?t(u,h,p):(a=!0,h),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}(t,e,arguments.length>=2,!0))}function Ob(t){return t<=0?()=>jo:ge((e,n)=>{let r=[];e.subscribe(Te(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(const i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function Lb(t){return ge((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}const tt="primary",Cm=Symbol("RouteTitle");class Ote{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function Kh(t){return new Ote(t)}function Lte(t,e,n){const r=n.path.split("/");if(r.length>t.length||"full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const i={};for(let s=0;s<r.length;s++){const o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function $o(t,e){const n=t?Fb(t):void 0,r=e?Fb(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!tU(t[i],e[i]))return!1;return!0}function Fb(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function tU(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}return t===e}function nU(t){return t.length>0?t[t.length-1]:null}function Zu(t){return function ete(t){return!!t&&(t instanceof qt||xe(t.lift)&&xe(t.subscribe))}(t)?t:$E(t)?jt(Promise.resolve(t)):Re(t)}const Vte={exact:function sU(t,e,n){if(!Dc(t.segments,e.segments)||!LI(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!t.children[r]||!sU(t.children[r],e.children[r],n))return!1;return!0},subset:oU},rU={exact:function Ute(t,e){return $o(t,e)},subset:function Bte(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>tU(t[n],e[n]))},ignored:()=>!0};function iU(t,e,n){return Vte[n.paths](t.root,e.root,n.matrixParams)&&rU[n.queryParams](t.queryParams,e.queryParams)&&!("exact"===n.fragment&&t.fragment!==e.fragment)}function oU(t,e,n){return aU(t,e,e.segments,n)}function aU(t,e,n,r){if(t.segments.length>n.length){const i=t.segments.slice(0,n.length);return!(!Dc(i,n)||e.hasChildren()||!LI(i,n,r))}if(t.segments.length===n.length){if(!Dc(t.segments,n)||!LI(t.segments,n,r))return!1;for(const i in e.children)if(!t.children[i]||!oU(t.children[i],e.children[i],r))return!1;return!0}{const i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!!(Dc(t.segments,i)&&LI(t.segments,i,r)&&t.children[tt])&&aU(t.children[tt],e,s,r)}}function LI(t,e,n){return e.every((r,i)=>rU[n](t[i].parameters,r.parameters))}class Zh{constructor(e=new $t([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Kh(this.queryParams)),this._queryParamMap}toString(){return Hte.serialize(this)}}class $t{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return FI(this)}}class Sm{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=Kh(this.parameters)),this._parameterMap}toString(){return cU(this)}}function Dc(t,e){return t.length===e.length&&t.every((n,r)=>n.path===e[r].path)}let Qh=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:()=>new Vb,providedIn:"root"})}return t})();class Vb{parse(e){const n=new ene(e);return new Zh(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){const n=`/${Dm(e.root,!0)}`,r=function Wte(t){const e=Object.keys(t).map(n=>{const r=t[n];return Array.isArray(r)?r.map(i=>`${VI(n)}=${VI(i)}`).join("&"):`${VI(n)}=${VI(r)}`}).filter(n=>!!n);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${n}${r}${"string"==typeof e.fragment?`#${function zte(t){return encodeURI(t)}(e.fragment)}`:""}`}}const Hte=new Vb;function FI(t){return t.segments.map(e=>cU(e)).join("/")}function Dm(t,e){if(!t.hasChildren())return FI(t);if(e){const n=t.children[tt]?Dm(t.children[tt],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==tt&&r.push(`${i}:${Dm(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=function $te(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===tt&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==tt&&(n=n.concat(e(i,r)))}),n}(t,(r,i)=>i===tt?[Dm(t.children[tt],!1)]:[`${i}:${Dm(r,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[tt]?`${FI(t)}/${n[0]}`:`${FI(t)}/(${n.join("//")})`}}function uU(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function VI(t){return uU(t).replace(/%3B/gi,";")}function Ub(t){return uU(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function UI(t){return decodeURIComponent(t)}function lU(t){return UI(t.replace(/\+/g,"%20"))}function cU(t){return`${Ub(t.path)}${function qte(t){return Object.keys(t).map(e=>`;${Ub(e)}=${Ub(t[e])}`).join("")}(t.parameters)}`}const Gte=/^[^\/()?;#]+/;function Bb(t){const e=t.match(Gte);return e?e[0]:""}const Kte=/^[^\/()?;=#]+/,Qte=/^[^=?&#]+/,Xte=/^[^&#]+/;class ene{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new $t([],{}):new $t([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[tt]=new $t(e,n)),r}parseSegment(){const e=Bb(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new L(4009,!1);return this.capture(e),new Sm(UI(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const n=function Zte(t){const e=t.match(Kte);return e?e[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const i=Bb(this.remaining);i&&(r=i,this.capture(r))}e[UI(n)]=UI(r)}parseQueryParam(e){const n=function Yte(t){const e=t.match(Qte);return e?e[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const o=function Jte(t){const e=t.match(Xte);return e?e[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const i=lU(n),s=lU(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=Bb(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new L(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=tt);const o=this.parseChildren();n[s]=1===Object.keys(o).length?o[tt]:new $t([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new L(4011,!1)}}function dU(t){return t.segments.length>0?new $t([],{[tt]:t}):t}function hU(t){const e={};for(const r of Object.keys(t.children)){const s=hU(t.children[r]);if(r===tt&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}return function tne(t){if(1===t.numberOfChildren&&t.children[tt]){const e=t.children[tt];return new $t(t.segments.concat(e.segments),e.children)}return t}(new $t(t.segments,e))}function bc(t){return t instanceof Zh}function fU(t){let e;const i=dU(function n(s){const o={};for(const u of s.children){const l=n(u);o[u.outlet]=l}const a=new $t(s.url,o);return s===t&&(e=a),a}(t.root));return e??i}function pU(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(0===e.length)return jb(i,i,i,n,r);const s=function rne(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new mU(!0,0,t);let e=0,n=!1;const r=t.reduce((i,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([u,l])=>{a[u]="string"==typeof l?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return"string"!=typeof s?[...i,s]:0===o?(s.split("/").forEach((a,u)=>{0==u&&"."===a||(0==u&&""===a?n=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,s]},[]);return new mU(n,e,r)}(e);if(s.toRoot())return jb(i,i,new $t([],{}),n,r);const o=function ine(t,e,n){if(t.isAbsolute)return new jI(e,!0,0);if(!n)return new jI(e,!1,NaN);if(null===n.parent)return new jI(n,!0,0);const r=BI(t.commands[0])?0:1;return function sne(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new L(4005,!1);i=r.segments.length}return new jI(r,!1,i-s)}(n,n.segments.length-1+r,t.numberOfDoubleDots)}(s,i,t),a=o.processChildren?Am(o.segmentGroup,o.index,s.commands):_U(o.segmentGroup,o.index,s.commands);return jb(i,o.segmentGroup,a,n,r)}function BI(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function bm(t){return"object"==typeof t&&null!=t&&t.outlets}function jb(t,e,n,r,i){let o,s={};r&&Object.entries(r).forEach(([u,l])=>{s[u]=Array.isArray(l)?l.map(h=>`${h}`):`${l}`}),o=t===e?n:gU(t,e,n);const a=dU(hU(o));return new Zh(a,s,i)}function gU(t,e,n){const r={};return Object.entries(t.children).forEach(([i,s])=>{r[i]=s===e?n:gU(s,e,n)}),new $t(t.segments,r)}class mU{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&BI(r[0]))throw new L(4003,!1);const i=r.find(bm);if(i&&i!==nU(r))throw new L(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class jI{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}}function _U(t,e,n){if(t||(t=new $t([],{})),0===t.segments.length&&t.hasChildren())return Am(t,e,n);const r=function ane(t,e,n){let r=0,i=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;const o=t.segments[i],a=n[r];if(bm(a))break;const u=`${a}`,l=r<n.length-1?n[r+1]:null;if(i>0&&void 0===u)break;if(u&&l&&"object"==typeof l&&void 0===l.outlets){if(!vU(u,l,o))return s;r+=2}else{if(!vU(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const s=new $t(t.segments.slice(0,r.pathIndex),{});return s.children[tt]=new $t(t.segments.slice(r.pathIndex),t.children),Am(s,0,i)}return r.match&&0===i.length?new $t(t.segments,{}):r.match&&!t.hasChildren()?$b(t,e,n):r.match?Am(t,0,i):$b(t,e,n)}function Am(t,e,n){if(0===n.length)return new $t(t.segments,{});{const r=function one(t){return bm(t[0])?t[0].outlets:{[tt]:t}}(n),i={};if(Object.keys(r).some(s=>s!==tt)&&t.children[tt]&&1===t.numberOfChildren&&0===t.children[tt].segments.length){const s=Am(t.children[tt],e,n);return new $t(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(i[s]=_U(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{void 0===r[s]&&(i[s]=o)}),new $t(t.segments,i)}}function $b(t,e,n){const r=t.segments.slice(0,e);let i=0;for(;i<n.length;){const s=n[i];if(bm(s)){const u=une(s.outlets);return new $t(r,u)}if(0===i&&BI(n[0])){r.push(new Sm(t.segments[e].path,yU(n[0]))),i++;continue}const o=bm(s)?s.outlets[tt]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&BI(a)?(r.push(new Sm(o,yU(a))),i+=2):(r.push(new Sm(o,{})),i++)}return new $t(r,{})}function une(t){const e={};return Object.entries(t).forEach(([n,r])=>{"string"==typeof r&&(r=[r]),null!==r&&(e[n]=$b(new $t([],{}),0,r))}),e}function yU(t){const e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function vU(t,e,n){return t==n.path&&$o(e,n.parameters)}const Rm="imperative";class Ho{constructor(e,n){this.id=e,this.url=n}}class $I extends Ho{constructor(e,n,r="imperative",i=null){super(e,n),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Ua extends Ho{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Yh extends Ho{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Xh extends Ho{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=16}}class HI extends Ho{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class EU extends Ho{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class lne extends Ho{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class cne extends Ho{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class dne extends Ho{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class hne extends Ho{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class fne{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class pne{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class gne{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class mne{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class _ne{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class yne{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class IU{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Hb{}class zb{constructor(e){this.url=e}}class vne{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Pm,this.attachRef=null}}let Pm=(()=>{class t{constructor(){this.contexts=new Map}onChildOutletCreated(n,r){const i=this.getOrCreateContext(n);i.outlet=r,this.contexts.set(n,i)}onChildOutletDestroyed(n){const r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new vne,this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class wU{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){const n=qb(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){const n=qb(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){const n=Wb(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Wb(e,this._root).map(n=>n.value)}}function qb(t,e){if(t===e.value)return e;for(const n of e.children){const r=qb(t,n);if(r)return r}return null}function Wb(t,e){if(t===e.value)return[e];for(const n of e.children){const r=Wb(t,n);if(r.length)return r.unshift(e),r}return[]}class lo{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}}function Jh(t){const e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}class TU extends wU{constructor(e,n){super(e),this.snapshot=n,Zb(this,e)}toString(){return this.snapshot.toString()}}function CU(t,e){const n=function Ene(t,e){const o=new Kb([],{},{},"",{},tt,e,null,{});return new SU("",new lo(o,[]))}(0,e),r=new x([new Sm("",{})]),i=new x({}),s=new x({}),o=new x({}),a=new x(""),u=new ef(r,i,o,a,s,tt,e,n.root);return u.snapshot=n.root,new TU(new lo(u,[]),n)}class ef{constructor(e,n,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(fe(l=>l[Cm]))??Re(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(fe(e=>Kh(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(fe(e=>Kh(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Gb(t,e,n="emptyOnly"){let r;const{routeConfig:i}=t;return r=null===e||"always"!==n&&""!==i?.path&&(e.component||e.routeConfig?.loadComponent)?{params:{...t.params},data:{...t.data},resolve:{...t.data,...t._resolvedData??{}}}:{params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.data,...i?.data,...t._resolvedData}},i&&bU(i)&&(r.resolve[Cm]=i.title),r}class Kb{get title(){return this.data?.[Cm]}constructor(e,n,r,i,s,o,a,u,l){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Kh(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Kh(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class SU extends wU{constructor(e,n){super(n),this.url=e,Zb(this,n)}toString(){return DU(this._root)}}function Zb(t,e){e.value._routerState=t,e.children.forEach(n=>Zb(t,n))}function DU(t){const e=t.children.length>0?` { ${t.children.map(DU).join(", ")} } `:"";return`${t.value}${e}`}function Qb(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,$o(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),$o(e.params,n.params)||t.paramsSubject.next(n.params),function Fte(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!$o(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.urlSubject.next(n.url),$o(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function Yb(t,e){const n=$o(t.params,e.params)&&function jte(t,e){return Dc(t,e)&&t.every((n,r)=>$o(n.parameters,e[r].parameters))}(t.url,e.url);return n&&!(!t.parent!=!e.parent)&&(!t.parent||Yb(t.parent,e.parent))}function bU(t){return"string"==typeof t.title||null===t.title}let Xb=(()=>{class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=tt,this.activateEvents=new gi,this.deactivateEvents=new gi,this.attachEvents=new gi,this.detachEvents=new gi,this.parentContexts=oe(Pm),this.location=oe(ro),this.changeDetector=oe(IE),this.environmentInjector=oe(Mi),this.inputBinder=oe(zI,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){const{firstChange:r,previousValue:i}=n.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new L(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new L(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new L(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new L(4013,!1);this._activatedRoute=n;const i=this.location,o=n.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,u=new Ine(n,a,i.injector);this.activated=i.createComponent(o,{index:i.length,injector:u,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275dir=Kn({type:t,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Kr]})}return t})();class Ine{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===ef?this.route:e===Pm?this.childContexts:this.parent.get(e,n)}}const zI=new ue("");let AU=(()=>{class t{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){const{activatedRoute:r}=n,i=Mb([r.queryParams,r.params,r.data]).pipe($n(([s,o,a],u)=>(a={...s,...o,...a},0===u?Re(a):Promise.resolve(a)))).subscribe(s=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==r||null===r.component)return void this.unsubscribeFromRouteData(n);const o=function NQ(t){const e=Ye(t);if(!e)return null;const n=new Ug(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(r.component);if(o)for(const{templateName:a}of o.inputs)n.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(n)});this.outletDataSubscriptions.set(n,i)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac})}return t})();function Nm(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=e.value;const i=function Tne(t,e,n){return e.children.map(r=>{for(const i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return Nm(t,r,i);return Nm(t,r)})}(t,e,n);return new lo(r,i)}{if(t.shouldAttach(e.value)){const s=t.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Nm(t,a)),o}}const r=function Cne(t){return new ef(new x(t.url),new x(t.params),new x(t.queryParams),new x(t.fragment),new x(t.data),t.outlet,t.component,t)}(e.value),i=e.children.map(s=>Nm(t,s));return new lo(r,i)}}const Jb="ngNavigationCancelingError";function RU(t,e){const{redirectTo:n,navigationBehaviorOptions:r}=bc(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=PU(!1,0,e);return i.url=n,i.navigationBehaviorOptions=r,i}function PU(t,e,n){const r=new Error("NavigationCancelingError: "+(t||""));return r[Jb]=!0,r.cancellationCode=e,n&&(r.url=n),r}function NU(t){return t&&t[Jb]}let MU=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=Gr({type:t,selectors:[["ng-component"]],standalone:!0,features:[QL],decls:1,vars:0,template:function(r,i){1&r&&io(0,"router-outlet")},dependencies:[Xb],encapsulation:2})}return t})();function eA(t){const e=t.children&&t.children.map(eA),n=e?{...t,children:e}:{...t};return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==tt&&(n.component=MU),n}function zo(t){return t.outlet||tt}function Mm(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){const n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}class Mne{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){const n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),Qb(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){const i=Jh(n);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){const i=e.value,s=n?n.value:null;if(i===s)if(i.component){const o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){const r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Jh(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);if(r&&r.outlet){const o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){const r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Jh(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){const i=Jh(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new yne(s.value.snapshot))}),e.children.length&&this.forwardEvent(new mne(e.value.snapshot))}activateRoutes(e,n,r){const i=e.value,s=n?n.value:null;if(Qb(i),i===s)if(i.component){const o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){const o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Qb(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=Mm(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}}class xU{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class qI{constructor(e,n){this.component=e,this.route=n}}function xne(t,e,n){const r=t._root;return xm(r,e?e._root:null,n,[r.value])}function tf(t,e){const n=Symbol(),r=e.get(t,n);return r===n?"function"!=typeof t||function yC(t){return null!==ou(t)}(t)?e.get(t):t:r}function xm(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=Jh(e);return t.children.forEach(o=>{(function One(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const u=function Lne(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!Dc(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Dc(t.url,e.url)||!$o(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Yb(t,e)||!$o(t.queryParams,e.queryParams);default:return!Yb(t,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new xU(r)):(s.data=o.data,s._resolvedData=o._resolvedData),xm(t,e,s.component?a?a.children:null:n,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new qI(a.outlet.component,o))}else o&&km(e,a,i),i.canActivateChecks.push(new xU(r)),xm(t,null,s.component?a?a.children:null:n,r,i)})(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>km(a,n.getContext(o),i)),i}function km(t,e,n){const r=Jh(t),i=t.value;Object.entries(r).forEach(([s,o])=>{km(o,i.component?e?e.children.getContext(s):null:e,n)}),n.canDeactivateChecks.push(new qI(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function Om(t){return"function"==typeof t}function kU(t){return t instanceof MI||"EmptyError"===t?.name}const WI=Symbol("INITIAL_VALUE");function nf(){return $n(t=>Mb(t.map(e=>e.pipe(qh(1),kI(WI)))).pipe(fe(e=>{for(const n of e)if(!0!==n){if(n===WI)return WI;if(!1===n||n instanceof Zh)return n}return!0}),uo(e=>e!==WI),qh(1)))}function OU(t){return function Io(...t){return ca(t)}(xr(e=>{if(bc(e))throw RU(0,e)}),fe(e=>!0===e))}class tA{constructor(e){this.segmentGroup=e||null}}class nA extends Error{constructor(e){super(),this.urlTree=e}}function rf(t){return xI(new tA(t))}class nre{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return Re(r);if(i.numberOfChildren>1||!i.children[tt])return xI(new L(4e3,!1));i=i.children[tt]}}applyRedirectCommands(e,n,r){const i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new nA(i);return i}applyRedirectCreateUrlTree(e,n,r,i){const s=this.createSegmentGroup(e,n.root,r,i);return new Zh(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){const r={};return Object.entries(e).forEach(([i,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){const s=this.createSegments(e,n.segments,r,i);let o={};return Object.entries(n.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new $t(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){const i=r[n.path.substring(1)];if(!i)throw new L(4001,!1);return i}findOrReturn(e,n){let r=0;for(const i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}}const rA={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function rre(t,e,n,r,i){const s=iA(t,e,n);return s.matched?(r=function Dne(t,e){return t.providers&&!t._injector&&(t._injector=tD(t.providers,e,`Route: ${t.path}`)),t._injector??e}(e,r),function Jne(t,e,n,r){const i=e.canMatch;return i&&0!==i.length?Re(i.map(o=>{const a=tf(o,t);return Zu(function $ne(t){return t&&Om(t.canMatch)}(a)?a.canMatch(e,n):z(t,()=>a(e,n)))})).pipe(nf(),OU()):Re(!0)}(r,e,n).pipe(fe(o=>!0===o?s:{...rA}))):Re(s)}function iA(t,e,n){if("**"===e.path)return function ire(t){return{matched:!0,parameters:t.length>0?nU(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}(n);if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{...rA}:{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const i=(e.matcher||Lte)(n,t,e);if(!i)return{...rA};const s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});const o=i.consumed.length>0?{...s,...i.consumed[i.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function LU(t,e,n,r){return n.length>0&&function are(t,e,n){return n.some(r=>GI(t,e,r)&&zo(r)!==tt)}(t,n,r)?{segmentGroup:new $t(e,ore(r,new $t(n,t.children))),slicedSegments:[]}:0===n.length&&function ure(t,e,n){return n.some(r=>GI(t,e,r))}(t,n,r)?{segmentGroup:new $t(t.segments,sre(t,0,n,r,t.children)),slicedSegments:n}:{segmentGroup:new $t(t.segments,t.children),slicedSegments:n}}function sre(t,e,n,r,i){const s={};for(const o of r)if(GI(t,n,o)&&!i[zo(o)]){const a=new $t([],{});s[zo(o)]=a}return{...i,...s}}function ore(t,e){const n={};n[tt]=e;for(const r of t)if(""===r.path&&zo(r)!==tt){const i=new $t([],{});n[zo(r)]=i}return n}function GI(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path}class dre{}class pre{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new nre(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new L(4002,`'${e.segmentGroup}'`)}recognize(){const e=LU(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(fe(n=>{const r=new Kb([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},tt,this.rootComponentType,null,{}),i=new lo(r,n),s=new SU("",i),o=function nne(t,e,n=null,r=null){return pU(fU(t),e,n,r)}(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,tt).pipe(Wh(r=>{if(r instanceof nA)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof tA?this.noMatchError(r):r}))}inheritParamsAndData(e,n){const r=e.value,i=Gb(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return 0===r.segments.length&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(fe(s=>s instanceof lo?[s]:[]))}processChildren(e,n,r){const i=[];for(const s of Object.keys(r.children))"primary"===s?i.unshift(s):i.push(s);return jt(i).pipe(Tm(s=>{const o=r.children[s],a=function Pne(t,e){const n=t.filter(r=>zo(r)===e);return n.push(...t.filter(r=>zo(r)!==e)),n}(n,s);return this.processSegmentGroup(e,a,o,s)}),Gh((s,o)=>(s.push(...o),s)),OI(null),function Mte(t,e){const n=arguments.length>=2;return r=>r.pipe(t?uo((i,s)=>t(i,s,r)):or,Ob(1),n?OI(e):eU(()=>new MI))}(),Jr(s=>{if(null===s)return rf(r);const o=FU(s);return function gre(t){t.sort((e,n)=>e.value.outlet===tt?-1:n.value.outlet===tt?1:e.value.outlet.localeCompare(n.value.outlet))}(o),Re(o)}))}processSegment(e,n,r,i,s,o){return jt(n).pipe(Tm(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(Wh(u=>{if(u instanceof tA)return Re(null);throw u}))),Ku(a=>!!a),Wh(a=>{if(kU(a))return function cre(t,e,n){return 0===e.length&&!t.children[n]}(r,i,s)?Re(new dre):rf(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return function lre(t,e,n,r){return!!(zo(t)===r||r!==tt&&GI(e,n,t))&&iA(e,t,n).matched}(r,i,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):rf(i):rf(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){const{matched:a,consumedSegments:u,positionalParamSegments:l,remainingSegments:h}=iA(n,i,s);if(!a)return rf(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const p=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,p).pipe(Jr(m=>this.processSegment(e,r,n,m.concat(h),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){const o=rre(n,r,i,e);return"**"===r.path&&(n.children={}),o.pipe($n(a=>a.matched?this.getChildConfig(e=r._injector??e,r,i).pipe($n(({routes:u})=>{const l=r._loadedInjector??e,{consumedSegments:h,remainingSegments:p,parameters:m}=a,_=new Kb(h,m,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,function _re(t){return t.data||{}}(r),zo(r),r.component??r._loadedComponent??null,r,function yre(t){return t.resolve||{}}(r)),{segmentGroup:v,slicedSegments:I}=LU(n,h,p,u);if(0===I.length&&v.hasChildren())return this.processChildren(l,u,v).pipe(fe(N=>null===N?null:new lo(_,N)));if(0===u.length&&0===I.length)return Re(new lo(_,[]));const T=zo(r)===s;return this.processSegment(l,u,v,I,T?tt:s,!0).pipe(fe(N=>new lo(_,N instanceof lo?[N]:[])))})):rf(n)))}getChildConfig(e,n,r){return n.children?Re({routes:n.children,injector:e}):n.loadChildren?void 0!==n._loadedRoutes?Re({routes:n._loadedRoutes,injector:n._loadedInjector}):function Xne(t,e,n,r){const i=e.canLoad;return void 0===i||0===i.length?Re(!0):Re(i.map(o=>{const a=tf(o,t);return Zu(function Vne(t){return t&&Om(t.canLoad)}(a)?a.canLoad(e,n):z(t,()=>a(e,n)))})).pipe(nf(),OU())}(e,n,r).pipe(Jr(i=>i?this.configLoader.loadChildren(e,n).pipe(xr(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):function tre(t){return xI(PU(!1,3))}())):Re({routes:[],injector:e})}}function mre(t){const e=t.value.routeConfig;return e&&""===e.path}function FU(t){const e=[],n=new Set;for(const r of t){if(!mre(r)){e.push(r);continue}const i=e.find(s=>r.value.routeConfig===s.value.routeConfig);void 0!==i?(i.children.push(...r.children),n.add(i)):e.push(r)}for(const r of n){const i=FU(r.children);e.push(new lo(r.value,i))}return e.filter(r=>!n.has(r))}function VU(t){const e=t.children.map(n=>VU(n)).flat();return[t,...e]}function sA(t){return $n(e=>{const n=t(e);return n?jt(n).pipe(fe(()=>e)):Re(e)})}let UU=(()=>{class t{buildTitle(n){let r,i=n.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===tt);return r}getResolvedTitleForRoute(n){return n.data[Cm]}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:()=>oe(Cre),providedIn:"root"})}return t})(),Cre=(()=>{class t extends UU{constructor(n){super(),this.title=n}updateTitle(n){const r=this.buildTitle(n);void 0!==r&&this.title.setTitle(r)}static#e=this.\u0275fac=function(r){return new(r||t)(K(e2))};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const sf=new ue("",{providedIn:"root",factory:()=>({})}),af=new ue("ROUTES");let oA=(()=>{class t{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=oe(xF)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return Re(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const r=Zu(n.loadComponent()).pipe(fe(BU),xr(s=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=s}),Lb(()=>{this.componentLoaders.delete(n)})),i=new J2(r,()=>new P).pipe(kb());return this.componentLoaders.set(n,i),i}loadChildren(n,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Re({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const s=function Sre(t,e,n,r){return Zu(t.loadChildren()).pipe(fe(BU),Jr(i=>i instanceof KL||Array.isArray(i)?Re(i):jt(e.compileModuleAsync(i))),fe(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,!0):(s=i.create(n).injector,o=s.get(af,[],{optional:!0,self:!0}).flat()),{routes:o.map(eA),injector:s}}))}(r,this.compiler,n,this.onLoadEndListener).pipe(Lb(()=>{this.childrenLoaders.delete(r)})),o=new J2(s,()=>new P).pipe(kb());return this.childrenLoaders.set(r,o),o}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function BU(t){return function Dre(t){return t&&"object"==typeof t&&"default"in t}(t)?t.default:t}let aA=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:()=>oe(bre),providedIn:"root"})}return t})(),bre=(()=>{class t{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,r){return n}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const jU=new ue(""),$U=new ue("");function Are(t,e,n){const r=t.get($U),i=t.get(Li);return t.get(ht).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s;const o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),function Rre(t){return new Promise(e=>{gO(e,{injector:t})})}(t))),{onViewTransitionCreated:u}=r;return u&&z(t,()=>u({transition:a,from:e,to:n})),o})}let KI=(()=>{class t{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new P,this.transitionAbortSubject=new P,this.configLoader=oe(oA),this.environmentInjector=oe(Mi),this.urlSerializer=oe(Qh),this.rootContexts=oe(Pm),this.location=oe(dm),this.inputBindingEnabled=null!==oe(zI,{optional:!0}),this.titleStrategy=oe(UU),this.options=oe(sf,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=oe(aA),this.createViewTransition=oe(jU,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Re(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=i=>this.events.next(new pne(i)),this.configLoader.onLoadStartListener=i=>this.events.next(new fne(i))}complete(){this.transitions?.complete()}handleNavigationRequest(n){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...n,id:r})}setupNavigations(n,r,i){return this.transitions=new x({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Rm,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(uo(s=>0!==s.id),fe(s=>({...s,extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),$n(s=>{this.currentTransition=s;let o=!1,a=!1;return Re(s).pipe(xr(u=>{this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),$n(u=>{const l=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!l&&"reload"!==(u.extras.onSameUrlNavigation??n.onSameUrlNavigation)){const p="";return this.events.next(new Xh(u.id,this.urlSerializer.serialize(u.rawUrl),p,0)),u.resolve(null),jo}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return Re(u).pipe($n(p=>{const m=this.transitions?.getValue();return this.events.next(new $I(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),m!==this.transitions?.getValue()?jo:Promise.resolve(p)}),function vre(t,e,n,r,i,s){return Jr(o=>function hre(t,e,n,r,i,s,o="emptyOnly"){return new pre(t,e,n,r,i,o,s).recognize()}(t,e,n,r,o.extractedUrl,i,s).pipe(fe(({state:a,tree:u})=>({...o,targetSnapshot:a,urlAfterRedirects:u}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),xr(p=>{s.targetSnapshot=p.targetSnapshot,s.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:p.urlAfterRedirects};const m=new EU(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(m)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){const{id:p,extractedUrl:m,source:_,restoredState:v,extras:I}=u,T=new $I(p,this.urlSerializer.serialize(m),_,v);this.events.next(T);const N=CU(0,this.rootComponentType).snapshot;return this.currentTransition=s={...u,targetSnapshot:N,urlAfterRedirects:m,extras:{...I,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=m,Re(s)}{const p="";return this.events.next(new Xh(u.id,this.urlSerializer.serialize(u.extractedUrl),p,1)),u.resolve(null),jo}}),xr(u=>{const l=new lne(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(l)}),fe(u=>(this.currentTransition=s={...u,guards:xne(u.targetSnapshot,u.currentSnapshot,this.rootContexts)},s)),function zne(t,e){return Jr(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return 0===o.length&&0===s.length?Re({...n,guardsResult:!0}):function qne(t,e,n,r){return jt(t).pipe(Jr(i=>function Yne(t,e,n,r,i){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Re(s.map(a=>{const u=Mm(e)??i,l=tf(a,u);return Zu(function jne(t){return t&&Om(t.canDeactivate)}(l)?l.canDeactivate(t,e,n,r):z(u,()=>l(t,e,n,r))).pipe(Ku())})).pipe(nf()):Re(!0)}(i.component,i.route,n,e,r)),Ku(i=>!0!==i,!0))}(o,r,i,t).pipe(Jr(a=>a&&function Fne(t){return"boolean"==typeof t}(a)?function Wne(t,e,n,r){return jt(e).pipe(Tm(i=>xb(function Kne(t,e){return null!==t&&e&&e(new gne(t)),Re(!0)}(i.route.parent,r),function Gne(t,e){return null!==t&&e&&e(new _ne(t)),Re(!0)}(i.route,r),function Qne(t,e,n){const r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function kne(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(o)).filter(o=>null!==o).map(o=>X2(()=>Re(o.guards.map(u=>{const l=Mm(o.node)??n,h=tf(u,l);return Zu(function Bne(t){return t&&Om(t.canActivateChild)}(h)?h.canActivateChild(r,t):z(l,()=>h(r,t))).pipe(Ku())})).pipe(nf())));return Re(s).pipe(nf())}(t,i.path,n),function Zne(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return Re(!0);const i=r.map(s=>X2(()=>{const o=Mm(e)??n,a=tf(s,o);return Zu(function Une(t){return t&&Om(t.canActivate)}(a)?a.canActivate(e,t):z(o,()=>a(e,t))).pipe(Ku())}));return Re(i).pipe(nf())}(t,i.route,n))),Ku(i=>!0!==i,!0))}(r,s,t,e):Re(a)),fe(a=>({...n,guardsResult:a})))})}(this.environmentInjector,u=>this.events.next(u)),xr(u=>{if(s.guardsResult=u.guardsResult,bc(u.guardsResult))throw RU(0,u.guardsResult);const l=new cne(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(l)}),uo(u=>!!u.guardsResult||(this.cancelNavigationTransition(u,"",3),!1)),sA(u=>{if(u.guards.canActivateChecks.length)return Re(u).pipe(xr(l=>{const h=new dne(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}),$n(l=>{let h=!1;return Re(l).pipe(function Ere(t,e){return Jr(n=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return Re(n);const s=new Set(i.map(u=>u.route)),o=new Set;for(const u of s)if(!o.has(u))for(const l of VU(u))o.add(l);let a=0;return jt(o).pipe(Tm(u=>s.has(u)?function Ire(t,e,n,r){const i=t.routeConfig,s=t._resolve;return void 0!==i?.title&&!bU(i)&&(s[Cm]=i.title),function wre(t,e,n,r){const i=Fb(t);if(0===i.length)return Re({});const s={};return jt(i).pipe(Jr(o=>function Tre(t,e,n,r){const i=Mm(e)??r,s=tf(t,i);return Zu(s.resolve?s.resolve(e,n):z(i,()=>s(e,n)))}(t[o],e,n,r).pipe(Ku(),xr(a=>{s[o]=a}))),Ob(1),function xte(t){return fe(()=>t)}(s),Wh(o=>kU(o)?jo:xI(o)))}(s,t,e,r).pipe(fe(o=>(t._resolvedData=o,t.data=Gb(t,t.parent,n).resolve,null)))}(u,r,t,e):(u.data=Gb(u,u.parent,t).resolve,Re(void 0))),xr(()=>a++),Ob(1),Jr(u=>a===o.size?Re(n):jo))})}(this.paramsInheritanceStrategy,this.environmentInjector),xr({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(l,"",2)}}))}),xr(l=>{const h=new hne(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}))}),sA(u=>{const l=h=>{const p=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(h.routeConfig).pipe(xr(m=>{h.component=m}),fe(()=>{})));for(const m of h.children)p.push(...l(m));return p};return Mb(l(u.targetSnapshot.root)).pipe(OI(null),qh(1))}),sA(()=>this.afterPreactivation()),$n(()=>{const{currentSnapshot:u,targetSnapshot:l}=s,h=this.createViewTransition?.(this.environmentInjector,u.root,l.root);return h?jt(h).pipe(fe(()=>s)):Re(s)}),fe(u=>{const l=function wne(t,e,n){const r=Nm(t,e._root,n?n._root:void 0);return new TU(r,e)}(n.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=s={...u,targetRouterState:l},this.currentNavigation.targetRouterState=l,s}),xr(()=>{this.events.next(new Hb)}),((t,e,n,r)=>fe(i=>(new Mne(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)))(this.rootContexts,n.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),qh(1),xr({next:u=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ua(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{o=!0}}),function kte(t){return ge((e,n)=>{os(t).subscribe(Te(n,()=>n.complete(),$r)),!n.closed&&e.subscribe(n)})}(this.transitionAbortSubject.pipe(xr(u=>{throw u}))),Lb(()=>{o||a||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),Wh(u=>{if(a=!0,NU(u))this.events.next(new Yh(s.id,this.urlSerializer.serialize(s.extractedUrl),u.message,u.cancellationCode)),function Sne(t){return NU(t)&&bc(t.url)}(u)?this.events.next(new zb(u.url)):s.resolve(!1);else{this.events.next(new HI(s.id,this.urlSerializer.serialize(s.extractedUrl),u,s.targetSnapshot??void 0));try{s.resolve(n.errorHandler(u))}catch(l){s.reject(l)}}return jo}))}))}cancelNavigationTransition(n,r,i){const s=new Yh(n.id,this.urlSerializer.serialize(n.extractedUrl),r,i);this.events.next(s),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Pre(t){return t!==Rm}let Nre=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:()=>oe(xre),providedIn:"root"})}return t})();class Mre{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}}let xre=(()=>{class t extends Mre{static#e=this.\u0275fac=(()=>{let n;return function(i){return(n||(n=ag(t)))(i||t)}})();static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),HU=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:()=>oe(kre),providedIn:"root"})}return t})(),kre=(()=>{class t extends HU{constructor(){super(...arguments),this.location=oe(dm),this.urlSerializer=oe(Qh),this.options=oe(sf,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=oe(aA),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Zh,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=CU(0,null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(r=>{"popstate"===r.type&&n(r.url,r.state)})}handleRouterEvent(n,r){if(n instanceof $I)this.stateMemento=this.createStateMemento();else if(n instanceof Xh)this.rawUrlTree=r.initialUrl;else if(n instanceof EU){if("eager"===this.urlUpdateStrategy&&!r.extras.skipLocationChange){const i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(i,r)}}else n instanceof Hb?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r))):n instanceof Yh&&(3===n.code||2===n.code)?this.restoreHistory(r):n instanceof HI?this.restoreHistory(r,!0):n instanceof Ua&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,r){const i=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){const o={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId)};this.location.replaceState(i,"",o)}else{const s={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId+1)};this.location.go(i,"",s)}}restoreHistory(n,r=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===n.finalUrl&&0===s&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,r){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}static#e=this.\u0275fac=(()=>{let n;return function(i){return(n||(n=ag(t)))(i||t)}})();static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Lm=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(Lm||{});function zU(t,e){t.events.pipe(uo(n=>n instanceof Ua||n instanceof Yh||n instanceof HI||n instanceof Xh),fe(n=>n instanceof Ua||n instanceof Xh?Lm.COMPLETE:n instanceof Yh&&(0===n.code||1===n.code)?Lm.REDIRECTING:Lm.FAILED),uo(n=>n!==Lm.REDIRECTING),qh(1)).subscribe(()=>{e()})}function Ore(t){throw t}const Lre={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Fre={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ks=(()=>{class t{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=oe(MF),this.stateManager=oe(HU),this.options=oe(sf,{optional:!0})||{},this.pendingTasks=oe(fD),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=oe(KI),this.urlSerializer=oe(Qh),this.location=oe(dm),this.urlHandlingStrategy=oe(aA),this._events=new P,this.errorHandler=this.options.errorHandler||Ore,this.navigated=!1,this.routeReuseStrategy=oe(Nre),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=oe(af,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!oe(zI,{optional:!0}),this.eventsSubscription=new Pt,this.isNgZoneEnabled=oe(ht)instanceof ht&&ht.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const n=this.navigationTransitions.events.subscribe(r=>{try{const i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(null!==i&&null!==s)if(this.stateManager.handleRouterEvent(r,s),r instanceof Yh&&0!==r.code&&1!==r.code)this.navigated=!0;else if(r instanceof Ua)this.navigated=!0;else if(r instanceof zb){const o=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),a={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Pre(i.source)};this.scheduleNavigation(o,Rm,null,a,{resolve:i.resolve,reject:i.reject,promise:i.promise})}(function Ure(t){return!(t instanceof Hb||t instanceof zb)})(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Rm,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription||(this.nonRouterCurrentEntryChangeSubscription=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",r)},0)}))}navigateToSyncWithBrowser(n,r,i){const s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){const u={...i};delete u.navigationId,delete u.\u0275routerPageId,0!==Object.keys(u).length&&(s.state=u)}const a=this.parseUrl(n);this.scheduleNavigation(a,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(eA),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,r={}){const{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:u}=r,l=u?this.currentUrlTree.fragment:o;let p,h=null;switch(a){case"merge":h={...this.currentUrlTree.queryParams,...s};break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=s||null}null!==h&&(h=this.removeEmptyProps(h));try{p=fU(i?i.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||!n[0].startsWith("/"))&&(n=[]),p=this.currentUrlTree.root}return pU(p,n,h,l??null)}navigateByUrl(n,r={skipLocationChange:!1}){const i=bc(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Rm,null,r)}navigate(n,r={skipLocationChange:!1}){return function Vre(t){for(let e=0;e<t.length;e++)if(null==t[e])throw new L(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,r){let i;if(i=!0===r?{...Lre}:!1===r?{...Fre}:r,bc(n))return iU(this.currentUrlTree,n,i);const s=this.parseUrl(n);return iU(this.currentUrlTree,s,i)}removeEmptyProps(n){return Object.keys(n).reduce((r,i)=>{const s=n[i];return null!=s&&(r[i]=s),r},{})}scheduleNavigation(n,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,u,l;o?(a=o.resolve,u=o.reject,l=o.promise):l=new Promise((p,m)=>{a=p,u=m});const h=this.pendingTasks.add();return zU(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:s,resolve:a,reject:u,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(p=>Promise.reject(p))}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),ZI=(()=>{class t{constructor(n,r,i,s,o,a){this.router=n,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=o,this.locationStrategy=a,this.href=null,this.commands=null,this.onChanges=new P,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const u=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===u||"area"===u,this.isAnchorElement?this.subscription=n.events.subscribe(l=>{l instanceof Ua&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){null!=n?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(n,r,i,s,o){return!!(null===this.urlTree||this.isAnchorElement&&(0!==n||r||i||s||o||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const n=null===this.href?null:function Tk(t,e,n){return function F3(t,e){return"src"===e&&("embed"===t||"frame"===t||"iframe"===t||"media"===t||"script"===t)||"href"===e&&("base"===t||"link"===t)?wk:Ik}(e,n)(t)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(n,r){const i=this.renderer,s=this.el.nativeElement;null!==r?i.setAttribute(s,n,r):i.removeAttribute(s,n)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static#e=this.\u0275fac=function(r){return new(r||t)(Oe(ks),Oe(ef),function Au(t){return function ZC(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const r=n.length;let i=0;for(;i<r;){const s=n[i];if(Dp(s))break;if(0===s)i+=2;else if("number"==typeof s)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(s===e)return n[i+1];i+=2}}}return null}(Dt(),t)}("tabindex"),Oe(fE),Oe(Bu),Oe(wc))};static#t=this.\u0275dir=Kn({type:t,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,i){1&r&&HE("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),2&r&&_S("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",ND],skipLocationChange:["skipLocationChange","skipLocationChange",ND],replaceUrl:["replaceUrl","replaceUrl",ND],routerLink:"routerLink"},standalone:!0,features:[SO,Kr]})}return t})(),qU=(()=>{class t{get isActive(){return this._isActive}constructor(n,r,i,s,o){this.router=n,this.element=r,this.renderer=i,this.cdr=s,this.link=o,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new gi,this.routerEventsSubscription=n.events.subscribe(a=>{a instanceof Ua&&this.update()})}ngAfterContentInit(){Re(this.links.changes,Re(null)).pipe(zh()).subscribe(n=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const n=[...this.links.toArray(),this.link].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=jt(n).pipe(zh()).subscribe(r=>{this._isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(n){const r=Array.isArray(n)?n:n.split(" ");this.classes=r.filter(i=>!!i)}ngOnChanges(n){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{const n=this.hasActiveLinks();this._isActive!==n&&(this._isActive=n,this.cdr.markForCheck(),this.classes.forEach(r=>{n?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),n&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(n))})}isLinkActive(n){const r=function Bre(t){return!!t.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return i=>!!i.urlTree&&n.isActive(i.urlTree,r)}hasActiveLinks(){const n=this.isLinkActive(this.router);return this.link&&n(this.link)||this.links.some(n)}static#e=this.\u0275fac=function(r){return new(r||t)(Oe(ks),Oe(Bu),Oe(fE),Oe(IE),Oe(ZI,8))};static#t=this.\u0275dir=Kn({type:t,selectors:[["","routerLinkActive",""]],contentQueries:function(r,i,s){if(1&r&&hF(s,ZI,5),2&r){let o;dF(o=function fF(){return function z7(t,e){return t[Ri].queries[e].queryList}(H(),Tv())}())&&(i.links=o)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[Kr]})}return t})();class WU{}let jre=(()=>{class t{constructor(n,r,i,s,o){this.router=n,this.injector=i,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(uo(n=>n instanceof Ua),Tm(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,r){const i=[];for(const s of r){s.providers&&!s._injector&&(s._injector=tD(s.providers,n,`Route: ${s.path}`));const o=s._injector??n,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&i.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&i.push(this.processRoutes(a,s.children??s._loadedRoutes))}return jt(i).pipe(zh())}preloadConfig(n,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(n,r):Re(null);const s=i.pipe(Jr(o=>null===o?Re(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??n,o.routes))));return r.loadComponent&&!r._loadedComponent?jt([s,this.loader.loadComponent(r)]).pipe(zh()):s})}static#e=this.\u0275fac=function(r){return new(r||t)(K(ks),K(xF),K(Mi),K(WU),K(oA))};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const uA=new ue("");let GU=(()=>{class t{constructor(n,r,i,s,o={}){this.urlSerializer=n,this.transitions=r,this.viewportScroller=i,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof $I?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof Ua?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof Xh&&0===n.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof IU&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new IU(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){!function Wk(){throw new Error("invalid")}()};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac})}return t})();function qo(t,e){return{\u0275kind:t,\u0275providers:e}}function ZU(){const t=oe(Yr);return e=>{const n=t.get(Ec);if(e!==n.components[0])return;const r=t.get(ks),i=t.get(QU);1===t.get(lA)&&r.initialNavigation(),t.get(YU,null,st.Optional)?.setUpPreloading(),t.get(uA,null,st.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const QU=new ue("",{factory:()=>new P}),lA=new ue("",{providedIn:"root",factory:()=>1}),YU=new ue("");function qre(t){return qo(0,[{provide:YU,useExisting:jre},{provide:WU,useExisting:t}])}function Gre(t){return qo(9,[{provide:jU,useValue:Are},{provide:$U,useValue:{skipNextTransition:!!t?.skipInitialTransition,...t}}])}const XU=new ue("ROUTER_FORROOT_GUARD"),Kre=[dm,{provide:Qh,useClass:Vb},ks,Pm,{provide:ef,useFactory:function KU(t){return t.routerState.root},deps:[ks]},oA,[]];let cA=(()=>{class t{constructor(n){}static forRoot(n,r){return{ngModule:t,providers:[Kre,[],{provide:af,multi:!0,useValue:n},{provide:XU,useFactory:Xre,deps:[[ks,new rc,new xo]]},{provide:sf,useValue:r||{}},r?.useHash?{provide:wc,useClass:LQ}:{provide:wc,useClass:IV},{provide:uA,useFactory:()=>{const t=oe(sX),e=oe(ht),n=oe(sf),r=oe(KI),i=oe(Qh);return n.scrollOffset&&t.setOffset(n.scrollOffset),new GU(i,r,t,e,n)}},r?.preloadingStrategy?qre(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?Jre(r):[],r?.bindToComponentInputs?qo(8,[AU,{provide:zI,useExisting:AU}]).\u0275providers:[],r?.enableViewTransitions?Gre().\u0275providers:[],[{provide:JU,useFactory:ZU},{provide:ED,multi:!0,useExisting:JU}]]}}static forChild(n){return{ngModule:t,providers:[{provide:af,multi:!0,useValue:n}]}}static#e=this.\u0275fac=function(r){return new(r||t)(K(XU,8))};static#t=this.\u0275mod=_r({type:t});static#n=this.\u0275inj=Ar({})}return t})();function Xre(t){return"guarded"}function Jre(t){return["disabled"===t.initialNavigation?qo(3,[{provide:yD,multi:!0,useFactory:()=>{const e=oe(ks);return()=>{e.setUpLocationChangeListener()}}},{provide:lA,useValue:2}]).\u0275providers:[],"enabledBlocking"===t.initialNavigation?qo(2,[{provide:lA,useValue:0},{provide:yD,multi:!0,deps:[Yr],useFactory:e=>{const n=e.get(kQ,Promise.resolve());return()=>n.then(()=>new Promise(r=>{const i=e.get(ks),s=e.get(QU);zU(i,()=>{r(!0)}),e.get(KI).afterPreactivation=()=>(r(!0),s.closed?Re(void 0):s),i.initialNavigation()}))}}]).\u0275providers:[]]}const JU=new ue(""),tie_firebaseConfig={apiKey:"AIzaSyCwVifARku6nPemSHNDWivjnivQKT2cc8g",authDomain:"e-shop-c52ad.firebaseapp.com",projectId:"e-shop-c52ad",storageBucket:"e-shop-c52ad.appspot.com",messagingSenderId:"444472786878",appId:"1:444472786878:web:470744a21521084819c3ef",measurementId:"G-VL5TBK5XY1"};var Fi=We(534);(0,Fi.registerVersion)("firebase","10.7.1","app");class iie extends Pt{constructor(e,n){super()}schedule(e,n=0){return this}}const QI={setInterval(t,e,...n){const{delegate:r}=QI;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){const{delegate:e}=QI;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};class eB extends iie{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;const i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return QI.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return n;null!=n&&QI.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,n);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let i,r=!1;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,Gn(r,this),null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}}const dA={now:()=>(dA.delegate||Date).now(),delegate:void 0};class Fm{constructor(e,n=Fm.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}}Fm.now=dA.now;class tB extends Fm{constructor(e,n=Fm.now){super(e,n),this.actions=[],this._active=!1}flush(e){const{actions:n}=this;if(this._active)return void n.push(e);let r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}}const aie=new class oie extends tB{}(class sie extends eB{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}}),YI=new tB(eB),uf=new am("ANGULARFIRE2_VERSION");class XI{constructor(){return((t,e)=>{const n=(0,Fi.getApps)(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r})(lie)}}const lie="app-check";function lf(){}class nB{zone;delegate;constructor(e,n=aie){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){const i=this.zone;return this.delegate.schedule(function(o){i.runGuarded(()=>{e.apply(this,[o])})},n,r)}}class cie{zone;task=null;constructor(e){this.zone=e}call(e,n){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",lf,{},lf,lf)),n.pipe(xr({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let JI=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new nB(Zone.current)),this.insideAngular=n.run(()=>new nB(Zone.current,YI)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(K(ht))};static \u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function cf(){const t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return t}function rB(t){return t.pipe(Gu(cf().outsideAngular))}function Hn(t){return function hie(t){return function(n){return(n=n.lift(new cie(t.ngZone))).pipe(Hh(t.outsideAngular),Gu(t.insideAngular))}}(cf())(t)}var Vi=We(106);Vi.Z.registerVersion("firebase","10.7.1","app-compat");const mie=["ngOnDestroy"];class iB{constructor(e){return e}}const df=new ue("angularfire2.app.options"),hf=new ue("angularfire2.app.name");function Vm(t,e,n){const i="object"==typeof n&&n||{};i.name=i.name||"string"==typeof n&&n||"[DEFAULT]";const o=Vi.Z.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>Vi.Z.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){const a=!!module.hot;vie("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new iB(o)}const vie=(t,...e)=>{},Eie={provide:iB,useFactory:Vm,deps:[df,ht,[new rc,hf]]};let Iie=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:df,useValue:n},{provide:hf,useValue:r}]}}constructor(n){Vi.Z.registerVersion("angularfire",uf.full,"core"),Vi.Z.registerVersion("angularfire",uf.full,"app-compat"),Vi.Z.registerVersion("angular",pZ.full,n.toString())}static \u0275fac=function(r){return new(r||t)(K(eo))};static \u0275mod=_r({type:t});static \u0275inj=Ar({providers:[Eie]})}return t})();function ew(t,e,n,r,i){const[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return function wie(t,e){try{return t.toString()===e.toString()}catch{return t===e}}(i,o)||(sB("error",`${e} was already initialized on the ${n} Firebase App with different settings.${Tie?" You may need to reload as Firebase is not HMR aware.":""}`),sB("warn",{is:i,was:o})),s;{const a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}const Tie=typeof module<"u"&&!!module.hot,sB=(t,...e)=>{};function hA(...t){const e=wm(t),n=function gte(t,e){return"number"==typeof Nb(t)?t.pop():e}(t,1/0),r=t;return r.length?1===r.length?os(r[0]):zh(n)(jt(r,e)):jo}globalThis.\u0275AngularfireInstanceCache||=[],We(230);class Cie extends P{constructor(e=1/0,n=1/0,r=dA){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){const{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){const{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){const o=n.now();let a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}}function oB(t={}){const{connector:e=(()=>new P),resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,u,l=0,h=!1,p=!1;const m=()=>{a?.unsubscribe(),a=void 0},_=()=>{m(),o=u=void 0,h=p=!1},v=()=>{const I=o;_(),I?.unsubscribe()};return ge((I,T)=>{l++,!p&&!h&&m();const N=u=u??e();T.add(()=>{l--,0===l&&!p&&!h&&(a=fA(v,i))}),N.subscribe(T),!o&&l>0&&(o=new sr({next:b=>N.next(b),error:b=>{p=!0,m(),a=fA(_,n,b),N.error(b)},complete:()=>{h=!0,m(),a=fA(_,r),N.complete()}}),os(I).subscribe(o))})(s)}}function fA(t,e,...n){if(!0===e)return void t();if(!1===e)return;const r=new sr({next:()=>{r.unsubscribe(),t()}});return os(e(...n)).subscribe(r)}function aB(t,e,n){let r,i=!1;return t&&"object"==typeof t?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t):r=t??1/0,oB({connector:()=>new Cie(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function uB(t,e){return xe(e)?$n(()=>t,e):$n(()=>t)}const pA=new ue("angularfire2.auth.use-emulator"),gA=new ue("angularfire2.auth.settings"),mA=new ue("angularfire2.auth.tenant-id"),_A=new ue("angularfire2.auth.langugage-code"),yA=new ue("angularfire2.auth.use-device-language"),vA=new ue("angularfire.auth.persistence"),EA=(t,e,n,r,i,s,o,a)=>ew(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{const u=e.runOutsideAngular(()=>t.auth());if(n&&u.useEmulator(...n),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(const[l,h]of Object.entries(o))u.settings[l]=h;return a&&u.setPersistence(a),u},[n,r,i,s,o,a]);let Um=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,u,l,h,p,m,_){const v=new P,I=Re(void 0).pipe(Gu(o.outsideAngular),$n(()=>s.runOutsideAngular(()=>Promise.resolve().then(We.bind(We,230)))),fe(()=>Vm(n,s,r)),fe(T=>EA(T,s,a,l,h,p,u,m)),aB({bufferSize:1,refCount:!1}));if(mI(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Re(null);else{I.pipe(Ku()).subscribe();const T=I.pipe($n(k=>k.getRedirectResult().then($=>$,()=>null)),Hn,aB({bufferSize:1,refCount:!1})),N=I.pipe($n(k=>new qt($=>({unsubscribe:s.runOutsideAngular(()=>k.onAuthStateChanged(ie=>$.next(ie),ie=>$.error(ie),()=>$.complete()))})))),b=I.pipe($n(k=>new qt($=>({unsubscribe:s.runOutsideAngular(()=>k.onIdTokenChanged(ie=>$.next(ie),ie=>$.error(ie),()=>$.complete()))}))));this.authState=T.pipe(uB(N),Hh(o.outsideAngular),Gu(o.insideAngular)),this.user=T.pipe(uB(b),Hh(o.outsideAngular),Gu(o.insideAngular)),this.idToken=this.user.pipe($n(k=>k?jt(k.getIdToken()):Re(null))),this.idTokenResult=this.user.pipe($n(k=>k?jt(k.getIdTokenResult()):Re(null))),this.credential=hA(T,v,this.authState.pipe(uo(k=>!k))).pipe(fe(k=>k?.user?k:null),Hh(o.outsideAngular),Gu(o.insideAngular))}return((t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(mie.indexOf(s)>-1)return()=>{};const o=e.toPromise().then(a=>{const u=a?.[s];return"function"==typeof u?u.bind(a):u?.then?u.then(l=>n.run(()=>l)):n.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,l)=>o.then(h=>{const p=h?.(...l);return r?.spy?.apply&&r.spy.apply(s,l,p),p})})})}))(this,I,s,{spy:{apply:(T,N,b)=>{(T.startsWith("signIn")||T.startsWith("createUser"))&&b.then(k=>v.next(k))}}})}static \u0275fac=function(r){return new(r||t)(K(df),K(hf,8),K(eo),K(ht),K(JI),K(pA,8),K(gA,8),K(mA,8),K(_A,8),K(yA,8),K(vA,8),K(XI,8))};static \u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),Die=(()=>{class t{constructor(){Vi.Z.registerVersion("angularfire",uf.full,"auth-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=_r({type:t});static \u0275inj=Ar({providers:[Um]})}return t})();var q=We(861),w=We(58),co=We(537);const lB="firebasestorage.googleapis.com",cB="storageBucket";class Dn extends w.ZR{constructor(e,n,r=0){super(IA(e),`Firebase Storage: ${n} (${IA(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Dn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return IA(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var mn=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(mn||{});function IA(t){return"storage/"+t}function wA(){return new Dn(mn.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function dB(){return new Dn(mn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function hB(){return new Dn(mn.CANCELED,"User canceled the upload/download.")}function fB(){return new Dn(mn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function ff(t){return new Dn(mn.INVALID_ARGUMENT,t)}function pB(){return new Dn(mn.APP_DELETED,"The Firebase app was deleted.")}function gB(t){return new Dn(mn.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Bm(t,e){return new Dn(mn.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function jm(t){throw new Dn(mn.INTERNAL_ERROR,"Internal error: "+t)}class ei{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=ei.makeFromUrl(e,n)}catch{return new ei(e,"")}if(""===r.path)return r;throw function Fie(t){return new Dn(mn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)",a=new RegExp("^gs://"+i+"(/(.*))?$","i");function l($){$.path_=decodeURIComponent($.path)}const p=n.replace(/[.]/g,"\\."),k=[{regex:a,indices:{bucket:1,path:3},postModify:function s($){"/"===$.path.charAt($.path.length-1)&&($.path_=$.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${p}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:l},{regex:new RegExp(`^https?://${n===lB?"(?:storage.googleapis.com|storage.cloud.google.com)":n}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:l}];for(let $=0;$<k.length;$++){const ie=k[$],pe=ie.regex.exec(e);if(pe){let kt=pe[ie.indices.path];kt||(kt=""),r=new ei(pe[ie.indices.bucket],kt),ie.postModify(r);break}}if(null==r)throw function Lie(t){return new Dn(mn.INVALID_URL,"Invalid URL '"+t+"'.")}(e);return r}}class $ie{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function tw(t){return"string"==typeof t||t instanceof String}function mB(t){return TA()&&t instanceof Blob}function TA(){return typeof Blob<"u"}function CA(t,e,n,r){if(r<e)throw ff(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw ff(`Invalid value for '${t}'. Expected ${n} or less.`)}function Ba(t,e,n){let r=e;return null==n&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function _B(t){const e=encodeURIComponent;let n="?";for(const r in t)t.hasOwnProperty(r)&&(n=n+(e(r)+"=")+e(t[r])+"&");return n=n.slice(0,-1),n}var pf=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(pf||{});function yB(t,e){const n=t>=500&&t<600,i=-1!==[408,429].indexOf(t),s=-1!==e.indexOf(t);return n||i||s}class Kie{constructor(e,n,r,i,s,o,a,u,l,h,p,m=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=u,this.timeout_=l,this.progressCallback_=h,this.connectionFactory_=p,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,v)=>{this.resolve_=_,this.reject_=v,this.start_()})}start_(){const n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const u=this.callback_(a,a.getResponse());!function qie(t){return void 0!==t}(u)?s():s(u)}catch(u){o(u)}else if(null!==a){const u=wA();u.serverResponse=a.getErrorText(),o(this.errorCallback_?this.errorCallback_(a,u):u)}else o(i.canceled?this.appDelete_?pB():hB():dB())};this.canceled_?n(0,new nw(!1,null,!0)):this.backoffId_=function Hie(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function u(){return 2===a}let l=!1;function h(...T){l||(l=!0,e.apply(null,T))}function p(T){i=setTimeout(()=>{i=null,t(_,u())},T)}function m(){s&&clearTimeout(s)}function _(T,...N){if(l)return void m();if(T)return m(),void h.call(null,T,...N);if(u()||o)return m(),void h.call(null,T,...N);let k;r<64&&(r*=2),1===a?(a=2,k=0):k=1e3*(r+Math.random()),p(k)}let v=!1;function I(T){v||(v=!0,m(),!l&&(null!==i?(T||(a=2),clearTimeout(i),p(0)):T||(a=1)))}return p(0),s=setTimeout(()=>{o=!0,I(!0)},n),I}((r,i)=>{if(i)return void r(!1,new nw(!1,null,!0));const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{null!==this.progressCallback_&&this.progressCallback_(a.loaded,a.lengthComputable?a.total:-1)};null!==this.progressCallback_&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===pf.NO_ERROR,u=s.getStatus();if(!a||yB(u,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===pf.ABORT;return void r(!1,new nw(!1,null,h))}const l=-1!==this.successCodes_.indexOf(u);r(!0,new nw(l,s))})},n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function zie(t){t(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class nw{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function tse(...t){const e=function ese(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==e){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}if(TA())return new Blob(t);throw new Dn(mn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const as={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class SA{constructor(e,n){this.data=e,this.contentType=n||null}}function DA(t,e){switch(t){case as.RAW:return new SA(vB(e));case as.BASE64:case as.BASE64URL:return new SA(EB(t,e));case as.DATA_URL:return new SA(function sse(t){const e=new IB(t);return e.base64?EB(as.BASE64,e.rest):function ise(t){let e;try{e=decodeURIComponent(t)}catch{throw Bm(as.DATA_URL,"Malformed data URL.")}return vB(e)}(e.rest)}(e),function ose(t){return new IB(t).contentType}(e))}throw wA()}function vB(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?n<t.length-1&&56320==(64512&t.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function EB(t,e){switch(t){case as.BASE64:{const i=-1!==e.indexOf("-"),s=-1!==e.indexOf("_");if(i||s)throw Bm(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case as.BASE64URL:{const i=-1!==e.indexOf("+"),s=-1!==e.indexOf("/");if(i||s)throw Bm(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=function rse(t){if(typeof atob>"u")throw function jie(t){return new Dn(mn.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(t)}(e)}catch(i){throw i.message.includes("polyfill")?i:Bm(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class IB{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(null===n)throw Bm(as.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;null!=r&&(this.base64=function ase(t,e){return t.length>=e.length&&t.substring(t.length-e.length)===e}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class Wo{constructor(e,n){let r=0,i="";mB(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(mB(this.data_)){const i=function nse(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}(this.data_,e,n);return null===i?null:new Wo(i)}{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Wo(r,!0)}}static getBlob(...e){if(TA()){const n=e.map(r=>r instanceof Wo?r.data_:r);return new Wo(tse.apply(null,n))}{const n=e.map(o=>tw(o)?DA(as.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new Wo(i,!0)}}uploadData(){return this.data_}}function bA(t){let e;try{e=JSON.parse(t)}catch{return null}return function Gie(t){return"object"==typeof t&&!Array.isArray(t)}(e)?e:null}function wB(t){const e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function cse(t,e){return e}class Ei{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||cse}}let rw=null;function $m(){if(rw)return rw;const t=[];t.push(new Ei("bucket")),t.push(new Ei("generation")),t.push(new Ei("metageneration")),t.push(new Ei("name","fullPath",!0));const n=new Ei("name");n.xform=function e(s,o){return function dse(t){return!tw(t)||t.length<2?t:wB(t)}(o)},t.push(n);const i=new Ei("size");return i.xform=function r(s,o){return void 0!==o?Number(o):o},t.push(i),t.push(new Ei("timeCreated")),t.push(new Ei("updated")),t.push(new Ei("md5Hash",null,!0)),t.push(new Ei("cacheControl",null,!0)),t.push(new Ei("contentDisposition",null,!0)),t.push(new Ei("contentEncoding",null,!0)),t.push(new Ei("contentLanguage",null,!0)),t.push(new Ei("contentType",null,!0)),t.push(new Ei("metadata","customMetadata",!0)),rw=t,rw}function TB(t,e,n){const r=bA(e);return null===r?null:function fse(t,e,n){const r={type:"file"},i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return function hse(t,e){Object.defineProperty(t,"ref",{get:function n(){const s=new ei(t.bucket,t.fullPath);return e._makeStorageReference(s)}})}(r,t),r}(t,r,n)}function AA(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}const CB="prefixes",SB="items";class Go{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Ko(t){if(!t)throw wA()}function iw(t,e){return function n(r,i){const s=TB(t,i,e);return Ko(null!==s),s}}function gf(t){return function e(n,r){let i;return i=401===n.getStatus()?n.getErrorText().includes("Firebase App Check token is invalid")?function kie(){return new Dn(mn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function xie(){return new Dn(mn.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===n.getStatus()?function Mie(t){return new Dn(mn.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(t.bucket):403===n.getStatus()?function Oie(t){return new Dn(mn.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}(t.path):r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}}function Hm(t){const e=gf(t);return function n(r,i){let s=e(r,i);return 404===r.getStatus()&&(s=function Nie(t){return new Dn(mn.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}(t.path)),s.serverResponse=i.serverResponse,s}}function DB(t,e,n){const i=Ba(e.fullServerUrl(),t.host,t._protocol),o=t.maxOperationRetryTime,a=new Go(i,"GET",iw(t,n),o);return a.errorHandler=Hm(e),a}function vse(t,e,n,r,i){const s={};s.prefix=e.isRoot?"":e.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);const a=Ba(e.bucketOnlyServerUrl(),t.host,t._protocol),l=t.maxOperationRetryTime,h=new Go(a,"GET",function _se(t,e){return function n(r,i){const s=function mse(t,e,n){const r=bA(n);return null===r?null:function gse(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[CB])for(const i of n[CB]){const s=i.replace(/\/$/,""),o=t._makeStorageReference(new ei(e,s));r.prefixes.push(o)}if(n[SB])for(const i of n[SB]){const s=t._makeStorageReference(new ei(e,i.name));r.items.push(s)}return r}(t,e,r)}(t,e,i);return Ko(null!==s),s}}(t,e.bucket),l);return h.urlParams=s,h.errorHandler=gf(e),h}function AB(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function Tse(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}class sw{constructor(e,n,r,i){this.current=e,this.total=n,this.finalized=!!r,this.metadata=i||null}}function RA(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Ko(!1)}return Ko(!!n&&-1!==(e||["active"]).indexOf(n)),n}const bse={STATE_CHANGED:"state_changed"},Ii={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function PA(t){switch(t){case"running":case"pausing":case"canceling":return Ii.RUNNING;case"paused":return Ii.PAUSED;case"success":return Ii.SUCCESS;case"canceled":return Ii.CANCELED;default:return Ii.ERROR}}class Ase{constructor(e,n,r){if(function Wie(t){return"function"==typeof t}(e)||null!=n||null!=r)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{const s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}}function mf(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}let NB=null;class Rse{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=pf.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=pf.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=pf.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw jm("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),void 0!==i)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw jm("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw jm("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw jm("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw jm("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class Pse extends Rse{initXhr(){this.xhr_.responseType="text"}}function ho(){return NB?NB():new Pse}class MB{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=$m(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(mn.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const s=this.isExponentialBackoffExpired();if(yB(i.status,[])){if(!s)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();i=dB()}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(mn.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,n)=>{const r=function Cse(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o=AB(e,r,i),a={name:o.fullPath},u=Ba(s,t.host,t._protocol),h={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},p=AA(o,n),v=new Go(u,"POST",function _(I){let T;RA(I);try{T=I.getResponseHeader("X-Goog-Upload-URL")}catch{Ko(!1)}return Ko(tw(T)),T},t.maxUploadRetryTime);return v.urlParams=a,v.headers=h,v.body=p,v.errorHandler=gf(e),v}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,ho,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const i=function Sse(t,e,n,r){const u=new Go(n,"POST",function s(l){const h=RA(l,["active","final"]);let p=null;try{p=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Ko(!1)}p||Ko(!1);const m=Number(p);return Ko(!isNaN(m)),new sw(m,r.size(),"final"===h)},t.maxUploadRetryTime);return u.headers={"X-Goog-Upload-Command":"query"},u.errorHandler=gf(e),u}(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,ho,n,r);this._request=s,s.getPromise().then(o=>{this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,n=new sw(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=function Dse(t,e,n,r,i,s,o,a){const u=new sw(0,0);if(o?(u.current=o.current,u.total=o.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw function Uie(){return new Dn(mn.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const l=u.total-u.current;let h=l;i>0&&(h=Math.min(h,i));const p=u.current;let _="";_=0===h?"finalize":l===h?"upload, finalize":"upload";const v={"X-Goog-Upload-Command":_,"X-Goog-Upload-Offset":`${u.current}`},I=r.slice(p,p+h);if(null===I)throw fB();const k=new Go(n,"POST",function T($,ie){const pe=RA($,["active","final"]),qe=u.current+h,kt=r.size();let Br;return Br="final"===pe?iw(e,s)($,ie):null,new sw(qe,kt,"final"===pe,Br)},e.maxUploadRetryTime);return k.headers=v,k.body=I.uploadData(),k.progressCallback=a||null,k.errorHandler=gf(t),k}(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(u){return this._error=u,void this._transition("error")}const a=this._ref.storage._makeRequest(o,ho,i,s,!1);this._request=a,a.getPromise().then(u=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(u.current),u.finalized?(this._metadata=u.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=DB(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,ho,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=function RB(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},u=function a(){let k="";for(let $=0;$<2;$++)k+=Math.random().toString().slice(2);return k}();o["Content-Type"]="multipart/related; boundary="+u;const l=AB(e,r,i),h=AA(l,n),_=Wo.getBlob("--"+u+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+h+"\r\n--"+u+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",r,"\r\n--"+u+"--");if(null===_)throw fB();const v={name:l.fullPath},I=Ba(s,t.host,t._protocol),N=t.maxUploadRetryTime,b=new Go(I,"POST",iw(t,n),N);return b.urlParams=v,b.headers=o,b.body=_.uploadData(),b.errorHandler=gf(e),b}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,ho,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const n="paused"===this._state;this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=hB(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=PA(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,i){const s=new Ase(n||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);-1!==n&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(PA(this._state)){case Ii.SUCCESS:mf(this._resolve.bind(null,this.snapshot))();break;case Ii.CANCELED:case Ii.ERROR:mf(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(PA(this._state)){case Ii.RUNNING:case Ii.PAUSED:e.next&&mf(e.next.bind(e,this.snapshot))();break;case Ii.SUCCESS:e.complete&&mf(e.complete.bind(e))();break;default:e.error&&mf(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class Rc{constructor(e,n){this._service=e,this._location=n instanceof ei?n:ei.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Rc(e,n)}get root(){const e=new ei(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return wB(this._location.path)}get storage(){return this._service}get parent(){const e=function use(t){if(0===t.length)return null;const e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;const n=new ei(this._location.bucket,e);return new Rc(this._service,n)}_throwIfRoot(e){if(""===this._location.path)throw gB(e)}}function kB(t,e,n){return NA.apply(this,arguments)}function NA(){return(NA=(0,q.Z)(function*(t,e,n){const i=yield OB(t,{pageToken:n});e.prefixes.push(...i.prefixes),e.items.push(...i.items),null!=i.nextPageToken&&(yield kB(t,e,i.nextPageToken))})).apply(this,arguments)}function OB(t,e){null!=e&&"number"==typeof e.maxResults&&CA("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=vse(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,ho)}function $se(t){t._throwIfRoot("getDownloadURL");const e=function Ese(t,e,n){const i=Ba(e.fullServerUrl(),t.host,t._protocol),o=t.maxOperationRetryTime,a=new Go(i,"GET",function yse(t,e){return function n(r,i){const s=TB(t,i,e);return Ko(null!==s),function pse(t,e,n,r){const i=bA(e);if(null===i||!tw(i.downloadTokens))return null;const s=i.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map(l=>{const p=t.fullPath;return Ba("/b/"+o(t.bucket)+"/o/"+o(p),n,r)+_B({alt:"media",token:l})})[0]}(s,i,t.host,t._protocol)}}(t,n),o);return a.errorHandler=Hm(e),a}(t.storage,t._location,$m());return t.storage.makeRequestWithTokens(e,ho).then(n=>{if(null===n)throw function Bie(){return new Dn(mn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return n})}function LB(t,e){const n=function lse(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),r=new ei(t._location.bucket,n);return new Rc(t.storage,r)}function FB(t,e){if(t instanceof MA){const n=t;if(null==n._bucket)throw function Vie(){return new Dn(mn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+cB+"' property when initializing the app?")}();const r=new Rc(n,n._bucket);return null!=e?FB(r,e):r}return void 0!==e?LB(t,e):t}function Wse(t,e){if(e&&function zse(t){return/^[A-Za-z]+:\/\//.test(t)}(e)){if(t instanceof MA)return function qse(t,e){return new Rc(t,e)}(t,e);throw ff("To use ref(service, url), the first argument must be a Storage instance.")}return FB(t,e)}function VB(t,e){const n=e?.[cB];return null==n?null:ei.makeFromBucketSpec(n,t)}class MA{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=lB,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?ei.makeFromBucketSpec(i,this._host):VB(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?ei.makeFromBucketSpec(this._url,e):VB(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){CA("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){CA("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,q.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const n=e._authProvider.getImmediate({optional:!0});if(n){const r=yield n.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,q.Z)(function*(){const n=e._appCheckProvider.getImmediate({optional:!0});return n?(yield n.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Rc(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new $ie(pB());{const o=function Jie(t,e,n,r,i,s,o=!0){const a=_B(t.urlParams),u=t.url+a,l=Object.assign({},t.headers);return function Yie(t,e){e&&(t["X-Firebase-GMPID"]=e)}(l,e),function Zie(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(l,n),function Qie(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(l,s),function Xie(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(l,r),new Kie(u,t.method,l,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,n){var r=this;return(0,q.Z)(function*(){const[i,s]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,n,i,s).getPromise()})()}}const UB="@firebase/storage";function $B(t,e){return Wse(t=(0,w.m9)(t),e)}function noe(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new MA(n,r,i,e,Fi.SDK_VERSION)}!function roe(){(0,Fi._registerComponent)(new co.wA("storage",noe,"PUBLIC").setMultipleInstances(!0)),(0,Fi.registerVersion)(UB,"0.12.0",""),(0,Fi.registerVersion)(UB,"0.12.0","esm2017")}();class ow{constructor(e,n,r){this._delegate=e,this.task=n,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class zB{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new ow(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(r=>{if(e)return e(new ow(r,this,this._ref))},n)}on(e,n,r,i){let s;return n&&(s="function"==typeof n?o=>n(new ow(o,this,this._ref)):{next:n.next?o=>n.next(new ow(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}}class qB{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new ja(e,this._service))}get items(){return this._delegate.items.map(e=>new ja(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class ja{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const n=function toe(t,e){return LB(t,e)}(this._delegate,e);return new ja(n,this.storage)}get root(){return new ja(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new ja(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new zB(function Kse(t,e,n){return function Fse(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new MB(t,new Wo(e),n)}(t=(0,w.m9)(t),e,n)}(this._delegate,e,n),this)}putString(e,n=as.RAW,r){this._throwIfRoot("putString");const i=DA(n,e),s=Object.assign({},r);return null==s.contentType&&null!=i.contentType&&(s.contentType=i.contentType),new zB(new MB(this._delegate,new Wo(i.data,!0),s),this)}listAll(){return function Xse(t){return function Use(t){const e={prefixes:[],items:[]};return kB(t,e).then(()=>e)}(t=(0,w.m9)(t))}(this._delegate).then(e=>new qB(e,this.storage))}list(e){return function Yse(t,e){return OB(t=(0,w.m9)(t),e)}(this._delegate,e||void 0).then(n=>new qB(n,this.storage))}getMetadata(){return function Zse(t){return function Bse(t){t._throwIfRoot("getMetadata");const e=DB(t.storage,t._location,$m());return t.storage.makeRequestWithTokens(e,ho)}(t=(0,w.m9)(t))}(this._delegate)}updateMetadata(e){return function Qse(t,e){return function jse(t,e){t._throwIfRoot("updateMetadata");const n=function Ise(t,e,n,r){const s=Ba(e.fullServerUrl(),t.host,t._protocol),a=AA(n,r),l=t.maxOperationRetryTime,h=new Go(s,"PATCH",iw(t,r),l);return h.headers={"Content-Type":"application/json; charset=utf-8"},h.body=a,h.errorHandler=Hm(e),h}(t.storage,t._location,e,$m());return t.storage.makeRequestWithTokens(n,ho)}(t=(0,w.m9)(t),e)}(this._delegate,e)}getDownloadURL(){return function Jse(t){return $se(t=(0,w.m9)(t))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function eoe(t){return function Hse(t){t._throwIfRoot("deleteObject");const e=function wse(t,e){const r=Ba(e.fullServerUrl(),t.host,t._protocol),a=new Go(r,"DELETE",function o(u,l){},t.maxOperationRetryTime);return a.successCodes=[200,204],a.errorHandler=Hm(e),a}(t.storage,t._location);return t.storage.makeRequestWithTokens(e,ho)}(t=(0,w.m9)(t))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw gB(e)}}class WB{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(GB(e))throw ff("ref() expected a child path but got a URL, use refFromURL instead.");return new ja($B(this._delegate,e),this)}refFromURL(e){if(!GB(e))throw ff("refFromURL() expected a full URL but got a child path, use ref() instead.");try{ei.makeFromUrl(e,this._delegate.host)}catch{throw ff("refFromUrl() expected a valid full URL but got an invalid one.")}return new ja($B(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,r={}){!function HB(t,e,n,r={}){!function Gse(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken="string"==typeof i?i:(0,w.Sg)(i,t.app.options.projectId))}(t,e,n,r)}(this._delegate,e,n,r)}}function GB(t){return/^[A-Za-z]+:\/\//.test(t)}function aoe(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("storage").getImmediate({identifier:e});return new WB(n,r)}function KB(t){const e=function loe(t){return new qt(e=>{const n=o=>e.next(o);n(t.snapshot);const s=t.on("state_changed",n);return t.then(o=>{n(o),e.complete()},o=>{n(t.snapshot),(o=>{e.error(o)})(o)}),function(){s()}}).pipe(function bie(t,e=YI){return ge((n,r)=>{let i=null,s=null,o=null;const a=()=>{if(i){i.unsubscribe(),i=null;const l=s;s=null,r.next(l)}};function u(){const l=o+t,h=e.now();if(h<l)return i=this.schedule(void 0,l-h),void r.add(i);a()}n.subscribe(Te(r,l=>{s=l,o=e.now(),i||(i=e.schedule(u,t),r.add(i))},()=>{a(),r.complete()},void 0,()=>{s=i=null}))})}(0))}(t);return{task:t,then:t.then.bind(t),catch:t.catch.bind(t),pause:t.pause.bind(t),cancel:t.cancel.bind(t),resume:t.resume.bind(t),snapshotChanges:()=>e,percentageChanges:()=>e.pipe(fe(n=>n.bytesTransferred/n.totalBytes*100))}}function aw(t){return{getDownloadURL:()=>Re(void 0).pipe(rB,$n(()=>t.getDownloadURL()),Hn),getMetadata:()=>Re(void 0).pipe(rB,$n(()=>t.getMetadata()),Hn),delete:()=>jt(t.delete()),child:e=>aw(t.child(e)),updateMetadata:e=>jt(t.updateMetadata(e)),put:(e,n)=>KB(t.put(e,n)),putString:(e,n,r)=>KB(t.putString(e,n,r)),list:e=>jt(t.list(e)),listAll:()=>jt(t.listAll())}}!function uoe(t){const e={TaskState:Ii,TaskEvent:bse,StringFormat:as,Storage:WB,Reference:ja};t.INTERNAL.registerComponent(new co.wA("storage-compat",aoe,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage-compat","0.3.3")}(Vi.Z);const coe=new ue("angularfire2.storageBucket"),doe=new ue("angularfire2.storage.maxUploadRetryTime"),hoe=new ue("angularfire2.storage.maxOperationRetryTime"),foe=new ue("angularfire2.storage.use-emulator");let poe=(()=>{class t{storage;constructor(n,r,i,s,o,a,u,l,h,p){const m=Vm(n,o,r);this.storage=ew(`${m.name}.storage.${i}`,"AngularFireStorage",m.name,()=>{const _=o.runOutsideAngular(()=>m.storage(i||void 0)),v=h;return v&&_.useEmulator(...v),u&&_.setMaxUploadRetryTime(u),l&&_.setMaxOperationRetryTime(l),_},[u,l])}ref(n){return aw(this.storage.ref(n))}refFromURL(n){return aw(this.storage.refFromURL(n))}upload(n,r,i){return aw(this.storage.ref(n)).put(r,i)}static \u0275fac=function(r){return new(r||t)(K(df),K(hf,8),K(coe,8),K(eo),K(ht),K(JI),K(doe,8),K(hoe,8),K(foe,8),K(XI,8))};static \u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),goe=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=_r({type:t});static \u0275inj=Ar({})}return t})(),moe=(()=>{class t{constructor(){Vi.Z.registerVersion("angularfire",uf.full,"gcs-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=_r({type:t});static \u0275inj=Ar({providers:[poe],imports:[goe]})}return t})();function xA(){return ge((t,e)=>{let n,r=!1;t.subscribe(Te(e,i=>{const s=n;n=i,r&&e.next([s,i]),r=!0}))})}function ZB(t,e=or){return t=t??_oe,ge((n,r)=>{let i,s=!0;n.subscribe(Te(r,o=>{const a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function _oe(t,e){return t===e}var de,us=We(879),yoe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},fo={},kA=kA||{},Ge=yoe||self;function uw(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function zm(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var OA="closure_uid_"+(1e9*Math.random()>>>0),Eoe=0;function Ioe(t,e,n){return t.call.apply(t.bind,arguments)}function woe(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function ti(t,e,n){return(ti=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ioe:woe).apply(null,arguments)}function lw(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function vr(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Qu(){this.s=this.s,this.o=this.o}Qu.prototype.s=!1,Qu.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function voe(t){Object.prototype.hasOwnProperty.call(t,OA)&&t[OA]||(t[OA]=++Eoe)}(this)},Qu.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const QB=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function LA(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function YB(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(uw(r)){const i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function ni(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}ni.prototype.h=function(){this.defaultPrevented=!0};var Coe=function(){if(!Ge.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const n=()=>{};Ge.addEventListener("test",n,e),Ge.removeEventListener("test",n,e)}catch{}return t}();function qm(t){return/^[\s\xa0]*$/.test(t)}function cw(){var t=Ge.navigator;return t&&(t=t.userAgent)?t:""}function Zo(t){return-1!=cw().indexOf(t)}function FA(t){return FA[" "](t),t}FA[" "]=function(){};var UA,t,Doe=Zo("Opera"),_f=Zo("Trident")||Zo("MSIE"),XB=Zo("Edge"),VA=XB||_f,JB=Zo("Gecko")&&!(-1!=cw().toLowerCase().indexOf("webkit")&&!Zo("Edge"))&&!(Zo("Trident")||Zo("MSIE"))&&!Zo("Edge"),boe=-1!=cw().toLowerCase().indexOf("webkit")&&!Zo("Edge");function ej(){var t=Ge.document;return t?t.documentMode:void 0}e:{var BA="",jA=(t=cw(),JB?/rv:([^\);]+)(\)|;)/.exec(t):XB?/Edge\/([\d\.]+)/.exec(t):_f?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):boe?/WebKit\/(\S+)/.exec(t):Doe?/(?:Version)[ \/]?(\S+)/.exec(t):void 0);if(jA&&(BA=jA?jA[1]:""),_f){var $A=ej();if(null!=$A&&$A>parseFloat(BA)){UA=String($A);break e}}UA=BA}var Aoe=Ge.document&&_f&&(ej()||parseInt(UA,10))||void 0;function Wm(t,e){if(ni.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(JB){e:{try{FA(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Roe[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Wm.$.h.call(this)}}vr(Wm,ni);var Roe={2:"touch",3:"pen",4:"mouse"};Wm.prototype.h=function(){Wm.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Gm="closure_listenable_"+(1e6*Math.random()|0),Poe=0;function Noe(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++Poe,this.fa=this.ia=!1}function dw(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function zA(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function nj(t){const e={};for(const n in t)e[n]=t[n];return e}const rj="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ij(t,e){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)t[n]=r[n];for(let s=0;s<rj.length;s++)n=rj[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function hw(t){this.src=t,this.g={},this.h=0}function qA(t,e){var n=e.type;if(n in t.g){var s,r=t.g[n],i=QB(r,e);(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(dw(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function WA(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}hw.prototype.add=function(t,e,n,r,i){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=WA(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new Noe(e,this.src,s,!!r,i)).ia=n,t.push(e)),e};var GA="closure_lm_"+(1e6*Math.random()|0),KA={};function sj(t,e,n,r,i){if(r&&r.once)return aj(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)sj(t,e[s],n,r,i);return null}return n=XA(n),t&&t[Gm]?t.O(e,n,zm(r)?!!r.capture:!!r,i):oj(t,e,n,!1,r,i)}function oj(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=zm(i)?!!i.capture:!!i,a=QA(t);if(a||(t[GA]=a=new hw(t)),(n=a.add(e,n,r,o,s)).proxy)return n;if(r=function xoe(){const e=koe;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Coe||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(lj(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function aj(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)aj(t,e[s],n,r,i);return null}return n=XA(n),t&&t[Gm]?t.P(e,n,zm(r)?!!r.capture:!!r,i):oj(t,e,n,!0,r,i)}function uj(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)uj(t,e[s],n,r,i);else r=zm(r)?!!r.capture:!!r,n=XA(n),t&&t[Gm]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=WA(s=t.g[e],n,r,i))&&(dw(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=QA(t))&&(e=t.g[e.toString()],t=-1,e&&(t=WA(e,n,r,i)),(n=-1<t?e[t]:null)&&ZA(n))}function ZA(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[Gm])qA(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(lj(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=QA(e))?(qA(n,t),0==n.h&&(n.src=null,e[GA]=null)):dw(t)}}}function lj(t){return t in KA?KA[t]:KA[t]="on"+t}function koe(t,e){if(t.fa)t=!0;else{e=new Wm(e,this);var n=t.listener,r=t.la||t.src;t.ia&&ZA(t),t=n.call(r,e)}return t}function QA(t){return(t=t[GA])instanceof hw?t:null}var YA="__closure_events_fn_"+(1e9*Math.random()>>>0);function XA(t){return"function"==typeof t?t:(t[YA]||(t[YA]=function(e){return t.handleEvent(e)}),t[YA])}function Er(){Qu.call(this),this.i=new hw(this),this.S=this,this.J=null}function kr(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,"string"==typeof e)e=new ni(e,t);else if(e instanceof ni)e.target=e.target||t;else{var i=e;ij(e=new ni(r,t),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=fw(o,r,!0,e)&&i}if(i=fw(o=e.g=t,r,!0,e)&&i,i=fw(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)i=fw(o=e.g=n[s],r,!1,e)&&i}function fw(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,u=o.la||o.src;o.ia&&qA(t.i,o),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}vr(Er,Qu),Er.prototype[Gm]=!0,Er.prototype.removeEventListener=function(t,e,n,r){uj(this,t,e,n,r)},Er.prototype.N=function(){if(Er.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)dw(n[r]);delete t.g[e],t.h--}}this.J=null},Er.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Er.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var JA=Ge.JSON.stringify;function Loe(){var t=eR;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var cj=new class Ooe{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new Voe,t=>t.reset());class Voe{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function Uoe(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function Boe(t){Ge.setTimeout(()=>{throw t},0)}let Km,Zm=!1,eR=new class Foe{constructor(){this.h=this.g=null}add(e,n){const r=cj.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},dj=()=>{const t=Ge.Promise.resolve(void 0);Km=()=>{t.then(joe)}};var joe=()=>{for(var t;t=Loe();){try{t.h.call(t.g)}catch(n){Boe(n)}var e=cj;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Zm=!1};function pw(t,e){Er.call(this),this.h=t||1,this.g=e||Ge,this.j=ti(this.qb,this),this.l=Date.now()}function tR(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function nR(t,e,n){if("function"==typeof t)n&&(t=ti(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=ti(t.handleEvent,t)}return 2147483647<Number(e)?-1:Ge.setTimeout(t,e||0)}function hj(t){t.g=nR(()=>{t.g=null,t.i&&(t.i=!1,hj(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}vr(pw,Er),(de=pw.prototype).ga=!1,de.T=null,de.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),kr(this,"tick"),this.ga&&(tR(this),this.start()))}},de.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},de.N=function(){pw.$.N.call(this),tR(this),delete this.g};class $oe extends Qu{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:hj(this)}N(){super.N(),this.g&&(Ge.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Qm(t){Qu.call(this),this.h=t,this.g={}}vr(Qm,Qu);var fj=[];function pj(t,e,n,r){Array.isArray(n)||(n&&(fj[0]=n.toString()),n=fj);for(var i=0;i<n.length;i++){var s=sj(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function gj(t){zA(t.g,function(e,n){this.g.hasOwnProperty(n)&&ZA(e)},t),t.g={}}function gw(){this.g=!0}function yf(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function Woe(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return JA(n)}catch{return e}}(t,n)+(r?" "+r:"")})}Qm.prototype.N=function(){Qm.$.N.call(this),gj(this)},Qm.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},gw.prototype.Ea=function(){this.g=!1},gw.prototype.info=function(){};var Pc={},mj=null;function mw(){return mj=mj||new Er}function _j(t){ni.call(this,Pc.Ta,t)}function Ym(t){const e=mw();kr(e,new _j(e))}function yj(t,e){ni.call(this,Pc.STAT_EVENT,t),this.stat=e}function wi(t){const e=mw();kr(e,new yj(e,t))}function vj(t,e){ni.call(this,Pc.Ua,t),this.size=e}function Xm(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Ge.setTimeout(function(){t()},e)}Pc.Ta="serverreachability",vr(_j,ni),Pc.STAT_EVENT="statevent",vr(yj,ni),Pc.Ua="timingevent",vr(vj,ni);var _w={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Ej={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function rR(){}function wj(){}rR.prototype.h=null;var oR,Jm={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function iR(){ni.call(this,"d")}function sR(){ni.call(this,"c")}function yw(){}function e_(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Qm(this),this.P=Goe,this.V=new pw(t=VA?125:void 0),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Tj}function Tj(){this.i=null,this.g="",this.h=!1}vr(iR,ni),vr(sR,ni),vr(yw,rR),yw.prototype.g=function(){return new XMLHttpRequest},yw.prototype.i=function(){return{}},oR=new yw;var Goe=45e3,Cj={},aR={};function uR(t,e,n){t.L=1,t.A=ww($a(e)),t.u=n,t.S=!0,Sj(t,null)}function Sj(t,e){t.G=Date.now(),t_(t),t.B=$a(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),Oj(n.i,"t",r),t.o=0,n=t.l.J,t.h=new Tj,t.g=s$(t.l,n?e:null,!t.u),0<t.O&&(t.M=new $oe(ti(t.Pa,t,t.g),t.O)),pj(t.U,t.g,"readystatechange",t.nb),e=t.I?nj(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Ym(),function Hoe(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var l=a[u].split("=");if(1<l.length){var h=l[0];l=l[1];var p=h.split("_");o=2<=p.length&&"type"==p[1]?o+(h+"=")+l+"&":o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o})}(t.j,t.v,t.B,t.m,t.W,t.u)}function Dj(t){return!!t.g&&"GET"==t.v&&2!=t.L&&t.l.Ha}function bj(t,e,n){let i,r=!0;for(;!t.J&&t.o<n.length;){if(i=Koe(t,n),i==aR){4==e&&(t.s=4,wi(14),r=!1),yf(t.j,t.m,null,"[Incomplete Response]");break}if(i==Cj){t.s=4,wi(15),yf(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}yf(t.j,t.m,i,null),lR(t,i)}Dj(t)&&0!=t.o&&(t.h.g=t.h.g.slice(t.o),t.o=0),4!=e||0!=n.length||t.h.h||(t.s=1,wi(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),mR(e),e.M=!0,wi(11))):(yf(t.j,t.m,n,"[Invalid Chunked Response]"),Nc(t),n_(t))}function Koe(t,e){var n=t.o,r=e.indexOf("\n",n);return-1==r?aR:(n=Number(e.substring(n,r)),isNaN(n)?Cj:(r+=1)+n>e.length?aR:(e=e.slice(r,r+n),t.o=r+n,e))}function t_(t){t.Y=Date.now()+t.P,Aj(t,t.P)}function Aj(t,e){if(null!=t.C)throw Error("WatchDog timer not null");t.C=Xm(ti(t.lb,t),e)}function vw(t){t.C&&(Ge.clearTimeout(t.C),t.C=null)}function n_(t){0==t.l.H||t.J||t$(t.l,t)}function Nc(t){vw(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,tR(t.V),gj(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function lR(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||cR(n.i,t)))if(!t.K&&cR(n.i,t)&&3==n.H){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break e;Aw(n),Dw(n)}gR(n),wi(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=Xm(ti(n.ib,n),6e3));if(1>=Vj(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else xc(n,11)}else if((t.K||n.g==t)&&Aw(n),!qm(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(n.V=l[0],l=l[1],2==n.H)if("c"==l[0]){n.K=l[1],n.pa=l[2];const h=l[3];null!=h&&(n.ra=h,n.l.info("VER="+n.ra));const p=l[4];null!=p&&(n.Ga=p,n.l.info("SVER="+n.Ga));const m=l[5];null!=m&&"number"==typeof m&&0<m&&(n.L=r=1.5*m,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const _=t.g;if(_){const v=_.g?_.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(v){var s=r.i;s.g||-1==v.indexOf("spdy")&&-1==v.indexOf("quic")&&-1==v.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(dR(s,s.h),s.h=null))}if(r.F){const I=_.g?_.g.getResponseHeader("X-HTTP-Session-Id"):null;I&&(r.Da=I,ln(r.I,r.F,I))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=t;if((r=n).wa=i$(r,r.J?r.pa:null,r.Y),o.K){Uj(r.i,o);var a=o,u=r.L;u&&a.setTimeout(u),a.C&&(vw(a),t_(a)),r.g=o}else Jj(r);0<n.j.length&&bw(n)}else"stop"!=l[0]&&"close"!=l[0]||xc(n,7);else 3==n.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?xc(n,7):pR(n):"noop"!=l[0]&&n.h&&n.h.Aa(l),n.A=0)}Ym()}catch{}}function Rj(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(uw(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function Qoe(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(uw(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}(t),r=function Zoe(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(uw(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}(de=e_.prototype).setTimeout=function(t){this.P=t},de.nb=function(t){t=t.target;const e=this.M;e&&3==Qo(t)?e.l():this.Pa(t)},de.Pa=function(t){try{if(t==this.g)e:{const h=Qo(this.g);var e=this.g.Ia();if(this.g.da(),!(3>h)&&(3!=h||VA||this.g&&(this.h.h||this.g.ja()||Gj(this.g)))){this.J||4!=h||7==e||Ym(),vw(this);var n=this.g.da();this.ca=n;t:if(Dj(this)){var r=Gj(this.g);t="";var i=r.length,s=4==Qo(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Nc(this),n_(this);var o="";break t}this.h.i=new Ge.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function zoe(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+s+" "+o})}(this.j,this.v,this.B,this.m,this.W,h,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!qm(a)){var l=a;break t}}l=null}if(!(n=l)){this.i=!1,this.s=3,wi(12),Nc(this),n_(this);break e}yf(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,lR(this,n)}this.S?(bj(this,h,o),VA&&this.i&&3==h&&(pj(this.U,this.V,"tick",this.mb),this.V.start())):(yf(this.j,this.m,o,null),lR(this,o)),4==h&&Nc(this),this.i&&!this.J&&(4==h?t$(this.l,this):(this.i=!1,t_(this)))}else(function pae(t){const e={};t=(t.g&&2<=Qo(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<t.length;r++){if(qm(t[r]))continue;var n=Uoe(t[r]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}!function Moe(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,function(r){return r.join(", ")})})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,wi(12)):(this.s=0,wi(13)),Nc(this),n_(this)}}}catch{}},de.mb=function(){if(this.g){var t=Qo(this.g),e=this.g.ja();this.o<e.length&&(vw(this),bj(this,t,e),this.i&&4!=t&&t_(this))}},de.cancel=function(){this.J=!0,Nc(this)},de.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(function qoe(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.j,this.B),2!=this.L&&(Ym(),wi(17)),Nc(this),this.s=2,n_(this)):Aj(this,this.Y-t)};var Pj=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Mc(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Mc){this.h=t.h,Ew(this,t.j),this.s=t.s,this.g=t.g,Iw(this,t.m),this.l=t.l;var e=t.i,n=new s_;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Nj(this,n),this.o=t.o}else t&&(e=String(t).match(Pj))?(this.h=!1,Ew(this,e[1]||"",!0),this.s=r_(e[2]||""),this.g=r_(e[3]||"",!0),Iw(this,e[4]),this.l=r_(e[5]||"",!0),Nj(this,e[6]||"",!0),this.o=r_(e[7]||"")):(this.h=!1,this.i=new s_(null,this.h))}function $a(t){return new Mc(t)}function Ew(t,e,n){t.j=n?r_(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Iw(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Nj(t,e,n){e instanceof s_?(t.i=e,function rae(t,e){e&&!t.j&&(Yu(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(xj(this,r),Oj(this,i,n))},t)),t.j=e}(t.i,t.h)):(n||(e=i_(e,tae)),t.i=new s_(e,t.h))}function ln(t,e,n){t.i.set(e,n)}function ww(t){return ln(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function r_(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function i_(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Xoe),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Xoe(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Mc.prototype.toString=function(){var t=[],e=this.j;e&&t.push(i_(e,Mj,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(i_(e,Mj,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(i_(n,"/"==n.charAt(0)?eae:Joe,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",i_(n,nae)),t.join("")};var Mj=/[#\/\?@]/g,Joe=/[#\?:]/g,eae=/[#\?]/g,tae=/[#\?@]/g,nae=/#/g;function s_(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Yu(t){t.g||(t.g=new Map,t.h=0,t.i&&function Yoe(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function xj(t,e){Yu(t),e=vf(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function kj(t,e){return Yu(t),e=vf(t,e),t.g.has(e)}function Oj(t,e,n){xj(t,e),0<n.length&&(t.i=null,t.g.set(vf(t,e),LA(n)),t.h+=n.length)}function vf(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(de=s_.prototype).add=function(t,e){Yu(this),this.i=null,t=vf(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},de.forEach=function(t,e){Yu(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)},de.ta=function(){Yu(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n},de.Z=function(t){Yu(this);let e=[];if("string"==typeof t)kj(this,t)&&(e=e.concat(this.g.get(vf(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},de.set=function(t,e){return Yu(this),this.i=null,kj(this,t=vf(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},de.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},de.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};var iae=class{constructor(t,e){this.g=t,this.map=e}};function Lj(t){this.l=t||sae,t=Ge.PerformanceNavigationTiming?0<(t=Ge.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Ge.g&&Ge.g.Ka&&Ge.g.Ka()&&Ge.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var sae=10;function Fj(t){return!!t.h||!!t.g&&t.g.size>=t.j}function Vj(t){return t.h?1:t.g?t.g.size:0}function cR(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function dR(t,e){t.g?t.g.add(e):t.h=e}function Uj(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Bj(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return LA(t.i)}Lj.prototype.cancel=function(){if(this.i=Bj(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var oae=class{stringify(t){return Ge.JSON.stringify(t,void 0)}parse(t){return Ge.JSON.parse(t,void 0)}};function aae(){this.g=new oae}function uae(t,e,n){const r=n||"";try{Rj(t,function(i,s){let o=i;zm(i)&&(o=JA(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Tw(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function o_(t){this.l=t.ec||null,this.j=t.ob||!1}function Cw(t,e){Er.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=hR,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}vr(o_,rR),o_.prototype.g=function(){return new Cw(this.l,this.j)},o_.prototype.i=function(t){return function(){return t}}({}),vr(Cw,Er);var hR=0;function jj(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function a_(t){t.readyState=4,t.l=null,t.j=null,t.A=null,u_(t)}function u_(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(de=Cw.prototype).open=function(t,e){if(this.readyState!=hR)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,u_(this)},de.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Ge).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},de.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,a_(this)),this.readyState=hR},de.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,u_(this)),this.g&&(this.readyState=3,u_(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Ge.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;jj(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},de.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?a_(this):u_(this),3==this.readyState&&jj(this)}},de.Za=function(t){this.g&&(this.response=this.responseText=t,a_(this))},de.Ya=function(t){this.g&&(this.response=t,a_(this))},de.ka=function(){this.g&&a_(this)},de.setRequestHeader=function(t,e){this.v.append(t,e)},de.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},de.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Cw.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var cae=Ge.JSON.parse;function Mn(t){Er.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=$j,this.L=this.M=!1}vr(Mn,Er);var $j="",dae=/^https?$/i,hae=["POST","PUT"];function Hj(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,zj(t),Sw(t)}function zj(t){t.F||(t.F=!0,kr(t,"complete"),kr(t,"error"))}function qj(t){if(t.h&&typeof kA<"u"&&(!t.C[1]||4!=Qo(t)||2!=t.da()))if(t.v&&4==Qo(t))nR(t.La,0,t);else if(kr(t,"readystatechange"),4==Qo(t)){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=0===o){var i=String(t.I).match(Pj)[1]||null;!i&&Ge.self&&Ge.self.location&&(i=Ge.self.location.protocol.slice(0,-1)),r=!dae.test(i?i.toLowerCase():"")}n=r}if(n)kr(t,"complete"),kr(t,"success");else{t.m=6;try{var s=2<Qo(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",zj(t)}}finally{Sw(t)}}}function Sw(t,e){if(t.g){Wj(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||kr(t,"ready");try{n.onreadystatechange=r}catch{}}}function Wj(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Ge.clearTimeout(t.A),t.A=null)}function Qo(t){return t.g?t.g.readyState:0}function Gj(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case $j:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function Kj(t){let e="";return zA(t,function(n,r){e+=r,e+=":",e+=n,e+="\r\n"}),e}function fR(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Kj(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):ln(t,e,n))}function l_(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Zj(t){this.Ga=0,this.j=[],this.l=new gw,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=l_("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=l_("baseRetryDelayMs",5e3,t),this.hb=l_("retryDelaySeedMs",1e4,t),this.eb=l_("forwardChannelMaxRetries",2,t),this.xa=l_("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new Lj(t&&t.concurrentRequestLimit),this.Ja=new aae,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function pR(t){if(Qj(t),3==t.H){var e=t.W++,n=$a(t.I);if(ln(n,"SID",t.K),ln(n,"RID",e),ln(n,"TYPE","terminate"),c_(t,n),(e=new e_(t,t.l,e)).L=2,e.A=ww($a(n)),n=!1,Ge.navigator&&Ge.navigator.sendBeacon)try{n=Ge.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&Ge.Image&&((new Image).src=e.A,n=!0),n||(e.g=s$(e.l,null),e.g.ha(e.A)),e.G=Date.now(),t_(e)}r$(t)}function Dw(t){t.g&&(mR(t),t.g.cancel(),t.g=null)}function Qj(t){Dw(t),t.u&&(Ge.clearTimeout(t.u),t.u=null),Aw(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Ge.clearTimeout(t.m),t.m=null)}function bw(t){if(!Fj(t.i)&&!t.m){t.m=!0;var e=t.Na;Km||dj(),Zm||(Km(),Zm=!0),eR.add(e,t),t.C=0}}function Yj(t,e){var n;n=e?e.m:t.W++;const r=$a(t.I);ln(r,"SID",t.K),ln(r,"RID",n),ln(r,"AID",t.V),c_(t,r),t.o&&t.s&&fR(r,t.o,t.s),n=new e_(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=Xj(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),dR(t.i,n),uR(n,r,e)}function c_(t,e){t.na&&zA(t.na,function(n,r){ln(e,r,n)}),t.h&&Rj({},function(n,r){ln(e,r,n)})}function Xj(t,e,n){n=Math.min(t.j.length,n);var r=t.h?ti(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){const o=["count="+n];-1==s?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let u=0;u<n;u++){let l=i[u].g;const h=i[u].map;if(l-=s,0>l)s=Math.max(0,i[u].g-100),a=!1;else try{uae(h,o,"req"+l+"_")}catch{r&&r(h)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function Jj(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Km||dj(),Zm||(Km(),Zm=!0),eR.add(e,t),t.A=0}}function gR(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=Xm(ti(t.Ma,t),n$(t,t.A)),t.A++,0))}function mR(t){null!=t.B&&(Ge.clearTimeout(t.B),t.B=null)}function e$(t){t.g=new e_(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=$a(t.wa);ln(e,"RID","rpc"),ln(e,"SID",t.K),ln(e,"AID",t.V),ln(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&ln(e,"TO",t.qa),ln(e,"TYPE","xmlhttp"),c_(t,e),t.o&&t.s&&fR(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=ww($a(e)),n.u=null,n.S=!0,Sj(n,t)}function Aw(t){null!=t.v&&(Ge.clearTimeout(t.v),t.v=null)}function t$(t,e){var n=null;if(t.g==e){Aw(t),mR(t),t.g=null;var r=2}else{if(!cR(t.i,e))return;n=e.F,Uj(t.i,e),r=1}if(0!=t.H)if(e.i)if(1==r){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;kr(r=mw(),new vj(r,n)),bw(t)}else Jj(t);else if(3==(i=e.s)||0==i&&0<e.ca||!(1==r&&function gae(t,e){return!(Vj(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=Xm(ti(t.Na,t,e),n$(t,t.C)),t.C++,0)))}(t,e)||2==r&&gR(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:xc(t,5);break;case 4:xc(t,10);break;case 3:xc(t,6);break;default:xc(t,2)}}function n$(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function xc(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var r=ti(t.pb,t);n||(n=new Mc("//www.google.com/images/cleardot.gif"),Ge.location&&"http"==Ge.location.protocol||Ew(n,"https"),ww(n)),function lae(t,e){const n=new gw;if(Ge.Image){const r=new Image;r.onload=lw(Tw,n,r,"TestLoadImage: loaded",!0,e),r.onerror=lw(Tw,n,r,"TestLoadImage: error",!1,e),r.onabort=lw(Tw,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=lw(Tw,n,r,"TestLoadImage: timeout",!1,e),Ge.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else wi(2);t.H=0,t.h&&t.h.za(e),r$(t),Qj(t)}function r$(t){if(t.H=0,t.ma=[],t.h){const e=Bj(t.i);(0!=e.length||0!=t.j.length)&&(YB(t.ma,e),YB(t.ma,t.j),t.i.i.length=0,LA(t.j),t.j.length=0),t.h.ya()}}function i$(t,e,n){var r=n instanceof Mc?$a(n):new Mc(n);if(""!=r.g)e&&(r.g=e+"."+r.g),Iw(r,r.m);else{var i=Ge.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Mc(null);r&&Ew(s,r),e&&(s.g=e),i&&Iw(s,i),n&&(s.l=n),r=s}return e=t.Da,(n=t.F)&&e&&ln(r,n,e),ln(r,"VER",t.ra),c_(t,r),r}function s$(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Mn(t.Ha&&!t.va?new o_({ob:n}):t.va)).Oa(t.J),e}function o$(){}function Rw(){if(_f&&!(10<=Number(Aoe)))throw Error("Environmental error: no available transport.")}function ls(t,e){Er.call(this),this.g=new Zj(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!qm(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!qm(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new Ef(this)}function a$(t){iR.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function u$(){sR.call(this),this.status=1}function Ef(t){this.g=t}function po(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function _R(t,e,n){n||(n=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;var s=t.g[3],o=(e=t.g[0])+(s^(n=t.g[1])&((i=t.g[2])^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}function Lt(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=0|t[i];r&&s==e||(n[i]=s,r=!1)}this.g=n}(de=Mn.prototype).Oa=function(t){this.M=t},de.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():oR.g(),this.C=function Ij(t){return t.h||(t.h=t.i())}(this.u?this.u:oR),this.g.onreadystatechange=ti(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){return void Hj(this,s)}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const s of r.keys())n.set(s,r.get(s))}r=Array.from(n.keys()).find(s=>"content-type"==s.toLowerCase()),i=Ge.FormData&&t instanceof Ge.FormData,!(0<=QB(hae,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Wj(this),0<this.B&&((this.L=function fae(t){return _f&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ti(this.ua,this)):this.A=nR(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){Hj(this,s)}},de.ua=function(){typeof kA<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,kr(this,"timeout"),this.abort(8))},de.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,kr(this,"complete"),kr(this,"abort"),Sw(this))},de.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Sw(this,!0)),Mn.$.N.call(this)},de.La=function(){this.s||(this.G||this.v||this.l?qj(this):this.kb())},de.kb=function(){qj(this)},de.isActive=function(){return!!this.g},de.da=function(){try{return 2<Qo(this)?this.g.status:-1}catch{return-1}},de.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},de.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),cae(e)}},de.Ia=function(){return this.m},de.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(de=Zj.prototype).ra=8,de.H=1,de.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new e_(this,this.l,t);let s=this.s;if(this.U&&(s?(s=nj(s),ij(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=n;break e}if(4096===e||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=Xj(this,i,e),ln(n=$a(this.I),"RID",t),ln(n,"CVER",22),this.F&&ln(n,"X-HTTP-Session-Id",this.F),c_(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(Kj(s)))+"&"+e:this.o&&fR(n,this.o,s)),dR(this.i,i),this.bb&&ln(n,"TYPE","init"),this.P?(ln(n,"$req",e),ln(n,"SID","null"),i.aa=!0,uR(i,n,null)):uR(i,n,e),this.H=2}}else 3==this.H&&(t?Yj(this,t):0==this.j.length||Fj(this.i)||Yj(this))},de.Ma=function(){if(this.u=null,e$(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Xm(ti(this.jb,this),t)}},de.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,wi(10),Dw(this),e$(this))},de.ib=function(){null!=this.v&&(this.v=null,Dw(this),gR(this),wi(19))},de.pb=function(t){t?(this.l.info("Successfully pinged google.com"),wi(2)):(this.l.info("Failed to ping google.com"),wi(1))},de.isActive=function(){return!!this.h&&this.h.isActive(this)},(de=o$.prototype).Ba=function(){},de.Aa=function(){},de.za=function(){},de.ya=function(){},de.isActive=function(){return!0},de.Va=function(){},Rw.prototype.g=function(t,e){return new ls(t,e)},vr(ls,Er),ls.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;wi(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=i$(t,null,t.Y),bw(t)},ls.prototype.close=function(){pR(this.g)},ls.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=JA(t),t=n);e.j.push(new iae(e.fb++,t)),3==e.H&&bw(e)},ls.prototype.N=function(){this.g.h=null,delete this.j,pR(this.g),delete this.g,ls.$.N.call(this)},vr(a$,iR),vr(u$,sR),vr(Ef,o$),Ef.prototype.Ba=function(){kr(this.g,"a")},Ef.prototype.Aa=function(t){kr(this.g,new a$(t))},Ef.prototype.za=function(t){kr(this.g,new u$)},Ef.prototype.ya=function(){kr(this.g,"b")},vr(po,function mae(){this.blockSize=-1}),po.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},po.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=n;)_R(this,t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){_R(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){_R(this,r),i=0;break}}this.h=i,this.i+=e},po.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};var _ae={};function yR(t){return-128<=t&&128>t?function Soe(t,e){var n=_ae;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(e){return new Lt([0|e],0>e?-1:0)}):new Lt([0|t],0>t?-1:0)}function Yo(t){if(isNaN(t)||!isFinite(t))return If;if(0>t)return Or(Yo(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=vR;return new Lt(e,0)}var vR=4294967296,If=yR(0),ER=yR(1),c$=yR(16777216);function Ha(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function Os(t){return-1==t.h}function Or(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Lt(n,~t.h).add(ER)}function Pw(t,e){return t.add(Or(e))}function Nw(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function d_(t,e){this.g=t,this.h=e}function Mw(t,e){if(Ha(e))throw Error("division by zero");if(Ha(t))return new d_(If,If);if(Os(t))return e=Mw(Or(t),e),new d_(Or(e.g),Or(e.h));if(Os(e))return e=Mw(t,Or(e)),new d_(Or(e.g),e.h);if(30<t.g.length){if(Os(t)||Os(e))throw Error("slowDivide_ only works with positive integers.");for(var n=ER,r=e;0>=r.X(t);)n=d$(n),r=d$(r);var i=wf(n,1),s=wf(r,1);for(r=wf(r,2),n=wf(n,2);!Ha(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=wf(r,1),n=wf(n,1)}return e=Pw(t,i.R(e)),new d_(i,e)}for(i=If;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=Yo(n)).R(e);Os(o)||0<o.X(t);)o=(s=Yo(n-=r)).R(e);Ha(s)&&(s=ER),i=i.add(s),t=Pw(t,o)}return new d_(i,t)}function d$(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Lt(n,t.h)}function wf(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Lt(i,t.h)}(de=Lt.prototype).ea=function(){if(Os(this))return-Or(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:vR+r)*e,e*=vR}return t},de.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(Ha(this))return"0";if(Os(this))return"-"+Or(this).toString(t);for(var e=Yo(Math.pow(t,6)),n=this,r="";;){var i=Mw(n,e).g,s=((0<(n=Pw(n,i.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(Ha(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},de.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},de.X=function(t){return Os(t=Pw(this,t))?-1:Ha(t)?0:1},de.abs=function(){return Os(this)?Or(this):this},de.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(65535&this.D(i))+(65535&t.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,n[i]=(o&=65535)<<16|(s&=65535)}return new Lt(n,-2147483648&n[n.length-1]?-1:0)},de.R=function(t){if(Ha(this)||Ha(t))return If;if(Os(this))return Os(t)?Or(this).R(Or(t)):Or(Or(this).R(t));if(Os(t))return Or(this.R(Or(t)));if(0>this.X(c$)&&0>t.X(c$))return Yo(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=t.D(i)>>>16,u=65535&t.D(i);n[2*r+2*i]+=o*u,Nw(n,2*r+2*i),n[2*r+2*i+1]+=s*u,Nw(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Nw(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Nw(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Lt(n,0)},de.gb=function(t){return Mw(this,t).h},de.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Lt(n,this.h&t.h)},de.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Lt(n,this.h|t.h)},de.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Lt(n,this.h^t.h)},Rw.prototype.createWebChannel=Rw.prototype.g,ls.prototype.send=ls.prototype.u,ls.prototype.open=ls.prototype.m,ls.prototype.close=ls.prototype.close,_w.NO_ERROR=0,_w.TIMEOUT=8,_w.HTTP_ERROR=6,Ej.COMPLETE="complete",wj.EventType=Jm,Jm.OPEN="a",Jm.CLOSE="b",Jm.ERROR="c",Jm.MESSAGE="d",Er.prototype.listen=Er.prototype.O,Mn.prototype.listenOnce=Mn.prototype.P,Mn.prototype.getLastError=Mn.prototype.Sa,Mn.prototype.getLastErrorCode=Mn.prototype.Ia,Mn.prototype.getStatus=Mn.prototype.da,Mn.prototype.getResponseJson=Mn.prototype.Wa,Mn.prototype.getResponseText=Mn.prototype.ja,Mn.prototype.send=Mn.prototype.ha,Mn.prototype.setWithCredentials=Mn.prototype.Oa,po.prototype.digest=po.prototype.l,po.prototype.reset=po.prototype.reset,po.prototype.update=po.prototype.j,Lt.prototype.add=Lt.prototype.add,Lt.prototype.multiply=Lt.prototype.R,Lt.prototype.modulo=Lt.prototype.gb,Lt.prototype.compare=Lt.prototype.X,Lt.prototype.toNumber=Lt.prototype.ea,Lt.prototype.toString=Lt.prototype.toString,Lt.prototype.getBits=Lt.prototype.D,Lt.fromNumber=Yo,Lt.fromString=function l$(t,e){if(0==t.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==t.charAt(0))return Or(l$(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Yo(Math.pow(e,8)),r=If,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Yo(Math.pow(e,s)),r=r.R(s).add(Yo(o))):r=(r=r.R(n)).add(Yo(o))}return r};var yae=fo.createWebChannelTransport=function(){return new Rw},vae=fo.getStatEventTarget=function(){return mw()},IR=fo.ErrorCode=_w,Eae=fo.EventType=Ej,Iae=fo.Event=Pc,h$=fo.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},xw=(fo.FetchXmlHttpFactory=o_,fo.WebChannel=wj),wae=fo.XhrIo=Mn,Tae=fo.Md5=po,Tf=fo.Integer=Lt;const f$="@firebase/firestore";class Ir{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ir.UNAUTHENTICATED=new Ir(null),Ir.GOOGLE_CREDENTIALS=new Ir("google-credentials-uid"),Ir.FIRST_PARTY=new Ir("first-party-uid"),Ir.MOCK_USER=new Ir("mock-user");let Cf="10.7.0";const Xu=new us.Yd("@firebase/firestore");function Sf(){return Xu.logLevel}function ne(t,...e){if(Xu.logLevel<=us.in.DEBUG){const n=e.map(wR);Xu.debug(`Firestore (${Cf}): ${t}`,...n)}}function zn(t,...e){if(Xu.logLevel<=us.in.ERROR){const n=e.map(wR);Xu.error(`Firestore (${Cf}): ${t}`,...n)}}function Ui(t,...e){if(Xu.logLevel<=us.in.WARN){const n=e.map(wR);Xu.warn(`Firestore (${Cf}): ${t}`,...n)}}function wR(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch{return t}}function _e(t="Unexpected state"){const e=`FIRESTORE (${Cf}) INTERNAL ASSERTION FAILED: `+t;throw zn(e),new Error(e)}function Se(t,e){t||_e()}function le(t,e){return t}const V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ee extends w.ZR{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class hr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}class p${constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Dae{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ir.UNAUTHENTICATED))}shutdown(){}}class bae{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Aae{constructor(e){this.t=e,this.currentUser=Ir.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){var r=this;let i=this.i;const s=l=>this.i!==i?(i=this.i,n(l)):Promise.resolve();let o=new hr;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new hr,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=o;e.enqueueRetryable((0,q.Z)(function*(){yield l.promise,yield s(r.currentUser)}))},u=l=>{ne("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>u(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?u(l):(ne("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new hr)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ne("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Se("string"==typeof r.accessToken),new p$(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Se(null===e||"string"==typeof e),new Ir(e)}}class Rae{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Ir.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Pae{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new Rae(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ir.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class g${constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Nae{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=s=>{null!=s.error&&ne("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,ne("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ne("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):ne("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Se("string"==typeof n.token),this.R=n.token,new g$(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Mae(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class m${static newId(){const n=62*Math.floor(256/62);let r="";for(;r.length<20;){const i=Mae(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return r}}function ze(t,e){return t<e?-1:t>e?1:0}function Df(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function _$(t){return t+"\0"}class _n{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ee(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ee(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ee(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ee(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return _n.fromMillis(Date.now())}static fromDate(e){return _n.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new _n(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ze(this.nanoseconds,e.nanoseconds):ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ae{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ae(e)}static min(){return new Ae(new _n(0,0))}static max(){return new Ae(new _n(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class h_{constructor(e,n,r){void 0===n?n=0:n>e.length&&_e(),void 0===r?r=e.length-n:r>e.length-n&&_e(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return 0===h_.comparator(this,e)}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof h_?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class vt extends h_{construct(e,n,r){return new vt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ee(V.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new vt(n)}static emptyPath(){return new vt([])}}const xae=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class cn extends h_{construct(e,n,r){return new cn(e,n,r)}static isValidIdentifier(e){return xae.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),cn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new cn(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(0===r.length)throw new ee(V.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if("\\"===a){if(i+1===e.length)throw new ee(V.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new ee(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===a?(o=!o,i++):"."!==a||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new ee(V.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new cn(n)}static emptyPath(){return new cn([])}}class ce{constructor(e){this.path=e}static fromPath(e){return new ce(vt.fromString(e))}static fromName(e){return new ce(vt.fromString(e).popFirst(5))}static empty(){return new ce(vt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===vt.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,n){return vt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ce(new vt(e.slice()))}}class bf{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function TR(t){return t.fields.find(e=>2===e.kind)}function kc(t){return t.fields.filter(e=>2!==e.kind)}bf.UNKNOWN_ID=-1;class Oc{constructor(e,n){this.fieldPath=e,this.kind=n}}class Af{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Af(0,cs.min())}}function y$(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Ae.fromTimestamp(1e9===r?new _n(n+1,0):new _n(n,r));return new cs(i,ce.empty(),e)}function v$(t){return new cs(t.readTime,t.key,-1)}class cs{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new cs(Ae.min(),ce.empty(),-1)}static max(){return new cs(Ae.max(),ce.empty(),-1)}}function CR(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=ce.comparator(t.documentKey,e.documentKey),0!==n?n:ze(t.largestBatchId,e.largestBatchId))}const E$="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class I${constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Ju(t){return SR.apply(this,arguments)}function SR(){return SR=(0,q.Z)(function*(t){if(t.code!==V.FAILED_PRECONDITION||t.message!==E$)throw t;ne("LocalStore","Unexpectedly lost primary lease")}),SR.apply(this,arguments)}class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&_e(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new O((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof O?n:O.resolve(n)}catch(n){return O.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):O.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):O.reject(n)}static resolve(e){return new O((n,r)=>{n(e)})}static reject(e){return new O((n,r)=>{r(e)})}static waitFor(e){return new O((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=O.resolve(!1);for(const r of e)n=n.next(i=>i?O.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new O((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let u=0;u<s;u++){const l=u;n(e[l]).next(h=>{o[l]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,n){return new O((r,i)=>{const s=()=>{!0===e()?n().next(()=>{s()},i):r()};s()})}}class kw{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new hr,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new f_(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=DR(r.target.error);this.V.reject(new f_(e,i))}}static open(e,n,r,i){try{return new kw(n,e.transaction(i,r))}catch(s){throw new f_(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(ne("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const n=this.transaction.objectStore(e);return new Fae(n)}}class go{constructor(e,n,r){this.name=e,this.version=n,this.p=r,12.2===go.S((0,w.z$)())&&zn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return ne("SimpleDb","Removing database:",e),Lc(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,w.hl)())return!1;if(go.C())return!0;const e=(0,w.z$)(),n=go.S(e),r=0<n&&n<10,i=go.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.F)}static M(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){var n=this;return(0,q.Z)(function*(){return n.db||(ne("SimpleDb","Opening database:",n.name),n.db=yield new Promise((r,i)=>{const s=indexedDB.open(n.name,n.version);s.onsuccess=o=>{r(o.target.result)},s.onblocked=()=>{i(new f_(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const a=o.target.error;i("VersionError"===a.name?new ee(V.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===a.name?new ee(V.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a):new f_(e,a))},s.onupgradeneeded=o=>{ne("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',o.oldVersion),n.p.N(o.target.result,s.transaction,o.oldVersion,n.version).next(()=>{ne("SimpleDb","Database upgrade to version "+n.version+" complete")})}})),n.B&&(n.db.onversionchange=r=>n.B(r)),n.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){var s=this;return(0,q.Z)(function*(){const o="readonly"===n;let a=0;for(;;){++a;try{s.db=yield s.O(e);const u=kw.open(s.db,e,o?"readonly":"readwrite",r),l=i(u).next(h=>(u.g(),h)).catch(h=>(u.abort(h),O.reject(h))).toPromise();return l.catch(()=>{}),yield u.m,l}catch(u){const l=u,h="FirebaseError"!==l.name&&a<3;if(ne("SimpleDb","Transaction failed with error:",l.message,"Retrying:",h),s.close(),!h)return Promise.reject(l)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class Lae{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return Lc(this.k.delete())}}class f_ extends ee{constructor(e,n){super(V.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function el(t){return"IndexedDbTransactionError"===t.name}class Fae{constructor(e){this.store=e}put(e,n){let r;return void 0!==n?(ne("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(ne("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Lc(r)}add(e){return ne("SimpleDb","ADD",this.store.name,e,e),Lc(this.store.add(e))}get(e){return Lc(this.store.get(e)).next(n=>(void 0===n&&(n=null),ne("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return ne("SimpleDb","DELETE",this.store.name,e),Lc(this.store.delete(e))}count(){return ne("SimpleDb","COUNT",this.store.name),Lc(this.store.count())}W(e,n){const r=this.options(e,n);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),s=[];return this.G(i,(o,a)=>{s.push(a)}).next(()=>s)}{const i=this.store.getAll(r.range);return new O((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}}j(e,n){const r=this.store.getAll(e,null===n?void 0:n);return new O((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){ne("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.J=!1;const i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.G(i,n)}Z(e){const n=this.cursor({});return new O((r,i)=>{n.onerror=s=>{const o=DR(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){const r=[];return new O((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const u=new Lae(a),l=n(a.primaryKey,a.value,u);if(l instanceof O){const h=l.catch(p=>(u.done(),O.reject(p)));r.push(h)}u.isDone?i():null===u.$?a.continue():a.continue(u.$)}}).next(()=>O.waitFor(r))}options(e,n){let r;return void 0!==e&&("string"==typeof e?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Lc(t){return new O((e,n)=>{t.onsuccess=r=>{e(r.target.result)},t.onerror=r=>{const i=DR(r.target.error);n(i)}})}let w$=!1;function DR(t){const e=go.S((0,w.z$)());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new ee("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return w$||(w$=!0,setTimeout(()=>{throw r},0)),r}}return t}class Vae{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ee(e){var n=this;ne("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,q.Z)(function*(){n.task=null;try{ne("IndexBackiller",`Documents written: ${yield n.X.te()}`)}catch(r){el(r)?ne("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield Ju(r)}yield n.ee(6e4)}))}}class Uae{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){var n=this;return(0,q.Z)(function*(){return n.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>n.ne(r,e))})()}ne(e,n){const r=new Set;let i=n,s=!0;return O.doWhile(()=>!0===s&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(null!==o&&!r.has(o))return ne("IndexBackiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(ne("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=v$(s);CR(o,r)>0&&(r=o)}),new cs(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}let ds=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){const n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function p_(t){return null==t}function g_(t){return 0===t&&1/t==-1/0}function T$(t){return"number"==typeof t&&Number.isInteger(t)&&!g_(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function ri(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=C$(e)),e=Bae(t.get(n),e);return C$(e)}function Bae(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=s}}return n}function C$(t){return t+"\x01\x01"}function Xo(t){const e=t.length;if(Se(e>=2),2===e)return Se("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),vt.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("\x01",s);switch((o<0||o>n)&&_e(),t.charAt(o+1)){case"\x01":const a=t.substring(s,o);let u;0===i.length?u=a:(i+=a,u=i,i=""),r.push(u);break;case"\x10":i+=t.substring(s,o),i+="\0";break;case"\x11":i+=t.substring(s,o+1);break;default:_e()}s=o+2}return new vt(r)}const S$=["userId","batchId"];function Ow(t,e){return[t,ri(e)]}function D$(t,e,n){return[t,ri(e),n]}const jae={},$ae=["prefixPath","collectionGroup","readTime","documentId"],Hae=["prefixPath","collectionGroup","documentId"],zae=["collectionGroup","readTime","prefixPath","documentId"],qae=["canonicalId","targetId"],Wae=["targetId","path"],Gae=["path","targetId"],Kae=["collectionId","parent"],Zae=["indexId","uid"],Qae=["uid","sequenceNumber"],Yae=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Xae=["indexId","uid","orderedDocumentKey"],Jae=["userId","collectionPath","documentId"],eue=["userId","collectionPath","largestBatchId"],tue=["userId","collectionGroup","largestBatchId"],b$=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],nue=[...b$,"documentOverlays"],A$=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],R$=A$,rue=[...R$,"indexConfiguration","indexState","indexEntries"];class bR extends I${constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}}function wr(t,e){const n=le(t);return go.M(n.ae,e)}function P$(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function tl(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function N$(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class tn{constructor(e,n){this.comparator=e,this.root=n||Lr.EMPTY}insert(e,n){return new tn(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Lr.BLACK,null,null))}remove(e){return new tn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Lr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Lw(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Lw(this.root,e,this.comparator,!1)}getReverseIterator(){return new Lw(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Lw(this.root,e,this.comparator,!0)}}class Lw{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Lr{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Lr.RED,this.left=i??Lr.EMPTY,this.right=s??Lr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Lr(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):0===s?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Lr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return Lr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Lr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Lr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw _e();const e=this.left.check();if(e!==this.right.check())throw _e();return e+(this.isRed()?0:1)}}Lr.EMPTY=null,Lr.RED=!0,Lr.BLACK=!1,Lr.EMPTY=new class{constructor(){this.size=0}get key(){throw _e()}get value(){throw _e()}get color(){throw _e()}get left(){throw _e()}get right(){throw _e()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Lr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ht{constructor(e){this.comparator=e,this.data=new tn(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=void 0!==n?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new M$(this.data.getIterator())}getIteratorFrom(e){return new M$(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ht)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ht(this.comparator);return n.data=e,n}}class M${constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Rf(t){return t.hasNext()?t.getNext():void 0}class Bi{constructor(e){this.fields=e,e.sort(cn.comparator)}static empty(){return new Bi([])}unionWith(e){let n=new Ht(cn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Bi(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Df(this.fields,e.fields,(n,r)=>n.isEqual(r))}}class x$ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class fr{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new x$("Invalid base64 string: "+s):s}}(e);return new fr(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new fr(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}fr.EMPTY_BYTE_STRING=new fr("");const sue=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function nl(t){if(Se(!!t),"string"==typeof t){let e=0;const n=sue.exec(t);if(Se(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:xn(t.seconds),nanos:xn(t.nanos)}}function xn(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function za(t){return"string"==typeof t?fr.fromBase64String(t):fr.fromUint8Array(t)}function Fw(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=t?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Vw(t){const e=t.mapValue.fields.__previous_value__;return Fw(e)?Vw(e):e}function m_(t){const e=nl(t.mapValue.fields.__local_write_time__.timestampValue);return new _n(e.seconds,e.nanos)}class oue{constructor(e,n,r,i,s,o,a,u,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=l}}class rl{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new rl("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof rl&&e.projectId===this.projectId&&e.database===this.database}}const il={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Uw={nullValue:"NULL_VALUE"};function sl(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Fw(t)?4:F$(t)?9007199254740991:10:_e()}function Jo(t,e){if(t===e)return!0;const n=sl(t);if(n!==sl(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return m_(t).isEqual(m_(e));case 3:return function(i,s){if("string"==typeof i.timestampValue&&"string"==typeof s.timestampValue&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=nl(i.timestampValue),a=nl(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return s=e,za(t.bytesValue).isEqual(za(s.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return xn(i.geoPointValue.latitude)===xn(s.geoPointValue.latitude)&&xn(i.geoPointValue.longitude)===xn(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return xn(i.integerValue)===xn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=xn(i.doubleValue),a=xn(s.doubleValue);return o===a?g_(o)===g_(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Df(t.arrayValue.values||[],e.arrayValue.values||[],Jo);case 10:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(P$(o)!==P$(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(void 0===a[u]||!Jo(o[u],a[u])))return!1;return!0}(t,e);default:return _e()}var s}function __(t,e){return void 0!==(t.values||[]).find(n=>Jo(n,e))}function ol(t,e){if(t===e)return 0;const n=sl(t),r=sl(e);if(n!==r)return ze(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ze(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=xn(s.integerValue||s.doubleValue),u=xn(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return k$(t.timestampValue,e.timestampValue);case 4:return k$(m_(t),m_(e));case 5:return ze(t.stringValue,e.stringValue);case 6:return function(s,o){const a=za(s),u=za(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),u=o.split("/");for(let l=0;l<a.length&&l<u.length;l++){const h=ze(a[l],u[l]);if(0!==h)return h}return ze(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=ze(xn(s.latitude),xn(o.latitude));return 0!==a?a:ze(xn(s.longitude),xn(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],u=o.values||[];for(let l=0;l<a.length&&l<u.length;++l){const h=ol(a[l],u[l]);if(h)return h}return ze(a.length,u.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===il.mapValue&&o===il.mapValue)return 0;if(s===il.mapValue)return 1;if(o===il.mapValue)return-1;const a=s.fields||{},u=Object.keys(a),l=o.fields||{},h=Object.keys(l);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){const m=ze(u[p],h[p]);if(0!==m)return m;const _=ol(a[u[p]],l[h[p]]);if(0!==_)return _}return ze(u.length,h.length)}(t.mapValue,e.mapValue);default:throw _e()}}function k$(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ze(t,e);const n=nl(t),r=nl(e),i=ze(n.seconds,r.seconds);return 0!==i?i:ze(n.nanos,r.nanos)}function Pf(t){return AR(t)}function AR(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=nl(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?za(t.bytesValue).toBase64():"referenceValue"in t?ce.fromName(t.referenceValue).toString():"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=AR(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${AR(n.fields[o])}`;return i+"}"}(t.mapValue):_e()}function Fc(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function RR(t){return!!t&&"integerValue"in t}function y_(t){return!!t&&"arrayValue"in t}function O$(t){return!!t&&"nullValue"in t}function L$(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function jw(t){return!!t&&"mapValue"in t}function v_(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return tl(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=v_(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=v_(t.arrayValue.values[n]);return e}return Object.assign({},t)}function F$(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}function aue(t){return"nullValue"in t?Uw:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Fc(rl.empty(),ce.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:_e()}function uue(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Fc(rl.empty(),ce.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?il:_e()}function V$(t,e){const n=ol(t.value,e.value);return 0!==n?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function U$(t,e){const n=ol(t.value,e.value);return 0!==n?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}class Fr{constructor(e){this.value=e}static empty(){return new Fr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!jw(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=v_(n)}setAll(e){let n=cn.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=v_(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());jw(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Jo(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];jw(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){tl(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Fr(v_(this.value))}}function B$(t){const e=[];return tl(t.fields,(n,r)=>{const i=new cn([n]);if(jw(r)){const s=B$(r.mapValue).fields;if(0===s.length)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Bi(e)}class dn{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new dn(e,0,Ae.min(),Ae.min(),Ae.min(),Fr.empty(),0)}static newFoundDocument(e,n,r,i){return new dn(e,1,n,Ae.min(),r,i,0)}static newNoDocument(e,n){return new dn(e,2,n,Ae.min(),Ae.min(),Fr.empty(),0)}static newUnknownDocument(e,n){return new dn(e,3,n,Ae.min(),Ae.min(),Fr.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ae.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Fr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Fr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ae.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof dn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new dn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class al{constructor(e,n){this.position=e,this.inclusive=n}}function j$(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(r=s.field.isKeyField()?ce.comparator(ce.fromName(o.referenceValue),n.key):ol(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function $$(t,e){if(null===t)return null===e;if(null===e||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Jo(t.position[n],e.position[n]))return!1;return!0}class E_{constructor(e,n="asc"){this.field=e,this.dir=n}}function lue(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class H${}class ft extends H${constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?"in"===n||"not-in"===n?this.createKeyFieldInFilter(e,n,r):new cue(e,n,r):"array-contains"===n?new fue(e,r):"in"===n?new Z$(e,r):"not-in"===n?new pue(e,r):"array-contains-any"===n?new gue(e,r):new ft(e,n,r)}static createKeyFieldInFilter(e,n,r){return"in"===n?new due(e,r):new hue(e,r)}matches(e){const n=e.data.field(this.field);return"!="===this.op?null!==n&&this.matchesComparison(ol(n,this.value)):null!==n&&sl(this.value)===sl(n)&&this.matchesComparison(ol(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return _e()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ft extends H${constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new Ft(e,n)}matches(e){return Nf(this)?void 0===this.filters.find(n=>!n.matches(e)):void 0!==this.filters.find(n=>n.matches(e))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Nf(t){return"and"===t.op}function PR(t){return"or"===t.op}function NR(t){return z$(t)&&Nf(t)}function z$(t){for(const e of t.filters)if(e instanceof Ft)return!1;return!0}function MR(t){if(t instanceof ft)return t.field.canonicalString()+t.op.toString()+Pf(t.value);if(NR(t))return t.filters.map(e=>MR(e)).join(",");{const e=t.filters.map(n=>MR(n)).join(",");return`${t.op}(${e})`}}function q$(t,e){return t instanceof ft?(r=t,(i=e)instanceof ft&&r.op===i.op&&r.field.isEqual(i.field)&&Jo(r.value,i.value)):t instanceof Ft?function(r,i){return i instanceof Ft&&r.op===i.op&&r.filters.length===i.filters.length&&r.filters.reduce((s,o,a)=>s&&q$(o,i.filters[a]),!0)}(t,e):void _e();var r,i}function W$(t,e){const n=t.filters.concat(e);return Ft.create(n,t.op)}function G$(t){return t instanceof ft?`${(n=t).field.canonicalString()} ${n.op} ${Pf(n.value)}`:t instanceof Ft?function(n){return n.op.toString()+" {"+n.getFilters().map(G$).join(" ,")+"}"}(t):"Filter";var n}class cue extends ft{constructor(e,n,r){super(e,n,r),this.key=ce.fromName(r.referenceValue)}matches(e){const n=ce.comparator(e.key,this.key);return this.matchesComparison(n)}}class due extends ft{constructor(e,n){super(e,"in",n),this.keys=K$(0,n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class hue extends ft{constructor(e,n){super(e,"not-in",n),this.keys=K$(0,n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function K$(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(r=>ce.fromName(r.referenceValue))}class fue extends ft{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return y_(n)&&__(n.arrayValue,this.value)}}class Z$ extends ft{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return null!==n&&__(this.value.arrayValue,n)}}class pue extends ft{constructor(e,n){super(e,"not-in",n)}matches(e){if(__(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return null!==n&&!__(this.value.arrayValue,n)}}class gue extends ft{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!y_(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>__(this.value.arrayValue,r))}}class mue{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}}function xR(t,e=null,n=[],r=[],i=null,s=null,o=null){return new mue(t,e,n,r,i,s,o)}function Vc(t){const e=le(t);if(null===e.ce){let n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>MR(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),p_(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Pf(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Pf(r)).join(",")),e.ce=n}return e.ce}function I_(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!lue(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!q$(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!$$(t.startAt,e.startAt)&&$$(t.endAt,e.endAt)}function $w(t){return ce.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Hw(t,e){return t.filters.filter(n=>n instanceof ft&&n.field.isEqual(e))}function Q$(t,e,n){let r=Uw,i=!0;for(const s of Hw(t,e)){let o=Uw,a=!0;switch(s.op){case"<":case"<=":o=aue(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Uw}V$({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(null!==n)for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];V$({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}return{value:r,inclusive:i}}function Y$(t,e,n){let r=il,i=!0;for(const s of Hw(t,e)){let o=il,a=!0;switch(s.op){case">=":case">":o=uue(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=il}U$({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(null!==n)for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];U$({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}return{value:r,inclusive:i}}class qa{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.le=null,this.he=null,this.Pe=null}}function X$(t,e,n,r,i,s,o,a){return new qa(t,e,n,r,i,s,o,a)}function Mf(t){return new qa(t)}function J$(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function kR(t){return null!==t.collectionGroup}function xf(t){const e=le(t);if(null===e.le){e.le=[];const n=new Set;for(const s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ht(cn.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new E_(s,r))}),n.has(cn.keyField().canonicalString())||e.le.push(new E_(cn.keyField(),r))}return e.le}function Ti(t){const e=le(t);return e.he||(e.he=function eH(t,e){if("F"===t.limitType)return xR(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>new E_(i.field,"desc"===i.dir?"asc":"desc"));const n=t.endAt?new al(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new al(t.startAt.position,t.startAt.inclusive):null;return xR(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}(e,xf(t))),e.he}function OR(t,e){const n=t.filters.concat([e]);return new qa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function zw(t,e,n){return new qa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function w_(t,e){return I_(Ti(t),Ti(e))&&t.limitType===e.limitType}function tH(t){return`${Vc(Ti(t))}|lt:${t.limitType}`}function kf(t){return`Query(target=${function(n){let r=n.path.canonicalString();return null!==n.collectionGroup&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>G$(i)).join(", ")}]`),p_(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>{return`${(o=i).field.canonicalString()} (${o.dir})`;var o}).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Pf(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Pf(i)).join(",")),`Target(${r})`}(Ti(t))}; limitType=${t.limitType})`}function T_(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return null!==r.collectionGroup?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ce.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of xf(r))if(!s.field.isKeyField()&&null===i.data.field(s.field))return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&(i=e,!((r=t).startAt&&!function(o,a,u){const l=j$(o,a,u);return o.inclusive?l<=0:l<0}(r.startAt,xf(r),i)||r.endAt&&!function(o,a,u){const l=j$(o,a,u);return o.inclusive?l>=0:l>0}(r.endAt,xf(r),i)));var r,i}function nH(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function rH(t){return(e,n)=>{let r=!1;for(const i of xf(t)){const s=_ue(i,e,n);if(0!==s)return s;r=r||i.field.isKeyField()}return 0}}function _ue(t,e,n){const r=t.field.isKeyField()?ce.comparator(e.key,n.key):function(s,o,a){const u=o.data.field(s),l=a.data.field(s);return null!==u&&null!==l?ol(u,l):_e()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return _e()}}class Wa{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r)for(const[i,s]of r)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){tl(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return N$(this.inner)}size(){return this.innerSize}}const yue=new tn(ce.comparator);function ji(){return yue}const iH=new tn(ce.comparator);function C_(...t){let e=iH;for(const n of t)e=e.insert(n.key,n);return e}function sH(t){let e=iH;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ea(){return S_()}function oH(){return S_()}function S_(){return new Wa(t=>t.toString(),(t,e)=>t.isEqual(e))}const vue=new tn(ce.comparator),Eue=new Ht(ce.comparator);function Je(...t){let e=Eue;for(const n of t)e=e.add(n);return e}const Iue=new Ht(ze);function LR(){return Iue}function aH(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:g_(e)?"-0":e}}function uH(t){return{integerValue:""+t}}function lH(t,e){return T$(e)?uH(e):aH(t,e)}class qw{constructor(){this._=void 0}}function wue(t,e,n){return t instanceof Of?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Fw(s)&&(s=Vw(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Uc?dH(t,e):t instanceof Bc?hH(t,e):function(i,s){const o=cH(i,s),a=fH(o)+fH(i.Ie);return RR(o)&&RR(i.Ie)?uH(a):aH(i.serializer,a)}(t,e)}function Tue(t,e,n){return t instanceof Uc?dH(t,e):t instanceof Bc?hH(t,e):n}function cH(t,e){return t instanceof Lf?RR(r=e)||(s=r)&&"doubleValue"in s?e:{integerValue:0}:null;var r,s}class Of extends qw{}class Uc extends qw{constructor(e){super(),this.elements=e}}function dH(t,e){const n=pH(e);for(const r of t.elements)n.some(i=>Jo(i,r))||n.push(r);return{arrayValue:{values:n}}}class Bc extends qw{constructor(e){super(),this.elements=e}}function hH(t,e){let n=pH(e);for(const r of t.elements)n=n.filter(i=>!Jo(i,r));return{arrayValue:{values:n}}}class Lf extends qw{constructor(e,n){super(),this.serializer=e,this.Ie=n}}function fH(t){return xn(t.integerValue||t.doubleValue)}function pH(t){return y_(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class D_{constructor(e,n){this.field=e,this.transform=n}}class Sue{constructor(e,n){this.version=e,this.transformResults=n}}class yn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new yn}static exists(e){return new yn(void 0,e)}static updateTime(e){return new yn(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ww(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Gw{}function gH(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new Vf(t.key,yn.none()):new Ff(t.key,t.data,yn.none());{const n=t.data,r=Fr.empty();let i=new Ht(cn.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);null===o&&s.length>1&&(s=s.popLast(),o=n.field(s)),null===o?r.delete(s):r.set(s,o),i=i.add(s)}return new Ga(t.key,r,new Bi(i.toArray()),yn.none())}}function Due(t,e,n){t instanceof Ff?function(i,s,o){const a=i.value.clone(),u=yH(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Ga?function(i,s,o){if(!Ww(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=yH(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(_H(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):e.convertToNoDocument(n.version).setHasCommittedMutations()}function b_(t,e,n,r){return t instanceof Ff?function(s,o,a,u){if(!Ww(s.precondition,o))return a;const l=s.value.clone(),h=vH(s.fieldTransforms,u,o);return l.setAll(h),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ga?function(s,o,a,u){if(!Ww(s.precondition,o))return a;const l=vH(s.fieldTransforms,u,o),h=o.data;return h.setAll(_H(s)),h.setAll(l),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null===a?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,n,r):(a=n,Ww(t.precondition,o=e)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a);var o,a}function bue(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=cH(r.transform,i||null);null!=s&&(null===n&&(n=Fr.empty()),n.set(r.field,s))}return n||null}function mH(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(r=t.fieldTransforms)&&void 0===i||r&&i&&Df(r,i,(s,o)=>function Cue(t,e){return t.field.isEqual(e.field)&&(i=e.transform,(r=t.transform)instanceof Uc&&i instanceof Uc||r instanceof Bc&&i instanceof Bc?Df(r.elements,i.elements,Jo):r instanceof Lf&&i instanceof Lf?Jo(r.Ie,i.Ie):r instanceof Of&&i instanceof Of);var r,i}(s,o))))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask));var r,i}class Ff extends Gw{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ga extends Gw{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function _H(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function yH(t,e,n){const r=new Map;Se(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,Tue(o,a,n[i]))}return r}function vH(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,wue(s,o,e))}return r}class Vf extends Gw{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class FR extends Gw{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class VR{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&Due(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=b_(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=b_(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=oH();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const u=gH(o,a);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Ae.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Je())}isEqual(e){return this.batchId===e.batchId&&Df(this.mutations,e.mutations,(n,r)=>mH(n,r))&&Df(this.baseMutations,e.baseMutations,(n,r)=>mH(n,r))}}class UR{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Se(e.mutations.length===r.length);let i=vue;const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new UR(e,n,r,i)}}class BR{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Rue{constructor(e,n){this.count=e,this.unchangedNames=n}}var tr,Et;function EH(t){switch(t){default:return _e();case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0}}function IH(t){if(void 0===t)return zn("GRPC error has no .code"),V.UNKNOWN;switch(t){case tr.OK:return V.OK;case tr.CANCELLED:return V.CANCELLED;case tr.UNKNOWN:return V.UNKNOWN;case tr.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case tr.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case tr.INTERNAL:return V.INTERNAL;case tr.UNAVAILABLE:return V.UNAVAILABLE;case tr.UNAUTHENTICATED:return V.UNAUTHENTICATED;case tr.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case tr.NOT_FOUND:return V.NOT_FOUND;case tr.ALREADY_EXISTS:return V.ALREADY_EXISTS;case tr.PERMISSION_DENIED:return V.PERMISSION_DENIED;case tr.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case tr.ABORTED:return V.ABORTED;case tr.OUT_OF_RANGE:return V.OUT_OF_RANGE;case tr.UNIMPLEMENTED:return V.UNIMPLEMENTED;case tr.DATA_LOSS:return V.DATA_LOSS;default:return _e()}}(Et=tr||(tr={}))[Et.OK=0]="OK",Et[Et.CANCELLED=1]="CANCELLED",Et[Et.UNKNOWN=2]="UNKNOWN",Et[Et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Et[Et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Et[Et.NOT_FOUND=5]="NOT_FOUND",Et[Et.ALREADY_EXISTS=6]="ALREADY_EXISTS",Et[Et.PERMISSION_DENIED=7]="PERMISSION_DENIED",Et[Et.UNAUTHENTICATED=16]="UNAUTHENTICATED",Et[Et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Et[Et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Et[Et.ABORTED=10]="ABORTED",Et[Et.OUT_OF_RANGE=11]="OUT_OF_RANGE",Et[Et.UNIMPLEMENTED=12]="UNIMPLEMENTED",Et[Et.INTERNAL=13]="INTERNAL",Et[Et.UNAVAILABLE=14]="UNAVAILABLE",Et[Et.DATA_LOSS=15]="DATA_LOSS";function wH(){return new TextEncoder}const Pue=new Tf([4294967295,4294967295],0);function TH(t){const e=wH().encode(t),n=new Tae;return n.update(e),new Uint8Array(n.digest())}function CH(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Tf([n,r],0),new Tf([i,s],0)]}class jR{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new A_(`Invalid padding: ${n}`);if(r<0)throw new A_(`Invalid hash count: ${r}`);if(e.length>0&&0===this.hashCount)throw new A_(`Invalid hash count: ${r}`);if(0===e.length&&0!==n)throw new A_(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Tf.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Tf.fromNumber(r)));return 1===i.compare(Pue)&&(i=new Tf([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const n=TH(e),[r,i]=CH(n);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new jR(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(0===this.Te)return;const n=TH(e),[r,i]=CH(n);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);this.Re(o)}}Re(e){const n=Math.floor(e/8);this.bitmap[n]|=1<<e%8}}class A_ extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class R_{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,P_.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new R_(Ae.min(),i,new tn(ze),ji(),Je())}}class P_{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new P_(r,n,Je(),Je(),Je())}}class Zw{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}}class SH{constructor(e,n){this.targetId=e,this.fe=n}}class DH{constructor(e,n,r=fr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class bH{constructor(){this.ge=0,this.pe=RH(),this.ye=fr.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=Je(),n=Je(),r=Je();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:_e()}}),new P_(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=RH()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,Se(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class Nue{constructor(e){this.Le=e,this.ke=new Map,this.qe=ji(),this.Qe=AH(),this.Ke=new tn(ze)}$e(e){for(const n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(const n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{const r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:_e()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){const n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){const s=i.target;if($w(s))if(0===r){const o=new ce(s.path);this.We(n,o,dn.newNoDocument(o,Ae.min()))}else Se(1===r);else{const o=this.Ze(n);if(o!==r){const a=this.Xe(e),u=a?this.et(a,e,o):1;0!==u&&(this.He(n),this.Ke=this.Ke.insert(n,2===u?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Xe(e){const n=e.fe.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=za(r).toUint8Array()}catch(u){if(u instanceof x$)return Ui("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new jR(o,i,s)}catch(u){return Ui(u instanceof A_?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return 0===a.Te?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){const n=new Map;this.ke.forEach((s,o)=>{const a=this.Ye(o);if(a){if(s.current&&$w(a.target)){const u=new ce(a.target.path);null!==this.qe.get(u)||this.st(o,u)||this.We(o,u,dn.newNoDocument(u,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=Je();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{const l=this.Ye(u);return!l||"TargetPurposeLimboResolution"===l.purpose||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));const i=new R_(e,n,this.Ke,this.qe,r);return this.qe=ji(),this.Qe=AH(),this.Ke=new tn(ze),i}Ue(e,n){if(!this.je(e))return;const r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new bH,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Ht(ze),this.Qe=this.Qe.insert(e,n)),n}je(e){const n=null!==this.Ye(e);return n||ne("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){const n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new bH),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function AH(){return new tn(ce.comparator)}function RH(){return new tn(ce.comparator)}const Mue={asc:"ASCENDING",desc:"DESCENDING"},xue={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},kue={and:"AND",or:"OR"};class Oue{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function $R(t,e){return t.useProto3Json||p_(e)?e:{value:e}}function Uf(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function PH(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Lue(t,e){return Uf(t,e.toTimestamp())}function qn(t){return Se(!!t),Ae.fromTimestamp(function(n){const r=nl(n);return new _n(r.seconds,r.nanos)}(t))}function HR(t,e){return(r=t,new vt(["projects",r.projectId,"databases",r.database])).child("documents").child(e).canonicalString();var r}function NH(t){const e=vt.fromString(t);return Se(BH(e)),e}function N_(t,e){return HR(t.databaseId,e.path)}function ta(t,e){const n=NH(e);if(n.get(1)!==t.databaseId.projectId)throw new ee(V.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ee(V.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ce(xH(n))}function zR(t,e){return HR(t.databaseId,e)}function MH(t){const e=NH(t);return 4===e.length?vt.emptyPath():xH(e)}function M_(t){return new vt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function xH(t){return Se(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function kH(t,e,n){return{name:N_(t,e),fields:n.value.mapValue.fields}}function OH(t,e,n){const r=ta(t,e.name),i=qn(e.updateTime),s=e.createTime?qn(e.createTime):Ae.min(),o=new Fr({mapValue:{fields:e.fields}}),a=dn.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function x_(t,e){let n;if(e instanceof Ff)n={update:kH(t,e.key,e.value)};else if(e instanceof Vf)n={delete:N_(t,e.key)};else if(e instanceof Ga)n={update:kH(t,e.key,e.data),updateMask:zue(e.fieldMask)};else{if(!(e instanceof FR))return _e();n={verify:N_(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Of)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Uc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Bc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Lf)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw _e()}(0,r))),e.precondition.isNone||(n.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:Lue(t,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:_e()),n;var s}function qR(t,e){const n=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?yn.updateTime(qn(s.updateTime)):void 0!==s.exists?yn.exists(s.exists):yn.none():yn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;"setToServerValue"in a?(Se("REQUEST_TIME"===a.setToServerValue),u=new Of):"appendMissingElements"in a?u=new Uc(a.appendMissingElements.values||[]):"removeAllFromArray"in a?u=new Bc(a.removeAllFromArray.values||[]):"increment"in a?u=new Lf(o,a.increment):_e();const l=cn.fromServerFormat(a.fieldPath);return new D_(l,u)}(t,i)):[];var s;if(e.update){const i=ta(t,e.update.name),s=new Fr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=new Bi((e.updateMask.fieldPaths||[]).map(h=>cn.fromServerFormat(h)));return new Ga(i,s,o,n,r)}return new Ff(i,s,n,r)}if(e.delete){const i=ta(t,e.delete);return new Vf(i,n)}if(e.verify){const i=ta(t,e.verify);return new FR(i,n)}return _e()}function LH(t,e){return{documents:[zR(t,e.path)]}}function WR(t,e){const n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=zR(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=zR(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(u){if(0!==u.length)return UH(Ft.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const s=function(u){if(0!==u.length)return u.map(l=>{return{field:ul((p=l).field),direction:jue(p.dir)};var p})}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=$R(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(u=e.startAt).inclusive,values:u.position}),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),n;var u}function FH(t){let e=MH(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Se(1===r);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];n.where&&(s=function(p){const m=VH(p);return m instanceof Ft&&NR(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(m=>{return new E_(Bf((v=m).field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction));var v}));let a=null;n.limit&&(a=function(p){let m;return m="object"==typeof p?p.value:p,p_(m)?null:m}(n.limit));let u=null;var p;n.startAt&&(u=new al((p=n.startAt).values||[],!!p.before));let l=null;return n.endAt&&(l=function(p){return new al(p.values||[],!p.before)}(n.endAt)),X$(e,i,o,s,a,"F",u,l)}function VH(t){return void 0!==t.unaryFilter?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Bf(n.unaryFilter.field);return ft.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Bf(n.unaryFilter.field);return ft.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Bf(n.unaryFilter.field);return ft.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Bf(n.unaryFilter.field);return ft.create(o,"!=",{nullValue:"NULL_VALUE"});default:return _e()}}(t):void 0!==t.fieldFilter?ft.create(Bf((n=t).fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return _e()}}(n.fieldFilter.op),n.fieldFilter.value):void 0!==t.compositeFilter?function(n){return Ft.create(n.compositeFilter.filters.map(r=>VH(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return _e()}}(n.compositeFilter.op))}(t):_e();var n}function jue(t){return Mue[t]}function $ue(t){return xue[t]}function Hue(t){return kue[t]}function ul(t){return{fieldPath:t.canonicalString()}}function Bf(t){return cn.fromServerFormat(t.fieldPath)}function UH(t){return t instanceof ft?function(n){if("=="===n.op){if(L$(n.value))return{unaryFilter:{field:ul(n.field),op:"IS_NAN"}};if(O$(n.value))return{unaryFilter:{field:ul(n.field),op:"IS_NULL"}}}else if("!="===n.op){if(L$(n.value))return{unaryFilter:{field:ul(n.field),op:"IS_NOT_NAN"}};if(O$(n.value))return{unaryFilter:{field:ul(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ul(n.field),op:$ue(n.op),value:n.value}}}(t):t instanceof Ft?function(n){const r=n.getFilters().map(i=>UH(i));return 1===r.length?r[0]:{compositeFilter:{op:Hue(n.op),filters:r}}}(t):_e()}function zue(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function BH(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class Ka{constructor(e,n,r,i,s=Ae.min(),o=Ae.min(),a=fr.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new Ka(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ka(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ka(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ka(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class jH{constructor(e){this.ut=e}}function $H(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Qw(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:N_(s=t.ut,(o=e).key),fields:o.data.value.mapValue.fields,updateTime:Uf(s,o.version.toTimestamp()),createTime:Uf(s,o.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:jc(e.version)};else{if(!e.isUnknownDocument())return _e();r.unknownDocument={path:n.path.toArray(),version:jc(e.version)}}var s,o;return r}function Qw(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function jc(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function $c(t){const e=new _n(t.seconds,t.nanoseconds);return Ae.fromTimestamp(e)}function Hc(t,e){const n=(e.baseMutations||[]).map(s=>qR(t.ut,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const r=e.mutations.map(s=>qR(t.ut,s)),i=_n.fromMillis(e.localWriteTimeMs);return new VR(e.batchId,i,n,r)}function k_(t){const e=$c(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?$c(t.lastLimboFreeSnapshotVersion):Ae.min();let r;return r=void 0!==t.query.documents?(Se(1===(s=t.query).documents.length),Ti(Mf(MH(s.documents[0])))):function(s){return Ti(FH(s))}(t.query),new Ka(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,fr.fromBase64String(t.resumeToken));var s}function HH(t,e){const n=jc(e.snapshotVersion),r=jc(e.lastLimboFreeSnapshotVersion);let i;i=$w(e.target)?LH(t.ut,e.target):WR(t.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Vc(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function GR(t){const e=FH({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?zw(e,e.limit,"L"):e}function KR(t,e){return new BR(e.largestBatchId,qR(t.ut,e.overlayMutation))}function zH(t,e){const n=e.path.lastSegment();return[t,ri(e.path.popLast()),n]}function qH(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:jc(r.readTime),documentKey:ri(r.documentKey.path),largestBatchId:r.largestBatchId}}class Wue{getBundleMetadata(e,n){return WH(e).get(n).next(r=>{if(r)return{id:(s=r).bundleId,createTime:$c(s.createTime),version:s.version};var s})}saveBundleMetadata(e,n){return WH(e).put({bundleId:(i=n).id,createTime:jc(qn(i.createTime)),version:i.version});var i}getNamedQuery(e,n){return GH(e).get(n).next(r=>{if(r)return{name:(s=r).name,query:GR(s.bundledQuery),readTime:$c(s.readTime)};var s})}saveNamedQuery(e,n){return GH(e).put({name:(i=n).name,readTime:jc(qn(i.readTime)),bundledQuery:i.bundledQuery});var i}}function WH(t){return wr(t,"bundles")}function GH(t){return wr(t,"namedQueries")}class Yw{constructor(e,n){this.serializer=e,this.userId=n}static ct(e,n){return new Yw(e,n.uid||"")}getOverlay(e,n){return O_(e).get(zH(this.userId,n)).next(r=>r?KR(this.serializer,r):null)}getOverlays(e,n){const r=ea();return O.forEach(n,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new BR(n,o);i.push(this.lt(e,a))}),O.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(ri(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(O_(e).H("collectionPathOverlayIndex",a))}),O.waitFor(s)}getOverlaysForCollection(e,n,r){const i=ea(),s=ri(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return O_(e).W("collectionPathOverlayIndex",o).next(a=>{for(const u of a){const l=KR(this.serializer,u);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=ea();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return O_(e).Y({index:"collectionGroupOverlayIndex",range:a},(u,l,h)=>{const p=KR(this.serializer,l);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):h.done()}).next(()=>s)}lt(e,n){return O_(e).put(function(i,s,o){const[a,u,l]=zH(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:x_(i.ut,o.mutation)}}(this.serializer,this.userId,n))}}function O_(t){return wr(t,"documentOverlays")}class zc{constructor(){}ht(e,n){this.Pt(e,n),n.It()}Pt(e,n){if("nullValue"in e)this.Tt(n,5);else if("booleanValue"in e)this.Tt(n,10),n.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(n,15),n.Et(xn(e.integerValue));else if("doubleValue"in e){const r=xn(e.doubleValue);isNaN(r)?this.Tt(n,13):(this.Tt(n,15),g_(r)?n.Et(0):n.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(n,20),"string"==typeof r?n.dt(r):(n.dt(`${r.seconds||""}`),n.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,n),this.Rt(n);else if("bytesValue"in e)this.Tt(n,30),n.Vt(za(e.bytesValue)),this.Rt(n);else if("referenceValue"in e)this.ft(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(n,45),n.Et(r.latitude||0),n.Et(r.longitude||0)}else"mapValue"in e?F$(e)?this.Tt(n,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,n),this.Rt(n)):"arrayValue"in e?(this.yt(e.arrayValue,n),this.Rt(n)):_e()}At(e,n){this.Tt(n,25),this.wt(e,n)}wt(e,n){n.dt(e)}gt(e,n){const r=e.fields||{};this.Tt(n,55);for(const i of Object.keys(r))this.At(i,n),this.Pt(r[i],n)}yt(e,n){const r=e.values||[];this.Tt(n,50);for(const i of r)this.Pt(i,n)}ft(e,n){this.Tt(n,37),ce.fromName(e).path.forEach(r=>{this.Tt(n,60),this.wt(r,n)})}Tt(e,n){e.Et(n)}Rt(e){e.Et(2)}}function Gue(t){if(0===t)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function KH(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=Gue(255&r[s]);if(i+=o,8!==o)break}return i}(t);return Math.ceil(e/8)}zc.St=new zc;class Kue{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Dt(r.value),r=n.next();this.Ct()}vt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(n<"\ud800"||"\udbff"<n)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=n.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\ud800"||"\udbff"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const n=this.Bt(e),r=KH(n);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}kt(e){const n=this.Bt(e),r=KH(n);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=0!=(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Dt(e){const n=255&e;0===n?(this.Qt(0),this.Qt(255)):255===n?(this.Qt(255),this.Qt(0)):this.Qt(n)}Ft(e){const n=255&e;0===n?(this.$t(0),this.$t(255)):255===n?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class Zue{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class Que{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class L_{constructor(){this.Wt=new Kue,this.Gt=new Zue(this.Wt),this.zt=new Que(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return 0===e?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class qc{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,n=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new qc(this.indexId,this.documentKey,this.arrayValue,r)}}function ll(t,e){let n=t.indexId-e.indexId;return 0!==n?n:(n=ZH(t.arrayValue,e.arrayValue),0!==n?n:(n=ZH(t.directionalValue,e.directionalValue),0!==n?n:ce.comparator(t.documentKey,e.documentKey)))}function ZH(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(0!==r)return r}return t.length-e.length}class QH{constructor(e){this.Jt=new Ht((n,r)=>cn.comparator(n.field,r.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const n of e.filters){const r=n;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(Se(e.collectionGroup===this.collectionId),this.Xt)return!1;const n=TR(e);if(void 0!==n&&!this.tn(n))return!1;const r=kc(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const a=this.Jt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const u=r[s];if(!this.nn(a,u)||!this.rn(this.Yt[o++],u))return!1}++s}for(;s<r.length;++s)if(o>=this.Yt.length||!this.rn(this.Yt[o++],r[s]))return!1;return!0}sn(){if(this.Xt)return null;let e=new Ht(cn.comparator);const n=[];for(const r of this.Zt)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)n.push(new Oc(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Oc(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Oc(r.field,"asc"===r.dir?0:1)));return new bf(bf.UNKNOWN_ID,this.collectionId,n,Af.empty())}tn(e){for(const n of this.Zt)if(this.nn(n,e))return!0;return!1}nn(e,n){return!(void 0===e||!e.field.isEqual(n.fieldPath))&&2===n.kind==("array-contains"===e.op||"array-contains-any"===e.op)}rn(e,n){return!!e.field.isEqual(n.fieldPath)&&(0===n.kind&&"asc"===e.dir||1===n.kind&&"desc"===e.dir)}}function YH(t){var e,n;if(Se(t instanceof ft||t instanceof Ft),t instanceof ft){if(t instanceof Z$){const i=(null===(n=null===(e=t.value.arrayValue)||void 0===e?void 0:e.values)||void 0===n?void 0:n.map(s=>ft.create(t.field,"==",s)))||[];return Ft.create(i,"or")}return t}const r=t.filters.map(i=>YH(i));return Ft.create(r,t.op)}function Yue(t){if(0===t.getFilters().length)return[];const e=YR(YH(t));return Se(XH(e)),ZR(e)||QR(e)?[e]:e.getFilters()}function ZR(t){return t instanceof ft}function QR(t){return t instanceof Ft&&NR(t)}function XH(t){return ZR(t)||QR(t)||function(n){if(n instanceof Ft&&PR(n)){for(const r of n.getFilters())if(!ZR(r)&&!QR(r))return!1;return!0}return!1}(t)}function YR(t){if(Se(t instanceof ft||t instanceof Ft),t instanceof ft)return t;if(1===t.filters.length)return YR(t.filters[0]);const e=t.filters.map(r=>YR(r));let n=Ft.create(e,t.op);return n=Xw(n),XH(n)?n:(Se(n instanceof Ft),Se(Nf(n)),Se(n.filters.length>1),n.filters.reduce((r,i)=>XR(r,i)))}function XR(t,e){let n;return Se(t instanceof ft||t instanceof Ft),Se(e instanceof ft||e instanceof Ft),n=t instanceof ft?e instanceof ft?Ft.create([t,e],"and"):JH(t,e):e instanceof ft?JH(e,t):function(i,s){if(Se(i.filters.length>0&&s.filters.length>0),Nf(i)&&Nf(s))return W$(i,s.getFilters());const o=PR(i)?i:s,a=PR(i)?s:i,u=o.filters.map(l=>XR(l,a));return Ft.create(u,"or")}(t,e),Xw(n)}function JH(t,e){if(Nf(e))return W$(e,t.getFilters());{const n=e.filters.map(r=>XR(t,r));return Ft.create(n,"or")}}function Xw(t){if(Se(t instanceof ft||t instanceof Ft),t instanceof ft)return t;const e=t.getFilters();if(1===e.length)return Xw(e[0]);if(z$(t))return t;const n=e.map(i=>Xw(i)),r=[];return n.forEach(i=>{i instanceof ft?r.push(i):i instanceof Ft&&(i.op===t.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:Ft.create(r,t.op)}class Xue{constructor(){this.on=new JR}addToCollectionParentIndex(e,n){return this.on.add(n),O.resolve()}getCollectionParents(e,n){return O.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return O.resolve()}deleteFieldIndex(e,n){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,n){return O.resolve()}getDocumentsMatchingTarget(e,n){return O.resolve(null)}getIndexType(e,n){return O.resolve(0)}getFieldIndexes(e,n){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,n){return O.resolve(cs.min())}getMinOffsetFromCollectionGroup(e,n){return O.resolve(cs.min())}updateCollectionGroup(e,n,r){return O.resolve()}updateIndexEntries(e,n){return O.resolve()}}class JR{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ht(vt.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ht(vt.comparator)).toArray()}}const Jw=new Uint8Array(0);class Jue{constructor(e,n){this.user=e,this.databaseId=n,this._n=new JR,this.an=new Wa(r=>Vc(r),(r,i)=>I_(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this._n.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this._n.add(n)});const s={collectionId:r,parent:ri(i)};return ez(e).put(s)}return O.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[_$(n),""],!1,!0);return ez(e).W(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Xo(o.parent))}return r})}addFieldIndex(e,n){const r=F_(e),i={indexId:(a=n).indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])};var a;delete i.indexId;const s=r.add(i);if(n.indexState){const o=$f(e);return s.next(a=>{o.put(qH(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=F_(e),i=$f(e),s=jf(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=F_(e),r=jf(e),i=$f(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return O.forEach(this.un(n),r=>this.getIndexType(e,r).next(i=>{if(0===i||1===i){const s=new QH(r).sn();if(null!=s)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=jf(e);let i=!0;const s=new Map;return O.forEach(this.un(n),o=>this.cn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Je();const a=[];return O.forEach(s,(u,l)=>{var k;ne("IndexedDbIndexManager",`Using index ${k=u,`id=${k.indexId}|cg=${k.collectionGroup}|f=${k.fields.map($=>`${$.fieldPath}:${$.kind}`).join(",")}`} to execute ${Vc(n)}`);const h=function(k,$){const ie=TR($);if(void 0===ie)return null;for(const pe of Hw(k,ie.fieldPath))switch(pe.op){case"array-contains-any":return pe.value.arrayValue.values||[];case"array-contains":return[pe.value]}return null}(l,u),p=function(k,$){const ie=new Map;for(const pe of kc($))for(const qe of Hw(k,pe.fieldPath))switch(qe.op){case"==":case"in":ie.set(pe.fieldPath.canonicalString(),qe.value);break;case"not-in":case"!=":return ie.set(pe.fieldPath.canonicalString(),qe.value),Array.from(ie.values())}return null}(l,u),m=function(k,$){const ie=[];let pe=!0;for(const qe of kc($)){const kt=0===qe.kind?Q$(k,qe.fieldPath,k.startAt):Y$(k,qe.fieldPath,k.startAt);ie.push(kt.value),pe&&(pe=kt.inclusive)}return new al(ie,pe)}(l,u),_=function(k,$){const ie=[];let pe=!0;for(const qe of kc($)){const kt=0===qe.kind?Y$(k,qe.fieldPath,k.endAt):Q$(k,qe.fieldPath,k.endAt);ie.push(kt.value),pe&&(pe=kt.inclusive)}return new al(ie,pe)}(l,u),v=this.ln(u,l,m),I=this.ln(u,l,_),T=this.hn(u,l,p),N=this.Pn(u.indexId,h,v,m.inclusive,I,_.inclusive,T);return O.forEach(N,b=>r.j(b,n.limit).next(k=>{k.forEach($=>{const ie=ce.fromSegments($.documentKey);o.has(ie)||(o=o.add(ie),a.push(ie))})}))}).next(()=>a)}return O.resolve(null)})}un(e){let n=this.an.get(e);return n||(n=0===e.filters.length?[e]:Yue(Ft.create(e.filters,"and")).map(r=>xR(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,n),n)}Pn(e,n,r,i,s,o,a){const u=(null!=n?n.length:1)*Math.max(r.length,s.length),l=u/(null!=n?n.length:1),h=[];for(let p=0;p<u;++p){const m=n?this.In(n[p/l]):Jw,_=this.Tn(e,m,r[p%l],i),v=this.En(e,m,s[p%l],o),I=a.map(T=>this.Tn(e,m,T,!0));h.push(...this.createRange(_,v,I))}return h}Tn(e,n,r,i){const s=new qc(e,ce.empty(),n,r);return i?s:s.Ht()}En(e,n,r,i){const s=new qc(e,ce.empty(),n,r);return i?s.Ht():s}cn(e,n){const r=new QH(n),i=null!=n.collectionGroup?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.en(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.un(n);return O.forEach(i,s=>this.cn(e,s).next(o=>{o?0!==r&&o.fields.length<function(u){let l=new Ht(cn.comparator),h=!1;for(const p of u.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||("array-contains"===m.op||"array-contains-any"===m.op?h=!0:l=l.add(m.field));for(const p of u.orderBy)p.field.isKeyField()||(l=l.add(p.field));return l.size+(h?1:0)}(s)&&(r=1):r=0})).next(()=>null!==n.limit&&i.length>1&&2===r?1:r)}dn(e,n){const r=new L_;for(const i of kc(e)){const s=n.data.field(i.fieldPath);if(null==s)return null;const o=r.jt(i.kind);zc.St.ht(s,o)}return r.Ut()}In(e){const n=new L_;return zc.St.ht(e,n.jt(0)),n.Ut()}An(e,n){const r=new L_;return zc.St.ht(Fc(this.databaseId,n),r.jt(function(s){const o=kc(s);return 0===o.length?0:o[o.length-1].kind}(e))),r.Ut()}hn(e,n,r){if(null===r)return[];let i=[];i.push(new L_);let s=0;for(const o of kc(e)){const a=r[s++];for(const u of i)if(this.Rn(n,o.fieldPath)&&y_(a))i=this.Vn(i,o,a);else{const l=u.jt(o.kind);zc.St.ht(a,l)}}return this.mn(i)}ln(e,n,r){return this.hn(e,n,r.position)}mn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Ut();return n}Vn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const u=new L_;u.seed(a.Ut()),zc.St.ht(o,u.jt(n.kind)),s.push(u)}return s}Rn(e,n){return!!e.filters.find(r=>r instanceof ft&&r.field.isEqual(n)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,n){const r=F_(e),i=$f(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{const o=[];return O.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(h,p){const m=p?new Af(p.sequenceNumber,new cs($c(p.readTime),new ce(Xo(p.documentKey)),p.largestBatchId)):Af.empty(),_=h.fields.map(([v,I])=>new Oc(cn.fromServerFormat(v),I));return new bf(h.indexId,h.collectionGroup,_,m)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>0===n.length?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==s?s:ze(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=F_(e),s=$f(e);return this.fn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>O.forEach(a,u=>s.put(qH(u.indexId,this.user,o,r)))))}updateIndexEntries(e,n){const r=new Map;return O.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?O.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),O.forEach(a,u=>this.gn(e,i,u).next(l=>{const h=this.pn(s,u);return l.isEqual(h)?O.resolve():this.yn(e,s,u,l,h)}))))})}wn(e,n,r,i){return jf(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,n.key),documentKey:n.key.path.toArray()})}Sn(e,n,r,i){return jf(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,n.key),n.key.path.toArray()])}gn(e,n,r){const i=jf(e);let s=new Ht(ll);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,n)])},(o,a)=>{s=s.add(new qc(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}pn(e,n){let r=new Ht(ll);const i=this.dn(n,e);if(null==i)return r;const s=TR(n);if(null!=s){const o=e.data.field(s.fieldPath);if(y_(o))for(const a of o.arrayValue.values||[])r=r.add(new qc(n.indexId,e.key,this.In(a),i))}else r=r.add(new qc(n.indexId,e.key,Jw,i));return r}yn(e,n,r,i,s){ne("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(u,l,h,p,m){const _=u.getIterator(),v=l.getIterator();let I=Rf(_),T=Rf(v);for(;I||T;){let N=!1,b=!1;if(I&&T){const k=h(I,T);k<0?b=!0:k>0&&(N=!0)}else null!=I?b=!0:N=!0;N?(p(T),T=Rf(v)):b?(m(I),I=Rf(_)):(I=Rf(_),T=Rf(v))}}(i,s,ll,a=>{o.push(this.wn(e,n,r,a))},a=>{o.push(this.Sn(e,n,r,a))}),O.waitFor(o)}fn(e){let n=1;return $f(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>ll(o,a)).filter((o,a,u)=>!a||0!==ll(o,u[a-1]));const i=[];i.push(e);for(const o of r){const a=ll(o,e),u=ll(o,n);if(0===a)i[0]=e.Ht();else if(a>0&&u<0)i.push(o),i.push(o.Ht());else if(u>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.bn(i[o],i[o+1]))return[];s.push(IDBKeyRange.bound([i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Jw,[]],[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Jw,[]]))}return s}bn(e,n){return ll(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(tz)}getMinOffset(e,n){return O.mapArray(this.un(n),r=>this.cn(e,r).next(i=>i||_e())).next(tz)}}function ez(t){return wr(t,"collectionParents")}function jf(t){return wr(t,"indexEntries")}function F_(t){return wr(t,"indexConfiguration")}function $f(t){return wr(t,"indexState")}function tz(t){Se(0!==t.length);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;CR(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new cs(e.readTime,e.documentKey,n)}const nz={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class ii{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new ii(e,ii.DEFAULT_COLLECTION_PERCENTILE,ii.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function rz(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const u=r.Y({range:o},(h,p,m)=>(a++,m.delete()));s.push(u.next(()=>{Se(1===a)}));const l=[];for(const h of n.mutations){const p=D$(e,h.key.path,n.batchId);s.push(i.delete(p)),l.push(h.key)}return O.waitFor(s).next(()=>l)}function eT(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw _e();e=t.noDocument}return JSON.stringify(e).length}ii.DEFAULT_COLLECTION_PERCENTILE=10,ii.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ii.DEFAULT=new ii(41943040,ii.DEFAULT_COLLECTION_PERCENTILE,ii.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ii.DISABLED=new ii(-1,0,0);class tT{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,n,r,i){Se(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new tT(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return cl(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=Hf(e),o=cl(e);return o.add({}).next(a=>{Se("number"==typeof a);const u=new VR(a,n,r,i),l=function(_,v,I){const T=I.baseMutations.map(b=>x_(_.ut,b)),N=I.mutations.map(b=>x_(_.ut,b));return{userId:v,batchId:I.batchId,localWriteTimeMs:I.localWriteTime.toMillis(),baseMutations:T,mutations:N}}(this.serializer,this.userId,u),h=[];let p=new Ht((m,_)=>ze(m.canonicalString(),_.canonicalString()));for(const m of i){const _=D$(this.userId,m.key.path,a);p=p.add(m.key.path.popLast()),h.push(o.put(l)),h.push(s.put(_,jae))}return p.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Dn[a]=u.keys()}),O.waitFor(h).next(()=>u)})}lookupMutationBatch(e,n){return cl(e).get(n).next(r=>r?(Se(r.userId===this.userId),Hc(this.serializer,r)):null)}Cn(e,n){return this.Dn[n]?O.resolve(this.Dn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Dn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return cl(e).Y({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(Se(a.batchId>=r),s=Hc(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return cl(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return cl(e).W("userMutationsIndex",n).next(r=>r.map(i=>Hc(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Ow(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Hf(e).Y({range:i},(o,a,u)=>{const[l,h,p]=o,m=Xo(h);if(l===this.userId&&n.path.isEqual(m))return cl(e).get(p).next(_=>{if(!_)throw _e();Se(_.userId===this.userId),s.push(Hc(this.serializer,_))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ht(ze);const i=[];return n.forEach(s=>{const o=Ow(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=Hf(e).Y({range:a},(l,h,p)=>{const[m,_,v]=l,I=Xo(_);m===this.userId&&s.path.isEqual(I)?r=r.add(v):p.done()});i.push(u)}),O.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Ow(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Ht(ze);return Hf(e).Y({range:o},(u,l,h)=>{const[p,m,_]=u,v=Xo(m);p===this.userId&&r.isPrefixOf(v)?v.length===i&&(a=a.add(_)):h.done()}).next(()=>this.vn(e,a))}vn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(cl(e).get(s).next(o=>{if(null===o)throw _e();Se(o.userId===this.userId),r.push(Hc(this.serializer,o))}))}),O.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return rz(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Fn(n.batchId)}),O.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return O.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return Hf(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){const u=Xo(s[1]);i.push(u)}else a.done()}).next(()=>{Se(0===i.length)})})}containsKey(e,n){return iz(e,this.userId,n)}Mn(e){return sz(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function iz(t,e,n){const r=Ow(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Hf(t).Y({range:s,J:!0},(a,u,l)=>{const[h,p,m]=a;h===e&&p===i&&(o=!0),l.done()}).next(()=>o)}function cl(t){return wr(t,"mutations")}function Hf(t){return wr(t,"documentMutations")}function sz(t){return wr(t,"mutationQueues")}class Wc{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new Wc(0)}static Nn(){return new Wc(-1)}}class ele{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Bn(e).next(n=>{const r=new Wc(n.highestTargetId);return n.highestTargetId=r.next(),this.Ln(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(n=>Ae.fromTimestamp(new _n(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Ln(e,i)))}addTargetData(e,n){return this.kn(e,n).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(n,r),this.Ln(e,r))))}updateTargetData(e,n){return this.kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>zf(e).delete(n.targetId)).next(()=>this.Bn(e)).next(r=>(Se(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return zf(e).Y((o,a)=>{const u=k_(a);u.sequenceNumber<=n&&null===r.get(u.targetId)&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>O.waitFor(s)).next(()=>i)}forEachTarget(e,n){return zf(e).Y((r,i)=>{const s=k_(i);n(s)})}Bn(e){return oz(e).get("targetGlobalKey").next(n=>(Se(null!==n),n))}Ln(e,n){return oz(e).put("targetGlobalKey",n)}kn(e,n){return zf(e).put(HH(this.serializer,n))}qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Vc(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return zf(e).Y({range:i,index:"queryTargetsIndex"},(o,a,u)=>{const l=k_(a);I_(n,l.target)&&(s=l,u.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=dl(e);return n.forEach(o=>{const a=ri(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),O.waitFor(i)}removeMatchingKeys(e,n,r){const i=dl(e);return O.forEach(n,s=>{const o=ri(s.path);return O.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=dl(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=dl(e);let s=Je();return i.Y({range:r,J:!0},(o,a,u)=>{const l=Xo(o[1]),h=new ce(l);s=s.add(h)}).next(()=>s)}containsKey(e,n){const r=ri(n.path),i=IDBKeyRange.bound([r],[_$(r)],!1,!0);let s=0;return dl(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],u,l)=>{0!==o&&(s++,l.done())}).next(()=>s>0)}_t(e,n){return zf(e).get(n).next(r=>r?k_(r):null)}}function zf(t){return wr(t,"targets")}function oz(t){return wr(t,"targetGlobal")}function dl(t){return wr(t,"targetDocuments")}function az([t,e],[n,r]){const i=ze(t,n);return 0===i?ze(e,r):i}class tle{constructor(e){this.Qn=e,this.buffer=new Ht(az),this.Kn=0}$n(){return++this.Kn}Un(e){const n=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();az(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class uz{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Wn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return null!==this.Wn}Gn(e){var n=this;ne("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,q.Z)(function*(){n.Wn=null;try{yield n.localStore.collectGarbage(n.garbageCollector)}catch(r){el(r)?ne("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield Ju(r)}yield n.Gn(3e5)}))}}class nle{constructor(e,n){this.zn=e,this.params=n}calculateTargetCount(e,n){return this.zn.jn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(0===n)return O.resolve(ds._e);const r=new tle(n);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.zn.removeOrphanedDocuments(e,n)}collect(e,n){return-1===this.params.cacheSizeCollectionThreshold?(ne("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(nz)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ne("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),nz):this.Jn(e,n))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,n){let r,i,s,o,a,u,l;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(ne("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,n))).next(p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(l=Date.now(),Sf()<=us.in.DEBUG&&ne("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-h}ms\n\tDetermined least recently used ${i} in `+(a-o)+`ms\n\tRemoved ${s} targets in `+(u-a)+`ms\n\tRemoved ${p} documents in `+(l-u)+`ms\nTotal Duration: ${l-h}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}class rle{constructor(e,n){this.db=e,this.garbageCollector=function lz(t,e){return new nle(t,e)}(this,n)}jn(e){const n=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Yn(e){let n=0;return this.Hn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Hn(e,n){return this.Zn(e,(r,i)=>n(i))}addReference(e,n,r){return nT(e,r)}removeReference(e,n,r){return nT(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return nT(e,n)}Xn(e,n){return function(i,s){let o=!1;return sz(i).Z(a=>iz(i,a,s).next(u=>(u&&(o=!0),O.resolve(!u)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(o,a)=>{if(a<=n){const u=this.Xn(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Ae.min()),dl(e).delete([0,ri(o.path)])))});i.push(u)}}).next(()=>O.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return nT(e,n)}Zn(e,n){const r=dl(e);let i,s=ds._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:l})=>{0===o?(s!==ds._e&&n(new ce(Xo(i)),s),s=l,i=u):s=ds._e}).next(()=>{s!==ds._e&&n(new ce(Xo(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function nT(t,e){return dl(t).put((i=t.currentSequenceNumber,{targetId:0,path:ri(e.path),sequenceNumber:i}));var i}class cz{constructor(){this.changes=new Wa(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,dn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return void 0!==r?O.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class ile{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Gc(e).put(r)}removeEntry(e,n,r){return Gc(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Qw(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.er(e,r)))}getEntry(e,n){let r=dn.newInvalidDocument(n);return Gc(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(V_(n))},(i,s)=>{r=this.tr(n,s)}).next(()=>r)}nr(e,n){let r={size:0,document:dn.newInvalidDocument(n)};return Gc(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(V_(n))},(i,s)=>{r={document:this.tr(n,s),size:eT(s)}}).next(()=>r)}getEntries(e,n){let r=ji();return this.rr(e,n,(i,s)=>{const o=this.tr(i,s);r=r.insert(i,o)}).next(()=>r)}ir(e,n){let r=ji(),i=new tn(ce.comparator);return this.rr(e,n,(s,o)=>{const a=this.tr(s,o);r=r.insert(s,a),i=i.insert(s,eT(o))}).next(()=>({documents:r,sr:i}))}rr(e,n,r){if(n.isEmpty())return O.resolve();let i=new Ht(pz);n.forEach(u=>i=i.add(u));const s=IDBKeyRange.bound(V_(i.first()),V_(i.last())),o=i.getIterator();let a=o.getNext();return Gc(e).Y({index:"documentKeyIndex",range:s},(u,l,h)=>{const p=ce.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&pz(a,p)<0;)r(a,null),a=o.getNext();a&&a.isEqual(p)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?h.U(V_(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Qw(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Gc(e).W(IDBKeyRange.bound(a,u,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let h=ji();for(const p of l){const m=this.tr(ce.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(T_(n,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,n,r,i){let s=ji();const o=fz(n,r),a=fz(n,cs.max());return Gc(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,l,h)=>{const p=this.tr(ce.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(p.key,p),s.size===i&&h.done()}).next(()=>s)}newChangeBuffer(e){return new sle(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return hz(e).get("remoteDocumentGlobalKey").next(n=>(Se(!!n),n))}er(e,n){return hz(e).put("remoteDocumentGlobalKey",n)}tr(e,n){if(n){const r=function que(t,e){let n;if(e.document)n=OH(t.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ce.fromSegments(e.noDocument.path),i=$c(e.noDocument.readTime);n=dn.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return _e();{const r=ce.fromSegments(e.unknownDocument.path),i=$c(e.unknownDocument.version);n=dn.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new _n(i[0],i[1]);return Ae.fromTimestamp(s)}(e.readTime)),n}(this.serializer,n);if(!r.isNoDocument()||!r.version.isEqual(Ae.min()))return r}return dn.newInvalidDocument(e)}}function dz(t){return new ile(t)}class sle extends cz{constructor(e,n){super(),this._r=e,this.trackRemovals=n,this.ar=new Wa(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ht((s,o)=>ze(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.ar.get(s);if(n.push(this._r.removeEntry(e,s,a.readTime)),o.isValidDocument()){const u=$H(this._r.serializer,o);i=i.add(s.path.popLast());const l=eT(u);r+=l-a.size,n.push(this._r.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){const u=$H(this._r.serializer,o.convertToNoDocument(Ae.min()));n.push(this._r.addEntry(e,s,u))}}),i.forEach(s=>{n.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),n.push(this._r.updateMetadata(e,r)),O.waitFor(n)}getFromCache(e,n){return this._r.nr(e,n).next(r=>(this.ar.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this._r.ir(e,n).next(({documents:r,sr:i})=>(i.forEach((s,o)=>{this.ar.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function hz(t){return wr(t,"remoteDocumentGlobal")}function Gc(t){return wr(t,"remoteDocumentsV14")}function V_(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function fz(t,e){const n=e.documentKey.path.toArray();return[t,Qw(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function pz(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=ze(n[s],r[s]),i)return i;return i=ze(n.length,r.length),i||(i=ze(n[n.length-2],r[r.length-2]),i||ze(n[n.length-1],r[r.length-1]))}class ole{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class gz{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(null!==r&&b_(r.mutation,i,Bi.empty(),_n.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Je()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Je()){const i=ea();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=C_();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=ea();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Je()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=ji();const o=S_(),a=S_();return n.forEach((u,l)=>{const h=r.get(l.key);i.has(l.key)&&(void 0===h||h.mutation instanceof Ga)?s=s.insert(l.key,l):void 0!==h?(o.set(l.key,h.mutation.getFieldMask()),b_(h.mutation,l,h.mutation.getFieldMask(),_n.now())):o.set(l.key,Bi.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((l,h)=>o.set(l,h)),n.forEach((l,h)=>{var p;return a.set(l,new ole(h,null!==(p=o.get(l))&&void 0!==p?p:null))}),a))}recalculateAndSaveOverlays(e,n){const r=S_();let i=new tn((o,a)=>o-a),s=Je();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(u=>{const l=n.get(u);if(null===l)return;let h=r.get(u)||Bi.empty();h=a.applyToLocalView(l,h),r.set(u,h);const p=(i.get(a.batchId)||Je()).add(u);i=i.insert(a.batchId,p)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),l=u.key,h=u.value,p=oH();h.forEach(m=>{if(!s.has(m)){const _=gH(n.get(m),r.get(m));null!==_&&p.set(m,_),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,p))}return O.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return ce.isDocumentKey((o=n).path)&&null===o.collectionGroup&&0===o.filters.length?this.getDocumentsMatchingDocumentQuery(e,n.path):kR(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i);var o}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):O.resolve(ea());let a=-1,u=s;return o.next(l=>O.forEach(l,(h,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(h)?O.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{u=u.insert(h,m)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,u,l,Je())).next(h=>({batchId:a,changes:sH(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ce(n)).next(r=>{let i=C_();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=C_();return this.indexManager.getCollectionParents(e,s).next(a=>O.forEach(a,u=>{const l=(p=n,m=u.child(s),new qa(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt));var p,m;return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(h=>{h.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,l)=>{const h=l.getKey();null===o.get(h)&&(o=o.insert(h,dn.newInvalidDocument(h)))});let a=C_();return o.forEach((u,l)=>{const h=s.get(u);void 0!==h&&b_(h.mutation,l,Bi.empty(),_n.now()),T_(n,l)&&(a=a.insert(u,l))}),a})}}class ale{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return O.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,{id:(i=n).id,version:i.version,createTime:qn(i.createTime)}),O.resolve();var i}getNamedQuery(e,n){return O.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,{name:(i=n).name,query:GR(i.bundledQuery),readTime:qn(i.readTime)}),O.resolve();var i}}class ule{constructor(){this.overlays=new tn(ce.comparator),this.lr=new Map}getOverlay(e,n){return O.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ea();return O.forEach(n,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.lt(e,n,s)}),O.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.lr.get(r);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),O.resolve()}getOverlaysForCollection(e,n,r){const i=ea(),s=n.length+1,o=new ce(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,l=u.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return O.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new tn((l,h)=>l-h);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let h=s.get(l.largestBatchId);null===h&&(h=ea(),s=s.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}const a=ea(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,h)=>a.set(l,h)),!(a.size()>=i)););return O.resolve(a)}lt(e,n,r){const i=this.overlays.get(r.key);if(null!==i){const o=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new BR(n,r));let s=this.lr.get(n);void 0===s&&(s=Je(),this.lr.set(n,s)),this.lr.set(n,s.add(r.key))}}class eP{constructor(){this.hr=new Ht(Tr.Pr),this.Ir=new Ht(Tr.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){const r=new Tr(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new Tr(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){const n=new ce(new vt([])),r=new Tr(n,e),i=new Tr(n,e+1),s=[];return this.Ir.forEachInRange([r,i],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const n=new ce(new vt([])),r=new Tr(n,e),i=new Tr(n,e+1);let s=Je();return this.Ir.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Tr(e,0),r=this.hr.firstAfterOrEqual(n);return null!==r&&e.isEqual(r.key)}}class Tr{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return ce.comparator(e.key,n.key)||ze(e.gr,n.gr)}static Tr(e,n){return ze(e.gr,n.gr)||ce.comparator(e.key,n.key)}}class lle{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new Ht(Tr.Pr)}checkEmpty(e){return O.resolve(0===this.mutationQueue.length)}addMutationBatch(e,n,r,i){const s=this.pr;this.pr++;const o=new VR(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.yr=this.yr.add(new Tr(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return O.resolve(o)}lookupMutationBatch(e,n){return O.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){const i=this.Sr(n+1),s=i<0?0:i;return O.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Tr(n,0),i=new Tr(n,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],o=>{const a=this.wr(o.gr);s.push(a)}),O.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ht(ze);return n.forEach(i=>{const s=new Tr(i,0),o=new Tr(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{r=r.add(a.gr)})}),O.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;ce.isDocumentKey(s)||(s=s.child(""));const o=new Tr(new ce(s),0);let a=new Ht(ze);return this.yr.forEachWhile(u=>{const l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(u.gr)),!0)},o),O.resolve(this.br(a))}br(e){const n=[];return e.forEach(r=>{const i=this.wr(r);null!==i&&n.push(i)}),n}removeMutationBatch(e,n){Se(0===this.Dr(n.batchId,"removed")),this.mutationQueue.shift();let r=this.yr;return O.forEach(n.mutations,i=>{const s=new Tr(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){const r=new Tr(n,0),i=this.yr.firstAfterOrEqual(r);return O.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return O.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}wr(e){const n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class cle{constructor(e){this.Cr=e,this.docs=new tn(ce.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return O.resolve(r?r.document.mutableCopy():dn.newInvalidDocument(n))}getEntries(e,n){let r=ji();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():dn.newInvalidDocument(i))}),O.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=ji();const o=n.path,a=new ce(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:l,value:{document:h}}=u.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||CR(v$(h),r)<=0||(i.has(h.key)||T_(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return O.resolve(s)}getAllFromCollectionGroup(e,n,r,i){_e()}vr(e,n){return O.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new dle(this)}getSize(e){return O.resolve(this.size)}}class dle extends cz{constructor(e){super(),this._r=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),O.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}}class hle{constructor(e){this.persistence=e,this.Fr=new Wa(n=>Vc(n),I_),this.lastRemoteSnapshotVersion=Ae.min(),this.highestTargetId=0,this.Mr=0,this.Or=new eP,this.targetCount=0,this.Nr=Wc.On()}forEachTarget(e,n){return this.Fr.forEach((r,i)=>n(i)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),O.resolve()}kn(e){this.Fr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Nr=new Wc(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,O.resolve()}updateTargetData(e,n){return this.kn(n),O.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=n&&null===r.get(a.targetId)&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),O.waitFor(s).next(()=>i)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,n){const r=this.Fr.get(n)||null;return O.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),O.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),O.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),O.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Or.mr(n);return O.resolve(r)}containsKey(e,n){return O.resolve(this.Or.containsKey(n))}}class tP{constructor(e,n){this.Br={},this.overlays={},this.Lr=new ds(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new hle(this),this.indexManager=new Xue,this.remoteDocumentCache=new cle(r=>this.referenceDelegate.Qr(r)),this.serializer=new jH(n),this.Kr=new ale(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new ule,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new lle(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){ne("MemoryPersistence","Starting transaction:",e);const i=new fle(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,n){return O.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}}class fle extends I${constructor(e){super(),this.currentSequenceNumber=e}}class rT{constructor(e){this.persistence=e,this.Gr=new eP,this.zr=null}static jr(e){return new rT(e)}get Hr(){if(this.zr)return this.zr;throw _e()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),O.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),O.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.Hr,r=>{const i=ce.fromPath(r);return this.Jr(e,i).next(s=>{s||n.removeEntry(i,Ae.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return O.or([()=>O.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}}class ple{constructor(e){this.serializer=e}N(e,n,r,i){const s=new kw("createOrUpgrade",n);var u;r<1&&i>=1&&(e.createObjectStore("owner"),(u=e).createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",S$,{unique:!0}),u.createObjectStore("documentMutations"),mz(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=O.resolve();return r<3&&i>=3&&(0!==r&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),mz(e)),o=o.next(()=>function(u){const l=u.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ae.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",h)}(s))),r<4&&i>=4&&(0!==r&&(o=o.next(()=>function(u,l){return l.store("mutations").W().next(h=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",S$,{unique:!0});const p=l.store("mutations"),m=h.map(_=>p.put(_));return O.waitFor(m)})}(e,s))),o=o.next(()=>{!function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(o=o.next(()=>this.Zr(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(o=o.next(()=>this.ei(s))),r<8&&i>=8&&(o=o.next(()=>this.ti(e,s))),r<9&&i>=9&&(o=o.next(()=>{!function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(o=o.next(()=>this.ni(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{!function(u){const l=u.createObjectStore("documentOverlays",{keyPath:Jae});l.createIndex("collectionPathOverlayIndex",eue,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",tue,{unique:!1})}(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){const l=u.createObjectStore("remoteDocumentsV14",{keyPath:$ae});l.createIndex("documentKeyIndex",Hae),l.createIndex("collectionGroupIndex",zae)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ii(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:Zae}).createIndex("sequenceNumberIndex",Qae,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:Yae}).createIndex("documentKeyIndex",Xae,{unique:!1})}(e))),o}Xr(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=eT(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>O.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>O.forEach(a,u=>{Se(u.userId===s.userId);const l=Hc(this.serializer,u);return rz(e,s.userId,l).next(()=>{})}))}))}ei(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((o,a)=>{const u=new vt(o),l=[0,ri(u)];s.push(n.get(l).next(h=>h?O.resolve():n.put({targetId:0,path:ri(u),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>O.waitFor(s))})}ti(e,n){e.createObjectStore("collectionParents",{keyPath:Kae});const r=n.store("collectionParents"),i=new JR,s=o=>{if(i.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:ri(u)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{const u=new vt(o);return s(u.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,u],l)=>{const h=Xo(a);return s(h.popLast())}))}ni(e){const n=e.store("targets");return n.Y((r,i)=>{const s=k_(i),o=HH(this.serializer,s);return n.put(o)})}ri(e,n){const r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{const a=n.store("remoteDocumentsV14"),u=(p=o,p.document?new ce(vt.fromString(p.document.name).popFirst(5)):p.noDocument?ce.fromSegments(p.noDocument.path):p.unknownDocument?ce.fromSegments(p.unknownDocument.path):_e()).path.toArray(),l={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};var p;i.push(a.put(l))}).next(()=>O.waitFor(i))}ii(e,n){const r=n.store("mutations"),i=dz(this.serializer),s=new tP(rT.jr,this.serializer.ut);return r.W().next(o=>{const a=new Map;return o.forEach(u=>{var l;let h=null!==(l=a.get(u.userId))&&void 0!==l?l:Je();Hc(this.serializer,u).keys().forEach(p=>h=h.add(p)),a.set(u.userId,h)}),O.forEach(a,(u,l)=>{const h=new Ir(l),p=Yw.ct(this.serializer,h),m=s.getIndexManager(h),_=tT.ct(h,this.serializer,m,s.referenceDelegate);return new gz(i,_,p,m).recalculateAndSaveOverlaysForDocumentKeys(new bR(n,ds._e),u).next()})})}}function mz(t){t.createObjectStore("targetDocuments",{keyPath:Wae}).createIndex("documentTargetsIndex",Gae,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",qae,{unique:!0}),t.createObjectStore("targetGlobal")}const nP="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class rP{constructor(e,n,r,i,s,o,a,u,l,h,p=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.si=s,this.window=o,this.document=a,this.oi=l,this._i=h,this.ai=p,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=m=>Promise.resolve(),!rP.D())throw new ee(V.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new rle(this,i),this.Ii=n+"main",this.serializer=new jH(u),this.Ti=new go(this.Ii,this.ai,new ple(this.serializer)),this.qr=new ele(this.referenceDelegate,this.serializer),this.remoteDocumentCache=dz(this.serializer),this.Kr=new Wue,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,!1===h&&zn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ee(V.FAILED_PRECONDITION,nP);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new ds(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){var n=this;return this.Pi=function(){var r=(0,q.Z)(function*(i){if(n.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(function(){var n=(0,q.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return n.apply(this,arguments)}}())}setNetworkEnabled(e){var n=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget((0,q.Z)(function*(){n.started&&(yield n.di())})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>sT(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(n=>{n||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(n=>this.isPrimary&&!n?this.pi(e).next(()=>!1):!!n&&this.yi(e).next(()=>!0))).catch(e=>{if(el(e))return ne("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ne("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return U_(e).get("owner").next(n=>O.resolve(this.wi(n)))}Si(e){return sT(e).delete(this.clientId)}bi(){var e=this;return(0,q.Z)(function*(){if(e.isPrimary&&!e.Di(e.hi,18e5)){e.hi=Date.now();const n=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=wr(r,"clientMetadata");return i.W().next(s=>{const o=e.Ci(s,18e5),a=s.filter(u=>-1===o.indexOf(u));return O.forEach(a,u=>i.delete(u.clientId)).next(()=>a)})}).catch(()=>[]);if(e.Ei)for(const r of n)e.Ei.removeItem(e.vi(r.clientId))}})()}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?O.resolve(!0):U_(e).get("owner").next(n=>{if(null!==n&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)){if(this.wi(n)&&this.networkEnabled)return!0;if(!this.wi(n)){if(!n.allowTabSynchronization)throw new ee(V.FAILED_PRECONDITION,nP);return!1}}return!(!this.networkEnabled||!this.inForeground)||sT(e).W().next(r=>void 0===this.Ci(r,5e3).find(i=>!(this.clientId===i.clientId||!(!this.networkEnabled&&i.networkEnabled||!this.inForeground&&i.inForeground&&this.networkEnabled===i.networkEnabled))))}).next(n=>(this.isPrimary!==n&&ne("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){var e=this;return(0,q.Z)(function*(){e.kr=!1,e.Mi(),e.li&&(e.li.cancel(),e.li=null),e.xi(),e.Oi(),yield e.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],n=>{const r=new bR(n,ds._e);return e.pi(r).next(()=>e.Si(r))}),e.Ti.close(),e.Ni()})()}Ci(e,n){return e.filter(r=>this.Di(r.updateTimeMs,n)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>sT(e).W().next(n=>this.Ci(n,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,n){return tT.ct(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Jue(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return Yw.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,n,r){ne("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===n?"readonly":"readwrite",s=15===(u=this.ai)?rue:14===u?R$:13===u?A$:12===u?nue:11===u?b$:void _e();var u;let o;return this.Ti.runTransaction(e,i,s,a=>(o=new bR(a,this.Lr?this.Lr.next():ds._e),"readwrite-primary"===n?this.fi(o).next(u=>!!u||this.gi(o)).next(u=>{if(!u)throw zn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new ee(V.FAILED_PRECONDITION,E$);return r(o)}).next(u=>this.yi(o).next(()=>u)):this.Li(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Li(e){return U_(e).get("owner").next(n=>{if(null!==n&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)&&!this.wi(n)&&!(this._i||this.allowTabSynchronization&&n.allowTabSynchronization))throw new ee(V.FAILED_PRECONDITION,nP)})}yi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return U_(e).put("owner",n)}static D(){return go.D()}pi(e){const n=U_(e);return n.get("owner").next(r=>this.wi(r)?(ne("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):O.resolve())}Di(e,n){const r=Date.now();return!(e<r-n||e>r&&(zn(`Detected an update time that is in the future: ${e} > ${r}`),1))}Ai(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground="visible"===this.document.visibilityState)}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ui=()=>{this.Mi();const n=/(?:Version|Mobile)\/1[456]/;(0,w.G6)()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var n;try{const r=null!==(null===(n=this.Ei)||void 0===n?void 0:n.getItem(this.vi(e)));return ne("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return zn("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){zn("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function U_(t){return wr(t,"owner")}function sT(t){return wr(t,"clientMetadata")}function iP(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}class sP{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=i}static Qi(e,n){let r=Je(),i=Je();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new sP(e,n.fromCache,r,i)}}class gle{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class _z{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.zi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new gle;return this.Hi(e,n,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,n,o,a.size)})}).next(()=>s.result)}Ji(e,n,r,i){return r.documentReadCount<this.Ui?(Sf()<=us.in.DEBUG&&ne("QueryEngine","SDK will not create cache indexes for query:",kf(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),O.resolve()):(Sf()<=us.in.DEBUG&&ne("QueryEngine","Query:",kf(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(Sf()<=us.in.DEBUG&&ne("QueryEngine","The SDK decides to create cache indexes for query:",kf(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ti(n))):O.resolve())}zi(e,n){if(J$(n))return O.resolve(null);let r=Ti(n);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==n.limit&&1===i&&(n=zw(n,null,"F"),r=Ti(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Je(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const l=this.Yi(n,a);return this.Zi(n,l,o,u.readTime)?this.zi(e,zw(n,null,"F")):this.Xi(e,l,n,u)}))})))}ji(e,n,r,i){return J$(n)||i.isEqual(Ae.min())?O.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const o=this.Yi(n,s);return this.Zi(n,o,r,i)?O.resolve(null):(Sf()<=us.in.DEBUG&&ne("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),kf(n)),this.Xi(e,o,n,y$(i,-1)).next(a=>a))})}Yi(e,n){let r=new Ht(rH(e));return n.forEach((i,s)=>{T_(e,s)&&(r=r.add(s))}),r}Zi(e,n,r,i){if(null===e.limit)return!1;if(r.size!==n.size)return!0;const s="F"===e.limitType?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,n,r){return Sf()<=us.in.DEBUG&&ne("QueryEngine","Using full collection scan to execute query:",kf(n)),this.Gi.getDocumentsMatchingQuery(e,n,cs.min(),r)}Xi(e,n,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}class mle{constructor(e,n,r,i){this.persistence=e,this.es=n,this.serializer=i,this.ts=new tn(ze),this.ns=new Wa(s=>Vc(s),I_),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new gz(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}}function yz(t,e,n,r){return new mle(t,e,n,r)}function vz(t,e){return oP.apply(this,arguments)}function oP(){return oP=(0,q.Z)(function*(t,e){const n=le(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let u=Je();for(const l of i){o.push(l.batchId);for(const h of l.mutations)u=u.add(h.key)}for(const l of s){a.push(l.batchId);for(const h of l.mutations)u=u.add(h.key)}return n.localDocuments.getDocuments(r,u).next(l=>({_s:l,removedBatchIds:o,addedBatchIds:a}))})})}),oP.apply(this,arguments)}function Ez(t){const e=le(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function Iz(t,e,n){let r=Je(),i=Je();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=ji();return n.forEach((a,u)=>{const l=s.get(a);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(Ae.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||0===u.version.compareTo(l.version)&&l.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):ne("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",u.version)}),{us:o,cs:i}})}function vle(t,e){const n=le(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function qf(t,e){const n=le(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.qr.getTargetData(r,e).next(s=>s?(i=s,O.resolve(i)):n.qr.allocateTargetId(r).next(o=>(i=new Ka(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.ts.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}function Wf(t,e,n){return aP.apply(this,arguments)}function aP(){return aP=(0,q.Z)(function*(t,e,n){const r=le(t),i=r.ts.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!el(o))throw o;ne("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}),aP.apply(this,arguments)}function oT(t,e,n){const r=le(t);let i=Ae.min(),s=Je();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,l,h){const p=le(u),m=p.ns.get(h);return void 0!==m?O.resolve(p.ts.get(m)):p.qr.getTargetData(l,h)}(r,o,Ti(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.es.getDocumentsMatchingQuery(o,e,n?i:Ae.min(),n?s:Je())).next(a=>(Cz(r,nH(e),a),{documents:a,ls:s})))}function wz(t,e){const n=le(t),r=le(n.qr),i=n.ts.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function Tz(t,e){const n=le(t),r=n.rs.get(e)||Ae.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.ss.getAllFromCollectionGroup(i,e,y$(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(Cz(n,e,i),i))}function Cz(t,e,n){let r=t.rs.get(e)||Ae.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.rs.set(e,r)}function uP(){return uP=(0,q.Z)(function*(t,e,n,r){const i=le(t);let s=Je(),o=ji();for(const l of n){const h=e.hs(l.metadata.name);l.document&&(s=s.add(h));const p=e.Ps(l);p.setReadTime(e.Is(l.metadata.readTime)),o=o.insert(h,p)}const a=i.ss.newChangeBuffer({trackRemovals:!0}),u=yield qf(i,(h=r,Ti(Mf(vt.fromString(`__bundle__/docs/${h}`)))));var h;return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>Iz(l,a,o).next(h=>(a.apply(l),h)).next(h=>i.qr.removeMatchingKeysForTargetId(l,u.targetId).next(()=>i.qr.addMatchingKeys(l,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,h.us,h.cs)).next(()=>h.us)))}),uP.apply(this,arguments)}function Ile(t,e){return lP.apply(this,arguments)}function lP(){return lP=(0,q.Z)(function*(t,e,n=Je()){const r=yield qf(t,Ti(GR(e.bundledQuery))),i=le(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=qn(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Kr.saveNamedQuery(s,e);const a=r.withResumeToken(fr.EMPTY_BYTE_STRING,o);return i.ts=i.ts.insert(a.targetId,a),i.qr.updateTargetData(s,a).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,n,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}),lP.apply(this,arguments)}function Sz(t,e){return`firestore_clients_${t}_${e}`}function Dz(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function cP(t,e){return`firestore_targets_${t}_${e}`}class aT{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Ts(e,n,r){const i=JSON.parse(r);let s,o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code,o&&(s=new ee(i.error.code,i.error.message))),o?new aT(e,n,i.state,s):(zn("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class B_{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ts(e,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new ee(r.error.code,r.error.message))),s?new B_(e,r.state,i):(zn("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class uT{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ts(e,n){const r=JSON.parse(n);let i="object"==typeof r&&r.activeTargetIds instanceof Array,s=LR();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=T$(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new uT(e,s):(zn("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class dP{constructor(e,n){this.clientId=e,this.onlineState=n}static Ts(e){const n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new dP(n.clientId,n.onlineState):(zn("SharedClientState",`Failed to parse online state: ${e}`),null)}}class hP{constructor(){this.activeTargetIds=LR()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fP{constructor(e,n,r,i,s){this.window=e,this.si=n,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new tn(ze),this.started=!1,this.ps=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=Sz(this.persistenceKey,this.Rs),this.ws=`firestore_sequence_number_${this.persistenceKey}`,this.gs=this.gs.insert(this.Rs,new hP),this.Ss=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Cs=`firestore_online_state_${this.persistenceKey}`,this.vs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,q.Z)(function*(){const n=yield e.syncEngine.Bi();for(const i of n){if(i===e.Rs)continue;const s=e.getItem(Sz(e.persistenceKey,i));if(s){const o=uT.Ts(i,s);o&&(e.gs=e.gs.insert(o.clientId,o))}}e.Fs();const r=e.storage.getItem(e.Cs);if(r){const i=e.Ms(r);i&&e.xs(i)}for(const i of e.ps)e.fs(i);e.ps=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let n=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,n,r){this.Ns(e,n,r),this.Bs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(cP(this.persistenceKey,e));if(r){const i=B_.Ts(e,r);i&&(n=i.state)}}return this.Ls.ds(e),this.Fs(),n}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(cP(this.persistenceKey,e))}updateQueryState(e,n,r){this.ks(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return ne("SharedClientState","READ",e,n),n}setItem(e,n){ne("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){ne("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){var n=this;const r=e;if(r.storageArea===this.storage){if(ne("SharedClientState","EVENT",r.key,r.newValue),r.key===this.ys)return void zn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable((0,q.Z)(function*(){if(n.started){if(null!==r.key)if(n.Ss.test(r.key)){if(null==r.newValue){const i=n.Ks(r.key);return n.$s(i,null)}{const i=n.Us(r.key,r.newValue);if(i)return n.$s(i.clientId,i)}}else if(n.bs.test(r.key)){if(null!==r.newValue){const i=n.Ws(r.key,r.newValue);if(i)return n.Gs(i)}}else if(n.Ds.test(r.key)){if(null!==r.newValue){const i=n.zs(r.key,r.newValue);if(i)return n.js(i)}}else if(r.key===n.Cs){if(null!==r.newValue){const i=n.Ms(r.newValue);if(i)return n.xs(i)}}else if(r.key===n.ws){const i=function(o){let a=ds._e;if(null!=o)try{const u=JSON.parse(o);Se("number"==typeof u),a=u}catch(u){zn("SharedClientState","Failed to read sequence number from WebStorage",u)}return a}(r.newValue);i!==ds._e&&n.sequenceNumberHandler(i)}else if(r.key===n.vs){const i=n.Hs(r.newValue);yield Promise.all(i.map(s=>n.syncEngine.Js(s)))}}else n.ps.push(r)}))}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,n,r){const i=new aT(this.currentUser,e,n,r),s=Dz(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const n=Dz(this.persistenceKey,this.currentUser,e);this.removeItem(n)}qs(e){this.storage.setItem(this.Cs,JSON.stringify({clientId:this.Rs,onlineState:e}))}ks(e,n,r){const i=cP(this.persistenceKey,e),s=new B_(e,n,r);this.setItem(i,s.Es())}Qs(e){const n=JSON.stringify(Array.from(e));this.setItem(this.vs,n)}Ks(e){const n=this.Ss.exec(e);return n?n[1]:null}Us(e,n){const r=this.Ks(e);return uT.Ts(r,n)}Ws(e,n){const r=this.bs.exec(e),i=Number(r[1]);return aT.Ts(new Ir(void 0!==r[2]?r[2]:null),i,n)}zs(e,n){const r=this.Ds.exec(e),i=Number(r[1]);return B_.Ts(i,n)}Ms(e){return dP.Ts(e)}Hs(e){return JSON.parse(e)}Gs(e){var n=this;return(0,q.Z)(function*(){if(e.user.uid===n.currentUser.uid)return n.syncEngine.Ys(e.batchId,e.state,e.error);ne("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,n){const r=n?this.gs.insert(e,n):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.Xs(o,a).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let n=LR();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class bz{constructor(){this.eo=new hP,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new hP,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class wle{ro(e){}shutdown(){}}class Az{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){ne("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){ne("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let lT=null;function pP(){return null===lT?lT=268435456+Math.round(2147483648*Math.random()):lT++,"0x"+lT.toString(16)}const Tle={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Cle{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}const si="WebChannelConnection";class Sle extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+n.host,this.fo=`projects/${i}/databases/${s}`,this.po="(default)"===this.databaseId.database?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(n,r,i,s,o){const a=pP(),u=this.So(n,r);ne("RestConnection",`Sending RPC '${n}' ${a}:`,u,i);const l={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(l,s,o),this.Do(n,u,l,i).then(h=>(ne("RestConnection",`Received RPC '${n}' ${a}: `,h),h),h=>{throw Ui("RestConnection",`RPC '${n}' ${a} failed with error: `,h,"url: ",u,"request:",i),h})}Co(n,r,i,s,o,a){return this.wo(n,r,i,s,o)}bo(n,r,i){n["X-Goog-Api-Client"]="gl-js/ fire/"+Cf,n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}So(n,r){return`${this.mo}/v1/${r}:${Tle[n]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,n,r,i){const s=pP();return new Promise((o,a)=>{const u=new wae;u.setWithCredentials(!0),u.listenOnce(Eae.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case IR.NO_ERROR:const h=u.getResponseJson();ne(si,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case IR.TIMEOUT:ne(si,`RPC '${e}' ${s} timed out`),a(new ee(V.DEADLINE_EXCEEDED,"Request time out"));break;case IR.HTTP_ERROR:const p=u.getStatus();if(ne(si,`RPC '${e}' ${s} failed with status:`,p,"response text:",u.getResponseText()),p>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const _=m?.error;if(_&&_.status&&_.message){const v=function(T){const N=T.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(N)>=0?N:V.UNKNOWN}(_.status);a(new ee(v,_.message))}else a(new ee(V.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new ee(V.UNAVAILABLE,"Connection failed."));break;default:_e()}}finally{ne(si,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(i);ne(si,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",l,r,15)})}vo(e,n,r){const i=pP(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=yae(),a=vae(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.useFetchStreams=!0),this.bo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const h=s.join("");ne(si,`Creating RPC '${e}' stream ${i}: ${h}`,u);const p=o.createWebChannel(h,u);let m=!1,_=!1;const v=new Cle({co:T=>{_?ne(si,`Not sending because RPC '${e}' stream ${i} is closed:`,T):(m||(ne(si,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),ne(si,`RPC '${e}' stream ${i} sending:`,T),p.send(T))},lo:()=>p.close()}),I=(T,N,b)=>{T.listen(N,k=>{try{b(k)}catch($){setTimeout(()=>{throw $},0)}})};return I(p,xw.EventType.OPEN,()=>{_||ne(si,`RPC '${e}' stream ${i} transport opened.`)}),I(p,xw.EventType.CLOSE,()=>{_||(_=!0,ne(si,`RPC '${e}' stream ${i} transport closed`),v.Ro())}),I(p,xw.EventType.ERROR,T=>{_||(_=!0,Ui(si,`RPC '${e}' stream ${i} transport errored:`,T),v.Ro(new ee(V.UNAVAILABLE,"The operation could not be completed")))}),I(p,xw.EventType.MESSAGE,T=>{var N;if(!_){const b=T.data[0];Se(!!b);const $=b.error||(null===(N=b[0])||void 0===N?void 0:N.error);if($){ne(si,`RPC '${e}' stream ${i} received error:`,$);const ie=$.status;let pe=function(Br){const Bs=tr[Br];if(void 0!==Bs)return IH(Bs)}(ie),qe=$.message;void 0===pe&&(pe=V.INTERNAL,qe="Unknown error status: "+ie+" with message "+$.message),_=!0,v.Ro(new ee(pe,qe)),p.close()}else ne(si,`RPC '${e}' stream ${i} received:`,b),v.Vo(b)}}),I(a,Iae.STAT_EVENT,T=>{T.stat===h$.PROXY?ne(si,`RPC '${e}' stream ${i} detected buffering proxy`):T.stat===h$.NOPROXY&&ne(si,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.Ao()},0),v}}function Rz(){return typeof window<"u"?window:null}function cT(){return typeof document<"u"?document:null}function j_(t){return new Oue(t,!0)}class gP{constructor(e,n,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=n,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const n=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&ne("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){null!==this.No&&(this.No.skipDelay(),this.No=null)}cancel(){null!==this.No&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class Pz{constructor(e,n,r,i,s,o,a,u){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new gP(e,n)}jo(){return 1===this.state||5===this.state||this.Ho()}Ho(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Jo()}stop(){var e=this;return(0,q.Z)(function*(){e.jo()&&(yield e.close(0))})()}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&null===this.Wo&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}Xo(){var e=this;return(0,q.Z)(function*(){if(e.Ho())return e.close(0)})()}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}close(e,n){var r=this;return(0,q.Z)(function*(){r.t_(),r.n_(),r.zo.cancel(),r.Uo++,4!==e?r.zo.reset():n&&n.code===V.RESOURCE_EXHAUSTED?(zn(n.toString()),zn("Using maximum backoff delay to prevent overloading the backend."),r.zo.Lo()):n&&n.code===V.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.r_(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Io(n)})()}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),n=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===n&&this.s_(r,i)},r=>{e(()=>{const i=new ee(V.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,n){const r=this.i_(this.Uo);this.stream=this.__(e,n),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){var e=this;this.state=5,this.zo.ko((0,q.Z)(function*(){e.state=0,e.start()}))}o_(e){return ne("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return n=>{this.si.enqueueAndForget(()=>this.Uo===e?n():(ne("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Dle extends Pz{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}__(e,n){return this.connection.vo("Listen",e,n)}onMessage(e){this.zo.reset();const n=function Vue(t,e){let n;if("targetChange"in e){const r="NO_CHANGE"===(l=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===l?1:"REMOVE"===l?2:"CURRENT"===l?3:"RESET"===l?4:_e(),i=e.targetChange.targetIds||[],s=function(l,h){return l.useProto3Json?(Se(void 0===h||"string"==typeof h),fr.fromBase64String(h||"")):(Se(void 0===h||h instanceof Uint8Array),fr.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const h=void 0===l.code?V.UNKNOWN:IH(l.code);return new ee(h,l.message||"")}(o);n=new DH(r,i,s,a||null)}else if("documentChange"in e){const r=e.documentChange,i=ta(t,r.document.name),s=qn(r.document.updateTime),o=r.document.createTime?qn(r.document.createTime):Ae.min(),a=new Fr({mapValue:{fields:r.document.fields}}),u=dn.newFoundDocument(i,s,o,a);n=new Zw(r.targetIds||[],r.removedTargetIds||[],u.key,u)}else if("documentDelete"in e){const r=e.documentDelete,i=ta(t,r.document),s=r.readTime?qn(r.readTime):Ae.min(),o=dn.newNoDocument(i,s);n=new Zw([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const r=e.documentRemove,i=ta(t,r.document);n=new Zw([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return _e();{const r=e.filter,{count:i=0,unchangedNames:s}=r,o=new Rue(i,s);n=new SH(r.targetId,o)}}var l;return n}(this.serializer,e),r=function(s){if(!("targetChange"in s))return Ae.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Ae.min():o.readTime?qn(o.readTime):Ae.min()}(e);return this.listener.a_(n,r)}u_(e){const n={};n.database=M_(this.serializer),n.addTarget=function(s,o){let a;const u=o.target;if(a=$w(u)?{documents:LH(s,u)}:{query:WR(s,u)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=PH(s,o.resumeToken);const l=$R(s,o.expectedCount);null!==l&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(Ae.min())>0){a.readTime=Uf(s,o.snapshotVersion.toTimestamp());const l=$R(s,o.expectedCount);null!==l&&(a.expectedCount=l)}return a}(this.serializer,e);const r=function Bue(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _e()}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);r&&(n.labels=r),this.e_(n)}c_(e){const n={};n.database=M_(this.serializer),n.removeTarget=e,this.e_(n)}}class ble extends Pz{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,n){return this.connection.vo("Write",e,n)}onMessage(e){if(Se(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const n=function Uue(t,e){return t&&t.length>0?(Se(void 0!==e),t.map(n=>function(i,s){let o=qn(i.updateTime?i.updateTime:s);return o.isEqual(Ae.min())&&(o=qn(s)),new Sue(o,i.transformResults||[])}(n,e))):[]}(e.writeResults,e.commitTime),r=qn(e.commitTime);return this.listener.I_(r,n)}return Se(!e.writeResults||0===e.writeResults.length),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=M_(this.serializer),this.e_(e)}P_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>x_(this.serializer,r))};this.e_(n)}}class Ale extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new ee(V.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,n,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,n,r,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ee(V.UNKNOWN,i.toString())})}Co(e,n,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,n,r,s,o,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ee(V.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class Ple{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){0===this.V_&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){"Online"===this.state?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,"Online"===e&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const n=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(zn(n),this.f_=!1):ne("OnlineStateTracker",n)}S_(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}}class Nle{constructor(e,n,r,i,s){var o=this;this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{r.enqueueAndForget((0,q.Z)(function*(){var u;hl(o)&&(ne("RemoteStore","Restarting streams for network reachability change."),yield(u=(0,q.Z)(function*(h){const p=le(h);p.C_.add(4),yield Gf(p),p.M_.set("Unknown"),p.C_.delete(4),yield $_(p)}),function l(h){return u.apply(this,arguments)})(o))}))}),this.M_=new Ple(r,i)}}function $_(t){return _P.apply(this,arguments)}function _P(){return _P=(0,q.Z)(function*(t){if(hl(t))for(const e of t.v_)yield e(!0)}),_P.apply(this,arguments)}function Gf(t){return yP.apply(this,arguments)}function yP(){return yP=(0,q.Z)(function*(t){for(const e of t.v_)yield e(!1)}),yP.apply(this,arguments)}function dT(t,e){const n=le(t);n.D_.has(e.targetId)||(n.D_.set(e.targetId,e),IP(n)?EP(n):Zf(n).Ho()&&vP(n,e))}function H_(t,e){const n=le(t),r=Zf(n);n.D_.delete(e),r.Ho()&&Nz(n,e),0===n.D_.size&&(r.Ho()?r.Zo():hl(n)&&n.M_.set("Unknown"))}function vP(t,e){if(t.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ae.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Zf(t).u_(e)}function Nz(t,e){t.x_.Oe(e),Zf(t).c_(e)}function EP(t){t.x_=new Nue({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.D_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Zf(t).start(),t.M_.g_()}function IP(t){return hl(t)&&!Zf(t).jo()&&t.D_.size>0}function hl(t){return 0===le(t).C_.size}function Mz(t){t.x_=void 0}function Mle(t){return wP.apply(this,arguments)}function wP(){return wP=(0,q.Z)(function*(t){t.D_.forEach((e,n)=>{vP(t,e)})}),wP.apply(this,arguments)}function xle(t,e){return TP.apply(this,arguments)}function TP(){return TP=(0,q.Z)(function*(t,e){Mz(t),IP(t)?(t.M_.w_(e),EP(t)):t.M_.set("Unknown")}),TP.apply(this,arguments)}function kle(t,e,n){return CP.apply(this,arguments)}function CP(){return CP=(0,q.Z)(function*(t,e,n){if(t.M_.set("Online"),e instanceof DH&&2===e.state&&e.cause)try{yield(r=(0,q.Z)(function*(s,o){const a=o.cause;for(const u of o.targetIds)s.D_.has(u)&&(yield s.remoteSyncer.rejectListen(u,a),s.D_.delete(u),s.x_.removeTarget(u))}),function i(s,o){return r.apply(this,arguments)})(t,e)}catch(r){ne("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield hT(t,r)}else if(e instanceof Zw?t.x_.$e(e):e instanceof SH?t.x_.Je(e):t.x_.Ge(e),!n.isEqual(Ae.min()))try{const r=yield Ez(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){const a=s.x_.it(o);return a.targetChanges.forEach((u,l)=>{if(u.resumeToken.approximateByteSize()>0){const h=s.D_.get(l);h&&s.D_.set(l,h.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,l)=>{const h=s.D_.get(u);if(!h)return;s.D_.set(u,h.withResumeToken(fr.EMPTY_BYTE_STRING,h.snapshotVersion)),Nz(s,u);const p=new Ka(h.target,u,l,h.sequenceNumber);vP(s,p)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){ne("RemoteStore","Failed to raise snapshot:",r),yield hT(t,r)}var r}),CP.apply(this,arguments)}function hT(t,e,n){return SP.apply(this,arguments)}function SP(){return SP=(0,q.Z)(function*(t,e,n){if(!el(e))throw e;t.C_.add(1),yield Gf(t),t.M_.set("Offline"),n||(n=()=>Ez(t.localStore)),t.asyncQueue.enqueueRetryable((0,q.Z)(function*(){ne("RemoteStore","Retrying IndexedDB access"),yield n(),t.C_.delete(1),yield $_(t)}))}),SP.apply(this,arguments)}function xz(t,e){return e().catch(n=>hT(t,n,e))}function Kf(t){return DP.apply(this,arguments)}function DP(){return DP=(0,q.Z)(function*(t){const e=le(t),n=fl(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;Ole(e);)try{const i=yield vle(e.localStore,r);if(null===i){0===e.b_.length&&n.Zo();break}r=i.batchId,Lle(e,i)}catch(i){yield hT(e,i)}kz(e)&&Oz(e)}),DP.apply(this,arguments)}function Ole(t){return hl(t)&&t.b_.length<10}function Lle(t,e){t.b_.push(e);const n=fl(t);n.Ho()&&n.h_&&n.P_(e.mutations)}function kz(t){return hl(t)&&!fl(t).jo()&&t.b_.length>0}function Oz(t){fl(t).start()}function Fle(t){return bP.apply(this,arguments)}function bP(){return bP=(0,q.Z)(function*(t){fl(t).E_()}),bP.apply(this,arguments)}function Vle(t){return AP.apply(this,arguments)}function AP(){return AP=(0,q.Z)(function*(t){const e=fl(t);for(const n of t.b_)e.P_(n.mutations)}),AP.apply(this,arguments)}function Ule(t,e,n){return RP.apply(this,arguments)}function RP(){return RP=(0,q.Z)(function*(t,e,n){const r=t.b_.shift(),i=UR.from(r,e,n);yield xz(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield Kf(t)}),RP.apply(this,arguments)}function Ble(t,e){return PP.apply(this,arguments)}function PP(){return PP=(0,q.Z)(function*(t,e){var n;e&&fl(t).h_&&(yield(n=(0,q.Z)(function*(i,s){if(EH(a=s.code)&&a!==V.ABORTED){const o=i.b_.shift();fl(i).Yo(),yield xz(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield Kf(i)}var a}),function r(i,s){return n.apply(this,arguments)})(t,e)),kz(t)&&Oz(t)}),PP.apply(this,arguments)}function Lz(t,e){return NP.apply(this,arguments)}function NP(){return NP=(0,q.Z)(function*(t,e){const n=le(t);n.asyncQueue.verifyOperationInProgress(),ne("RemoteStore","RemoteStore received new credentials");const r=hl(n);n.C_.add(3),yield Gf(n),r&&n.M_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.C_.delete(3),yield $_(n)}),NP.apply(this,arguments)}function MP(t,e){return xP.apply(this,arguments)}function xP(){return xP=(0,q.Z)(function*(t,e){const n=le(t);e?(n.C_.delete(2),yield $_(n)):e||(n.C_.add(2),yield Gf(n),n.M_.set("Unknown"))}),xP.apply(this,arguments)}function Zf(t){return t.O_||(t.O_=function(n,r,i){const s=le(n);return s.A_(),new Dle(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:Mle.bind(null,t),Io:xle.bind(null,t),a_:kle.bind(null,t)}),t.v_.push(function(){var e=(0,q.Z)(function*(n){n?(t.O_.Yo(),IP(t)?EP(t):t.M_.set("Unknown")):(yield t.O_.stop(),Mz(t))});return function(n){return e.apply(this,arguments)}}())),t.O_}function fl(t){return t.N_||(t.N_=function(n,r,i){const s=le(n);return s.A_(),new ble(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:Fle.bind(null,t),Io:Ble.bind(null,t),T_:Vle.bind(null,t),I_:Ule.bind(null,t)}),t.v_.push(function(){var e=(0,q.Z)(function*(n){n?(t.N_.Yo(),yield Kf(t)):(yield t.N_.stop(),t.b_.length>0&&(ne("RemoteStore",`Stopping write stream with ${t.b_.length} pending writes`),t.b_=[]))});return function(n){return e.apply(this,arguments)}}())),t.N_}class kP{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new hr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new kP(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ee(V.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Qf(t,e){if(zn("AsyncQueue",`${e}: ${t}`),el(t))return new ee(V.UNAVAILABLE,`${e}: ${t}`);throw t}class Yf{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ce.comparator(n.key,r.key):(n,r)=>ce.comparator(n.key,r.key),this.keyedMap=C_(),this.sortedSet=new tn(this.comparator)}static emptySet(e){return new Yf(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Yf)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,n){const r=new Yf;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class Fz{constructor(){this.B_=new tn(ce.comparator)}track(e){const n=e.doc.key,r=this.B_.get(n);r?0!==e.type&&3===r.type?this.B_=this.B_.insert(n,e):3===e.type&&1!==r.type?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.B_=this.B_.remove(n):1===e.type&&2===r.type?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):_e():this.B_=this.B_.insert(n,e)}L_(){const e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Xf{constructor(e,n,r,i,s,o,a,u,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Xf(e,n,Yf.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&w_(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}class jle{constructor(){this.k_=void 0,this.listeners=[]}}class $le{constructor(){this.queries=new Wa(e=>tH(e),w_),this.onlineState="Unknown",this.q_=new Set}}function OP(t,e){return LP.apply(this,arguments)}function LP(){return LP=(0,q.Z)(function*(t,e){const n=le(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new jle),i)try{s.k_=yield n.onListen(r)}catch(o){const a=Qf(o,`Initialization of query '${kf(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.listeners.push(e),e.Q_(n.onlineState),s.k_&&e.K_(s.k_)&&UP(n)}),LP.apply(this,arguments)}function FP(t,e){return VP.apply(this,arguments)}function VP(){return VP=(0,q.Z)(function*(t,e){const n=le(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}),VP.apply(this,arguments)}function Hle(t,e){const n=le(t);let r=!1;for(const i of e){const o=n.queries.get(i.query);if(o){for(const a of o.listeners)a.K_(i)&&(r=!0);o.k_=i}}r&&UP(n)}function zle(t,e,n){const r=le(t),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(e)}function UP(t){t.q_.forEach(e=>{e.next()})}class BP{constructor(e,n,r){this.query=e,this.U_=n,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new Xf(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.W_?this.z_(e)&&(this.U_.next(e),n=!0):this.j_(e,this.onlineState)&&(this.H_(e),n=!0),this.G_=e,n}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let n=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),n=!0),n}j_(e,n){return!e.fromCache||(!this.options.J_||!("Offline"!==n))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===n)}z_(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}H_(e){e=Xf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}class qle{constructor(e,n){this.Y_=e,this.byteLength=n}Z_(){return"metadata"in this.Y_}}class Vz{constructor(e){this.serializer=e}hs(e){return ta(this.serializer,e)}Ps(e){return e.metadata.exists?OH(this.serializer,e.document,!1):dn.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return qn(e)}}class Wle{constructor(e,n,r){this.X_=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Uz(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++n;const r=vt.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ta(e){const n=new Map,r=new Vz(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const o of i.metadata.queries){const a=(n.get(o)||Je()).add(s);n.set(o,a)}}return n}complete(){var e=this;return(0,q.Z)(function*(){const n=yield function Ele(t,e,n,r){return uP.apply(this,arguments)}(e.localStore,new Vz(e.serializer),e.documents,e.X_.id),r=e.ta(e.documents);for(const i of e.queries)yield Ile(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,na:e.collectionGroups,ra:n}})()}}function Uz(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}class Bz{constructor(e){this.key=e}}class jz{constructor(e){this.key=e}}class $z{constructor(e,n){this.query=e,this.ia=n,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=Je(),this.mutatedKeys=Je(),this._a=rH(e),this.aa=new Yf(this._a)}get ua(){return this.ia}ca(e,n){const r=n?n.la:new Fz,i=n?n.aa:this.aa;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,p)=>{const m=i.get(h),_=T_(this.query,p)?p:null,v=!!m&&this.mutatedKeys.has(m.key),I=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let T=!1;m&&_?m.data.isEqual(_.data)?v!==I&&(r.track({type:3,doc:_}),T=!0):this.ha(m,_)||(r.track({type:2,doc:_}),T=!0,(u&&this._a(_,u)>0||l&&this._a(_,l)<0)&&(a=!0)):!m&&_?(r.track({type:0,doc:_}),T=!0):m&&!_&&(r.track({type:1,doc:m}),T=!0,(u||l)&&(a=!0)),T&&(_?(o=o.add(_),s=I?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const h="F"===this.query.limitType?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{aa:o,la:r,Zi:a,mutatedKeys:s}}ha(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const o=e.la.L_();o.sort((h,p)=>function(_,v){const I=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _e()}};return I(_)-I(v)}(h.type,p.type)||this._a(h.doc,p.doc)),this.Pa(r),i=null!=i&&i;const a=n&&!i?this.Ia():[],u=0===this.oa.size&&this.current&&!i?1:0,l=u!==this.sa;return this.sa=u,0!==o.length||l?{snapshot:new Xf(this.query,e.aa,s,o,e.mutatedKeys,0===u,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:a}:{Ta:a}}Q_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({aa:this.aa,la:new Fz,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(n=>this.ia=this.ia.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ia=this.ia.delete(n)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=Je(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const n=[];return e.forEach(r=>{this.oa.has(r)||n.push(new jz(r))}),this.oa.forEach(r=>{e.has(r)||n.push(new Bz(r))}),n}da(e){this.ia=e.ls,this.oa=Je();const n=this.ca(e.documents);return this.applyChanges(n,!0)}Aa(){return Xf.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,0===this.sa,this.hasCachedResults)}}class Gle{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Kle{constructor(e){this.key=e,this.Ra=!1}}class Zle{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Va={},this.ma=new Wa(a=>tH(a),w_),this.fa=new Map,this.ga=new Set,this.pa=new tn(ce.comparator),this.ya=new Map,this.wa=new eP,this.Sa={},this.ba=new Map,this.Da=Wc.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return!0===this.Ca}}function Qle(t,e){return jP.apply(this,arguments)}function jP(){return jP=(0,q.Z)(function*(t,e){const n=cN(t);let r,i;const s=n.ma.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const o=yield qf(n.localStore,Ti(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield $P(n,e,r,"current"===a,o.resumeToken),n.isPrimaryClient&&dT(n.remoteStore,o)}return i}),jP.apply(this,arguments)}function $P(t,e,n,r,i){return HP.apply(this,arguments)}function HP(){return HP=(0,q.Z)(function*(t,e,n,r,i){t.va=(p,m,_)=>{return(v=(0,q.Z)(function*(T,N,b,k){let $=N.view.ca(b);$.Zi&&($=yield oT(T.localStore,N.query,!1).then(({documents:kt})=>N.view.ca(kt,$)));const ie=k&&k.targetChanges.get(N.targetId),pe=k&&null!=k.targetMismatches.get(N.targetId),qe=N.view.applyChanges($,T.isPrimaryClient,ie,pe);return JP(T,N.targetId,qe.Ta),qe.snapshot}),function I(T,N,b,k){return v.apply(this,arguments)})(t,p,m,_);var v};const s=yield oT(t.localStore,e,!0),o=new $z(e,s.ls),a=o.ca(s.documents),u=P_.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState,i),l=o.applyChanges(a,t.isPrimaryClient,u);JP(t,n,l.Ta);const h=new Gle(e,n,o);return t.ma.set(e,h),t.fa.has(n)?t.fa.get(n).push(e):t.fa.set(n,[e]),l.snapshot}),HP.apply(this,arguments)}function Yle(t,e){return zP.apply(this,arguments)}function zP(){return zP=(0,q.Z)(function*(t,e){const n=le(t),r=n.ma.get(e),i=n.fa.get(r.targetId);if(i.length>1)return n.fa.set(r.targetId,i.filter(s=>!w_(s,e))),void n.ma.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Wf(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),H_(n.remoteStore,r.targetId),Jf(n,r.targetId)}).catch(Ju))):(Jf(n,r.targetId),yield Wf(n.localStore,r.targetId,!0))}),zP.apply(this,arguments)}function qP(){return qP=(0,q.Z)(function*(t,e,n){const r=dN(t);try{const i=yield function(o,a){const u=le(o),l=_n.now(),h=a.reduce((_,v)=>_.add(v.key),Je());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",_=>{let v=ji(),I=Je();return u.ss.getEntries(_,h).next(T=>{v=T,v.forEach((N,b)=>{b.isValidDocument()||(I=I.add(N))})}).next(()=>u.localDocuments.getOverlayedDocuments(_,v)).next(T=>{p=T;const N=[];for(const b of a){const k=bue(b,p.get(b.key).overlayedDocument);null!=k&&N.push(new Ga(b.key,k,B$(k.value.mapValue),yn.exists(!0)))}return u.mutationQueue.addMutationBatch(_,l,N,a)}).next(T=>{m=T;const N=T.applyToLocalDocumentSet(p,I);return u.documentOverlayCache.saveOverlays(_,T.batchId,N)})}).then(()=>({batchId:m.batchId,changes:sH(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let l=o.Sa[o.currentUser.toKey()];l||(l=new tn(ze)),l=l.insert(a,u),o.Sa[o.currentUser.toKey()]=l}(r,i.batchId,n),yield Za(r,i.changes),yield Kf(r.remoteStore)}catch(i){const s=Qf(i,"Failed to persist write");n.reject(s)}}),qP.apply(this,arguments)}function Hz(t,e){return WP.apply(this,arguments)}function WP(){return WP=(0,q.Z)(function*(t,e){const n=le(t);try{const r=yield function yle(t,e){const n=le(t),r=e.snapshotVersion;let i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;const a=[];e.targetChanges.forEach((h,p)=>{const m=i.get(p);if(!m)return;a.push(n.qr.removeMatchingKeys(s,h.removedDocuments,p).next(()=>n.qr.addMatchingKeys(s,h.addedDocuments,p)));let _=m.withSequenceNumber(s.currentSequenceNumber);var I,T,N;null!==e.targetMismatches.get(p)?_=_.withResumeToken(fr.EMPTY_BYTE_STRING,Ae.min()).withLastLimboFreeSnapshotVersion(Ae.min()):h.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(h.resumeToken,r)),i=i.insert(p,_),T=_,N=h,(0===(I=m).resumeToken.approximateByteSize()||T.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=3e8||N.addedDocuments.size+N.modifiedDocuments.size+N.removedDocuments.size>0)&&a.push(n.qr.updateTargetData(s,_))});let u=ji(),l=Je();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(Iz(s,o,e.documentUpdates).next(h=>{u=h.us,l=h.cs})),!r.isEqual(Ae.min())){const h=n.qr.getLastRemoteSnapshotVersion(s).next(p=>n.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return O.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,l)).next(()=>u)}).then(s=>(n.ts=i,s))}(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.ya.get(s);o&&(Se(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ra=!0:i.modifiedDocuments.size>0?Se(o.Ra):i.removedDocuments.size>0&&(Se(o.Ra),o.Ra=!1))}),yield Za(n,r,e)}catch(r){yield Ju(r)}}),WP.apply(this,arguments)}function zz(t,e,n){const r=le(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const i=[];r.ma.forEach((s,o)=>{const a=o.view.Q_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const u=le(o);u.onlineState=a;let l=!1;u.queries.forEach((h,p)=>{for(const m of p.listeners)m.Q_(a)&&(l=!0)}),l&&UP(u)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Jle(t,e,n){return GP.apply(this,arguments)}function GP(){return GP=(0,q.Z)(function*(t,e,n){const r=le(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.ya.get(e),s=i&&i.key;if(s){let o=new tn(ce.comparator);o=o.insert(s,dn.newNoDocument(s,Ae.min()));const a=Je().add(s),u=new R_(Ae.min(),new Map,new tn(ze),o,a);yield Hz(r,u),r.pa=r.pa.remove(s),r.ya.delete(e),eN(r)}else yield Wf(r.localStore,e,!1).then(()=>Jf(r,e,n)).catch(Ju)}),GP.apply(this,arguments)}function ece(t,e){return KP.apply(this,arguments)}function KP(){return KP=(0,q.Z)(function*(t,e){const n=le(t),r=e.batch.batchId;try{const i=yield function _le(t,e){const n=le(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.ss.newChangeBuffer({trackRemovals:!0});return function(a,u,l,h){const p=l.batch,m=p.keys();let _=O.resolve();return m.forEach(v=>{_=_.next(()=>h.getEntry(u,v)).next(I=>{const T=l.docVersions.get(v);Se(null!==T),I.version.compareTo(T)<0&&(p.applyToRemoteDocument(I,l),I.isValidDocument()&&(I.setReadTime(l.commitVersion),h.addEntry(I)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(u,p))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=Je();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(u=u.add(a.batch.mutations[l].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}(n.localStore,e);XP(n,r,null),YP(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield Za(n,i)}catch(i){yield Ju(i)}}),KP.apply(this,arguments)}function tce(t,e,n){return ZP.apply(this,arguments)}function ZP(){return ZP=(0,q.Z)(function*(t,e,n){const r=le(t);try{const i=yield function(o,a){const u=le(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return u.mutationQueue.lookupMutationBatch(l,a).next(p=>(Se(null!==p),h=p.keys(),u.mutationQueue.removeMutationBatch(l,p))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,h,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>u.localDocuments.getDocuments(l,h))})}(r.localStore,e);XP(r,e,n),YP(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield Za(r,i)}catch(i){yield Ju(i)}}),ZP.apply(this,arguments)}function QP(){return QP=(0,q.Z)(function*(t,e){const n=le(t);hl(n.remoteStore)||ne("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(o){const a=le(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(n.localStore);if(-1===r)return void e.resolve();const i=n.ba.get(r)||[];i.push(e),n.ba.set(r,i)}catch(r){const i=Qf(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),QP.apply(this,arguments)}function YP(t,e){(t.ba.get(e)||[]).forEach(n=>{n.resolve()}),t.ba.delete(e)}function XP(t,e,n){const r=le(t);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function Jf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.fa.get(e))t.ma.delete(r),n&&t.Va.Fa(r,n);t.fa.delete(e),t.isPrimaryClient&&t.wa.Rr(e).forEach(r=>{t.wa.containsKey(r)||qz(t,r)})}function qz(t,e){t.ga.delete(e.path.canonicalString());const n=t.pa.get(e);null!==n&&(H_(t.remoteStore,n),t.pa=t.pa.remove(e),t.ya.delete(n),eN(t))}function JP(t,e,n){for(const r of n)r instanceof Bz?(t.wa.addReference(r.key,e),rce(t,r)):r instanceof jz?(ne("SyncEngine","Document no longer in limbo: "+r.key),t.wa.removeReference(r.key,e),t.wa.containsKey(r.key)||qz(t,r.key)):_e()}function rce(t,e){const n=e.key,r=n.path.canonicalString();t.pa.get(n)||t.ga.has(r)||(ne("SyncEngine","New document in limbo: "+n),t.ga.add(r),eN(t))}function eN(t){for(;t.ga.size>0&&t.pa.size<t.maxConcurrentLimboResolutions;){const e=t.ga.values().next().value;t.ga.delete(e);const n=new ce(vt.fromString(e)),r=t.Da.next();t.ya.set(r,new Kle(n)),t.pa=t.pa.insert(n,r),dT(t.remoteStore,new Ka(Ti(Mf(n.path)),r,"TargetPurposeLimboResolution",ds._e))}}function Za(t,e,n){return tN.apply(this,arguments)}function tN(){return tN=(0,q.Z)(function*(t,e,n){const r=le(t),i=[],s=[],o=[];var a;r.ma.isEmpty()||(r.ma.forEach((a,u)=>{o.push(r.va(u,e,n).then(l=>{if((l||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,l?.fromCache?"not-current":"current"),l){i.push(l);const h=sP.Qi(u.targetId,l);s.push(h)}}))}),yield Promise.all(o),r.Va.a_(i),yield(a=(0,q.Z)(function*(l,h){const p=le(l);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>O.forEach(h,_=>O.forEach(_.ki,v=>p.persistence.referenceDelegate.addReference(m,_.targetId,v)).next(()=>O.forEach(_.qi,v=>p.persistence.referenceDelegate.removeReference(m,_.targetId,v)))))}catch(m){if(!el(m))throw m;ne("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const _=m.targetId;if(!m.fromCache){const v=p.ts.get(_),T=v.withLastLimboFreeSnapshotVersion(v.snapshotVersion);p.ts=p.ts.insert(_,T)}}}),function u(l,h){return a.apply(this,arguments)})(r.localStore,s))}),tN.apply(this,arguments)}function ice(t,e){return nN.apply(this,arguments)}function nN(){return nN=(0,q.Z)(function*(t,e){const n=le(t);if(!n.currentUser.isEqual(e)){ne("SyncEngine","User change. New user:",e.toKey());const r=yield vz(n.localStore,e);n.currentUser=e,(s=n).ba.forEach(a=>{a.forEach(u=>{u.reject(new ee(V.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.ba.clear(),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Za(n,r._s)}var s}),nN.apply(this,arguments)}function sce(t,e){const n=le(t),r=n.ya.get(e);if(r&&r.Ra)return Je().add(r.key);{let i=Je();const s=n.fa.get(e);if(!s)return i;for(const o of s){const a=n.ma.get(o);i=i.unionWith(a.view.ua)}return i}}function oce(t,e){return rN.apply(this,arguments)}function rN(){return rN=(0,q.Z)(function*(t,e){const n=le(t),r=yield oT(n.localStore,e.query,!0),i=e.view.da(r);return n.isPrimaryClient&&JP(n,e.targetId,i.Ta),i}),rN.apply(this,arguments)}function ace(t,e){return iN.apply(this,arguments)}function iN(){return iN=(0,q.Z)(function*(t,e){const n=le(t);return Tz(n.localStore,e).then(r=>Za(n,r))}),iN.apply(this,arguments)}function uce(t,e,n,r){return sN.apply(this,arguments)}function sN(){return sN=(0,q.Z)(function*(t,e,n,r){const i=le(t),s=yield function(a,u){const l=le(a),h=le(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",p=>h.Cn(p,u).next(m=>m?l.localDocuments.getDocuments(p,m):O.resolve(null)))}(i.localStore,e);var u;null!==s?("pending"===n?yield Kf(i.remoteStore):"acknowledged"===n||"rejected"===n?(XP(i,e,r||null),YP(i,e),u=e,le(le(i.localStore).mutationQueue).Fn(u)):_e(),yield Za(i,s)):ne("SyncEngine","Cannot apply mutation batch with id: "+e)}),sN.apply(this,arguments)}function oN(){return oN=(0,q.Z)(function*(t,e){const n=le(t);if(cN(n),dN(n),!0===e&&!0!==n.Ca){const r=n.sharedClientState.getAllActiveQueryTargets(),i=yield Wz(n,r.toArray());n.Ca=!0,yield MP(n.remoteStore,!0);for(const s of i)dT(n.remoteStore,s)}else if(!1===e&&!1!==n.Ca){const r=[];let i=Promise.resolve();n.fa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Jf(n,o),Wf(n.localStore,o,!0))),H_(n.remoteStore,o)}),yield i,yield Wz(n,r),function(o){const a=le(o);a.ya.forEach((u,l)=>{H_(a.remoteStore,l)}),a.wa.Vr(),a.ya=new Map,a.pa=new tn(ce.comparator)}(n),n.Ca=!1,yield MP(n.remoteStore,!1)}}),oN.apply(this,arguments)}function Wz(t,e,n){return aN.apply(this,arguments)}function aN(){return aN=(0,q.Z)(function*(t,e,n){const r=le(t),i=[],s=[];for(const o of e){let a;const u=r.fa.get(o);if(u&&0!==u.length){a=yield qf(r.localStore,Ti(u[0]));for(const l of u){const h=r.ma.get(l),p=yield oce(r,h);p.snapshot&&s.push(p.snapshot)}}else{const l=yield wz(r.localStore,o);a=yield qf(r.localStore,l),yield $P(r,Gz(l),o,!1,a.resumeToken)}i.push(a)}return r.Va.a_(s),i}),aN.apply(this,arguments)}function Gz(t){return X$(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function cce(t){return n=le(t).localStore,le(le(n).persistence).Bi();var n}function dce(t,e,n,r){return uN.apply(this,arguments)}function uN(){return uN=(0,q.Z)(function*(t,e,n,r){const i=le(t);if(i.Ca)return void ne("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=yield Tz(i.localStore,nH(s[0])),a=R_.createSynthesizedRemoteEventForCurrentChange(e,"current"===n,fr.EMPTY_BYTE_STRING);yield Za(i,o,a);break}case"rejected":yield Wf(i.localStore,e,!0),Jf(i,e,r);break;default:_e()}}),uN.apply(this,arguments)}function hce(t,e,n){return lN.apply(this,arguments)}function lN(){return lN=(0,q.Z)(function*(t,e,n){const r=cN(t);if(r.Ca){for(const i of e){if(r.fa.has(i)){ne("SyncEngine","Adding an already active target "+i);continue}const s=yield wz(r.localStore,i),o=yield qf(r.localStore,s);yield $P(r,Gz(s),o.targetId,!1,o.resumeToken),dT(r.remoteStore,o)}for(const i of n)r.fa.has(i)&&(yield Wf(r.localStore,i,!1).then(()=>{H_(r.remoteStore,i),Jf(r,i)}).catch(Ju))}}),lN.apply(this,arguments)}function cN(t){const e=le(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Hz.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=sce.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Jle.bind(null,e),e.Va.a_=Hle.bind(null,e.eventManager),e.Va.Fa=zle.bind(null,e.eventManager),e}function dN(t){const e=le(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ece.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=tce.bind(null,e),e}class z_{constructor(){this.synchronizeTabs=!1}initialize(e){var n=this;return(0,q.Z)(function*(){n.serializer=j_(e.databaseInfo.databaseId),n.sharedClientState=n.createSharedClientState(e),n.persistence=n.createPersistence(e),yield n.persistence.start(),n.localStore=n.createLocalStore(e),n.gcScheduler=n.createGarbageCollectionScheduler(e,n.localStore),n.indexBackfillerScheduler=n.createIndexBackfillerScheduler(e,n.localStore)})()}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return yz(this.persistence,new _z,e.initialUser,this.serializer)}createPersistence(e){return new tP(rT.jr,this.serializer)}createSharedClientState(e){return new bz}terminate(){var e=this;return(0,q.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class hN extends z_{constructor(e,n,r){super(),this.xa=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var n=()=>super.initialize,r=this;return(0,q.Z)(function*(){yield n().call(r,e),yield r.xa.initialize(r,e),yield dN(r.xa.syncEngine),yield Kf(r.xa.remoteStore),yield r.persistence.mi(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return yz(this.persistence,new _z,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){return new uz(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){const r=new Uae(n,this.persistence);return new Vae(e.asyncQueue,r)}createPersistence(e){const n=iP(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?ii.withCacheSize(this.cacheSizeBytes):ii.DEFAULT;return new rP(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,Rz(),cT(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new bz}}class Kz extends hN{constructor(e,n){super(e,n,!1),this.xa=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){var n=()=>super.initialize,r=this;return(0,q.Z)(function*(){yield n().call(r,e);const i=r.xa.syncEngine;r.sharedClientState instanceof fP&&(r.sharedClientState.syncEngine={Ys:uce.bind(null,i),Zs:dce.bind(null,i),Xs:hce.bind(null,i),Bi:cce.bind(null,i),Js:ace.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.mi(function(){var s=(0,q.Z)(function*(o){yield function lce(t,e){return oN.apply(this,arguments)}(r.xa.syncEngine,o),r.gcScheduler&&(o&&!r.gcScheduler.started?r.gcScheduler.start():o||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(o&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():o||r.indexBackfillerScheduler.stop())});return function(o){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const n=Rz();if(!fP.D(n))throw new ee(V.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=iP(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new fP(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class ep{initialize(e,n){var r=this;return(0,q.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(n),r.remoteStore=r.createRemoteStore(n),r.eventManager=r.createEventManager(n),r.syncEngine=r.createSyncEngine(n,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>zz(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=ice.bind(null,r.syncEngine),yield MP(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new $le}createDatastore(e){const n=j_(e.databaseInfo.databaseId),r=new Sle(e.databaseInfo);return new Ale(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return r=this.localStore,i=this.datastore,s=e.asyncQueue,o=n=>zz(this.syncEngine,n,0),a=Az.D()?new Az:new wle,new Nle(r,i,s,o,a);var r,i,s,o,a}createSyncEngine(e,n){return function(i,s,o,a,u,l,h){const p=new Zle(i,s,o,a,u,l);return h&&(p.Ca=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return(e=(0,q.Z)(function*(r){const i=le(r);ne("RemoteStore","RemoteStore shutting down."),i.C_.add(5),yield Gf(i),i.F_.shutdown(),i.M_.set("Unknown")}),function n(r){return e.apply(this,arguments)})(this.remoteStore);var e}}function Zz(t,e=10240){let n=0;return{read:()=>(0,q.Z)(function*(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}})(),cancel:()=>(0,q.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class fT{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):zn("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}class gce{constructor(e,n){this.Ba=e,this.serializer=n,this.metadata=new hr,this.buffer=new Uint8Array,this.La=new TextDecoder("utf-8"),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}getMetadata(){var e=this;return(0,q.Z)(function*(){return e.metadata.promise})()}Ma(){var e=this;return(0,q.Z)(function*(){return yield e.getMetadata(),e.ka()})()}ka(){var e=this;return(0,q.Z)(function*(){const n=yield e.qa();if(null===n)return null;const r=e.La.decode(n),i=Number(r);isNaN(i)&&e.Qa(`length string (${r}) is not valid number`);const s=yield e.Ka(i);return new qle(JSON.parse(s),n.length+i)})()}$a(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}qa(){var e=this;return(0,q.Z)(function*(){for(;e.$a()<0&&!(yield e.Ua()););if(0===e.buffer.length)return null;const n=e.$a();n<0&&e.Qa("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,n);return e.buffer=e.buffer.slice(n),r})()}Ka(e){var n=this;return(0,q.Z)(function*(){for(;n.buffer.length<e;)(yield n.Ua())&&n.Qa("Reached the end of bundle when more is expected.");const r=n.La.decode(n.buffer.slice(0,e));return n.buffer=n.buffer.slice(e),r})()}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}Ua(){var e=this;return(0,q.Z)(function*(){const n=yield e.Ba.read();if(!n.done){const r=new Uint8Array(e.buffer.length+n.value.length);r.set(e.buffer),r.set(n.value,e.buffer.length),e.buffer=r}return n.done})()}}class mce{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var n=this;return(0,q.Z)(function*(){if(n.ensureCommitNotCalled(),n.mutations.length>0)throw new ee(V.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,q.Z)(function*(o,a){const u=le(o),l=M_(u.serializer)+"/documents",h={documents:a.map(v=>N_(u.serializer,v))},p=yield u.Co("BatchGetDocuments",l,h,a.length),m=new Map;p.forEach(v=>{const I=function Fue(t,e){return"found"in e?function(r,i){Se(!!i.found);const s=ta(r,i.found.name),o=qn(i.found.updateTime),a=i.found.createTime?qn(i.found.createTime):Ae.min(),u=new Fr({mapValue:{fields:i.found.fields}});return dn.newFoundDocument(s,o,a,u)}(t,e):"missing"in e?function(r,i){Se(!!i.missing),Se(!!i.readTime);const s=ta(r,i.missing),o=qn(i.readTime);return dn.newNoDocument(s,o)}(t,e):_e()}(u.serializer,v);m.set(I.key.toString(),I)});const _=[];return a.forEach(v=>{const I=m.get(v.toString());Se(!!I),_.push(I)}),_}),function s(o,a){return i.apply(this,arguments)})(n.datastore,e);var i;return r.forEach(i=>n.recordVersion(i)),r})()}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Vf(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,q.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const n=e.readVersions;var r;e.mutations.forEach(r=>{n.delete(r.key.toString())}),n.forEach((r,i)=>{const s=ce.fromPath(i);e.mutations.push(new FR(s,e.precondition(s)))}),yield(r=(0,q.Z)(function*(s,o){const a=le(s),u=M_(a.serializer)+"/documents",l={writes:o.map(h=>x_(a.serializer,h))};yield a.wo("Commit",u,l)}),function i(s,o){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw _e();n=Ae.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new ee(V.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(Ae.min())?yn.exists(!1):yn.updateTime(n):yn.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(Ae.min()))throw new ee(V.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return yn.updateTime(n)}return yn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class _ce{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new gP(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){var e=this;this.zo.ko((0,q.Z)(function*(){const n=new mce(e.datastore),r=e.za(n);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>n.commit().then(()=>{e.deferred.resolve(i)}).catch(s=>{e.ja(s)}))}).catch(i=>{e.ja(i)})}))}za(e){try{const n=this.updateFunction(e);return!p_(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if("FirebaseError"===e.name){const n=e.code;return"aborted"===n||"failed-precondition"===n||"already-exists"===n||!EH(n)}return!1}}class yce{constructor(e,n,r,i){var s=this;this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Ir.UNAUTHENTICATED,this.clientId=m$.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=(0,q.Z)(function*(a){ne("FirestoreClient","Received user=",a.uid),yield s.authCredentialListener(a),s.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(ne("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var e=this;return(0,q.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new ee(V.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const n=new hr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,q.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),n.resolve()}catch(r){const i=Qf(r,"Failed to shutdown persistence");n.reject(i)}})),n.promise}}function pT(t,e){return fN.apply(this,arguments)}function fN(){return fN=(0,q.Z)(function*(t,e){t.asyncQueue.verifyOperationInProgress(),ne("FirestoreClient","Initializing OfflineComponentProvider");const n=yield t.getConfiguration();yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(function(){var i=(0,q.Z)(function*(s){r.isEqual(s)||(yield vz(e.localStore,s),r=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}),fN.apply(this,arguments)}function pN(t,e){return gN.apply(this,arguments)}function gN(){return gN=(0,q.Z)(function*(t,e){t.asyncQueue.verifyOperationInProgress();const n=yield mN(t);ne("FirestoreClient","Initializing OnlineComponentProvider");const r=yield t.getConfiguration();yield e.initialize(n,r),t.setCredentialChangeListener(i=>Lz(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>Lz(e.remoteStore,s)),t._onlineComponents=e}),gN.apply(this,arguments)}function Qz(t){return"FirebaseError"===t.name?t.code===V.FAILED_PRECONDITION||t.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}function mN(t){return _N.apply(this,arguments)}function _N(){return _N=(0,q.Z)(function*(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ne("FirestoreClient","Using user provided OfflineComponentProvider");try{yield pT(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!Qz(n))throw n;Ui("Error using user provided cache. Falling back to memory cache: "+n),yield pT(t,new z_)}}else ne("FirestoreClient","Using default OfflineComponentProvider"),yield pT(t,new z_);return t._offlineComponents}),_N.apply(this,arguments)}function gT(t){return yN.apply(this,arguments)}function yN(){return yN=(0,q.Z)(function*(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ne("FirestoreClient","Using user provided OnlineComponentProvider"),yield pN(t,t._uninitializedComponentsProvider._online)):(ne("FirestoreClient","Using default OnlineComponentProvider"),yield pN(t,new ep))),t._onlineComponents}),yN.apply(this,arguments)}function Yz(t){return mN(t).then(e=>e.persistence)}function tp(t){return mN(t).then(e=>e.localStore)}function Xz(t){return gT(t).then(e=>e.remoteStore)}function vN(t){return gT(t).then(e=>e.syncEngine)}function np(t){return EN.apply(this,arguments)}function EN(){return EN=(0,q.Z)(function*(t){const e=yield gT(t),n=e.eventManager;return n.onListen=Qle.bind(null,e.syncEngine),n.onUnlisten=Yle.bind(null,e.syncEngine),n}),EN.apply(this,arguments)}function eq(t,e,n={}){const r=new hr;return t.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return function(s,o,a,u,l){const h=new fT({next:m=>{o.enqueueAndForget(()=>FP(s,p));const _=m.docs.has(a);!_&&m.fromCache?l.reject(new ee(V.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&u&&"server"===u.source?l.reject(new ee(V.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new BP(Mf(a.path),h,{includeMetadataChanges:!0,J_:!0});return OP(s,p)}(yield np(t),t.asyncQueue,e,n,r)})),r.promise}function tq(t,e,n={}){const r=new hr;return t.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return function(s,o,a,u,l){const h=new fT({next:m=>{o.enqueueAndForget(()=>FP(s,p)),m.fromCache&&"server"===u.source?l.reject(new ee(V.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new BP(a,h,{includeMetadataChanges:!0,J_:!0});return OP(s,p)}(yield np(t),t.asyncQueue,e,n,r)})),r.promise}function nq(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const rq=new Map;function IN(t,e,n){if(!n)throw new ee(V.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function iq(t,e,n,r){if(!0===e&&!0===r)throw new ee(V.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function sq(t){if(!ce.isDocumentKey(t))throw new ee(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function oq(t){if(ce.isDocumentKey(t))throw new ee(V.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function mT(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=(r=t).constructor?r.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var r;return"function"==typeof t?"a function":_e()}function dt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ee(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=mT(t);throw new ee(V.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function aq(t,e){if(e<=0)throw new ee(V.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}class uq{constructor(e){var n,r;if(void 0===e.host){if(void 0!==e.ssl)throw new ee(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(n=e.ssl)||void 0===n||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new ee(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}iq("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=nq(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(s){if(void 0!==s.timeoutSeconds){if(isNaN(s.timeoutSeconds))throw new ee(V.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ee(V.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ee(V.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class q_{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new uq({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new ee(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new ee(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new uq(e),void 0!==e.credentials&&(this._authCredentials=function(r){if(!r)return new Dae;switch(r.type){case"firstParty":return new Pae(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ee(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=rq.get(n);r&&(ne("ComponentProvider","Removing Datastore"),rq.delete(n),r.terminate())}(this),Promise.resolve()}}class Vr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Vr(this.firestore,e,this._query)}}class hn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new na(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new hn(this.firestore,e,this._key)}}class na extends Vr{constructor(e,n,r){super(e,n,Mf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new hn(this.firestore,null,new ce(e))}withConverter(e){return new na(this.firestore,e,this._path)}}function cq(t,e,...n){if(t=(0,w.m9)(t),IN("collection","path",e),t instanceof q_){const r=vt.fromString(e,...n);return oq(r),new na(t,null,r)}{if(!(t instanceof hn||t instanceof na))throw new ee(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(vt.fromString(e,...n));return oq(r),new na(t.firestore,null,r)}}function _T(t,e,...n){if(t=(0,w.m9)(t),1===arguments.length&&(e=m$.newId()),IN("doc","path",e),t instanceof q_){const r=vt.fromString(e,...n);return sq(r),new hn(t,null,new ce(r))}{if(!(t instanceof hn||t instanceof na))throw new ee(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(vt.fromString(e,...n));return sq(r),new hn(t.firestore,t instanceof na?t.converter:null,new ce(r))}}function dq(t,e){return t=(0,w.m9)(t),e=(0,w.m9)(e),(t instanceof hn||t instanceof na)&&(e instanceof hn||e instanceof na)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function wN(t,e){return t=(0,w.m9)(t),e=(0,w.m9)(e),t instanceof Vr&&e instanceof Vr&&t.firestore===e.firestore&&w_(t._query,e._query)&&t.converter===e.converter}class Pce{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new gP(this,"async_queue_retry"),this.iu=()=>{const n=cT();n&&ne("AsyncQueue","Visibility state changed to "+n.visibilityState),this.zo.Qo()};const e=cT();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const n=cT();n&&"function"==typeof n.removeEventListener&&n.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const n=new hr;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}_u(){var e=this;return(0,q.Z)(function*(){if(0!==e.Ya.length){try{yield e.Ya[0](),e.Ya.shift(),e.zo.reset()}catch(n){if(!el(n))throw n;ne("AsyncQueue","Operation failed with retryable error: "+n)}e.Ya.length>0&&e.zo.ko(()=>e._u())}})()}ou(e){const n=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{throw this.eu=r,this.tu=!1,zn("INTERNAL UNHANDLED ERROR: ",function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+"\n"+o.stack),a}(r)),r}).then(r=>(this.tu=!1,r))));return this.Ja=n,n}enqueueAfterDelay(e,n,r){this.su(),this.ru.indexOf(e)>-1&&(n=0);const i=kP.createAndSchedule(this,e,n,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&_e()}verifyOperationInProgress(){}uu(){var e=this;return(0,q.Z)(function*(){let n;do{n=e.Ja,yield n}while(n!==e.Ja)})()}cu(e){for(const n of this.Xa)if(n.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Xa)if(n.skipDelay(),"all"!==e&&n.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const n=this.Xa.indexOf(e);this.Xa.splice(n,1)}}function TN(t){return function(n,r){if("object"!=typeof n||null===n)return!1;const i=n;for(const s of["next","error","complete"])if(s in i&&"function"==typeof i[s])return!0;return!1}(t)}class Nce{constructor(){this._progressObserver={},this._taskCompletionResolver=new hr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class nn extends q_{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Pce,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||hq(this),this._firestoreClient.terminate()}}function kn(t){return t._firestoreClient||hq(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function hq(t){var e,n,r;const i=t._freezeSettings(),s=(u=(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",new oue(t._databaseId,u,t._persistenceKey,(h=i).host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,nq(h.experimentalLongPollingOptions),h.useFetchStreams));var u,h;t._firestoreClient=new yce(t._authCredentials,t._appCheckCredentials,t._queue,s),null!==(n=i.localCache)&&void 0!==n&&n._offlineComponentProvider&&null!==(r=i.localCache)&&void 0!==r&&r._onlineComponentProvider&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function fq(t,e,n){const r=new hr;return t.asyncQueue.enqueue((0,q.Z)(function*(){try{yield pT(t,n),yield pN(t,e),r.resolve()}catch(i){const s=i;if(!Qz(s))throw s;Ui("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function pq(t){if(t._initialized||t._terminated)throw new ee(V.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class ra{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ra(fr.fromBase64String(e))}catch(n){throw new ee(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ra(fr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Qa{constructor(...e){for(let n=0;n<e.length;++n)if(0===e[n].length)throw new ee(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new cn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Kc{constructor(e){this._methodName=e}}class yT{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ee(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ee(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ze(this._lat,e._lat)||ze(this._long,e._long)}}const $ce=/^__.*__$/;class Hce{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return null!==this.fieldMask?new Ga(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ff(e,this.data,n,this.fieldTransforms)}}class gq{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ga(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function mq(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _e()}}class vT{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===s&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new vT(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var n;const r=null===(n=this.path)||void 0===n?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var n;const r=null===(n=this.path)||void 0===n?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return wT(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return void 0!==this.fieldMask.find(n=>e.isPrefixOf(n))||void 0!==this.fieldTransforms.find(n=>e.isPrefixOf(n.field))}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(0===e.length)throw this.mu("Document fields must not be empty");if(mq(this.Iu)&&$ce.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class zce{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||j_(e)}pu(e,n,r,i=!1){return new vT({Iu:e,methodName:n,gu:r,path:cn.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Zc(t){const e=t._freezeSettings(),n=j_(t._databaseId);return new zce(t._databaseId,!!e.ignoreUndefinedProperties,n)}function ET(t,e,n,r,i,s={}){const o=t.pu(s.merge||s.mergeFields?2:0,e,n,i);bN("Data must be an object, but it was:",o,r);const a=vq(r,o);let u,l;if(s.merge)u=new Bi(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const p of s.mergeFields){const m=K_(e,p,n);if(!o.contains(m))throw new ee(V.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);Iq(h,m)||h.push(m)}u=new Bi(h),l=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,l=o.fieldTransforms;return new Hce(new Fr(a),u,l)}class G_ extends Kc{_toFieldTransform(e){if(2!==e.Iu)throw e.mu(1===e.Iu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof G_}}function _q(t,e,n){return new vT({Iu:3,gu:e.settings.gu,methodName:t._methodName,du:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class CN extends Kc{_toFieldTransform(e){return new D_(e.path,new Of)}isEqual(e){return e instanceof CN}}class qce extends Kc{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){const n=_q(this,e,!0),r=this.yu.map(s=>Qc(s,n)),i=new Uc(r);return new D_(e.path,i)}isEqual(e){return this===e}}class Wce extends Kc{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){const n=_q(this,e,!0),r=this.yu.map(s=>Qc(s,n)),i=new Bc(r);return new D_(e.path,i)}isEqual(e){return this===e}}class Gce extends Kc{constructor(e,n){super(e),this.wu=n}_toFieldTransform(e){const n=new Lf(e.serializer,lH(e.serializer,this.wu));return new D_(e.path,n)}isEqual(e){return this===e}}function SN(t,e,n,r){const i=t.pu(1,e,n);bN("Data must be an object, but it was:",i,r);const s=[],o=Fr.empty();tl(r,(u,l)=>{const h=IT(e,u,n);l=(0,w.m9)(l);const p=i.Ru(h);if(l instanceof G_)s.push(h);else{const m=Qc(l,p);null!=m&&(s.push(h),o.set(h,m))}});const a=new Bi(s);return new gq(o,a,i.fieldTransforms)}function DN(t,e,n,r,i,s){const o=t.pu(1,e,n),a=[K_(e,r,n)],u=[i];if(s.length%2!=0)throw new ee(V.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(K_(e,s[m])),u.push(s[m+1]);const l=[],h=Fr.empty();for(let m=a.length-1;m>=0;--m)if(!Iq(l,a[m])){const _=a[m];let v=u[m];v=(0,w.m9)(v);const I=o.Ru(_);if(v instanceof G_)l.push(_);else{const T=Qc(v,I);null!=T&&(l.push(_),h.set(_,T))}}const p=new Bi(l);return new gq(h,p,o.fieldTransforms)}function yq(t,e,n,r=!1){return Qc(n,t.pu(r?4:3,e))}function Qc(t,e){if(Eq(t=(0,w.m9)(t)))return bN("Unsupported field value:",e,t),vq(t,e);if(t instanceof Kc)return function(r,i){if(!mq(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.du&&4!==e.Iu)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let u=Qc(a,i.Vu(o));null==u&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if(null===(r=(0,w.m9)(r)))return{nullValue:"NULL_VALUE"};if("number"==typeof r)return lH(i.serializer,r);if("boolean"==typeof r)return{booleanValue:r};if("string"==typeof r)return{stringValue:r};if(r instanceof Date){const s=_n.fromDate(r);return{timestampValue:Uf(i.serializer,s)}}if(r instanceof _n){const s=new _n(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Uf(i.serializer,s)}}if(r instanceof yT)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ra)return{bytesValue:PH(i.serializer,r._byteString)};if(r instanceof hn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:HR(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${mT(r)}`)}(t,e)}function vq(t,e){const n={};return N$(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):tl(t,(r,i)=>{const s=Qc(i,e.Eu(r));null!=s&&(n[r]=s)}),{mapValue:{fields:n}}}function Eq(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof _n||t instanceof yT||t instanceof ra||t instanceof hn||t instanceof Kc)}function bN(t,e,n){if(!Eq(n)||"object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const r=mT(n);throw e.mu("an object"===r?t+" a custom object":t+" "+r)}var i}function K_(t,e,n){if((e=(0,w.m9)(e))instanceof Qa)return e._internalPath;if("string"==typeof e)return IT(t,e);throw wT("Field path arguments must be of type string or ",t,!1,void 0,n)}const Kce=new RegExp("[~\\*/\\[\\]]");function IT(t,e,n){if(e.search(Kce)>=0)throw wT(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Qa(...e.split("."))._internalPath}catch{throw wT(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function wT(t,e,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new ee(V.INVALID_ARGUMENT,a+t+u)}function Iq(t,e){return t.some(n=>n.isEqual(e))}class Z_{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new hn(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Zce(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(TT("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n)}}}class Zce extends Z_{data(){return super.data()}}function TT(t,e){return"string"==typeof e?IT(t,e):e instanceof Qa?e._internalPath:e._delegate._internalPath}function wq(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new ee(V.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class AN{}class Q_ extends AN{}function pl(t,e,...n){let r=[];e instanceof AN&&r.push(e),r=r.concat(n),function(s){const o=s.filter(u=>u instanceof rp).length,a=s.filter(u=>u instanceof Y_).length;if(o>1||o>0&&a>0)throw new ee(V.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Y_ extends Q_{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Y_(e,n,r)}_apply(e){const n=this._parse(e);return Dq(e._query,n),new Vr(e.firestore,e.converter,OR(e._query,n))}_parse(e){const n=Zc(e.firestore);return function(s,o,a,u,l,h,p){let m;if(l.isKeyField()){if("array-contains"===h||"array-contains-any"===h)throw new ee(V.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if("in"===h||"not-in"===h){Sq(p,h);const _=[];for(const v of p)_.push(Cq(u,s,v));m={arrayValue:{values:_}}}else m=Cq(u,s,p)}else"in"!==h&&"not-in"!==h&&"array-contains-any"!==h||Sq(p,h),m=yq(a,"where",p,"in"===h||"not-in"===h);return ft.create(l,h,m)}(e._query,0,n,e.firestore._databaseId,this._field,this._op,this._value)}}class rp extends AN{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new rp(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===n.length?n[0]:Ft.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return 0===n.getFilters().length?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const u of a)Dq(o,u),o=OR(o,u)}(e._query,n),new Vr(e.firestore,e.converter,OR(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class RN extends Q_{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new RN(e,n)}_apply(e){const n=function(i,s,o){if(null!==i.startAt)throw new ee(V.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new ee(V.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new E_(s,o)}(e._query,this._field,this._direction);return new Vr(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new qa(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}class CT extends Q_{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new CT(e,n,r)}_apply(e){return new Vr(e.firestore,e.converter,zw(e._query,this._limit,this._limitType))}}class ST extends Q_{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new ST(e,n,r)}_apply(e){const n=Tq(e,this.type,this._docOrFields,this._inclusive);return new Vr(e.firestore,e.converter,(s=n,new qa((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)));var i,s}}class DT extends Q_{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new DT(e,n,r)}_apply(e){const n=Tq(e,this.type,this._docOrFields,this._inclusive);return new Vr(e.firestore,e.converter,(s=n,new qa((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)));var i,s}}function Tq(t,e,n,r){if(n[0]=(0,w.m9)(n[0]),n[0]instanceof Z_)return function(s,o,a,u,l){if(!u)throw new ee(V.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const p of xf(s))if(p.field.isKeyField())h.push(Fc(o,u.key));else{const m=u.data.field(p.field);if(Fw(m))throw new ee(V.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===m){const _=p.field.canonicalString();throw new ee(V.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}h.push(m)}return new al(h,l)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=Zc(t.firestore);return function(o,a,u,l,h,p){const m=o.explicitOrderBy;if(h.length>m.length)throw new ee(V.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const _=[];for(let v=0;v<h.length;v++){const I=h[v];if(m[v].field.isKeyField()){if("string"!=typeof I)throw new ee(V.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof I}`);if(!kR(o)&&-1!==I.indexOf("/"))throw new ee(V.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${I}' contains a slash.`);const T=o.path.child(vt.fromString(I));if(!ce.isDocumentKey(T))throw new ee(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${T}' is not because it contains an odd number of segments.`);const N=new ce(T);_.push(Fc(a,N))}else{const T=yq(u,l,I);_.push(T)}}return new al(_,p)}(t._query,t.firestore._databaseId,i,e,n,r)}}function Cq(t,e,n){if("string"==typeof(n=(0,w.m9)(n))){if(""===n)throw new ee(V.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!kR(e)&&-1!==n.indexOf("/"))throw new ee(V.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(vt.fromString(n));if(!ce.isDocumentKey(r))throw new ee(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Fc(t,new ce(r))}if(n instanceof hn)return Fc(t,n._key);throw new ee(V.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${mT(n)}.`)}function Sq(t,e){if(!Array.isArray(t)||0===t.length)throw new ee(V.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Dq(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw new ee(V.INVALID_ARGUMENT,n===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class PN{convertValue(e,n="none"){switch(sl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return xn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(za(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw _e()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return tl(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new yT(xn(e.latitude),xn(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Vw(e);return null==r?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(m_(e));default:return null}}convertTimestamp(e){const n=nl(e);return new _n(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=vt.fromString(e);Se(BH(r));const i=new rl(r.get(1),r.get(3)),s=new ce(r.popFirst(5));return i.isEqual(n)||zn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}function bT(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class ide extends PN{constructor(e){super(),this.firestore=e}convertBytes(e){return new ra(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new hn(this.firestore,null,n)}}class Yc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ya extends Z_{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new X_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(TT("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class X_ extends Ya{data(e={}){return super.data(e)}}class gl{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Yc(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new X_(this._firestore,this._userDataWriter,r.key,r,new Yc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ee(V.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>({type:"added",doc:new X_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Yc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:o++}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||3!==a.type).map(a=>{const u=new X_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Yc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,h=-1;return 0!==a.type&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),1!==a.type&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:ode(a.type),doc:u,oldIndex:l,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function ode(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _e()}}function Aq(t,e){return t instanceof Ya&&e instanceof Ya?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof gl&&e instanceof gl&&t._firestore===e._firestore&&wN(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}class ml extends PN{constructor(e){super(),this.firestore=e}convertBytes(e){return new ra(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new hn(this.firestore,null,n)}}function Rq(t,e,n){t=dt(t,hn);const r=dt(t.firestore,nn),i=bT(t.converter,e,n);return ip(r,[ET(Zc(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,yn.none())])}function Pq(t,e,n,...r){t=dt(t,hn);const i=dt(t.firestore,nn),s=Zc(i);let o;return o="string"==typeof(e=(0,w.m9)(e))||e instanceof Qa?DN(s,"updateDoc",t._key,e,n,r):SN(s,"updateDoc",t._key,e),ip(i,[o.toMutation(t._key,yn.exists(!0))])}function Nq(t,...e){var n,r,i;t=(0,w.m9)(t);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||TN(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(TN(e[o])){const p=e[o];e[o]=null===(n=p.next)||void 0===n?void 0:n.bind(p),e[o+1]=null===(r=p.error)||void 0===r?void 0:r.bind(p),e[o+2]=null===(i=p.complete)||void 0===i?void 0:i.bind(p)}let u,l,h;if(t instanceof hn)l=dt(t.firestore,nn),h=Mf(t._key.path),u={next:p=>{e[o]&&e[o](NN(l,t,p))},error:e[o+1],complete:e[o+2]};else{const p=dt(t,Vr);l=dt(p.firestore,nn),h=p._query;const m=new ml(l);u={next:_=>{e[o]&&e[o](new gl(l,m,p,_))},error:e[o+1],complete:e[o+2]},wq(t._query)}return function(m,_,v,I){const T=new fT(I),N=new BP(_,T,v);return m.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return OP(yield np(m),N)})),()=>{T.Na(),m.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return FP(yield np(m),N)}))}}(kn(l),h,a,u)}function ip(t,e){return function(r,i){const s=new hr;return r.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return function Xle(t,e,n){return qP.apply(this,arguments)}(yield vN(r),i,s)})),s.promise}(kn(t),e)}function NN(t,e,n){const r=n.docs.get(e._key),i=new ml(t);return new Ya(t,i,e._key,r,new Yc(n.hasPendingWrites,n.fromCache),e.converter)}const Cde={maxAttempts:5};class Mq{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Zc(e)}set(e,n,r){this._verifyNotCommitted();const i=_l(e,this._firestore),s=bT(i.converter,n,r),o=ET(this._dataReader,"WriteBatch.set",i._key,s,null!==i.converter,r);return this._mutations.push(o.toMutation(i._key,yn.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=_l(e,this._firestore);let o;return o="string"==typeof(n=(0,w.m9)(n))||n instanceof Qa?DN(this._dataReader,"WriteBatch.update",s._key,n,r,i):SN(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,yn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=_l(e,this._firestore);return this._mutations=this._mutations.concat(new Vf(n._key,yn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ee(V.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function _l(t,e){if((t=(0,w.m9)(t)).firestore!==e)throw new ee(V.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}class Sde extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=Zc(n)}get(n){const r=_l(n,this._firestore),i=new ide(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||1!==s.length)return _e();const o=s[0];if(o.isFoundDocument())return new Z_(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Z_(this._firestore,i,r._key,null,r.converter);throw _e()})}set(n,r,i){const s=_l(n,this._firestore),o=bT(s.converter,r,i),a=ET(this._dataReader,"Transaction.set",s._key,o,null!==s.converter,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){const o=_l(n,this._firestore);let a;return a="string"==typeof(r=(0,w.m9)(r))||r instanceof Qa?DN(this._dataReader,"Transaction.update",o._key,r,i,s):SN(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){const r=_l(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=_l(e,this._firestore),r=new ml(this._firestore);return super.get(e).then(i=>new Ya(this._firestore,r,n._key,i._document,new Yc(!1,!1),n.converter))}}function xN(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new ee("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function Lq(){if(typeof Uint8Array>"u")throw new ee("unimplemented","Uint8Arrays are not available in this environment.")}function Fq(){if(!function iue(){return typeof atob<"u"}())throw new ee("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(e,n=!0){Cf=Fi.SDK_VERSION,(0,Fi._registerComponent)(new co.wA("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new nn(new Aae(r.getProvider("auth-internal")),new Nae(r.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new ee(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new rl(l.options.projectId,h)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),(0,Fi.registerVersion)(f$,"4.4.0",e),(0,Fi.registerVersion)(f$,"4.4.0","esm2017")}();class J_{constructor(e){this._delegate=e}static fromBase64String(e){return Fq(),new J_(ra.fromBase64String(e))}static fromUint8Array(e){return Lq(),new J_(ra.fromUint8Array(e))}toBase64(){return Fq(),this._delegate.toBase64()}toUint8Array(){return Lq(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function kN(t){return function Ode(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const r of e)if(r in n&&"function"==typeof n[r])return!0;return!1}(t,["next","error","complete"])}class Lde{enableIndexedDbPersistence(e,n){return function xce(t,e){pq(t=dt(t,nn));const n=kn(t);if(n._uninitializedComponentsProvider)throw new ee(V.FAILED_PRECONDITION,"SDK cache is already specified.");Ui("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings(),i=new ep;return fq(n,i,new hN(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return function kce(t){pq(t=dt(t,nn));const e=kn(t);if(e._uninitializedComponentsProvider)throw new ee(V.FAILED_PRECONDITION,"SDK cache is already specified.");Ui("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings(),r=new ep;return fq(e,r,new Kz(r,n.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function Oce(t){if(t._initialized&&!t._terminated)throw new ee(V.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new hr;return t._queue.enqueueAndForgetEvenWhileRestricted((0,q.Z)(function*(){try{yield(n=(0,q.Z)(function*(i){if(!go.D())return Promise.resolve();const s=i+"main";yield go.delete(s)}),function r(i){return n.apply(this,arguments)})(iP(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}var n})),e.promise}(e._delegate)}}class Vq{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof rl||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Ui("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},n),e)).merge,this._delegate._setSettings(e)}useEmulator(e,n,r={}){!function lq(t,e,n,r={}){var i;const s=(t=dt(t,q_))._getSettings(),o=`${e}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Ui("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if("string"==typeof r.mockUserToken)a=r.mockUserToken,u=Ir.MOCK_USER;else{a=(0,w.Sg)(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);const l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new ee(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Ir(l)}t._authCredentials=new bae(new p$(a,u))}}(this._delegate,e,n,r)}enableNetwork(){return function Fce(t){return function vce(t){return t.asyncQueue.enqueue((0,q.Z)(function*(){const e=yield Yz(t),n=yield Xz(t);return e.setNetworkEnabled(!0),function(i){const s=le(i);return s.C_.delete(0),$_(s)}(n)}))}(kn(t=dt(t,nn)))}(this._delegate)}disableNetwork(){return function Vce(t){return function Ece(t){return t.asyncQueue.enqueue((0,q.Z)(function*(){const e=yield Yz(t),n=yield Xz(t);return e.setNetworkEnabled(!1),(r=(0,q.Z)(function*(s){const o=le(s);o.C_.add(0),yield Gf(o),o.M_.set("Offline")}),function i(s){return r.apply(this,arguments)})(n);var r}))}(kn(t=dt(t,nn)))}(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,iq("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function Lce(t){return function(n){const r=new hr;return n.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return function nce(t,e){return QP.apply(this,arguments)}(yield vN(n),r)})),r.promise}(kn(t=dt(t,nn)))}(this._delegate)}onSnapshotsInSync(e){return function gde(t,e){return function Tce(t,e){const n=new fT(e);return t.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return i=yield np(t),s=n,le(i).q_.add(s),void s.next();var i,s})),()=>{n.Na(),t.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return i=yield np(t),s=n,void le(i).q_.delete(s);var i,s}))}}(kn(t=dt(t,nn)),TN(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new ee("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new sp(this,cq(this._delegate,e))}catch(n){throw Ci(n,"collection()","Firestore.collection()")}}doc(e){try{return new Ls(this,_T(this._delegate,e))}catch(n){throw Ci(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Si(this,function Rce(t,e){if(t=dt(t,q_),IN("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ee(V.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Vr(t,null,(r=e,new qa(vt.emptyPath(),r)));var r}(this._delegate,e))}catch(n){throw Ci(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function Dde(t,e,n){t=dt(t,nn);const r=Object.assign(Object.assign({},Cde),n);return function(s){if(s.maxAttempts<1)throw new ee(V.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const u=new hr;return s.asyncQueue.enqueueAndForget((0,q.Z)(function*(){const l=yield function Jz(t){return gT(t).then(e=>e.datastore)}(s);new _ce(s.asyncQueue,l,a,o,u).run()})),u.promise}(kn(t),i=>e(new Sde(t,i)),r)}(this._delegate,n=>e(new Uq(this,n)))}batch(){return kn(this._delegate),new Bq(new Mq(this._delegate,e=>ip(this._delegate,e)))}loadBundle(e){return function Uce(t,e){const n=kn(t=dt(t,nn)),r=new Nce;return function Cce(t,e,n,r){const i=function(o,a){let u;return u="string"==typeof o?wH().encode(o):o,h=function(h,p){if(h instanceof Uint8Array)return Zz(h,p);if(h instanceof ArrayBuffer)return Zz(new Uint8Array(h),p);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),new gce(h,a);var h}(n,j_(e));t.asyncQueue.enqueueAndForget((0,q.Z)(function*(){!function fce(t,e,n){const r=le(t);var i;(i=(0,q.Z)(function*(o,a,u){try{const l=yield a.getMetadata();if(yield function(v,I){const T=le(v),N=qn(I.createTime);return T.persistence.runTransaction("hasNewerBundle","readonly",b=>T.Kr.getBundleMetadata(b,I.id)).then(b=>!!b&&b.createTime.compareTo(N)>=0)}(o.localStore,l))return yield a.close(),u._completeWith({taskState:"Success",documentsLoaded:(v=l).totalDocuments,bytesLoaded:v.totalBytes,totalDocuments:v.totalDocuments,totalBytes:v.totalBytes}),Promise.resolve(new Set);u._updateProgress(Uz(l));const h=new Wle(l,o.localStore,a.serializer);let p=yield a.Ma();for(;p;){const _=yield h.ea(p);_&&u._updateProgress(_),p=yield a.Ma()}const m=yield h.complete();return yield Za(o,m.ra,void 0),yield function(v,I){const T=le(v);return T.persistence.runTransaction("Save bundle","readwrite",N=>T.Kr.saveBundleMetadata(N,I))}(o.localStore,l),u._completeWith(m.progress),Promise.resolve(m.na)}catch(l){return Ui("SyncEngine",`Loading bundle failed with ${l}`),u._failWith(l),Promise.resolve(new Set)}var v}),function s(o,a,u){return i.apply(this,arguments)})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield vN(t),i,r)}))}(n,t._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function Bce(t,e){return function Sce(t,e){return t.asyncQueue.enqueue((0,q.Z)(function*(){return function(r,i){const s=le(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Kr.getNamedQuery(o,i))}(yield tp(t),e)}))}(kn(t=dt(t,nn)),e).then(n=>n?new Vr(t,null,n.query):null)}(this._delegate,e).then(n=>n?new Si(this,n):null)}}class RT extends PN{constructor(e){super(),this.firestore=e}convertBytes(e){return new J_(new ra(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return Ls.forKey(n,this.firestore,null)}}class Uq{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new RT(e)}get(e){const n=Jc(e);return this._delegate.get(n).then(r=>new ey(this._firestore,new Ya(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const i=Jc(e);return r?(xN("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Jc(e);return 2===arguments.length?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Jc(e);return this._delegate.delete(n),this}}class Bq{constructor(e){this._delegate=e}set(e,n,r){const i=Jc(e);return r?(xN("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Jc(e);return 2===arguments.length?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Jc(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class Xc{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new X_(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new ty(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=Xc.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new Xc(e,new RT(e),n),i.set(n,s)),s}}Xc.INSTANCES=new WeakMap;class Ls{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new RT(e)}static forPath(e,n,r){if(e.length%2!=0)throw new ee("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Ls(n,new hn(n._delegate,r,new ce(e)))}static forKey(e,n,r){return new Ls(n,new hn(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new sp(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new sp(this.firestore,cq(this._delegate,e))}catch(n){throw Ci(n,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,w.m9)(e))instanceof hn&&dq(this._delegate,e)}set(e,n){n=xN("DocumentReference.set",n);try{return n?Rq(this._delegate,e,n):Rq(this._delegate,e)}catch(r){throw Ci(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return 1===arguments.length?Pq(this._delegate,e):Pq(this._delegate,e,n,...r)}catch(i){throw Ci(i,"updateDoc()","DocumentReference.update()")}}delete(){return function fde(t){return ip(dt(t.firestore,nn),[new Vf(t._key,yn.none())])}(this._delegate)}onSnapshot(...e){const n=jq(e),r=$q(e,i=>new ey(this.firestore,new Ya(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Nq(this._delegate,n,r)}get(e){let n;return n="cache"===e?.source?function ude(t){t=dt(t,hn);const e=dt(t.firestore,nn),n=kn(e),r=new ml(e);return function Ice(t,e){const n=new hr;return t.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return(r=(0,q.Z)(function*(s,o,a){try{const u=yield function(h,p){const m=le(h);return m.persistence.runTransaction("read document","readonly",_=>m.localDocuments.getDocument(_,p))}(s,o);u.isFoundDocument()?a.resolve(u):u.isNoDocument()?a.resolve(null):a.reject(new ee(V.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){const l=Qf(u,`Failed to get document '${o} from cache`);a.reject(l)}}),function i(s,o,a){return r.apply(this,arguments)})(yield tp(t),e,n);var r})),n.promise}(n,t._key).then(i=>new Ya(e,r,t._key,i,new Yc(null!==i&&i.hasLocalMutations,!0),t.converter))}(this._delegate):"server"===e?.source?function lde(t){t=dt(t,hn);const e=dt(t.firestore,nn);return eq(kn(e),t._key,{source:"server"}).then(n=>NN(e,t,n))}(this._delegate):function ade(t){t=dt(t,hn);const e=dt(t.firestore,nn);return eq(kn(e),t._key).then(n=>NN(e,t,n))}(this._delegate),n.then(r=>new ey(this.firestore,new Ya(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Ls(this.firestore,this._delegate.withConverter(e?Xc.getInstance(this.firestore,e):null))}}function Ci(t,e,n){return t.message=t.message.replace(e,n),t}function jq(t){for(const e of t)if("object"==typeof e&&!kN(e))return e;return{}}function $q(t,e){var n,r;let i;return i=kN(t[0])?t[0]:kN(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class ey{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Ls(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return Aq(this._delegate,e._delegate)}}class ty extends ey{data(e){const n=this._delegate.data(e);return this._delegate._converter||function Sae(t,e){t||_e()}(void 0!==n),n}}class Si{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new RT(e)}where(e,n,r){try{return new Si(this.firestore,pl(this._delegate,function Qce(t,e,n){const r=e,i=TT("where",t);return Y_._create(i,r,n)}(e,n,r)))}catch(i){throw Ci(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new Si(this.firestore,pl(this._delegate,function Yce(t,e="asc"){const n=e,r=TT("orderBy",t);return RN._create(r,n)}(e,n)))}catch(r){throw Ci(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Si(this.firestore,pl(this._delegate,function Xce(t){return aq("limit",t),CT._create("limit",t,"F")}(e)))}catch(n){throw Ci(n,"limit()","Query.limit()")}}limitToLast(e){try{return new Si(this.firestore,pl(this._delegate,function Jce(t){return aq("limitToLast",t),CT._create("limitToLast",t,"L")}(e)))}catch(n){throw Ci(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Si(this.firestore,pl(this._delegate,function ede(...t){return ST._create("startAt",t,!0)}(...e)))}catch(n){throw Ci(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Si(this.firestore,pl(this._delegate,function tde(...t){return ST._create("startAfter",t,!1)}(...e)))}catch(n){throw Ci(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Si(this.firestore,pl(this._delegate,function nde(...t){return DT._create("endBefore",t,!1)}(...e)))}catch(n){throw Ci(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Si(this.firestore,pl(this._delegate,function rde(...t){return DT._create("endAt",t,!0)}(...e)))}catch(n){throw Ci(n,"endAt()","Query.endAt()")}}isEqual(e){return wN(this._delegate,e._delegate)}get(e){let n;return n="cache"===e?.source?function dde(t){t=dt(t,Vr);const e=dt(t.firestore,nn),n=kn(e),r=new ml(e);return function wce(t,e){const n=new hr;return t.asyncQueue.enqueueAndForget((0,q.Z)(function*(){return(r=(0,q.Z)(function*(s,o,a){try{const u=yield oT(s,o,!0),l=new $z(o,u.ls),h=l.ca(u.documents),p=l.applyChanges(h,!1);a.resolve(p.snapshot)}catch(u){const l=Qf(u,`Failed to execute query '${o} against cache`);a.reject(l)}}),function i(s,o,a){return r.apply(this,arguments)})(yield tp(t),e,n);var r})),n.promise}(n,t._query).then(i=>new gl(e,r,t,i))}(this._delegate):"server"===e?.source?function hde(t){t=dt(t,Vr);const e=dt(t.firestore,nn),n=kn(e),r=new ml(e);return tq(n,t._query,{source:"server"}).then(i=>new gl(e,r,t,i))}(this._delegate):function cde(t){t=dt(t,Vr);const e=dt(t.firestore,nn),n=kn(e),r=new ml(e);return wq(t._query),tq(n,t._query).then(i=>new gl(e,r,t,i))}(this._delegate),n.then(r=>new ON(this.firestore,new gl(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=jq(e),r=$q(e,i=>new ON(this.firestore,new gl(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Nq(this._delegate,n,r)}withConverter(e){return new Si(this.firestore,this._delegate.withConverter(e?Xc.getInstance(this.firestore,e):null))}}class Vde{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new ty(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class ON{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new Si(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new ty(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new Vde(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new ty(this._firestore,r))})}isEqual(e){return Aq(this._delegate,e._delegate)}}class sp extends Si{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Ls(this.firestore,e):null}doc(e){try{return new Ls(this.firestore,void 0===e?_T(this._delegate):_T(this._delegate,e))}catch(n){throw Ci(n,"doc()","CollectionReference.doc()")}}add(e){return function pde(t,e){const n=dt(t.firestore,nn),r=_T(t),i=bT(t.converter,e);return ip(n,[ET(Zc(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,yn.exists(!1))]).then(()=>r)}(this._delegate,e).then(n=>new Ls(this.firestore,n))}isEqual(e){return dq(this._delegate,e._delegate)}withConverter(e){return new sp(this.firestore,this._delegate.withConverter(e?Xc.getInstance(this.firestore,e):null))}}function Jc(t){return dt(t,hn)}class LN{constructor(...e){this._delegate=new Qa(...e)}static documentId(){return new LN(cn.keyField().canonicalString())}isEqual(e){return(e=(0,w.m9)(e))instanceof Qa&&this._delegate._internalPath.isEqual(e._internalPath)}}class ed{constructor(e){this._delegate=e}static serverTimestamp(){const e=function Ade(){return new CN("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new ed(e)}static delete(){const e=function bde(){return new G_("deleteField")}();return e._methodName="FieldValue.delete",new ed(e)}static arrayUnion(...e){const n=function Rde(...t){return new qce("arrayUnion",t)}(...e);return n._methodName="FieldValue.arrayUnion",new ed(n)}static arrayRemove(...e){const n=function Pde(...t){return new Wce("arrayRemove",t)}(...e);return n._methodName="FieldValue.arrayRemove",new ed(n)}static increment(e){const n=function Nde(t){return new Gce("increment",t)}(e);return n._methodName="FieldValue.increment",new ed(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const Ude={Firestore:Vq,GeoPoint:yT,Timestamp:_n,Blob:J_,Transaction:Uq,WriteBatch:Bq,DocumentReference:Ls,DocumentSnapshot:ey,Query:Si,QueryDocumentSnapshot:ty,QuerySnapshot:ON,CollectionReference:sp,FieldPath:LN,FieldValue:ed,setLogLevel:function Fde(t){!function Cae(t){Xu.setLogLevel(t)}(t)},CACHE_SIZE_UNLIMITED:-1};function Hq(t,e){return function $de(t,e=YI){return new qt(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}(t,e)}function FN(t,e){return Hq(t,e).pipe(fe(n=>({payload:n,type:"query"})))}!function jde(t){(function Bde(t,e){t.INTERNAL.registerComponent(new co.wA("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},Ude)))})(t,(e,n)=>new Vq(e,n,new Lde)),t.registerVersion("@firebase/firestore-compat","0.3.23")}(Vi.Z);class zq{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){const r=this.ref.collection(e),{ref:i,query:s}=Qq(r,n);return new Gq(i,s,this.afs)}snapshotChanges(){return function Hde(t,e){return Hq(t,e).pipe(kI(void 0),xA(),fe(n=>{const[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(Hn)}valueChanges(e={}){return this.snapshotChanges().pipe(fe(({payload:n})=>e.idField?{...n.data(),[e.idField]:n.id}:n.data()))}get(e){return jt(this.ref.get(e)).pipe(Hn)}}function PT(t,e){return FN(t,e).pipe(kI(void 0),xA(),fe(n=>{const[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{const l=s.find(p=>p.doc.ref.isEqual(a.ref)),h=r?.payload.docs.find(p=>p.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&h&&JSON.stringify(h.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function qq(t,e,n){return PT(t,n).pipe(Gh((r,i)=>function zde(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=function qde(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return VN(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return VN(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return VN(t,e.oldIndex,1)}return t}(t,r))}),t}(r,i.map(s=>s.payload),e),[]),ZB(),fe(r=>r.map(i=>({type:i.type,payload:i}))))}function VN(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function Wq(t){return(!t||0===t.length)&&(t=["added","removed","modified"]),t}class Gq{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=PT(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(fe(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(kI(void 0),xA(),uo(([r,i])=>i.length>0||!r),fe(([,r])=>r),Hn)}auditTrail(e){return this.stateChanges(e).pipe(Gh((n,r)=>[...n,...r],[]))}snapshotChanges(e){const n=Wq(e);return qq(this.query,n,this.afs.schedulers.outsideAngular).pipe(Hn)}valueChanges(e={}){return FN(this.query,this.afs.schedulers.outsideAngular).pipe(fe(n=>n.payload.docs.map(r=>e.idField?{...r.data(),[e.idField]:r.id}:r.data())),Hn)}get(e){return jt(this.query.get(e)).pipe(Hn)}add(e){return this.ref.add(e)}doc(e){return new zq(this.ref.doc(e),this.afs)}}class Wde{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return e&&0!==e.length?PT(this.query,this.afs.schedulers.outsideAngular).pipe(fe(n=>n.filter(r=>e.indexOf(r.type)>-1)),uo(n=>n.length>0),Hn):PT(this.query,this.afs.schedulers.outsideAngular).pipe(Hn)}auditTrail(e){return this.stateChanges(e).pipe(Gh((n,r)=>[...n,...r],[]))}snapshotChanges(e){const n=Wq(e);return qq(this.query,n,this.afs.schedulers.outsideAngular).pipe(Hn)}valueChanges(e={}){return FN(this.query,this.afs.schedulers.outsideAngular).pipe(fe(r=>r.payload.docs.map(i=>e.idField?{[e.idField]:i.id,...i.data()}:i.data())),Hn)}get(e){return jt(this.query.get(e)).pipe(Hn)}}const Kq=new ue("angularfire2.enableFirestorePersistence"),Zq=new ue("angularfire2.firestore.persistenceSettings"),Gde=new ue("angularfire2.firestore.settings"),Kde=new ue("angularfire2.firestore.use-emulator");function Qq(t,e=(n=>n)){return{query:e(t),ref:t}}let Yq=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,u,l,h,p,m,_,v,I,T,N,b){this.schedulers=u;const k=Vm(n,a,r),$=h;p&&EA(k,a,m,v,I,T,_,N),[this.firestore,this.persistenceEnabled$]=ew(`${k.name}.firestore`,"AngularFirestore",k.name,()=>{const ie=a.runOutsideAngular(()=>k.firestore());if(s&&ie.settings(s),$&&ie.useEmulator(...$),i&&!mI(o)){const pe=()=>{try{return jt(ie.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(qe){return typeof console<"u"&&console.warn(qe),Re(!1)}};return[ie,a.runOutsideAngular(pe)]}return[ie,Re(!1)]},[s,$,i])}collection(n,r){let i;i="string"==typeof n?this.firestore.collection(n):n;const{ref:s,query:o}=Qq(i,r),a=this.schedulers.ngZone.run(()=>s);return new Gq(a,o,this)}collectionGroup(n,r){const i=r||(o=>o),s=this.firestore.collectionGroup(n);return new Wde(i(s),this)}doc(n){let r;r="string"==typeof n?this.firestore.doc(n):n;const i=this.schedulers.ngZone.run(()=>r);return new zq(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(K(df),K(hf,8),K(Kq,8),K(Gde,8),K(eo),K(ht),K(JI),K(Zq,8),K(Kde,8),K(Um,8),K(pA,8),K(gA,8),K(mA,8),K(_A,8),K(yA,8),K(vA,8),K(XI,8))};static \u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),Zde=(()=>{class t{constructor(){Vi.Z.registerVersion("angularfire",uf.full,"fst-compat")}static enablePersistence(n){return{ngModule:t,providers:[{provide:Kq,useValue:!0},{provide:Zq,useValue:n}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=_r({type:t});static \u0275inj=Ar({providers:[Yq]})}return t})();const Xq="@firebase/database";let UN="";function BN(t){UN=t}class Xde{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){null==n?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,w.Wl)(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return null==n?null:(0,w.cI)(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class Jde{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){null==n?delete this.cache_[e]:this.cache_[e]=n}get(e){return(0,w.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const eW=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Xde(e)}}catch{}return new Jde},td=eW("localStorage"),jN=eW("sessionStorage"),op=new us.Yd("@firebase/database"),tW=function(){let t=1;return function(){return t++}}(),nW=function(t){const e=(0,w.dS)(t),n=new w.gQ;n.update(e);const r=n.digest();return w.US.encodeByteArray(r)},ny=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=ny.apply(null,r):e+="object"==typeof r?(0,w.Wl)(r):r,e+=" "}return e};let nd=null,rW=!0;const iW=function(t,e){(0,w.hu)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(op.logLevel=us.in.VERBOSE,nd=op.log.bind(op),e&&jN.set("logging_enabled",!0)):"function"==typeof t?nd=t:(nd=null,jN.remove("logging_enabled"))},Cr=function(...t){if(!0===rW&&(rW=!1,null===nd&&!0===jN.get("logging_enabled")&&iW(!0)),nd){const e=ny.apply(null,t);nd(e)}},ry=function(t){return function(...e){Cr(t,...e)}},$N=function(...t){const e="FIREBASE INTERNAL ERROR: "+ny(...t);op.error(e)},ia=function(...t){const e=`FIREBASE FATAL ERROR: ${ny(...t)}`;throw op.error(e),new Error(e)},oi=function(...t){const e="FIREBASE WARNING: "+ny(...t);op.warn(e)},NT=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},yl="[MIN_NAME]",Xa="[MAX_NAME]",rd=function(t,e){if(t===e)return 0;if(t===yl||e===Xa)return-1;if(e===yl||t===Xa)return 1;{const n=aW(t),r=aW(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1}},nhe=function(t,e){return t===e?0:t<e?-1:1},iy=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,w.Wl)(e))},HN=function(t){if("object"!=typeof t||null===t)return(0,w.Wl)(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)0!==r&&(n+=","),n+=(0,w.Wl)(e[r]),n+=":",n+=HN(t[e[r]]);return n+="}",n},sW=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let i=0;i<n;i+=e)r.push(t.substring(i,i+e>n?n:i+e));return r};function Sr(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const oW=function(t){(0,w.hu)(!NT(t),"Invalid JSON number");const r=1023;let i,s,o,a,u;0===t?(s=0,o=0,i=1/t==-1/0?1:0):(i=t<0,(t=Math.abs(t))>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,52-a)-Math.pow(2,52))):(s=0,o=Math.round(t/Math.pow(2,-1074))));const l=[];for(u=52;u;u-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(u=11;u;u-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();const h=l.join("");let p="";for(u=0;u<64;u+=8){let m=parseInt(h.substr(u,8),2).toString(16);1===m.length&&(m="0"+m),p+=m}return p.toLowerCase()},ohe=new RegExp("^-?(0*)\\d{1,10}$"),aW=function(t){if(ohe.test(t)){const e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},ap=function(t){try{t()}catch(e){setTimeout(()=>{throw oi("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},sy=function(t,e){const n=setTimeout(t,e);return"number"==typeof n&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class che{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;null===(n=this.appCheckProvider)||void 0===n||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){oi(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class dhe{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&"auth/token-not-initialized"===n.code?(Cr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',oi(e)}}let oy=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}return t.OWNER="owner",t})();const hW=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,gW="websocket",mW="long_polling";class qN{constructor(e,n,r,i,s=!1,o="",a=!1,u=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=td.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&td.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function _W(t,e,n){let r;if((0,w.hu)("string"==typeof e,"typeof type must == string"),(0,w.hu)("object"==typeof n,"typeof params must == object"),e===gW)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==mW)throw new Error("Unknown connection type: "+e);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function hhe(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);const i=[];return Sr(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}class fhe{constructor(){this.counters_={}}incrementCounter(e,n=1){(0,w.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return(0,w.p$)(this.counters_)}}const WN={},GN={};function KN(t){const e=t.toString();return WN[e]||(WN[e]=new fhe),WN[e]}class ghe{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&ap(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class vl{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=ry(e),this.stats_=KN(n),this.urlFn=u=>(this.appCheckToken&&(u.ac=this.appCheckToken),_W(n,mW,u))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new ghe(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(t){if((0,w.Yr)()||"complete"===document.readyState)t();else{let e=!1;const n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new ZN((...s)=>{const[o,a,u,l,h]=s;if(this.incrementIncomingBytes_(s),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===o)this.id=a,this.password=u;else{if("close"!==o)throw new Error("Unrecognized command received: "+o);a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_()}},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&hW.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){vl.forceAllow_=!0}static forceDisallow(){vl.forceDisallow_=!0}static isAvailable(){return!((0,w.Yr)()||!vl.forceAllow_&&(vl.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=(0,w.Wl)(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=(0,w.h$)(n),i=sW(r,1840);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if((0,w.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=(0,w.Wl)(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class ZN{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,w.Yr)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=tW(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=ZN.createIFrame_();let s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Cr("frame writing exception"),a.stack&&Cr(a.stack),Cr(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Cr("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const o=this.pendingSegs.shift();r=r+"&seg"+i+"="+o.seg+"&ts"+i+"="+o.ts+"&d"+i+"="+o.d,i++}return n+=r,this.addLongPollTag_(n,this.currentSerial),!0}return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,n){(0,w.Yr)()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Cr("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let xT=null;typeof MozWebSocket<"u"?xT=MozWebSocket:typeof WebSocket<"u"&&(xT=WebSocket);let up=(()=>{class t{constructor(n,r,i,s,o,a,u){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=ry(this.connId),this.stats_=KN(r),this.connURL=t.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){const a={v:"5"};return!(0,w.Yr)()&&typeof location<"u"&&location.hostname&&hW.test(location.hostname)&&(a.r="f"),r&&(a.s=r),i&&(a.ls=i),s&&(a.ac=s),o&&(a.p=o),_W(n,gW,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,td.set("previous_websocket_failure",!0);try{let i;if((0,w.Yr)()){i={headers:{"User-Agent":`Firebase/5/${UN}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const o=process.env,a=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new xT(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&null!==xT&&!t.forceDisallow_}static previouslyFailed(){return td.isInMemoryStorage||!0===td.get("previous_websocket_failure")}markConnectionHealthy(){td.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,w.cI)(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if((0,w.hu)(null===this.frames,"We already have a frame buffer"),n.length<=6){const r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(null===this.mySock)return;const r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();const r=(0,w.Wl)(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=sW(r,16384);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t})(),CW=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[vl,up]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){const r=up&&up.isAvailable();let i=r&&!up.previouslyFailed();if(n.webSocketOnly&&(r||oi("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[up];else{const s=this.transports_=[];for(const o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return t.globalTransportInitialized_=!1,t})();class NW{constructor(e,n,r,i,s,o,a,u,l,h){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=l,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=ry("c:"+this.id+":"),this.transportManager_=new CW(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=sy(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const n=e.t;"a"===n?this.upgradeIfSecondaryHealthy_():"r"===n?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===n&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=iy("t",e),r=iy("d",e);if("c"===n)this.onSecondaryControl_(r);else{if("d"!==n)throw new Error("Unknown protocol layer: "+n);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=iy("t",e),r=iy("d",e);"c"===n?this.onControl_(r):"d"===n&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=iy("t",e);if("d"in e){const r=e.d;if("h"===n){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if("n"===n){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===n?this.onConnectionShutdown_(r):"r"===n?this.onReset_(r):"e"===n?$N("Server Error: "+r):"o"===n?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):$N("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),"5"!==r&&oi("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),sy(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):sy(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(td.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class MW{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}class xW{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,w.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context))return void i.splice(s,1)}validateEventType_(e){(0,w.hu)(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}class kT extends xW{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,w.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new kT}getInitialEvent(e){return(0,w.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class xt{constructor(e,n){if(void 0===n){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)""!==this.pieces_[n]&&(e+="/"+this.pieces_[n]);return e||"/"}}function bt(){return new xt("")}function ot(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function El(t){return t.pieces_.length-t.pieceNum_}function Kt(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new xt(t.pieces_,e)}function YN(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function ay(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function LW(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new xt(e,0)}function vn(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof xt)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new xt(n,0)}function at(t){return t.pieceNum_>=t.pieces_.length}function Di(t,e){const n=ot(t),r=ot(e);if(null===n)return e;if(n===r)return Di(Kt(t),Kt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Fhe(t,e){const n=ay(t,0),r=ay(e,0);for(let i=0;i<n.length&&i<r.length;i++){const s=rd(n[i],r[i]);if(0!==s)return s}return n.length===r.length?0:n.length<r.length?-1:1}function XN(t,e){if(El(t)!==El(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Fs(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(El(t)>El(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class Vhe{constructor(e,n){this.errorPrefix_=n,this.parts_=ay(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,w.ug)(this.parts_[r]);FW(this)}}function FW(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+id(t))}function id(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}class JN extends xW{constructor(){let e,n;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new JN}getInitialEvent(e){return(0,w.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const uy=1e3;let LT,sd=(()=>{class t extends MW{constructor(n,r,i,s,o,a,u,l){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=l,this.id=t.nextPersistentConnectionId_++,this.log_=ry("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=uy,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!(0,w.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");JN.getInstance().on("visible",this.onVisible_,this),-1===n.host.indexOf("fblocal")&&kT.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){const s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_((0,w.Wl)(o)),(0,w.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();const r=new w.BH,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{const u=a.d;"ok"===a.s?r.resolve(u):r.reject(u)}};return this.outstandingGets_.push(s),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(n,r,i,s){this.initConnection_();const o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),(0,w.hu)(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,w.hu)(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");const u={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(n){const r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){const r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i};n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest("q",o,u=>{const l=u.d,h=u.s;t.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",u),"ok"!==h&&this.removeListen_(i,s),n.onComplete&&n.onComplete(h,l))})}static warnOnListenWarnings_(n,r){if(n&&"object"==typeof n&&(0,w.r3)(n,"w")){const i=(0,w.DV)(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();oi(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&40===n.length||(0,w.GJ)(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const n=this.authToken_,r=(0,w.w9)(n)?"auth":"gauth",i={cred:n};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{const o=s.s,a=s.d||"error";this.authToken_===n&&("ok"===o?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{const r=n.s,i=n.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){const i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),(0,w.hu)(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);const o={p:n};s&&(o.q=i,o.t=s),this.sendRequest("n",o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){const o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();const a={p:r,d:i};void 0!==o&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(n){const r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){const r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+(0,w.Wl)(n));const r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),"d"===n?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===n?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===n?this.onListenRevoked_(r.p,r.q):"ac"===n?this.onAuthRevoked_(r.s,r.d):"apc"===n?this.onAppCheckRevoked_(r.s,r.d):"sd"===n?this.onSecurityDebugPacket_(r):$N("Unrecognized action received from server: "+(0,w.Wl)(n)+"\nAre you using the latest client?")}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){(0,w.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=uy,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=uy,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=uy),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const n=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var n=this;return(0,q.Z)(function*(){if(n.shouldReconnect_()){n.log_("Making a connection attempt"),n.lastConnectionAttemptTime_=(new Date).getTime(),n.lastConnectionEstablishedTime_=null;const r=n.onDataMessage_.bind(n),i=n.onReady_.bind(n),s=n.onRealtimeDisconnect_.bind(n),o=n.id+":"+t.nextConnectionId_++,a=n.lastSessionId;let u=!1,l=null;const h=function(){l?l.close():(u=!0,s())};n.realtime_={close:h,sendRequest:function(_){(0,w.hu)(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(_)}};const m=n.forceTokenRefresh_;n.forceTokenRefresh_=!1;try{const[_,v]=yield Promise.all([n.authTokenProvider_.getToken(m),n.appCheckTokenProvider_.getToken(m)]);u?Cr("getToken() completed but was canceled"):(Cr("getToken() completed. Creating connection."),n.authToken_=_&&_.accessToken,n.appCheckToken_=v&&v.token,l=new NW(o,n.repoInfo_,n.applicationId_,n.appCheckToken_,n.authToken_,r,i,s,I=>{oi(I+" ("+n.repoInfo_.toString()+")"),n.interrupt("server_kill")},a))}catch(_){n.log_("Failed to get token: "+_),u||(n.repoInfo_.nodeAdmin&&oi(_),h())}}})()}interrupt(n){Cr("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){Cr("Resuming connection for reason: "+n),delete this.interruptReasons_[n],(0,w.xb)(this.interruptReasons_)&&(this.reconnectDelay_=uy,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){const r=n-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){const r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;i=r?r.map(o=>HN(o)).join("$"):"default";const s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){const i=new xt(n).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(r),o.delete(r),0===o.size&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){Cr("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===n||"permission_denied"===n)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){Cr("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===n||"permission_denied"===n)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const n of this.listens.values())for(const r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){const n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){const n={};let r="js";(0,w.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),n["sdk."+r+"."+UN.replace(/\./g,"-")]=1,(0,w.uI)()?n["framework.cordova"]=1:(0,w.b$)()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){const n=kT.getInstance().currentlyOnline();return(0,w.xb)(this.interruptReasons_)&&n}}return t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t})();class lt{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new lt(e,n)}}class OT{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new lt(yl,e),i=new lt(yl,n);return 0!==this.compare(r,i)}minPost(){return lt.MIN}}class BW extends OT{static get __EMPTY_NODE(){return LT}static set __EMPTY_NODE(e){LT=e}compare(e,n){return rd(e.name,n.name)}isDefinedOn(e){throw(0,w.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return lt.MIN}maxPost(){return new lt(Xa,LT)}makePost(e,n){return(0,w.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new lt(e,LT)}toString(){return".key"}}const sa=new BW;class FT{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,i&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let n,e=this.nodeStack_.pop();if(n=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let tM,mo=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??$i.EMPTY_NODE,this.right=o??$i.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this;const o=i(n,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(n,r,i),null):0===o?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return $i.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(n,i.key)){if(i.right.isEmpty())return $i.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){const n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){const n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){const n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){const n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})();class $i{constructor(e,n=$i.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new $i(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,mo.BLACK,null,null))}remove(e){return new $i(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,mo.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),0===n)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),0===n){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}n<0?r=r.left:n>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new FT(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new FT(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new FT(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new FT(this.root_,null,this.comparator_,!0,e)}}function Whe(t,e){return rd(t.name,e.name)}function eM(t,e){return rd(t,e)}$i.EMPTY_NODE=new class qhe{copy(e,n,r,i,s){return this}insert(e,n,r){return new mo(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const jW=function(t){return"number"==typeof t?"number:"+oW(t):"string:"+t},$W=function(t){if(t.isLeafNode()){const e=t.val();(0,w.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,w.r3)(e,".sv"),"Priority must be a string or number.")}else(0,w.hu)(t===tM||t.isEmpty(),"priority of unexpected type.");(0,w.hu)(t===tM||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let HW,zW,qW,lp=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,(0,w.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),$W(this.priorityNode_)}static set __childrenNodeConstructor(n){HW=n}static get __childrenNodeConstructor(){return HW}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return".priority"===n?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return at(n)?this:".priority"===ot(n)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return".priority"===n?this.updatePriority(r):r.isEmpty()&&".priority"!==n?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){const i=ot(n);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,w.hu)(".priority"!==i||1===El(n),".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Kt(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+jW(this.priorityNode_.val())+":");const r=typeof this.value_;n+=r+":",n+="number"===r?oW(this.value_):this.value_,this.lazyHash_=nW(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:((0,w.hu)(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){const r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return(0,w.hu)(s>=0,"Unknown leaf type: "+r),(0,w.hu)(o>=0,"Unknown leaf type: "+i),s===o?"object"===i?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){return n===this||!!n.isLeafNode()&&(this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_))}}return t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t})();const rn=new class Qhe extends OT{compare(e,n){const r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return 0===s?rd(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return lt.MIN}maxPost(){return new lt(Xa,new lp("[PRIORITY-POST]",qW))}makePost(e,n){const r=zW(e);return new lt(n,new lp("[PRIORITY-POST]",r))}toString(){return".priority"}},Yhe=Math.log(2);class Xhe{constructor(e){this.count=parseInt(Math.log(e+1)/Yhe,10),this.current_=this.count-1;const i=(s=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const VT=function(t,e,n,r){t.sort(e);const i=function(u,l){const h=l-u;let p,m;if(0===h)return null;if(1===h)return p=t[u],m=n?n(p):p,new mo(m,p.node,mo.BLACK,null,null);{const _=parseInt(h/2,10)+u,v=i(u,_),I=i(_+1,l);return p=t[_],m=n?n(p):p,new mo(m,p.node,mo.BLACK,v,I)}},a=function(u){let l=null,h=null,p=t.length;const m=function(v,I){const T=p-v,N=p;p-=v;const b=i(T+1,N),k=t[T],$=n?n(k):k;_(new mo($,k.node,I,null,b))},_=function(v){l?(l.left=v,l=v):(h=v,l=v)};for(let v=0;v<u.count;++v){const I=u.nextBitIsOne(),T=Math.pow(2,u.count-(v+1));I?m(T,mo.BLACK):(m(T,mo.BLACK),m(T,mo.RED))}return h}(new Xhe(t.length));return new $i(r||e,a)};let nM;const cp={};class Ja{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return(0,w.hu)(cp&&rn,"ChildrenNode.ts has not been loaded"),nM=nM||new Ja({".priority":cp},{".priority":rn}),nM}get(e){const n=(0,w.DV)(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof $i?n:null}hasIndex(e){return(0,w.r3)(this.indexSet_,e.toString())}addIndex(e,n){(0,w.hu)(e!==sa,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=n.getIterator(lt.Wrap);let a,o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();a=i?VT(r,e.getCompare()):cp;const u=e.toString(),l=Object.assign({},this.indexSet_);l[u]=e;const h=Object.assign({},this.indexes_);return h[u]=a,new Ja(h,l)}addToIndexes(e,n){const r=(0,w.UI)(this.indexes_,(i,s)=>{const o=(0,w.DV)(this.indexSet_,s);if((0,w.hu)(o,"Missing index implementation for "+s),i===cp){if(o.isDefinedOn(e.node)){const a=[],u=n.getIterator(lt.Wrap);let l=u.getNext();for(;l;)l.name!==e.name&&a.push(l),l=u.getNext();return a.push(e),VT(a,o.getCompare())}return cp}{const a=n.get(e.name);let u=i;return a&&(u=u.remove(new lt(e.name,a))),u.insert(e,e.node)}});return new Ja(r,this.indexSet_)}removeFromIndexes(e,n){const r=(0,w.UI)(this.indexes_,i=>{if(i===cp)return i;{const s=n.get(e.name);return s?i.remove(new lt(e.name,s)):i}});return new Ja(r,this.indexSet_)}}let ly,Xe=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&$W(this.priorityNode_),this.children_.isEmpty()&&(0,w.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ly||(ly=new t(new $i(eM),null,Ja.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ly}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(".priority"===n)return this.getPriority();{const r=this.children_.get(n);return null===r?ly:r}}getChild(n){const r=ot(n);return null===r?this:this.getImmediateChild(r).getChild(Kt(n))}hasChild(n){return null!==this.children_.get(n)}updateImmediateChild(n,r){if((0,w.hu)(r,"We should always be passing snapshot nodes"),".priority"===n)return this.updatePriority(r);{const i=new lt(n,r);let s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));const a=s.isEmpty()?ly:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){const i=ot(n);if(null===i)return r;{(0,w.hu)(".priority"!==ot(n)||1===El(n),".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(Kt(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;const r={};let i=0,s=0,o=!0;if(this.forEachChild(rn,(a,u)=>{r[a]=u.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){const a=[];for(const u in r)a[u]=r[u];return a}return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let n="";this.getPriority().isEmpty()||(n+="priority:"+jW(this.getPriority().val())+":"),this.forEachChild(rn,(r,i)=>{const s=i.hash();""!==s&&(n+=":"+r+":"+s)}),this.lazyHash_=""===n?"":nW(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new lt(n,r));return o?o.name:null}return this.children_.getPredecessorKey(n)}getFirstChildName(n){const r=this.resolveIndex_(n);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(n){const r=this.getFirstChildName(n);return r?new lt(r,this.children_.get(r)):null}getLastChildName(n){const r=this.resolveIndex_(n);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(n){const r=this.getLastChildName(n);return r?new lt(r,this.children_.get(r)):null}forEachChild(n,r){const i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{const s=this.children_.getIteratorFrom(n.name,lt.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{const s=this.children_.getReverseIteratorFrom(n.name,lt.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===cy?-1:0}withIndex(n){if(n===sa||this.indexMap_.hasIndex(n))return this;{const r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===sa||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{const r=n;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(rn),s=r.getIterator(rn);let o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return null===o&&null===a}return!1}return!1}}resolveIndex_(n){return n===sa?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})();const cy=new class Jhe extends Xe{constructor(){super(new $i(eM),Xe.EMPTY_NODE,Ja.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Xe.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(lt,{MIN:{value:new lt(yl,Xe.EMPTY_NODE)},MAX:{value:new lt(Xa,cy)}}),BW.__EMPTY_NODE=Xe.EMPTY_NODE,lp.__childrenNodeConstructor=Xe,function Ghe(t){tM=t}(cy),function Zhe(t){qW=t}(cy);const efe=!0;function bn(t,e=null){if(null===t)return Xe.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),(0,w.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new lp(t,bn(e));if(t instanceof Array||!efe){let n=Xe.EMPTY_NODE;return Sr(t,(r,i)=>{if((0,w.r3)(t,r)&&"."!==r.substring(0,1)){const s=bn(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(bn(e))}{const n=[];let r=!1;if(Sr(t,(o,a)=>{if("."!==o.substring(0,1)){const u=bn(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),n.push(new lt(o,u)))}}),0===n.length)return Xe.EMPTY_NODE;const s=VT(n,Whe,o=>o.name,eM);if(r){const o=VT(n,rn.getCompare());return new Xe(s,bn(e),new Ja({".priority":o},{".priority":rn}))}return new Xe(s,bn(e),Ja.Default)}}!function Khe(t){zW=t}(bn);class rM extends OT{constructor(e){super(),this.indexPath_=e,(0,w.hu)(!at(e)&&".priority"!==ot(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return 0===s?rd(e.name,n.name):s}makePost(e,n){const r=bn(e),i=Xe.EMPTY_NODE.updateChild(this.indexPath_,r);return new lt(n,i)}maxPost(){const e=Xe.EMPTY_NODE.updateChild(this.indexPath_,cy);return new lt(Xa,e)}toString(){return ay(this.indexPath_,0).join("/")}}const iM=new class tfe extends OT{compare(e,n){const r=e.node.compareTo(n.node);return 0===r?rd(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return lt.MIN}maxPost(){return lt.MAX}makePost(e,n){const r=bn(e);return new lt(n,r)}toString(){return".value"}};function WW(t){return{type:"value",snapshotNode:t}}function dp(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function dy(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function hy(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}class sM{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){(0,w.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(null!=o&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(dy(n,a)):(0,w.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(dp(n,r)):o.trackChildChange(hy(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return null!=r&&(e.isLeafNode()||e.forEachChild(rn,(i,s)=>{n.hasChild(i)||r.trackChildChange(dy(i,s))}),n.isLeafNode()||n.forEachChild(rn,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(hy(i,s,o))}else r.trackChildChange(dp(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?Xe.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class fy{constructor(e){this.indexedFilter_=new sM(e.getIndex()),this.index_=e.getIndex(),this.startPost_=fy.getStartPost_(e),this.endPost_=fy.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new lt(n,r))||(r=Xe.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=Xe.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(Xe.EMPTY_NODE);const s=this;return n.forEachChild(rn,(o,a)=>{s.matches(new lt(o,a))||(i=i.updateImmediateChild(o,Xe.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}return e.getIndex().maxPost()}}class rfe{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new fy(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new lt(n,r))||(r=Xe.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=Xe.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<n.numChildren()&&n.isIndexed(this.index_)){let s;i=Xe.EMPTY_NODE.withIndex(this.index_),s=this.reverse_?n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();if(this.withinDirectionalStart(a)){if(!this.withinDirectionalEnd(a))break;i=i.updateImmediateChild(a.name,a.node),o++}}}else{let s;i=n.withIndex(this.index_),i=i.updatePriority(Xe.EMPTY_NODE),s=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let o=0;for(;s.hasNext();){const a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,Xe.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){const p=this.index_.getCompare();o=(m,_)=>p(_,m)}else o=this.index_.getCompare();const a=e;(0,w.hu)(a.numChildren()===this.limit_,"");const u=new lt(n,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(u);if(a.hasChild(n)){const p=a.getImmediateChild(n);let m=i.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=m&&(m.name===n||a.hasChild(m.name));)m=i.getChildAfterChild(this.index_,m,this.reverse_);const _=null==m?1:o(m,u);if(h&&!r.isEmpty()&&_>=0)return s?.trackChildChange(hy(n,r,p)),a.updateImmediateChild(n,r);{s?.trackChildChange(dy(n,p));const I=a.updateImmediateChild(n,Xe.EMPTY_NODE);return null!=m&&this.rangedFilter_.matches(m)?(s?.trackChildChange(dp(m.name,m.node)),I.updateImmediateChild(m.name,m.node)):I}}return r.isEmpty()?e:h&&o(l,u)>=0?(null!=s&&(s.trackChildChange(dy(l.name,l.node)),s.trackChildChange(dp(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(l.name,Xe.EMPTY_NODE)):e}}class UT{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=rn}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,w.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,w.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:yl}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,w.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,w.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Xa}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,w.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===rn}copy(){const e=new UT;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function oM(t,e,n){const r=t.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function aM(t,e,n){const r=t.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function BT(t,e){const n=t.copy();return n.index_=e,n}function GW(t){const e={};if(t.isDefault())return e;let n;if(t.index_===rn?n="$priority":t.index_===iM?n="$value":t.index_===sa?n="$key":((0,w.hu)(t.index_ instanceof rM,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=(0,w.Wl)(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=(0,w.Wl)(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+(0,w.Wl)(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=(0,w.Wl)(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+(0,w.Wl)(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function KW(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==rn&&(e.i=t.index_.toString()),e}class jT extends MW{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=ry("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return void 0!==n?"tag$"+n:((0,w.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=jT.getListenId_(e,r),a={};this.listens_[o]=a;const u=GW(e._queryParams);this.restRequest_(s+".json",u,(l,h)=>{let p=h;if(404===l&&(p=null,l=null),null===l&&this.onDataUpdate_(s,p,!1,r),(0,w.DV)(this.listens_,o)===a){let m;m=l?401===l?"permission_denied":"rest_error:"+l:"ok",i(m,null)}})}unlisten(e,n){const r=jT.getListenId_(e,n);delete this.listens_[r]}get(e){const n=GW(e._queryParams),r=e._path.toString(),i=new w.BH;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;404===s&&(a=null,s=null),null===s?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,w.xO)(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=(0,w.cI)(a.responseText)}catch{oi("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else 401!==a.status&&404!==a.status&&oi("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}class lfe{constructor(){this.rootNode_=Xe.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}function $T(){return{value:null,children:new Map}}function hp(t,e,n){if(at(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{const r=ot(e);t.children.has(r)||t.children.set(r,$T()),hp(t.children.get(r),e=Kt(e),n)}}function uM(t,e){if(at(e))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(rn,(r,i)=>{hp(t,new xt(r),i)}),uM(t,e)}}if(t.children.size>0){const n=ot(e);return e=Kt(e),t.children.has(n)&&uM(t.children.get(n),e)&&t.children.delete(n),0===t.children.size}return!0}function lM(t,e,n){null!==t.value?n(e,t.value):function cfe(t,e){t.children.forEach((n,r)=>{e(r,n)})}(t,(r,i)=>{lM(i,new xt(e.toString()+"/"+r),n)})}class dfe{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Sr(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}}class pfe{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new dfe(e);const r=1e4+2e4*Math.random();sy(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;Sr(e,(i,s)=>{s>0&&(0,w.r3)(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),sy(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var oa=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(oa||{});function hM(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}class HT{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=oa.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(at(this.path)){if(null!=this.affectedTree.value)return(0,w.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new xt(e));return new HT(bt(),n,this.revert)}}return(0,w.hu)(ot(this.path)===e,"operationForChild called for unrelated child."),new HT(Kt(this.path),this.affectedTree,this.revert)}}class py{constructor(e,n){this.source=e,this.path=n,this.type=oa.LISTEN_COMPLETE}operationForChild(e){return at(this.path)?new py(this.source,bt()):new py(this.source,Kt(this.path))}}class od{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=oa.OVERWRITE}operationForChild(e){return at(this.path)?new od(this.source,bt(),this.snap.getImmediateChild(e)):new od(this.source,Kt(this.path),this.snap)}}class fp{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=oa.MERGE}operationForChild(e){if(at(this.path)){const n=this.children.subtree(new xt(e));return n.isEmpty()?null:n.value?new od(this.source,bt(),n.value):new fp(this.source,bt(),n)}return(0,w.hu)(ot(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new fp(this.source,Kt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Il{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(at(e))return this.isFullyInitialized()&&!this.filtered_;const n=ot(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class gfe{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function gy(t,e,n,r,i,s){const o=r.filter(a=>a.type===n);o.sort((a,u)=>function yfe(t,e,n){if(null==e.childName||null==n.childName)throw(0,w.g5)("Should only compare child_ events.");const r=new lt(e.childName,e.snapshotNode),i=new lt(n.childName,n.snapshotNode);return t.index_.compare(r,i)}(t,a,u)),o.forEach(a=>{const u=function _fe(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(u,t.query_))})})}function zT(t,e){return{eventCache:t,serverCache:e}}function my(t,e,n,r){return zT(new Il(e,n,r),t.serverCache)}function QW(t,e,n,r){return zT(t.eventCache,new Il(e,n,r))}function qT(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function ad(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}let fM;class sn{constructor(e,n=(()=>(fM||(fM=new $i(nhe)),fM))()){this.value=e,this.children=n}static fromObject(e){let n=new sn(null);return Sr(e,(r,i)=>{n=n.set(new xt(r),i)}),n}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(null!=this.value&&n(this.value))return{path:bt(),value:this.value};if(at(e))return null;{const r=ot(e),i=this.children.get(r);if(null!==i){const s=i.findRootMostMatchingPathAndValue(Kt(e),n);return null!=s?{path:vn(new xt(r),s.path),value:s.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(at(e))return this;{const n=ot(e),r=this.children.get(n);return null!==r?r.subtree(Kt(e)):new sn(null)}}set(e,n){if(at(e))return new sn(n,this.children);{const r=ot(e),s=(this.children.get(r)||new sn(null)).set(Kt(e),n),o=this.children.insert(r,s);return new sn(this.value,o)}}remove(e){if(at(e))return this.children.isEmpty()?new sn(null):new sn(null,this.children);{const n=ot(e),r=this.children.get(n);if(r){const i=r.remove(Kt(e));let s;return s=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&s.isEmpty()?new sn(null):new sn(this.value,s)}return this}}get(e){if(at(e))return this.value;{const n=ot(e),r=this.children.get(n);return r?r.get(Kt(e)):null}}setTree(e,n){if(at(e))return n;{const r=ot(e),s=(this.children.get(r)||new sn(null)).setTree(Kt(e),n);let o;return o=s.isEmpty()?this.children.remove(r):this.children.insert(r,s),new sn(this.value,o)}}fold(e){return this.fold_(bt(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(vn(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,bt(),n)}findOnPath_(e,n,r){const i=!!this.value&&r(n,this.value);if(i)return i;if(at(e))return null;{const s=ot(e),o=this.children.get(s);return o?o.findOnPath_(Kt(e),vn(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,bt(),n)}foreachOnPath_(e,n,r){if(at(e))return this;{this.value&&r(n,this.value);const i=ot(e),s=this.children.get(i);return s?s.foreachOnPath_(Kt(e),vn(n,i),r):new sn(null)}}foreach(e){this.foreach_(bt(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(vn(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}class _o{constructor(e){this.writeTree_=e}static empty(){return new _o(new sn(null))}}function _y(t,e,n){if(at(e))return new _o(new sn(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let s=r.value;const o=Di(i,e);return s=s.updateChild(o,n),new _o(t.writeTree_.set(i,s))}{const i=new sn(n),s=t.writeTree_.setTree(e,i);return new _o(s)}}}function pM(t,e,n){let r=t;return Sr(n,(i,s)=>{r=_y(r,vn(e,i),s)}),r}function YW(t,e){if(at(e))return _o.empty();{const n=t.writeTree_.setTree(e,new sn(null));return new _o(n)}}function gM(t,e){return null!=ud(t,e)}function ud(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(Di(n.path,e)):null}function XW(t){const e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(rn,(r,i)=>{e.push(new lt(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new lt(r,i.value))}),e}function wl(t,e){if(at(e))return t;{const n=ud(t,e);return new _o(null!=n?new sn(n):t.writeTree_.subtree(e))}}function mM(t){return t.writeTree_.isEmpty()}function pp(t,e){return JW(bt(),t.writeTree_,e)}function JW(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{".priority"===i?((0,w.hu)(null!==s.value,"Priority writes must always be leaf nodes"),r=s.value):n=JW(vn(t,i),s,n)}),!n.getChild(t).isEmpty()&&null!==r&&(n=n.updateChild(vn(t,".priority"),r)),n}}function WT(t,e){return i4(e,t)}function Cfe(t,e){if(t.snap)return Fs(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Fs(vn(t.path,n),e))return!0;return!1}function Dfe(t){return t.visible}function e4(t,e,n){let r=_o.empty();for(let i=0;i<t.length;++i){const s=t[i];if(e(s)){const o=s.path;let a;if(s.snap)Fs(n,o)?(a=Di(n,o),r=_y(r,a,s.snap)):Fs(o,n)&&(a=Di(o,n),r=_y(r,bt(),s.snap.getChild(a)));else{if(!s.children)throw(0,w.g5)("WriteRecord should have .snap or .children");if(Fs(n,o))a=Di(n,o),r=pM(r,a,s.children);else if(Fs(o,n))if(a=Di(o,n),at(a))r=pM(r,bt(),s.children);else{const u=(0,w.DV)(s.children,ot(a));if(u){const l=u.getChild(Kt(a));r=_y(r,bt(),l)}}}}}return r}function t4(t,e,n,r,i){if(r||i){const s=wl(t.visibleWrites,e);return!i&&mM(s)?n:i||null!=n||gM(s,bt())?pp(e4(t.allWrites,function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(Fs(l.path,e)||Fs(e,l.path))},e),n||Xe.EMPTY_NODE):null}{const s=ud(t.visibleWrites,e);if(null!=s)return s;{const o=wl(t.visibleWrites,e);return mM(o)?n:null!=n||gM(o,bt())?pp(o,n||Xe.EMPTY_NODE):null}}}function GT(t,e,n,r){return t4(t.writeTree,t.treePath,e,n,r)}function _M(t,e){return function bfe(t,e,n){let r=Xe.EMPTY_NODE;const i=ud(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(rn,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){const s=wl(t.visibleWrites,e);return n.forEachChild(rn,(o,a)=>{const u=pp(wl(s,new xt(o)),a);r=r.updateImmediateChild(o,u)}),XW(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}return XW(wl(t.visibleWrites,e)).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}(t.writeTree,t.treePath,e)}function n4(t,e,n,r){return function Afe(t,e,n,r,i){(0,w.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=vn(e,n);if(gM(t.visibleWrites,s))return null;{const o=wl(t.visibleWrites,s);return mM(o)?i.getChild(n):pp(o,i.getChild(n))}}(t.writeTree,t.treePath,e,n,r)}function KT(t,e){return function Pfe(t,e){return ud(t.visibleWrites,e)}(t.writeTree,vn(t.treePath,e))}function yM(t,e,n){return function Rfe(t,e,n,r){const i=vn(e,n),s=ud(t.visibleWrites,i);return null!=s?s:r.isCompleteForChild(n)?pp(wl(t.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function r4(t,e){return i4(vn(t.treePath,e),t.writeTree)}function i4(t,e){return{treePath:t,writeTree:e}}class kfe{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;(0,w.hu)("child_added"===n||"child_changed"===n||"child_removed"===n,"Only child changes supported for tracking"),(0,w.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if("child_added"===n&&"child_removed"===s)this.changeMap.set(r,hy(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===n&&"child_added"===s)this.changeMap.delete(r);else if("child_removed"===n&&"child_changed"===s)this.changeMap.set(r,dy(r,i.oldSnap));else if("child_changed"===n&&"child_added"===s)this.changeMap.set(r,dp(r,e.snapshotNode));else{if("child_changed"!==n||"child_changed"!==s)throw(0,w.g5)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,hy(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const s4=new class Ofe{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}};class vM{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new Il(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return yM(this.writes_,e,r)}}getChildAfterChild(e,n,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:ad(this.viewCache_),s=function xfe(t,e,n,r,i,s){return function Nfe(t,e,n,r,i,s,o){let a;const u=wl(t.visibleWrites,e),l=ud(u,bt());if(null!=l)a=l;else{if(null==n)return[];a=pp(u,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const h=[],p=o.getCompare(),m=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let _=m.getNext();for(;_&&h.length<i;)0!==p(_,r)&&h.push(_),_=m.getNext();return h}}(t.writeTree,t.treePath,e,n,r,i,s)}(this.writes_,i,n,1,r,e);return 0===s.length?null:s[0]}}function o4(t,e,n,r,i,s){const o=e.eventCache;if(null!=KT(r,n))return e;{let a,u;if(at(n))if((0,w.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const l=ad(e),p=_M(r,l instanceof Xe?l:Xe.EMPTY_NODE);a=t.filter.updateFullNode(e.eventCache.getNode(),p,s)}else{const l=GT(r,ad(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{const l=ot(n);if(".priority"===l){(0,w.hu)(1===El(n),"Can't have a priority with additional path components");const h=o.getNode();u=e.serverCache.getNode();const p=n4(r,n,h,u);a=null!=p?t.filter.updatePriority(h,p):o.getNode()}else{const h=Kt(n);let p;if(o.isCompleteForChild(l)){u=e.serverCache.getNode();const m=n4(r,n,o.getNode(),u);p=null!=m?o.getNode().getImmediateChild(l).updateChild(h,m):o.getNode().getImmediateChild(l)}else p=yM(r,l,e.serverCache);a=null!=p?t.filter.updateChild(o.getNode(),l,p,h,i,s):o.getNode()}}return my(e,a,o.isFullyInitialized()||at(n),t.filter.filtersNodes())}}function ZT(t,e,n,r,i,s,o,a){const u=e.serverCache;let l;const h=o?t.filter:t.filter.getIndexedFilter();if(at(n))l=h.updateFullNode(u.getNode(),r,null);else if(h.filtersNodes()&&!u.isFiltered()){const _=u.getNode().updateChild(n,r);l=h.updateFullNode(u.getNode(),_,null)}else{const _=ot(n);if(!u.isCompleteForPath(n)&&El(n)>1)return e;const v=Kt(n),T=u.getNode().getImmediateChild(_).updateChild(v,r);l=".priority"===_?h.updatePriority(u.getNode(),T):h.updateChild(u.getNode(),_,T,v,s4,null)}const p=QW(e,l,u.isFullyInitialized()||at(n),h.filtersNodes());return o4(t,p,n,i,new vM(i,p,s),a)}function EM(t,e,n,r,i,s,o){const a=e.eventCache;let u,l;const h=new vM(i,e,s);if(at(n))l=t.filter.updateFullNode(e.eventCache.getNode(),r,o),u=my(e,l,!0,t.filter.filtersNodes());else{const p=ot(n);if(".priority"===p)l=t.filter.updatePriority(e.eventCache.getNode(),r),u=my(e,l,a.isFullyInitialized(),a.isFiltered());else{const m=Kt(n),_=a.getNode().getImmediateChild(p);let v;if(at(m))v=r;else{const I=h.getCompleteChild(p);v=null!=I?".priority"===YN(m)&&I.getChild(LW(m)).isEmpty()?I:I.updateChild(m,r):Xe.EMPTY_NODE}u=_.equals(v)?e:my(e,t.filter.updateChild(a.getNode(),p,v,m,h,o),a.isFullyInitialized(),t.filter.filtersNodes())}}return u}function a4(t,e){return t.eventCache.isCompleteForChild(e)}function u4(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function IM(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l,u=e;l=at(n)?r:new sn(null).setTree(n,r);const h=e.serverCache.getNode();return l.children.inorderTraversal((p,m)=>{if(h.hasChild(p)){const v=u4(0,e.serverCache.getNode().getImmediateChild(p),m);u=ZT(t,u,new xt(p),v,i,s,o,a)}}),l.children.inorderTraversal((p,m)=>{const _=!e.serverCache.isCompleteForChild(p)&&null===m.value;if(!h.hasChild(p)&&!_){const I=u4(0,e.serverCache.getNode().getImmediateChild(p),m);u=ZT(t,u,new xt(p),I,i,s,o,a)}}),u}class zfe{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new sM(r.getIndex()),s=function ife(t){return t.loadsAllData()?new sM(t.getIndex()):t.hasLimit()?new rfe(t):new fy(t)}(r);this.processor_=function Lfe(t){return{filter:t}}(s);const o=n.serverCache,a=n.eventCache,u=i.updateFullNode(Xe.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(Xe.EMPTY_NODE,a.getNode(),null),h=new Il(u,o.isFullyInitialized(),i.filtersNodes()),p=new Il(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=zT(p,h),this.eventGenerator_=new gfe(this.query_)}get query(){return this.query_}}function Gfe(t,e){const n=ad(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!at(e)&&!n.getImmediateChild(ot(e)).isEmpty())?n.getChild(e):null}function l4(t){return 0===t.eventRegistrations_.length}function c4(t,e,n){const r=[];if(n){(0,w.hu)(null==e,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){const o=t.eventRegistrations_[s];if(o.matches(e)){if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}else i.push(o)}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function d4(t,e,n,r){e.type===oa.MERGE&&null!==e.source.queryId&&((0,w.hu)(ad(t.viewCache_),"We should always have a full cache before handling merges"),(0,w.hu)(qT(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,s=function Vfe(t,e,n,r,i){const s=new kfe;let o,a;if(n.type===oa.OVERWRITE){const l=n;l.source.fromUser?o=EM(t,e,l.path,l.snap,r,i,s):((0,w.hu)(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!at(l.path),o=ZT(t,e,l.path,l.snap,r,i,a,s))}else if(n.type===oa.MERGE){const l=n;l.source.fromUser?o=function Bfe(t,e,n,r,i,s,o){let a=e;return r.foreach((u,l)=>{const h=vn(n,u);a4(e,ot(h))&&(a=EM(t,a,h,l,i,s,o))}),r.foreach((u,l)=>{const h=vn(n,u);a4(e,ot(h))||(a=EM(t,a,h,l,i,s,o))}),a}(t,e,l.path,l.children,r,i,s):((0,w.hu)(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=IM(t,e,l.path,l.children,r,i,a,s))}else if(n.type===oa.ACK_USER_WRITE){const l=n;o=l.revert?function Hfe(t,e,n,r,i,s){let o;if(null!=KT(r,n))return e;{const a=new vM(r,e,i),u=e.eventCache.getNode();let l;if(at(n)||".priority"===ot(n)){let h;if(e.serverCache.isFullyInitialized())h=GT(r,ad(e));else{const p=e.serverCache.getNode();(0,w.hu)(p instanceof Xe,"serverChildren would be complete if leaf node"),h=_M(r,p)}l=t.filter.updateFullNode(u,h,s)}else{const h=ot(n);let p=yM(r,h,e.serverCache);null==p&&e.serverCache.isCompleteForChild(h)&&(p=u.getImmediateChild(h)),l=null!=p?t.filter.updateChild(u,h,p,Kt(n),a,s):e.eventCache.getNode().hasChild(h)?t.filter.updateChild(u,h,Xe.EMPTY_NODE,Kt(n),a,s):u,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=GT(r,ad(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||null!=KT(r,bt()),my(e,l,o,t.filter.filtersNodes())}}(t,e,l.path,r,i,s):function jfe(t,e,n,r,i,s,o){if(null!=KT(i,n))return e;const a=e.serverCache.isFiltered(),u=e.serverCache;if(null!=r.value){if(at(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return ZT(t,e,n,u.getNode().getChild(n),i,s,a,o);if(at(n)){let l=new sn(null);return u.getNode().forEachChild(sa,(h,p)=>{l=l.set(new xt(h),p)}),IM(t,e,n,l,i,s,a,o)}return e}{let l=new sn(null);return r.foreach((h,p)=>{const m=vn(n,h);u.isCompleteForPath(m)&&(l=l.set(h,u.getNode().getChild(m)))}),IM(t,e,n,l,i,s,a,o)}}(t,e,l.path,l.affectedTree,r,i,s)}else{if(n.type!==oa.LISTEN_COMPLETE)throw(0,w.g5)("Unknown operation type: "+n.type);o=function $fe(t,e,n,r,i){const s=e.serverCache;return o4(t,QW(e,s.getNode(),s.isFullyInitialized()||at(n),s.isFiltered()),n,r,s4,i)}(t,e,n.path,r,s)}const u=s.getChanges();return function Ufe(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=qT(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(WW(qT(e)))}}(e,o,u),{viewCache:o,changes:u}}(t.processor_,i,e,n,r);return function Ffe(t,e){(0,w.hu)(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),(0,w.hu)(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}(t.processor_,s.viewCache),(0,w.hu)(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,h4(t,s.changes,s.viewCache.eventCache.getNode(),null)}function h4(t,e,n,r){return function mfe(t,e,n,r){const i=[],s=[];return e.forEach(o=>{"child_changed"===o.type&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(function nfe(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}(o.childName,o.snapshotNode))}),gy(t,i,"child_removed",e,r,n),gy(t,i,"child_added",e,r,n),gy(t,i,"child_moved",s,r,n),gy(t,i,"child_changed",e,r,n),gy(t,i,"value",e,r,n),i}(t.eventGenerator_,e,n,r?[r]:t.eventRegistrations_)}let QT,XT;class f4{constructor(){this.views=new Map}}function wM(t,e,n,r){const i=e.source.queryId;if(null!==i){const s=t.views.get(i);return(0,w.hu)(null!=s,"SyncTree gave us an op for an invalid query."),d4(s,e,n,r)}{let s=[];for(const o of t.views.values())s=s.concat(d4(o,e,n,r));return s}}function p4(t,e,n,r,i){const o=t.views.get(e._queryIdentifier);if(!o){let a=GT(n,i?r:null),u=!1;a?u=!0:r instanceof Xe?(a=_M(n,r),u=!1):(a=Xe.EMPTY_NODE,u=!1);const l=zT(new Il(a,u,!1),new Il(r,i,!1));return new zfe(e,l)}return o}function g4(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Tl(t,e){let n=null;for(const r of t.views.values())n=n||Gfe(r,e);return n}function m4(t,e){return e._queryParams.loadsAllData()?YT(t):t.views.get(e._queryIdentifier)}function _4(t,e){return null!=m4(t,e)}function Cl(t){return null!=YT(t)}function YT(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let rpe=1;class y4{constructor(e){this.listenProvider_=e,this.syncPointTree_=new sn(null),this.pendingWriteTree_=function Mfe(){return{visibleWrites:_o.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function TM(t,e,n,r,i){return function Efe(t,e,n,r,i){(0,w.hu)(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=_y(t.visibleWrites,e,n)),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r,i),i?gp(t,new od({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function Sl(t,e,n=!1){const r=function wfe(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}(t.pendingWriteTree_,e);if(function Tfe(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);(0,w.hu)(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&Cfe(a,r.path)?i=!1:Fs(r.path,a.path)&&(s=!0)),o--}return!!i&&(s?(function Sfe(t){t.visibleWrites=e4(t.allWrites,Dfe,bt()),t.lastWriteId=t.allWrites.length>0?t.allWrites[t.allWrites.length-1].writeId:-1}(t),!0):(r.snap?t.visibleWrites=YW(t.visibleWrites,r.path):Sr(r.children,u=>{t.visibleWrites=YW(t.visibleWrites,vn(r.path,u))}),!0))}(t.pendingWriteTree_,e)){let s=new sn(null);return null!=r.snap?s=s.set(bt(),!0):Sr(r.children,o=>{s=s.set(new xt(o),!0)}),gp(t,new HT(r.path,s,n))}return[]}function yy(t,e,n){return gp(t,new od({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function JT(t,e,n,r,i=!1){const s=e._path,o=t.syncPointTree_.get(s);let a=[];if(o&&("default"===e._queryIdentifier||_4(o,e))){const u=function epe(t,e,n,r){const i=e._queryIdentifier,s=[];let o=[];const a=Cl(t);if("default"===i)for(const[u,l]of t.views.entries())o=o.concat(c4(l,n,r)),l4(l)&&(t.views.delete(u),l.query._queryParams.loadsAllData()||s.push(l.query));else{const u=t.views.get(i);u&&(o=o.concat(c4(u,n,r)),l4(u)&&(t.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!Cl(t)&&s.push(new(function Yfe(){return(0,w.hu)(QT,"Reference.ts has not been loaded"),QT}())(e._repo,e._path)),{removed:s,events:o}}(o,e,n,r);(function Xfe(t){return 0===t.views.size})(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));const l=u.removed;if(a=u.events,!i){const h=-1!==l.findIndex(m=>m._queryParams.loadsAllData()),p=t.syncPointTree_.findOnPath(s,(m,_)=>Cl(_));if(h&&!p){const m=t.syncPointTree_.subtree(s);if(!m.isEmpty()){const _=function cpe(t){return t.fold((e,n,r)=>{if(n&&Cl(n))return[YT(n)];{let i=[];return n&&(i=g4(n)),Sr(r,(s,o)=>{i=i.concat(o)}),i}})}(m);for(let v=0;v<_.length;++v){const I=_[v],T=I.query,N=w4(t,I);t.listenProvider_.startListening(Ey(T),vy(t,T),N.hashFn,N.onComplete)}}}!p&&l.length>0&&!r&&(h?t.listenProvider_.stopListening(Ey(e),null):l.forEach(m=>{const _=t.queryToTagMap.get(tC(m));t.listenProvider_.stopListening(Ey(m),_)}))}!function dpe(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const i=tC(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}(t,l)}return a}function v4(t,e,n,r){const i=SM(t,r);if(null!=i){const s=DM(i),o=s.path,a=s.queryId,u=Di(o,e);return bM(t,o,new od(hM(a),u,n))}return[]}function CM(t,e,n,r=!1){const i=e._path;let s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(m,_)=>{const v=Di(m,i);s=s||Tl(_,v),o=o||Cl(_)});let u,a=t.syncPointTree_.get(i);a?(o=o||Cl(a),s=s||Tl(a,bt())):(a=new f4,t.syncPointTree_=t.syncPointTree_.set(i,a)),null!=s?u=!0:(u=!1,s=Xe.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((_,v)=>{const I=Tl(v,bt());I&&(s=s.updateImmediateChild(_,I))}));const l=_4(a,e);if(!l&&!e._queryParams.loadsAllData()){const m=tC(e);(0,w.hu)(!t.queryToTagMap.has(m),"View does not exist, but we have a tag");const _=function hpe(){return rpe++}();t.queryToTagMap.set(m,_),t.tagToQueryMap.set(_,m)}let p=function Jfe(t,e,n,r,i,s){const o=p4(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),function Kfe(t,e){t.eventRegistrations_.push(e)}(o,n),function Zfe(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(rn,(s,o)=>{r.push(dp(s,o))}),n.isFullyInitialized()&&r.push(WW(n.getNode())),h4(t,r,n.getNode(),e)}(o,n)}(a,e,n,WT(t.pendingWriteTree_,i),s,u);if(!l&&!o&&!r){const m=m4(a,e);p=p.concat(function fpe(t,e,n){const r=e._path,i=vy(t,e),s=w4(t,n),o=t.listenProvider_.startListening(Ey(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)(0,w.hu)(!Cl(a.value),"If we're adding a query, it shouldn't be shadowed");else{const u=a.fold((l,h,p)=>{if(!at(l)&&h&&Cl(h))return[YT(h).query];{let m=[];return h&&(m=m.concat(g4(h).map(_=>_.query))),Sr(p,(_,v)=>{m=m.concat(v)}),m}});for(let l=0;l<u.length;++l){const h=u[l];t.listenProvider_.stopListening(Ey(h),vy(t,h))}}return o}(t,e,m))}return p}function eC(t,e,n){const i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=Tl(a,Di(o,e));if(l)return l});return t4(i,e,s,n,!0)}function gp(t,e){return E4(e,t.syncPointTree_,null,WT(t.pendingWriteTree_,bt()))}function E4(t,e,n,r){if(at(t.path))return I4(t,e,n,r);{const i=e.get(bt());null==n&&null!=i&&(n=Tl(i,bt()));let s=[];const o=ot(t.path),a=t.operationForChild(o),u=e.children.get(o);if(u&&a){const l=n?n.getImmediateChild(o):null,h=r4(r,o);s=s.concat(E4(a,u,l,h))}return i&&(s=s.concat(wM(i,t,r,n))),s}}function I4(t,e,n,r){const i=e.get(bt());null==n&&null!=i&&(n=Tl(i,bt()));let s=[];return e.children.inorderTraversal((o,a)=>{const u=n?n.getImmediateChild(o):null,l=r4(r,o),h=t.operationForChild(o);h&&(s=s.concat(I4(h,a,u,l)))}),i&&(s=s.concat(wM(i,t,r,n))),s}function w4(t,e){const n=e.query,r=vy(t,n);return{hashFn:()=>(function qfe(t){return t.viewCache_.serverCache.getNode()}(e)||Xe.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function ape(t,e,n){const r=SM(t,n);if(r){const i=DM(r),s=i.path,o=i.queryId,a=Di(s,e);return bM(t,s,new py(hM(o),a))}return[]}(t,n._path,r):function ope(t,e){return gp(t,new py({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);{const s=function she(t,e){let n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}(i,n);return JT(t,n,null,s)}}}}function vy(t,e){const n=tC(e);return t.queryToTagMap.get(n)}function tC(t){return t._path.toString()+"$"+t._queryIdentifier}function SM(t,e){return t.tagToQueryMap.get(e)}function DM(t){const e=t.indexOf("$");return(0,w.hu)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new xt(t.substr(0,e))}}function bM(t,e,n){const r=t.syncPointTree_.get(e);return(0,w.hu)(r,"Missing sync point for query tag that we're tracking"),wM(r,n,WT(t.pendingWriteTree_,e),null)}function Ey(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(function npe(){return(0,w.hu)(XT,"Reference.ts has not been loaded"),XT}())(t._repo,t._path):t}class AM{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new AM(n)}node(){return this.node_}}class RM{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=vn(this.path_,e);return new RM(this.syncTree_,n)}node(){return eC(this.syncTree_,this.path_)}}const ppe=function(t){return(t=t||{}).timestamp=t.timestamp||(new Date).getTime(),t},T4=function(t,e,n){return t&&"object"==typeof t?((0,w.hu)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?gpe(t[".sv"],e,n):"object"==typeof t[".sv"]?mpe(t[".sv"],e):void(0,w.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},gpe=function(t,e,n){if("timestamp"===t)return n.timestamp;(0,w.hu)(!1,"Unexpected server value: "+t)},mpe=function(t,e,n){t.hasOwnProperty("increment")||(0,w.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;"number"!=typeof r&&(0,w.hu)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,w.hu)(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return"number"!=typeof o?r:o+r},C4=function(t,e,n,r){return NM(e,new RM(n,t),r)},PM=function(t,e,n){return NM(t,new AM(e),n)};function NM(t,e,n){const r=t.getPriority().val(),i=T4(r,e.getImmediateChild(".priority"),n);let s;if(t.isLeafNode()){const o=t,a=T4(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new lp(a,bn(i)):t}{const o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new lp(i))),o.forEachChild(rn,(a,u)=>{const l=NM(u,e.getImmediateChild(a),n);l!==u&&(s=s.updateImmediateChild(a,l))}),s}}class MM{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function nC(t,e){let n=e instanceof xt?e:new xt(e),r=t,i=ot(n);for(;null!==i;){const s=(0,w.DV)(r.node.children,i)||{children:{},childCount:0};r=new MM(i,r,s),n=Kt(n),i=ot(n)}return r}function ld(t){return t.node.value}function xM(t,e){t.node.value=e,kM(t)}function S4(t){return t.node.childCount>0}function rC(t,e){Sr(t.node.children,(n,r)=>{e(new MM(n,t,r))})}function D4(t,e,n,r){n&&!r&&e(t),rC(t,i=>{D4(i,e,!0,r)}),n&&r&&e(t)}function Iy(t){return new xt(null===t.parent?t.name:Iy(t.parent)+"/"+t.name)}function kM(t){null!==t.parent&&function vpe(t,e,n){const r=function _pe(t){return void 0===ld(t)&&!S4(t)}(n),i=(0,w.r3)(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,kM(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,kM(t))}(t.parent,t.name,t)}const Epe=/[\[\].#$\/\u0000-\u001F\u007F]/,Ipe=/[\[\].#$\u0000-\u001F\u007F]/,OM=10485760,iC=function(t){return"string"==typeof t&&0!==t.length&&!Epe.test(t)},b4=function(t){return"string"==typeof t&&0!==t.length&&!Ipe.test(t)},wy=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!NT(t)||t&&"object"==typeof t&&(0,w.r3)(t,".sv")},aa=function(t,e,n,r){r&&void 0===e||Ty((0,w.gK)(t,"value"),e,n)},Ty=function(t,e,n){const r=n instanceof xt?new Vhe(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+id(r));if("function"==typeof e)throw new Error(t+"contains a function "+id(r)+" with contents = "+e.toString());if(NT(e))throw new Error(t+"contains "+e.toString()+" "+id(r));if("string"==typeof e&&e.length>OM/3&&(0,w.ug)(e)>OM)throw new Error(t+"contains a string greater than "+OM+" utf8 bytes "+id(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,s=!1;if(Sr(e,(o,a)=>{if(".value"===o)i=!0;else if(".priority"!==o&&".sv"!==o&&(s=!0,!iC(o)))throw new Error(t+" contains an invalid key ("+o+") "+id(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function Uhe(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=(0,w.ug)(e),FW(t)})(r,o),Ty(t,a,r),function Bhe(t){const e=t.parts_.pop();t.byteLength_-=(0,w.ug)(e),t.parts_.length>0&&(t.byteLength_-=1)}(r)}),i&&s)throw new Error(t+' contains ".value" child '+id(r)+" in addition to actual children.")}},A4=function(t,e,n,r){if(r&&void 0===e)return;const i=(0,w.gK)(t,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];Sr(e,(o,a)=>{const u=new xt(o);if(Ty(i,a,vn(n,u)),".priority"===YN(u)&&!wy(a))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const s=ay(r);for(let o=0;o<s.length;o++)if((".priority"!==s[o]||o!==s.length-1)&&!iC(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(Fhe);let i=null;for(n=0;n<e.length;n++){if(r=e[n],null!==i&&Fs(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)},LM=function(t,e,n){if(!n||void 0!==e){if(NT(e))throw new Error((0,w.gK)(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!wy(e))throw new Error((0,w.gK)(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Cy=function(t,e,n,r){if(!(r&&void 0===n||iC(n)))throw new Error((0,w.gK)(t,e)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Sy=function(t,e,n,r){if(!(r&&void 0===n||b4(n)))throw new Error((0,w.gK)(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Cpe=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Sy(t,e,n,r)},Vs=function(t,e){if(".info"===ot(e))throw new Error(t+" failed = Can't modify data under /.info/")},R4=function(t,e){const n=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!iC(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),b4(t)}(n))throw new Error((0,w.gK)(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Spe{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function sC(t,e){let n=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();null!==n&&!XN(s,n.path)&&(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function P4(t,e,n){sC(t,n),N4(t,r=>XN(r,e))}function hs(t,e,n){sC(t,n),N4(t,r=>Fs(r,e)||Fs(e,r))}function N4(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const i=t.eventLists_[r];i&&(e(i.path)?(Dpe(t.eventLists_[r]),t.eventLists_[r]=null):n=!1)}n&&(t.eventLists_=[]),t.recursionDepth_--}function Dpe(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(null!==n){t.events[e]=null;const r=n.getEventRunner();nd&&Cr("event: "+n.toString()),ap(r)}}}const M4="repo_interrupt",bpe=25;class Ape{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Spe,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=$T(),this.transactionQueueTree_=new MM,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function x4(t){const n=t.infoData_.getNode(new xt(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+n}function Dy(t){return ppe({timestamp:x4(t)})}function k4(t,e,n,r,i){t.dataUpdateCount++;const s=new xt(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){const u=(0,w.UI)(n,l=>bn(l));o=function upe(t,e,n,r){const i=SM(t,r);if(i){const s=DM(i),o=s.path,a=s.queryId,u=Di(o,e),l=sn.fromObject(n);return bM(t,o,new fp(hM(a),u,l))}return[]}(t.serverSyncTree_,s,u,i)}else{const u=bn(n);o=v4(t.serverSyncTree_,s,u,i)}else if(r){const u=(0,w.UI)(n,l=>bn(l));o=function spe(t,e,n){const r=sn.fromObject(n);return gp(t,new fp({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(t.serverSyncTree_,s,u)}else{const u=bn(n);o=yy(t.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=_p(t,s)),hs(t.eventQueue_,a,o)}function O4(t,e){FM(t,"connected",e),!1===e&&function xpe(t){mp(t,"onDisconnectEvents");const e=Dy(t),n=$T();lM(t.onDisconnect_,bt(),(i,s)=>{const o=C4(i,s,t.serverSyncTree_,e);hp(n,i,o)});let r=[];lM(n,bt(),(i,s)=>{r=r.concat(yy(t.serverSyncTree_,i,s));const o=jM(t,i);_p(t,o)}),t.onDisconnect_=$T(),hs(t.eventQueue_,bt(),r)}(t)}function FM(t,e,n){const r=new xt("/.info/"+e),i=bn(n);t.infoData_.updateSnapshot(r,i);const s=yy(t.infoSyncTree_,r,i);hs(t.eventQueue_,r,s)}function oC(t){return t.nextWriteId_++}function VM(t,e,n,r,i){mp(t,"set",{path:e.toString(),value:n,priority:r});const s=Dy(t),o=bn(n,r),a=eC(t.serverSyncTree_,e),u=PM(o,a,s),l=oC(t),h=TM(t.serverSyncTree_,e,u,l,!0);sC(t.eventQueue_,h),t.server_.put(e.toString(),o.val(!0),(m,_)=>{const v="ok"===m;v||oi("set at "+e+" failed: "+m);const I=Sl(t.serverSyncTree_,l,!v);hs(t.eventQueue_,e,I),Dl(0,i,m,_)});const p=jM(t,e);_p(t,p),hs(t.eventQueue_,p,[])}function kpe(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{"ok"===r&&uM(t.onDisconnect_,e),Dl(0,n,r,i)})}function L4(t,e,n,r){const i=bn(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{"ok"===s&&hp(t.onDisconnect_,e,i),Dl(0,r,s,o)})}function UM(t,e,n){let r;r=".info"===ot(e._path)?JT(t.infoSyncTree_,e,n):JT(t.serverSyncTree_,e,n),P4(t.eventQueue_,e._path,r)}function F4(t){t.persistentConnection_&&t.persistentConnection_.interrupt(M4)}function mp(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Cr(n,...e)}function Dl(t,e,n,r){e&&ap(()=>{if("ok"===n)e(null);else{const i=(n||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function BM(t,e,n){return eC(t.serverSyncTree_,e,n)||Xe.EMPTY_NODE}function aC(t,e=t.transactionQueueTree_){if(e||uC(t,e),ld(e)){const n=U4(t,e);(0,w.hu)(n.length>0,"Sending zero length transaction queue"),n.every(i=>0===i.status)&&function Bpe(t,e,n){const r=n.map(l=>l.currentWriteId),i=BM(t,e,r);let s=i;const o=i.hash();for(let l=0;l<n.length;l++){const h=n[l];(0,w.hu)(0===h.status,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const p=Di(e,h.path);s=s.updateChild(p,h.currentOutputSnapshotRaw)}const a=s.val(!0),u=e;t.server_.put(u.toString(),a,l=>{mp(t,"transaction put response",{path:u.toString(),status:l});let h=[];if("ok"===l){const p=[];for(let m=0;m<n.length;m++)n[m].status=2,h=h.concat(Sl(t.serverSyncTree_,n[m].currentWriteId)),n[m].onComplete&&p.push(()=>n[m].onComplete(null,!0,n[m].currentOutputSnapshotResolved)),n[m].unwatcher();uC(t,nC(t.transactionQueueTree_,e)),aC(t,t.transactionQueueTree_),hs(t.eventQueue_,e,h);for(let m=0;m<p.length;m++)ap(p[m])}else{if("datastale"===l)for(let p=0;p<n.length;p++)n[p].status=3===n[p].status?4:0;else{oi("transaction at "+u.toString()+" failed: "+l);for(let p=0;p<n.length;p++)n[p].status=4,n[p].abortReason=l}_p(t,e)}},o)}(t,Iy(e),n)}else S4(e)&&rC(e,n=>{aC(t,n)})}function _p(t,e){const n=V4(t,e),r=Iy(n);return function jpe(t,e,n){if(0===e.length)return;const r=[];let i=[];const o=e.filter(a=>0===a.status).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const u=e[a],l=Di(n,u.path);let p,h=!1;if((0,w.hu)(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===u.status)h=!0,p=u.abortReason,i=i.concat(Sl(t.serverSyncTree_,u.currentWriteId,!0));else if(0===u.status)if(u.retryCount>=bpe)h=!0,p="maxretry",i=i.concat(Sl(t.serverSyncTree_,u.currentWriteId,!0));else{const m=BM(t,u.path,o);u.currentInputSnapshot=m;const _=e[a].update(m.val());if(void 0!==_){Ty("transaction failed: Data returned ",_,u.path);let v=bn(_);"object"==typeof _&&null!=_&&(0,w.r3)(_,".priority")||(v=v.updatePriority(m.getPriority()));const T=u.currentWriteId,N=Dy(t),b=PM(v,m,N);u.currentOutputSnapshotRaw=v,u.currentOutputSnapshotResolved=b,u.currentWriteId=oC(t),o.splice(o.indexOf(T),1),i=i.concat(TM(t.serverSyncTree_,u.path,b,u.currentWriteId,u.applyLocally)),i=i.concat(Sl(t.serverSyncTree_,T,!0))}else h=!0,p="nodata",i=i.concat(Sl(t.serverSyncTree_,u.currentWriteId,!0))}hs(t.eventQueue_,n,i),i=[],h&&(e[a].status=2,setTimeout(e[a].unwatcher,Math.floor(0)),e[a].onComplete&&r.push("nodata"===p?()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot):()=>e[a].onComplete(new Error(p),!1,null)))}uC(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)ap(r[a]);aC(t,t.transactionQueueTree_)}(t,U4(t,n),r),r}function V4(t,e){let n,r=t.transactionQueueTree_;for(n=ot(e);null!==n&&void 0===ld(r);)r=nC(r,n),n=ot(e=Kt(e));return r}function U4(t,e){const n=[];return B4(t,e,n),n.sort((r,i)=>r.order-i.order),n}function B4(t,e,n){const r=ld(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);rC(e,i=>{B4(t,i,n)})}function uC(t,e){const n=ld(e);if(n){let r=0;for(let i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,xM(e,n.length>0?n:void 0)}rC(e,r=>{uC(t,r)})}function jM(t,e){const n=Iy(V4(t,e)),r=nC(t.transactionQueueTree_,e);return function ype(t,e,n){let r=n?t:t.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{$M(t,i)}),$M(t,r),D4(r,i=>{$M(t,i)}),n}function $M(t,e){const n=ld(e);if(n){const r=[];let i=[],s=-1;for(let o=0;o<n.length;o++)3===n[o].status||(1===n[o].status?((0,w.hu)(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):((0,w.hu)(0===n[o].status,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Sl(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));-1===s?xM(e,void 0):n.length=s+1,hs(t.eventQueue_,Iy(e),i);for(let o=0;o<r.length;o++)ap(r[o])}}const HM=function(t,e){const n=zpe(t),r=n.namespace;return"firebase.com"===n.domain&&ia(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==n.domain&&ia("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&oi("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new qN(n.host,n.secure,r,"ws"===n.scheme||"wss"===n.scheme,e,"",r!==n.subdomain),path:new xt(n.pathString)}},zpe=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",u=443;if("string"==typeof t){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let h=t.indexOf("/");-1===h&&(h=t.length);let p=t.indexOf("?");-1===p&&(p=t.length),e=t.substring(0,Math.min(h,p)),h<p&&(i=function $pe(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}(t.substring(h,p)));const m=function Hpe(t){const e={};"?"===t.charAt(0)&&(t=t.substring(1));for(const n of t.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):oi(`Invalid query segment '${n}' in query '${t}'`)}return e}(t.substring(Math.min(t.length,p)));l=e.indexOf(":"),l>=0?(o="https"===a||"wss"===a,u=parseInt(e.substring(l+1),10)):l=e.length;const _=e.slice(0,l);if("localhost"===_.toLowerCase())n="localhost";else if(_.split(".").length<=2)n=_;else{const v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),n=e.substring(v+1),s=r}"ns"in m&&(s=m.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}},j4="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",qpe=function(){let t=0;const e=[];return function(n){const r=n===t;let i;t=n;const s=new Array(8);for(i=7;i>=0;i--)s[i]=j4.charAt(n%64),n=Math.floor(n/64);(0,w.hu)(0===n,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&63===e[i];i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)o+=j4.charAt(e[i]);return(0,w.hu)(20===o.length,"nextPushId: Length should be 20."),o}}();class $4{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,w.Wl)(this.snapshot.exportVal())}}class H4{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class zM{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return(0,w.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class z4{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new w.BH;return kpe(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Vs("OnDisconnect.remove",this._path);const e=new w.BH;return L4(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Vs("OnDisconnect.set",this._path),aa("OnDisconnect.set",e,this._path,!1);const n=new w.BH;return L4(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){Vs("OnDisconnect.setWithPriority",this._path),aa("OnDisconnect.setWithPriority",e,this._path,!1),LM("OnDisconnect.setWithPriority",n,!1);const r=new w.BH;return function Ope(t,e,n,r,i){const s=bn(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{"ok"===o&&hp(t.onDisconnect_,e,s),Dl(0,i,o,a)})}(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){Vs("OnDisconnect.update",this._path),A4("OnDisconnect.update",e,this._path,!1);const n=new w.BH;return function Lpe(t,e,n,r){if((0,w.xb)(n))return Cr("onDisconnect().update() called with empty data.  Don't do anything."),void Dl(0,r,"ok",void 0);t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{"ok"===i&&Sr(n,(o,a)=>{const u=bn(a);hp(t.onDisconnect_,vn(e,o),u)}),Dl(0,r,i,s)})}(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}class Hi{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return at(this._path)?null:YN(this._path)}get ref(){return new Us(this._repo,this._path)}get _queryIdentifier(){const e=KW(this._queryParams),n=HN(e);return"{}"===n?"default":n}get _queryObject(){return KW(this._queryParams)}isEqual(e){if(!((e=(0,w.m9)(e))instanceof Hi))return!1;const n=this._repo===e._repo,r=XN(this._path,e._path);return n&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function Lhe(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)}}function lC(t,e){if(!0===t._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function bl(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===sa){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==yl)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==Xa)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===rn){if(null!=e&&!wy(e)||null!=n&&!wy(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,w.hu)(t.getIndex()instanceof rM||t.getIndex()===iM,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function cC(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Us extends Hi{constructor(e,n){super(e,n,new UT,!1)}get parent(){const e=LW(this._path);return null===e?null:new Us(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class cd{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new xt(e),r=dd(this.ref,e);return new cd(this._node.getChild(n),r,rn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>e(new cd(i,dd(this.ref,r),rn)))}hasChild(e){const n=new xt(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function q4(t,e){return(t=(0,w.m9)(t))._checkNotDeleted("ref"),void 0!==e?dd(t._root,e):t._root}function W4(t,e){(t=(0,w.m9)(t))._checkNotDeleted("refFromURL");const n=HM(e,t._repo.repoInfo_.nodeAdmin);R4("refFromURL",n);const r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&ia("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),q4(t,n.path.toString())}function dd(t,e){return null===ot((t=(0,w.m9)(t))._path)?Cpe("child","path",e,!1):Sy("child","path",e,!1),new Us(t._repo,vn(t._path,e))}function qM(t,e){t=(0,w.m9)(t),Vs("set",t._path),aa("set",e,t._path,!1);const n=new w.BH;return VM(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function Qpe(t,e){A4("update",e,t._path,!1);const n=new w.BH;return function Mpe(t,e,n,r){mp(t,"update",{path:e.toString(),value:n});let i=!0;const s=Dy(t),o={};if(Sr(n,(a,u)=>{i=!1,o[a]=C4(vn(e,a),bn(u),t.serverSyncTree_,s)}),i)Cr("update() called with empty data.  Don't do anything."),Dl(0,r,"ok",void 0);else{const a=oC(t),u=function ipe(t,e,n,r){!function Ife(t,e,n,r){(0,w.hu)(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=pM(t.visibleWrites,e,n),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r);const i=sn.fromObject(n);return gp(t,new fp({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(t.serverSyncTree_,e,o,a);sC(t.eventQueue_,u),t.server_.merge(e.toString(),n,(l,h)=>{const p="ok"===l;p||oi("update at "+e+" failed: "+l);const m=Sl(t.serverSyncTree_,a,!p),_=m.length>0?_p(t,e):e;hs(t.eventQueue_,_,m),Dl(0,r,l,h)}),Sr(n,l=>{const h=jM(t,vn(e,l));_p(t,h)}),hs(t.eventQueue_,e,[])}}(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function Ype(t){t=(0,w.m9)(t);const e=new zM(()=>{}),n=new by(e);return function Npe(t,e,n){const r=function lpe(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(l,h)=>{const p=Di(l,n);r=r||Tl(h,p)});let i=t.syncPointTree_.get(n);i?r=r||Tl(i,bt()):(i=new f4,t.syncPointTree_=t.syncPointTree_.set(n,i));const s=null!=r,o=s?new Il(r,!0,!1):null;return function Wfe(t){return qT(t.viewCache_)}(p4(i,e,WT(t.pendingWriteTree_,e._path),s?o.getNode():Xe.EMPTY_NODE,s))}(t.serverSyncTree_,e);return null!=r?Promise.resolve(r):t.server_.get(e).then(i=>{const s=bn(i).withIndex(e._queryParams.getIndex());let o;if(CM(t.serverSyncTree_,e,n,!0),e._queryParams.loadsAllData())o=yy(t.serverSyncTree_,e._path,s);else{const a=vy(t.serverSyncTree_,e);o=v4(t.serverSyncTree_,e._path,s,a)}return hs(t.eventQueue_,e._path,o),JT(t.serverSyncTree_,e,n,null,!0),s},i=>(mp(t,"get for query "+(0,w.Wl)(e)+" failed: "+i),Promise.reject(new Error(i))))}(t._repo,t,n).then(r=>new cd(r,new Us(t._repo,t._path),t._queryParams.getIndex()))}class by{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,n){const r=n._queryParams.getIndex();return new $4("value",this,new cd(e.snapshotNode,new Us(n._repo,n._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new H4(this,e,n):null}matches(e){return e instanceof by&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class dC{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n="children_added"===e?"child_added":e;return n="children_removed"===n?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new H4(this,e,n):null}createEvent(e,n){(0,w.hu)(null!=e.childName,"Child events should have a childName.");const r=dd(new Us(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new $4(e.type,this,new cd(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof dC&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function Ay(t,e,n,r,i){let s;if("object"==typeof r&&(s=void 0,i=r),"function"==typeof r&&(s=r),i&&i.onlyOnce){const u=n,l=(h,p)=>{UM(t._repo,t,a),u(h,p)};l.userCallback=n.userCallback,l.context=n.context,n=l}const o=new zM(n,s||void 0),a="value"===e?new by(o):new dC(e,o);return function Fpe(t,e,n){let r;r=".info"===ot(e._path)?CM(t.infoSyncTree_,e,n):CM(t.serverSyncTree_,e,n),P4(t.eventQueue_,e._path,r)}(t._repo,t,a),()=>UM(t._repo,t,a)}function WM(t,e,n,r){return Ay(t,"value",e,n,r)}function G4(t,e,n,r){return Ay(t,"child_added",e,n,r)}function K4(t,e,n,r){return Ay(t,"child_changed",e,n,r)}function Z4(t,e,n,r){return Ay(t,"child_moved",e,n,r)}function Q4(t,e,n,r){return Ay(t,"child_removed",e,n,r)}function Y4(t,e,n){let r=null;const i=n?new zM(n):null;"value"===e?r=new by(i):e&&(r=new dC(e,i)),UM(t._repo,t,r)}class yo{}class X4 extends yo{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){aa("endAt",this._value,e._path,!0);const n=aM(e._queryParams,this._value,this._key);if(cC(n),bl(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Hi(e._repo,e._path,n,e._orderByCalled)}}class Jpe extends yo{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){aa("endBefore",this._value,e._path,!1);const n=function ufe(t,e,n){let r;return r=aM(t,e,t.index_===sa||n?n:yl),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(cC(n),bl(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Hi(e._repo,e._path,n,e._orderByCalled)}}class J4 extends yo{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){aa("startAt",this._value,e._path,!0);const n=oM(e._queryParams,this._value,this._key);if(cC(n),bl(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Hi(e._repo,e._path,n,e._orderByCalled)}}class nge extends yo{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){aa("startAfter",this._value,e._path,!1);const n=function afe(t,e,n){let r;return r=oM(t,e,t.index_===sa||n?n:Xa),r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(cC(n),bl(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Hi(e._repo,e._path,n,e._orderByCalled)}}class ige extends yo{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Hi(e._repo,e._path,function sfe(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}class oge extends yo{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Hi(e._repo,e._path,function ofe(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}class uge extends yo{constructor(e){super(),this._path=e}_apply(e){lC(e,"orderByChild");const n=new xt(this._path);if(at(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new rM(n),i=BT(e._queryParams,r);return bl(i),new Hi(e._repo,e._path,i,!0)}}class cge extends yo{_apply(e){lC(e,"orderByKey");const n=BT(e._queryParams,sa);return bl(n),new Hi(e._repo,e._path,n,!0)}}class hge extends yo{_apply(e){lC(e,"orderByPriority");const n=BT(e._queryParams,rn);return bl(n),new Hi(e._repo,e._path,n,!0)}}class pge extends yo{_apply(e){lC(e,"orderByValue");const n=BT(e._queryParams,iM);return bl(n),new Hi(e._repo,e._path,n,!0)}}class mge extends yo{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){if(aa("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new X4(this._value,this._key)._apply(new J4(this._value,this._key)._apply(e))}}function vo(t,...e){let n=(0,w.m9)(t);for(const r of e)n=r._apply(n);return n}(function Qfe(t){(0,w.hu)(!QT,"__referenceConstructor has already been defined"),QT=t})(Us),function tpe(t){(0,w.hu)(!XT,"__referenceConstructor has already been defined"),XT=t}(Us);const GM={};function KM(t,e,n,r,i){let s=r||t.options.databaseURL;void 0===s&&(t.options.projectId||ia("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Cr("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let u,l,o=HM(s,i),a=o.repoInfo;typeof process<"u"&&process.env&&(l=process.env.FIREBASE_DATABASE_EMULATOR_HOST),l?(u=!0,s=`http://${l}?ns=${a.namespace}`,o=HM(s,i),a=o.repoInfo):u=!o.repoInfo.secure;const h=i&&u?new oy(oy.OWNER):new dhe(t.name,t.options,e);R4("Invalid Firebase Database URL",o),at(o.path)||ia("Database URL must point to the root of a Firebase Database (not including a child path).");const p=function Ige(t,e,n,r){let i=GM[e.name];i||(i={},GM[e.name]=i);let s=i[t.toURLString()];return s&&ia("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Ape(t,false,n,r),i[t.toURLString()]=s,s}(a,t,h,new che(t.name,n));return new Tge(p,t)}class Tge{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function Rpe(t,e,n){if(t.stats_=KN(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new jT(t.repoInfo_,(r,i,s,o)=>{k4(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>O4(t,!0),0);else{if(typeof n<"u"&&null!==n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,w.Wl)(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new sd(t.repoInfo_,e,(r,i,s,o)=>{k4(t,r,i,s,o)},r=>{O4(t,r)},r=>{!function Ppe(t,e){Sr(e,(n,r)=>{FM(t,n,r)})}(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=function phe(t,e){const n=t.toString();return GN[n]||(GN[n]=e()),GN[n]}(t.repoInfo_,()=>new pfe(t.stats_,t.server_)),t.infoData_=new lfe,t.infoSyncTree_=new y4({startListening:(r,i,s,o)=>{let a=[];const u=t.infoData_.getNode(r._path);return u.isEmpty()||(a=yy(t.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),FM(t,"connected",!1),t.serverSyncTree_=new y4({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,u)=>{const l=o(a,u);hs(t.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Us(this._repo,bt())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function Ege(t,e){const n=GM[e];(!n||n[t.key]!==t)&&ia(`Database ${e}(${t.repoInfo_}) has already been deleted.`),F4(t),delete n[t.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&ia("Cannot call "+e+" on a deleted database.")}}function tG(){CW.IS_TRANSPORT_INITIALIZED&&oi("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function Cge(){tG(),vl.forceDisallow()}function Sge(){tG(),up.forceDisallow(),vl.forceAllow()}function Age(t,e){iW(t,e)}const Pge={".sv":"timestamp"};class xge{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}sd.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},sd.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)},function Rge(t){BN(Fi.SDK_VERSION),(0,Fi._registerComponent)(new co.wA("database",(e,{instanceIdentifier:n})=>KM(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n),"PUBLIC").setMultipleInstances(!0)),(0,Fi.registerVersion)(Xq,"1.0.2",t),(0,Fi.registerVersion)(Xq,"1.0.2","esm2017")}();const Fge=new us.Yd("@firebase/database-compat"),rG=function(t){Fge.warn("FIREBASE WARNING: "+t)};class Bge{constructor(e){this._delegate=e}cancel(e){(0,w.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,w.Wj)("OnDisconnect.cancel","onComplete",e,!0);const n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){(0,w.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,w.Wj)("OnDisconnect.remove","onComplete",e,!0);const n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){(0,w.Dv)("OnDisconnect.set",1,2,arguments.length),(0,w.Wj)("OnDisconnect.set","onComplete",n,!0);const r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){(0,w.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,w.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if((0,w.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,rG("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,w.Wj)("OnDisconnect.update","onComplete",n,!0);const r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}}class jge{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return(0,w.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class Al{constructor(e,n){this._database=e,this._delegate=n}val(){return(0,w.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,w.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,w.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,w.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,w.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),Sy("DataSnapshot.child","path",e,!1),new Al(this._database,this._delegate.child(e))}hasChild(e){return(0,w.Dv)("DataSnapshot.hasChild",1,1,arguments.length),Sy("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,w.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,w.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,w.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new Al(this._database,n)))}hasChildren(){return(0,w.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,w.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,w.Dv)("DataSnapshot.ref",0,0,arguments.length),new fs(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Ur{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;(0,w.Dv)("Query.on",2,4,arguments.length),(0,w.Wj)("Query.on","callback",n,!1);const o=Ur.getCancelAndContextArgs_("Query.on",r,i),a=(l,h)=>{n.call(o.context,new Al(this.database,l),h)};a.userCallback=n,a.context=o.context;const u=null===(s=o.cancel)||void 0===s?void 0:s.bind(o.context);switch(e){case"value":return WM(this._delegate,a,u),n;case"child_added":return G4(this._delegate,a,u),n;case"child_removed":return Q4(this._delegate,a,u),n;case"child_changed":return K4(this._delegate,a,u),n;case"child_moved":return Z4(this._delegate,a,u),n;default:throw new Error((0,w.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if((0,w.Dv)("Query.off",0,3,arguments.length),function(t,e,n){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,w.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,w.Wj)("Query.off","callback",n,!0),(0,w.lb)("Query.off","context",r,!0),n){const i=()=>{};i.userCallback=n,i.context=r,Y4(this._delegate,e,i)}else Y4(this._delegate,e)}get(){return Ype(this._delegate).then(e=>new Al(this.database,e))}once(e,n,r,i){(0,w.Dv)("Query.once",1,4,arguments.length),(0,w.Wj)("Query.once","callback",n,!0);const s=Ur.getCancelAndContextArgs_("Query.once",r,i),o=new w.BH,a=(l,h)=>{const p=new Al(this.database,l);n&&n.call(s.context,p,h),o.resolve(p)};a.userCallback=n,a.context=s.context;const u=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":WM(this._delegate,a,u,{onlyOnce:!0});break;case"child_added":G4(this._delegate,a,u,{onlyOnce:!0});break;case"child_removed":Q4(this._delegate,a,u,{onlyOnce:!0});break;case"child_changed":K4(this._delegate,a,u,{onlyOnce:!0});break;case"child_moved":Z4(this._delegate,a,u,{onlyOnce:!0});break;default:throw new Error((0,w.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return(0,w.Dv)("Query.limitToFirst",1,1,arguments.length),new Ur(this.database,vo(this._delegate,function sge(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new ige(t)}(e)))}limitToLast(e){return(0,w.Dv)("Query.limitToLast",1,1,arguments.length),new Ur(this.database,vo(this._delegate,function age(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new oge(t)}(e)))}orderByChild(e){return(0,w.Dv)("Query.orderByChild",1,1,arguments.length),new Ur(this.database,vo(this._delegate,function lge(t){if("$key"===t)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===t)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===t)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Sy("orderByChild","path",t,!1),new uge(t)}(e)))}orderByKey(){return(0,w.Dv)("Query.orderByKey",0,0,arguments.length),new Ur(this.database,vo(this._delegate,function dge(){return new cge}()))}orderByPriority(){return(0,w.Dv)("Query.orderByPriority",0,0,arguments.length),new Ur(this.database,vo(this._delegate,function fge(){return new hge}()))}orderByValue(){return(0,w.Dv)("Query.orderByValue",0,0,arguments.length),new Ur(this.database,vo(this._delegate,function gge(){return new pge}()))}startAt(e=null,n){return(0,w.Dv)("Query.startAt",0,2,arguments.length),new Ur(this.database,vo(this._delegate,function tge(t=null,e){return Cy("startAt","key",e,!0),new J4(t,e)}(e,n)))}startAfter(e=null,n){return(0,w.Dv)("Query.startAfter",0,2,arguments.length),new Ur(this.database,vo(this._delegate,function rge(t,e){return Cy("startAfter","key",e,!0),new nge(t,e)}(e,n)))}endAt(e=null,n){return(0,w.Dv)("Query.endAt",0,2,arguments.length),new Ur(this.database,vo(this._delegate,function Xpe(t,e){return Cy("endAt","key",e,!0),new X4(t,e)}(e,n)))}endBefore(e=null,n){return(0,w.Dv)("Query.endBefore",0,2,arguments.length),new Ur(this.database,vo(this._delegate,function ege(t,e){return Cy("endBefore","key",e,!0),new Jpe(t,e)}(e,n)))}equalTo(e,n){return(0,w.Dv)("Query.equalTo",1,2,arguments.length),new Ur(this.database,vo(this._delegate,function _ge(t,e){return Cy("equalTo","key",e,!0),new mge(t,e)}(e,n)))}toString(){return(0,w.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,w.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,w.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof Ur))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){const i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,(0,w.Wj)(e,"cancel",i.cancel,!0),i.context=r,(0,w.lb)(e,"context",i.context,!0);else if(n)if("object"==typeof n&&null!==n)i.context=n;else{if("function"!=typeof n)throw new Error((0,w.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=n}return i}get ref(){return new fs(this.database,new Us(this._delegate._repo,this._delegate._path))}}class fs extends Ur{constructor(e,n){super(e,new Hi(n._repo,n._path,new UT,!1)),this.database=e,this._delegate=n}getKey(){return(0,w.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,w.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new fs(this.database,dd(this._delegate,e))}getParent(){(0,w.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new fs(this.database,e):null}getRoot(){return(0,w.Dv)("Reference.root",0,0,arguments.length),new fs(this.database,this._delegate.root)}set(e,n){(0,w.Dv)("Reference.set",1,2,arguments.length),(0,w.Wj)("Reference.set","onComplete",n,!0);const r=qM(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if((0,w.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,rG("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Vs("Reference.update",this._delegate._path),(0,w.Wj)("Reference.update","onComplete",n,!0);const r=Qpe(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){(0,w.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,w.Wj)("Reference.setWithPriority","onComplete",r,!0);const i=function Zpe(t,e,n){if(Vs("setWithPriority",t._path),aa("setWithPriority",e,t._path,!1),LM("setWithPriority",n,!1),".length"===t.key||".keys"===t.key)throw"setWithPriority failed: "+t.key+" is a read-only object.";const r=new w.BH;return VM(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){(0,w.Dv)("Reference.remove",0,1,arguments.length),(0,w.Wj)("Reference.remove","onComplete",e,!0);const n=function Gpe(t){return Vs("remove",t._path),qM(t,null)}(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){(0,w.Dv)("Reference.transaction",1,3,arguments.length),(0,w.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,w.Wj)("Reference.transaction","onComplete",n,!0),function(t,e,n,r){if(void 0!==n&&"boolean"!=typeof n)throw new Error((0,w.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const i=function kge(t,e,n){var r;if(t=(0,w.m9)(t),Vs("Reference.transaction",t._path),".length"===t.key||".keys"===t.key)throw"Reference.transaction failed: "+t.key+" is a read-only object.";const i=null===(r=n?.applyLocally)||void 0===r||r,s=new w.BH,a=WM(t,()=>{});return function Upe(t,e,n,r,i,s){mp(t,"transaction on "+e);const o={path:e,update:n,onComplete:r,status:null,order:tW(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=BM(t,e,void 0);o.currentInputSnapshot=a;const u=o.update(a.val());if(void 0===u)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Ty("transaction failed: Data returned ",u,o.path),o.status=0;const l=nC(t.transactionQueueTree_,e),h=ld(l)||[];let p;h.push(o),xM(l,h),"object"==typeof u&&null!==u&&(0,w.r3)(u,".priority")?(p=(0,w.DV)(u,".priority"),(0,w.hu)(wy(p),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):p=(eC(t.serverSyncTree_,e)||Xe.EMPTY_NODE).getPriority().val();const m=Dy(t),_=bn(u,p),v=PM(_,a,m);o.currentOutputSnapshotRaw=_,o.currentOutputSnapshotResolved=v,o.currentWriteId=oC(t);const I=TM(t.serverSyncTree_,e,v,o.currentWriteId,o.applyLocally);hs(t.eventQueue_,e,I),aC(t,t.transactionQueueTree_)}}(t._repo,t._path,e,(u,l,h)=>{let p=null;u?s.reject(u):(p=new cd(h,new Us(t._repo,t._path),rn),s.resolve(new xge(l,p)))},a,i),s.promise}(this._delegate,e,{applyLocally:r}).then(s=>new jge(s.committed,new Al(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){(0,w.Dv)("Reference.setPriority",1,2,arguments.length),(0,w.Wj)("Reference.setPriority","onComplete",n,!0);const r=function Kpe(t,e){t=(0,w.m9)(t),Vs("setPriority",t._path),LM("setPriority",e,!1);const n=new w.BH;return VM(t._repo,vn(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){(0,w.Dv)("Reference.push",0,2,arguments.length),(0,w.Wj)("Reference.push","onComplete",n,!0);const r=function Wpe(t,e){t=(0,w.m9)(t),Vs("push",t._path),aa("push",e,t._path,!0);const n=x4(t._repo),r=qpe(n),i=dd(t,r),s=dd(t,r);let o;return o=null!=e?qM(s,e).then(()=>s):Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}(this._delegate,e),i=r.then(o=>new fs(this.database,o));n&&i.then(()=>n(null),o=>n(o));const s=new fs(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return Vs("Reference.onDisconnect",this._delegate._path),new Bge(new z4(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class Ry{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:Cge,forceLongPolling:Sge}}useEmulator(e,n,r={}){!function nG(t,e,n,r={}){(t=(0,w.m9)(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&ia("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&ia('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new oy(oy.OWNER);else if(r.mockUserToken){const o="string"==typeof r.mockUserToken?r.mockUserToken:(0,w.Sg)(r.mockUserToken,t.app.options.projectId);s=new oy(o)}!function vge(t,e,n,r){t.repoInfo_=new qN(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}(i,e,n,s)}(this._delegate,e,n,r)}ref(e){if((0,w.Dv)("database.ref",0,1,arguments.length),e instanceof fs){const n=W4(this._delegate,e.toString());return new fs(this,n)}{const n=q4(this._delegate,e);return new fs(this,n)}}refFromURL(e){(0,w.Dv)("database.refFromURL",1,1,arguments.length);const r=W4(this._delegate,e);return new fs(this,r)}goOffline(){return(0,w.Dv)("database.goOffline",0,0,arguments.length),function Dge(t){(t=(0,w.m9)(t))._checkNotDeleted("goOffline"),F4(t._repo)}(this._delegate)}goOnline(){return(0,w.Dv)("database.goOnline",0,0,arguments.length),function bge(t){(t=(0,w.m9)(t))._checkNotDeleted("goOnline"),function Vpe(t){t.persistentConnection_&&t.persistentConnection_.resume(M4)}(t._repo)}(this._delegate)}}Ry.ServerValue={TIMESTAMP:function Nge(){return Pge}(),increment:t=>function Mge(t){return{".sv":{increment:t}}}(t)};var Hge=Object.freeze({__proto__:null,initStandalone:function $ge({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){BN(n);const a=new co.H0("database-standalone"),u=new co.zt("auth-internal",a);let l;return u.setComponent(new co.wA("auth-internal",()=>r,"PRIVATE")),i&&(l=new co.zt("app-check-internal",a),l.setComponent(new co.wA("app-check-internal",()=>i,"PRIVATE"))),{instance:new Ry(KM(t,u,l,e,o),t),namespace:s}}});const zge=Ry.ServerValue;function Py(t,e,n="on",r=YI){return new qt(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),"once"===n&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),"on"===n?{unsubscribe(){null!=s&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(fe(i=>{const{snapshot:s,prevKey:o}=i;let a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),oB())}function iG(t){return null==t}function sG(t){return"function"==typeof t.set}function oG(t,e){return sG(e)?e:t.ref(e)}function aG(t,e){if(function Wge(t){return"string"==typeof t}(t))return e.stringCase();if(sG(t))return e.firebaseCase();if(function Gge(t){return"function"==typeof t.exportVal}(t))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof t)}function uG(t){return(iG(t)||0===t.length)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function lG(t,e,n){return hA(...(e=uG(e)).map(i=>Py(t,i,"on",n)))}function cG(t,e){return function(r,i){return aG(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function Yge(t){return function(n){return n?aG(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function dG(t,e){const n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function eme(t,e){const{payload:n,prevKey:r,key:i}=e,s=dG(t,i),o=function Jge(t,e){if(iG(e))return 0;{const n=dG(t,e);return-1===n?t.length:n+1}}(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(u=>{const l={payload:u,type:"value",prevKey:a,key:u.key};return a=u.key,t=[...t,l],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(u=>u.payload.key!==n.key)).splice(o,0,e);else{if(null==r)return[e,...t];(t=t.slice()).splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){const a=t.splice(s,1)[0];return(t=t.slice()).splice(o,0,a),t}return t;default:return t}}function hG(t,e,n){return function Xge(t,e,n){return Py(t,"value","once",n).pipe($n(r=>{const i=[Re(r)];return e.forEach(s=>i.push(Py(t,s,"on",n))),hA(...i).pipe(Gh(eme,[]))}),ZB())}(t,e=uG(e),n)}function fG(t,e){return function(){return Py(t,"value","on",e)}}!function qge(t){t.INTERNAL.registerComponent(new co.wA("database-compat",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new Ry(i,r)},"PUBLIC").setServiceProps({Reference:fs,Query:Ur,Database:Ry,DataSnapshot:Al,enableLogging:Age,INTERNAL:Hge,ServerValue:zge}).setMultipleInstances(!0)),t.registerVersion("@firebase/database-compat","1.0.2")}(Vi.Z);const rme=new ue("angularfire2.realtimeDatabaseURL"),ime=new ue("angularfire2.database.use-emulator");let sme=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,u,l,h,p,m,_,v,I,T){this.schedulers=a;const N=u,b=Vm(n,o,r);l&&EA(b,o,h,m,_,v,p,I),this.database=ew(`${b.name}.database.${i}`,"AngularFireDatabase",b.name,()=>{const k=o.runOutsideAngular(()=>b.database(i||void 0));return N&&k.useEmulator(...N),k},[N])}list(n,r){const i=this.schedulers.ngZone.runOutsideAngular(()=>oG(this.database,n));let s=i;return r&&(s=r(i)),function tme(t,e){const n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:cG(r,"update"),set:cG(r,"set"),push:i=>r.push(i),remove:Yge(r),snapshotChanges:i=>hG(t,i,n).pipe(Hn),stateChanges:i=>lG(t,i,n).pipe(Hn),auditTrail:i=>function Kge(t,e,n){return function Qge(t,e,n){return function Zge(t,e){return Py(t,"value","on",e).pipe(fe(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}(t,n).pipe(function Qde(...t){const e=Q2(t);return ge((n,r)=>{const i=t.length,s=new Array(i);let o=t.map(()=>!1),a=!1;for(let u=0;u<i;u++)os(t[u]).subscribe(Te(r,l=>{s[u]=l,!a&&!o[u]&&(o[u]=!0,(a=o.every(or))&&(o=null))},$r));n.subscribe(Te(r,u=>{if(a){const l=[u,...s];r.next(e?e(...l):l)}}))})}(e),fe(([i,s])=>{const o=i.lastKeyToLoad,a=s.map(u=>u.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),function Yde(t){return ge((e,n)=>{let r=!1,i=0;e.subscribe(Te(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}(i=>-1===i.loadedKeys.indexOf(i.lastKeyToLoad)),fe(i=>i.actions))}(t,lG(t,e).pipe(Gh((i,s)=>[...i,s],[])),n)}(t,i,n).pipe(Hn),valueChanges:(i,s)=>hG(t,i,n).pipe(fe(a=>a.map(u=>s&&s.idField?{...u.payload.val(),[s.idField]:u.key}:u.payload.val())),Hn)}}(s,this)}object(n){return function nme(t,e){return{query:t,snapshotChanges:()=>fG(t,e.schedulers.outsideAngular)().pipe(Hn),update:n=>t.ref.update(n),set:n=>t.ref.set(n),remove:()=>t.ref.remove(),valueChanges:()=>fG(t,e.schedulers.outsideAngular)().pipe(Hn,fe(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>oG(this.database,n)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(K(df),K(hf,8),K(rme,8),K(eo),K(ht),K(JI),K(ime,8),K(Um,8),K(pA,8),K(gA,8),K(mA,8),K(_A,8),K(yA,8),K(vA,8),K(XI,8))};static \u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),ome=(()=>{class t{constructor(){Vi.Z.registerVersion("angularfire",uf.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=_r({type:t});static \u0275inj=Ar({providers:[sme]})}return t})(),ame=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=Gr({type:t,selectors:[["app-home"]],decls:2,vars:0,template:function(r,i){1&r&&(Mt(0,"p"),Sn(1,"home works!"),Wt())}})}return t})(),pG=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=Gr({type:t,selectors:[["app-manage-products"]],decls:2,vars:0,template:function(r,i){1&r&&(Mt(0,"p"),Sn(1,"manage-products works!"),Wt())}})}return t})(),gG=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=Gr({type:t,selectors:[["app-my-orders"]],decls:2,vars:0,template:function(r,i){1&r&&(Mt(0,"p"),Sn(1,"my-orders works!"),Wt())}})}return t})(),ume=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=Gr({type:t,selectors:[["app-no-access"]],decls:2,vars:0,template:function(r,i){1&r&&(Mt(0,"p"),Sn(1,"no-access works!"),Wt())}})}return t})(),lme=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=Gr({type:t,selectors:[["app-shopping-cart"]],decls:2,vars:0,template:function(r,i){1&r&&(Mt(0,"p"),Sn(1,"shopping-cart works!"),Wt())}})}return t})(),cme=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=Gr({type:t,selectors:[["app-check-out"]],decls:2,vars:0,template:function(r,i){1&r&&(Mt(0,"p"),Sn(1,"check-out works!"),Wt())}})}return t})(),dme=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=Gr({type:t,selectors:[["app-order-success"]],decls:2,vars:0,template:function(r,i){1&r&&(Mt(0,"p"),Sn(1,"order-success works!"),Wt())}})}return t})(),hme=(()=>{class t{constructor(n,r,i){this.afAuth=n,this.router=r,this.afs=i}SetUserData(n){return this.afs.doc(`users/${n.uid}`).set({uid:n.uid,email:n.email,displayName:n.displayName,photoURL:n.photoURL,emailVerified:n.emailVerified},{merge:!0})}GoogleAuth(){return this.AuthLogin(new Vi.Z.auth.GoogleAuthProvider)}AuthLogin(n){return this.afAuth.signInWithPopup(n).then(r=>{this.router.navigate(["/shopping-cart"]),console.log("You have been successfully logged in!")}).catch(r=>{console.log(r)})}static#e=this.\u0275fac=function(r){return new(r||t)(K(Um),K(ks),K(Yq))};static#t=this.\u0275prov=Ie({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),mG=(()=>{class t{constructor(n){this.AuthService=n}signInWithGoogle(){this.AuthService.GoogleAuth()}static#e=this.\u0275fac=function(r){return new(r||t)(Oe(hme))};static#t=this.\u0275cmp=Gr({type:t,selectors:[["app-login"]],decls:25,vars:0,consts:[[1,"container"],[1,"row"],[1,"col-sm-9","col-md-7","col-lg-5","mx-auto"],[1,"card","border-0","shadow","rounded-3","my-5"],[1,"card-body","p-4","p-sm-5"],[1,"card-title","text-center","mb-5","fw-light","fs-5"],[1,"form-floating","mb-3"],["type","email","id","floatingInput","placeholder","name@example.com",1,"form-control"],["for","floatingInput"],["type","password","id","floatingPassword","placeholder","Password",1,"form-control"],["for","floatingPassword"],[1,"d-grid"],["type","submit",1,"btn","btn-primary","btn-login","text-uppercase","fw-bold"],[1,"my-4"],[1,"d-grid","mb-2"],[1,"btn","btn-google","btn-login","text-uppercase","fw-bold",3,"click"],["src","../../../assets/google.png","alt","","height","24px","width","24px"]],template:function(r,i){1&r&&(Mt(0,"body")(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"h5",5),Sn(7,"Login"),Wt(),Mt(8,"form")(9,"div",6),io(10,"input",7),Mt(11,"label",8),Sn(12,"Email address"),Wt()(),Mt(13,"div",6),io(14,"input",9),Mt(15,"label",10),Sn(16,"Password"),Wt()(),Mt(17,"div",11)(18,"button",12),Sn(19,"Sign in"),Wt()(),io(20,"hr",13),Mt(21,"div",14)(22,"button",15),HE("click",function(){return i.signInWithGoogle()}),io(23,"img",16),Sn(24," sign In With Google "),Wt()()()()()()()()())},styles:[".container[_ngcontent-%COMP%]{padding-top:5%}.btn-login[_ngcontent-%COMP%]{font-size:.9rem;letter-spacing:.05rem;padding:.75rem 1rem}.btn-google[_ngcontent-%COMP%]{color:#fff!important;background-color:#ea4335}.btn-facebook[_ngcontent-%COMP%]{color:#fff!important;background-color:#3b5998}"]})}return t})();const fme=[{path:"",component:ame},{path:"shopping-cart",component:lme},{path:"check-out",component:cme},{path:"order-success",component:dme},{path:"manage-products",component:pG},{path:"my-orders",component:gG},{path:"login",component:mG},{path:"manage-products",component:pG},{path:"my-orders",component:gG},{path:"login",component:mG},{path:"admin/products",component:(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=Gr({type:t,selectors:[["app-admin-products"]],decls:2,vars:0,template:function(r,i){1&r&&(Mt(0,"p"),Sn(1,"admin-products works!"),Wt())}})}return t})()},{path:"admin/orders",component:(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=Gr({type:t,selectors:[["app-admin-orders"]],decls:2,vars:0,template:function(r,i){1&r&&(Mt(0,"p"),Sn(1,"admin-orders works!"),Wt())}})}return t})()},{path:"no-access",component:ume},{path:"**",redirectTo:""}];let pme=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=_r({type:t});static#n=this.\u0275inj=Ar({imports:[cA.forRoot(fme),cA]})}return t})();const ZM=()=>["active"];let gme=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=Gr({type:t,selectors:[["navbar"]],decls:33,vars:6,consts:[["data-bs-theme","bg-primary ",1,"navbar","bg-light","border-bottom","border-body"],["routerLink","/",1,"navbar-brand"],["src","/assets/logo.png","width","50","height","50","routerLink","/",1,"bi","me-2","rounded-circle",3,"routerLinkActive"],[1,"nav","nav-tabs","navflex"],[1,"nav-item","nav-item2"],["aria-current","page","routerLink","/shopping-cart",1,"nav-link",3,"routerLinkActive"],[1,"nav-item"],["aria-current","page","routerLink","/login",1,"nav-link",3,"routerLinkActive"],["role","search",1,"d-flex"],["type","search","placeholder","Search Product \u{1f6d2}","aria-label","Search",1,"form-control","me-2"],["type","submit",1,"btn","btn-outline-success"],[1,"drop"],[1,"nav-item","dropdown"],["data-bs-toggle","dropdown","role","button","aria-expanded","true",1,"nav-link","dropdown-toggle","drop"],[1,"dropdown-menu"],["routerLink","/my-orders",1,"dropdown-item"],["routerLink","/admin/orders",1,"dropdown-item"],["routerLink","/admin/products",1,"dropdown-item"],[1,"dropdown-divider"],["href","#",1,"dropdown-item"]],template:function(r,i){1&r&&(Mt(0,"nav",0)(1,"a",1),io(2,"img",2),Wt(),Mt(3,"ul",3)(4,"li",4)(5,"a",5),Sn(6,"shopping cart"),Wt()(),Mt(7,"li",6)(8,"a",7),Sn(9,"Login"),Wt()(),Mt(10,"form",8),io(11,"input",9),Mt(12,"button",10),Sn(13,"Search"),Wt()(),Mt(14,"div",11)(15,"li",12)(16,"a",13),Sn(17,"Username"),Wt(),Mt(18,"ul",14)(19,"li")(20,"a",15),Sn(21,"my-orders"),Wt()(),Mt(22,"li")(23,"a",16),Sn(24,"manage Orders"),Wt()(),Mt(25,"li")(26,"a",17),Sn(27,"manage Products"),Wt()(),Mt(28,"li"),io(29,"hr",18),Wt(),Mt(30,"li")(31,"a",19),Sn(32,"logout"),Wt()()()()()()()),2&r&&(_E(2),jg("routerLinkActive",WE(3,ZM)),_E(3),jg("routerLinkActive",WE(4,ZM)),_E(3),jg("routerLinkActive",WE(5,ZM)))},dependencies:[ZI,qU]})}return t})(),mme=(()=>{class t{constructor(){this.title="e-shop"}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=Gr({type:t,selectors:[["app-root"]],decls:2,vars:0,template:function(r,i){1&r&&io(0,"navbar")(1,"router-outlet")},dependencies:[Xb,gme]})}return t})(),_me=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=_r({type:t,bootstrap:[mme]});static#n=this.\u0275inj=Ar({imports:[JV,pme,Jee,cA,Iie.initializeApp(tie_firebaseConfig),Die,Zde,moe,ome]})}return t})();YX().bootstrapModule(_me).catch(t=>console.error(t))},106:($s,nr,We)=>{We.d(nr,{Z:()=>On});var C=We(58),Ee=We(537),U=We(534),Le=We(879);class on{constructor(Ze,nt){this._delegate=Ze,this.firebase=nt,(0,U._addComponent)(Ze,new Ee.wA("app-compat",()=>this,"PUBLIC")),this.container=Ze.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Ze){this._delegate.automaticDataCollectionEnabled=Ze}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(Ze=>{this._delegate.checkDestroyed(),Ze()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,U.deleteApp)(this._delegate)))}_getService(Ze,nt=U._DEFAULT_ENTRY_NAME){var Ln;this._delegate.checkDestroyed();const pr=this._delegate.container.getProvider(Ze);return!pr.isInitialized()&&"EXPLICIT"===(null===(Ln=pr.getComponent())||void 0===Ln?void 0:Ln.instantiationMode)&&pr.initialize(),pr.getImmediate({identifier:nt})}_removeServiceInstance(Ze,nt=U._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(Ze).clearInstance(nt)}_addComponent(Ze){(0,U._addComponent)(this._delegate,Ze)}_addOrOverwriteComponent(Ze){(0,U._addOrOverwriteComponent)(this._delegate,Ze)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Rn=new C.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),X=function Tt(){const Ct=function rr(Ct){const Ze={},nt={__esModule:!0,initializeApp:function zt(rt,ir={}){const Y=U.initializeApp(rt,ir);if((0,C.r3)(Ze,Y.name))return Ze[Y.name];const fn=new Ct(Y,nt);return Ze[Y.name]=fn,fn},app:pr,registerVersion:U.registerVersion,setLogLevel:U.setLogLevel,onLog:U.onLog,apps:null,SDK_VERSION:U.SDK_VERSION,INTERNAL:{registerComponent:function St(rt){const ir=rt.name,Y=ir.replace("-compat","");if(U._registerComponent(rt)&&"PUBLIC"===rt.type){const fn=(pn=pr())=>{if("function"!=typeof pn[Y])throw Rn.create("invalid-app-argument",{appName:ir});return pn[Y]()};void 0!==rt.serviceProps&&(0,C.ZB)(fn,rt.serviceProps),nt[Y]=fn,Ct.prototype[Y]=function(...pn){return this._getService.bind(this,ir).apply(this,rt.multipleInstances?pn:[])}}return"PUBLIC"===rt.type?nt[Y]:null},removeApp:function Ln(rt){delete Ze[rt]},useAsService:function br(rt,ir){return"serverAuth"===ir?null:ir},modularAPIs:U}};function pr(rt){if(!(0,C.r3)(Ze,rt=rt||U._DEFAULT_ENTRY_NAME))throw Rn.create("no-app",{appName:rt});return Ze[rt]}return nt.default=nt,Object.defineProperty(nt,"apps",{get:function mt(){return Object.keys(Ze).map(rt=>Ze[rt])}}),pr.App=Ct,nt}(on);return Ct.INTERNAL=Object.assign(Object.assign({},Ct.INTERNAL),{createFirebaseNamespace:Tt,extendNamespace:function Ze(nt){(0,C.ZB)(Ct,nt)},createSubscribe:C.ne,ErrorFactory:C.LL,deepExtend:C.ZB}),Ct}(),re=new Le.Yd("@firebase/app-compat");if((0,C.jU)()&&void 0!==self.firebase){re.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Ct=self.firebase.SDK_VERSION;Ct&&Ct.indexOf("LITE")>=0&&re.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const On=X;!function pt(Ct){(0,U.registerVersion)("@firebase/app-compat","0.2.25",Ct)}()},534:($s,nr,We)=>{We.r(nr),We.d(nr,{FirebaseError:()=>Le.ZR,SDK_VERSION:()=>vs,_DEFAULT_ENTRY_NAME:()=>$r,_addComponent:()=>ms,_addOrOverwriteComponent:()=>zr,_apps:()=>Hr,_clearComponents:()=>ys,_components:()=>Ws,_getProvider:()=>Eo,_registerComponent:()=>_s,_removeServiceInstance:()=>Gs,deleteApp:()=>zi,getApp:()=>ru,getApps:()=>iu,initializeApp:()=>nu,onLog:()=>ca,registerVersion:()=>Io,setLogLevel:()=>qt});var C=We(861),Ee=We(537),U=We(879),Le=We(58);const on=(j,R)=>R.some(te=>j instanceof te);let $e,Rn;const X=new WeakMap,re=new WeakMap,we=new WeakMap,et=new WeakMap,pt=new WeakMap;let Ze={get(j,R,te){if(j instanceof IDBTransaction){if("done"===R)return re.get(j);if("objectStoreNames"===R)return j.objectStoreNames||we.get(j);if("store"===R)return te.objectStoreNames[1]?void 0:te.objectStore(te.objectStoreNames[0])}return zt(j[R])},set:(j,R,te)=>(j[R]=te,!0),has:(j,R)=>j instanceof IDBTransaction&&("done"===R||"store"===R)||R in j};function pr(j){return"function"==typeof j?function Ln(j){return j!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Tt(){return Rn||(Rn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(j)?function(...R){return j.apply(mt(this),R),zt(X.get(this))}:function(...R){return zt(j.apply(mt(this),R))}:function(R,...te){const ye=j.call(mt(this),R,...te);return we.set(ye,R.sort?R.sort():[R]),zt(ye)}}(j):(j instanceof IDBTransaction&&function Ct(j){if(re.has(j))return;const R=new Promise((te,ye)=>{const He=()=>{j.removeEventListener("complete",it),j.removeEventListener("error",L),j.removeEventListener("abort",L)},it=()=>{te(),He()},L=()=>{ye(j.error||new DOMException("AbortError","AbortError")),He()};j.addEventListener("complete",it),j.addEventListener("error",L),j.addEventListener("abort",L)});re.set(j,R)}(j),on(j,function rr(){return $e||($e=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(j,Ze):j)}function zt(j){if(j instanceof IDBRequest)return function On(j){const R=new Promise((te,ye)=>{const He=()=>{j.removeEventListener("success",it),j.removeEventListener("error",L)},it=()=>{te(zt(j.result)),He()},L=()=>{ye(j.error),He()};j.addEventListener("success",it),j.addEventListener("error",L)});return R.then(te=>{te instanceof IDBCursor&&X.set(te,j)}).catch(()=>{}),pt.set(R,j),R}(j);if(et.has(j))return et.get(j);const R=pr(j);return R!==j&&(et.set(j,R),pt.set(R,j)),R}const mt=j=>pt.get(j),rt=["get","getKey","getAll","getAllKeys","count"],ir=["put","add","delete","clear"],Y=new Map;function fn(j,R){if(!(j instanceof IDBDatabase)||R in j||"string"!=typeof R)return;if(Y.get(R))return Y.get(R);const te=R.replace(/FromIndex$/,""),ye=R!==te,He=ir.includes(te);if(!(te in(ye?IDBIndex:IDBObjectStore).prototype)||!He&&!rt.includes(te))return;const it=function(){var L=(0,C.Z)(function*(Zt,...Vt){const Wi=this.transaction(Zt,He?"readwrite":"readonly");let wo=Wi.store;return ye&&(wo=wo.index(Vt.shift())),(yield Promise.all([wo[te](...Vt),He&&Wi.done]))[0]});return function(Vt){return L.apply(this,arguments)}}();return Y.set(R,it),it}!function nt(j){Ze=j(Ze)}(j=>({...j,get:(R,te,ye)=>fn(R,te)||j.get(R,te,ye),has:(R,te)=>!!fn(R,te)||j.has(R,te)}));class pn{constructor(R){this.container=R}getPlatformInfoString(){return this.container.getProviders().map(te=>{if(function bi(j){const R=j.getComponent();return"VERSION"===R?.type}(te)){const ye=te.getImmediate();return`${ye.library}/${ye.version}`}return null}).filter(te=>te).join(" ")}}const Hs="@firebase/app",jr=new U.Yd("@firebase/app"),$r="[DEFAULT]",Pl={[Hs]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Hr=new Map,Ws=new Map;function ms(j,R){try{j.container.addComponent(R)}catch(te){jr.debug(`Component ${R.name} failed to register with FirebaseApp ${j.name}`,te)}}function zr(j,R){j.container.addOrOverwriteComponent(R)}function _s(j){const R=j.name;if(Ws.has(R))return jr.debug(`There were multiple attempts to register component ${R}.`),!1;Ws.set(R,j);for(const te of Hr.values())ms(te,j);return!0}function Eo(j,R){const te=j.container.getProvider("heartbeat").getImmediate({optional:!0});return te&&te.triggerHeartbeat(),j.container.getProvider(R)}function Gs(j,R,te=$r){Eo(j,R).clearInstance(te)}function ys(){Ws.clear()}const ci=new Le.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class sr{constructor(R,te,ye){this._isDeleted=!1,this._options=Object.assign({},R),this._config=Object.assign({},te),this._name=te.name,this._automaticDataCollectionEnabled=te.automaticDataCollectionEnabled,this._container=ye,this.container.addComponent(new Ee.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(R){this.checkDestroyed(),this._automaticDataCollectionEnabled=R}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(R){this._isDeleted=R}checkDestroyed(){if(this.isDeleted)throw ci.create("app-deleted",{appName:this._name})}}const vs="10.7.1";function nu(j,R={}){let te=j;"object"!=typeof R&&(R={name:R});const ye=Object.assign({name:$r,automaticDataCollectionEnabled:!1},R),He=ye.name;if("string"!=typeof He||!He)throw ci.create("bad-app-name",{appName:String(He)});if(te||(te=(0,Le.aH)()),!te)throw ci.create("no-options");const it=Hr.get(He);if(it){if((0,Le.vZ)(te,it.options)&&(0,Le.vZ)(ye,it.config))return it;throw ci.create("duplicate-app",{appName:He})}const L=new Ee.H0(He);for(const Vt of Ws.values())L.addComponent(Vt);const Zt=new sr(te,ye,L);return Hr.set(He,Zt),Zt}function ru(j=$r){const R=Hr.get(j);if(!R&&j===$r&&(0,Le.aH)())return nu();if(!R)throw ci.create("no-app",{appName:j});return R}function iu(){return Array.from(Hr.values())}function zi(j){return or.apply(this,arguments)}function or(){return(or=(0,C.Z)(function*(j){const R=j.name;Hr.has(R)&&(Hr.delete(R),yield Promise.all(j.container.getProviders().map(te=>te.delete())),j.isDeleted=!0)})).apply(this,arguments)}function Io(j,R,te){var ye;let He=null!==(ye=Pl[j])&&void 0!==ye?ye:j;te&&(He+=`-${te}`);const it=He.match(/\s|\//),L=R.match(/\s|\//);if(it||L){const Zt=[`Unable to register library "${He}" with version "${R}":`];return it&&Zt.push(`library name "${He}" contains illegal characters (whitespace or "/")`),it&&L&&Zt.push("and"),L&&Zt.push(`version name "${R}" contains illegal characters (whitespace or "/")`),void jr.warn(Zt.join(" "))}_s(new Ee.wA(`${He}-version`,()=>({library:He,version:R}),"VERSION"))}function ca(j,R){if(null!==j&&"function"!=typeof j)throw ci.create("invalid-log-argument");(0,U.Am)(j,R)}function qt(j){(0,U.Ub)(j)}const su="firebase-heartbeat-database",Nl=1,A="firebase-heartbeat-store";let S=null;function P(){return S||(S=function St(j,R,{blocked:te,upgrade:ye,blocking:He,terminated:it}={}){const L=indexedDB.open(j,R),Zt=zt(L);return ye&&L.addEventListener("upgradeneeded",Vt=>{ye(zt(L.result),Vt.oldVersion,Vt.newVersion,zt(L.transaction),Vt)}),te&&L.addEventListener("blocked",Vt=>te(Vt.oldVersion,Vt.newVersion,Vt)),Zt.then(Vt=>{it&&Vt.addEventListener("close",()=>it()),He&&Vt.addEventListener("versionchange",Wi=>He(Wi.oldVersion,Wi.newVersion,Wi))}).catch(()=>{}),Zt}(su,Nl,{upgrade:(j,R)=>{0===R&&j.createObjectStore(A)}}).catch(j=>{throw ci.create("idb-open",{originalErrorMessage:j.message})})),S}function x(){return(x=(0,C.Z)(function*(j){try{return yield(yield P()).transaction(A).objectStore(A).get(Te(j))}catch(R){if(R instanceof Le.ZR)jr.warn(R.message);else{const te=ci.create("idb-get",{originalErrorMessage:R?.message});jr.warn(te.message)}}})).apply(this,arguments)}function he(j,R){return ge.apply(this,arguments)}function ge(){return(ge=(0,C.Z)(function*(j,R){try{const ye=(yield P()).transaction(A,"readwrite");yield ye.objectStore(A).put(R,Te(j)),yield ye.done}catch(te){if(te instanceof Le.ZR)jr.warn(te.message);else{const ye=ci.create("idb-set",{originalErrorMessage:te?.message});jr.warn(ye.message)}}})).apply(this,arguments)}function Te(j){return`${j.name}!${j.options.appId}`}class Ue{constructor(R){this.container=R,this._heartbeatsCache=null;const te=this.container.getProvider("app").getImmediate();this._storage=new qi(te),this._heartbeatsCachePromise=this._storage.read().then(ye=>(this._heartbeatsCache=ye,ye))}triggerHeartbeat(){var R=this;return(0,C.Z)(function*(){var te,ye;const it=R.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),L=Qe();if((null!=(null===(te=R._heartbeatsCache)||void 0===te?void 0:te.heartbeats)||(R._heartbeatsCache=yield R._heartbeatsCachePromise,null!=(null===(ye=R._heartbeatsCache)||void 0===ye?void 0:ye.heartbeats)))&&R._heartbeatsCache.lastSentHeartbeatDate!==L&&!R._heartbeatsCache.heartbeats.some(Zt=>Zt.date===L))return R._heartbeatsCache.heartbeats.push({date:L,agent:it}),R._heartbeatsCache.heartbeats=R._heartbeatsCache.heartbeats.filter(Zt=>{const Vt=new Date(Zt.date).valueOf();return Date.now()-Vt<=2592e6}),R._storage.overwrite(R._heartbeatsCache)})()}getHeartbeatsHeader(){var R=this;return(0,C.Z)(function*(){var te;if(null===R._heartbeatsCache&&(yield R._heartbeatsCachePromise),null==(null===(te=R._heartbeatsCache)||void 0===te?void 0:te.heartbeats)||0===R._heartbeatsCache.heartbeats.length)return"";const ye=Qe(),{heartbeatsToSend:He,unsentEntries:it}=function gt(j,R=1024){const te=[];let ye=j.slice();for(const He of j){const it=te.find(L=>L.agent===He.agent);if(it){if(it.dates.push(He.date),da(te)>R){it.dates.pop();break}}else if(te.push({agent:He.agent,dates:[He.date]}),da(te)>R){te.pop();break}ye=ye.slice(1)}return{heartbeatsToSend:te,unsentEntries:ye}}(R._heartbeatsCache.heartbeats),L=(0,Le.L)(JSON.stringify({version:2,heartbeats:He}));return R._heartbeatsCache.lastSentHeartbeatDate=ye,it.length>0?(R._heartbeatsCache.heartbeats=it,yield R._storage.overwrite(R._heartbeatsCache)):(R._heartbeatsCache.heartbeats=[],R._storage.overwrite(R._heartbeatsCache)),L})()}}function Qe(){return(new Date).toISOString().substring(0,10)}class qi{constructor(R){this.app=R,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,C.Z)(function*(){return!!(0,Le.hl)()&&(0,Le.eu)().then(()=>!0).catch(()=>!1)})()}read(){var R=this;return(0,C.Z)(function*(){if(yield R._canUseIndexedDBPromise){const ye=yield function G(j){return x.apply(this,arguments)}(R.app);return ye?.heartbeats?ye:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(R){var te=this;return(0,C.Z)(function*(){var ye;if(yield te._canUseIndexedDBPromise){const it=yield te.read();return he(te.app,{lastSentHeartbeatDate:null!==(ye=R.lastSentHeartbeatDate)&&void 0!==ye?ye:it.lastSentHeartbeatDate,heartbeats:R.heartbeats})}})()}add(R){var te=this;return(0,C.Z)(function*(){var ye;if(yield te._canUseIndexedDBPromise){const it=yield te.read();return he(te.app,{lastSentHeartbeatDate:null!==(ye=R.lastSentHeartbeatDate)&&void 0!==ye?ye:it.lastSentHeartbeatDate,heartbeats:[...it.heartbeats,...R.heartbeats]})}})()}}function da(j){return(0,Le.L)(JSON.stringify({version:2,heartbeats:j})).length}!function pd(j){_s(new Ee.wA("platform-logger",R=>new pn(R),"PRIVATE")),_s(new Ee.wA("heartbeat",R=>new Ue(R),"PRIVATE")),Io(Hs,"0.9.25",j),Io(Hs,"0.9.25","esm2017"),Io("fire-js","")}("")},537:($s,nr,We)=>{We.d(nr,{H0:()=>rr,wA:()=>U,zt:()=>on});var C=We(861),Ee=We(58);class U{constructor(X,re,we){this.name=X,this.instanceFactory=re,this.type=we,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(X){return this.instantiationMode=X,this}setMultipleInstances(X){return this.multipleInstances=X,this}setServiceProps(X){return this.serviceProps=X,this}setInstanceCreatedCallback(X){return this.onInstanceCreated=X,this}}const Le="[DEFAULT]";class on{constructor(X,re){this.name=X,this.container=re,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(X){const re=this.normalizeInstanceIdentifier(X);if(!this.instancesDeferred.has(re)){const we=new Ee.BH;if(this.instancesDeferred.set(re,we),this.isInitialized(re)||this.shouldAutoInitialize())try{const et=this.getOrInitializeService({instanceIdentifier:re});et&&we.resolve(et)}catch{}}return this.instancesDeferred.get(re).promise}getImmediate(X){var re;const we=this.normalizeInstanceIdentifier(X?.identifier),et=null!==(re=X?.optional)&&void 0!==re&&re;if(!this.isInitialized(we)&&!this.shouldAutoInitialize()){if(et)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:we})}catch(pt){if(et)return null;throw pt}}getComponent(){return this.component}setComponent(X){if(X.name!==this.name)throw Error(`Mismatching Component ${X.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=X,this.shouldAutoInitialize()){if(function Rn(Tt){return"EAGER"===Tt.instantiationMode}(X))try{this.getOrInitializeService({instanceIdentifier:Le})}catch{}for(const[re,we]of this.instancesDeferred.entries()){const et=this.normalizeInstanceIdentifier(re);try{const pt=this.getOrInitializeService({instanceIdentifier:et});we.resolve(pt)}catch{}}}}clearInstance(X=Le){this.instancesDeferred.delete(X),this.instancesOptions.delete(X),this.instances.delete(X)}delete(){var X=this;return(0,C.Z)(function*(){const re=Array.from(X.instances.values());yield Promise.all([...re.filter(we=>"INTERNAL"in we).map(we=>we.INTERNAL.delete()),...re.filter(we=>"_delete"in we).map(we=>we._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(X=Le){return this.instances.has(X)}getOptions(X=Le){return this.instancesOptions.get(X)||{}}initialize(X={}){const{options:re={}}=X,we=this.normalizeInstanceIdentifier(X.instanceIdentifier);if(this.isInitialized(we))throw Error(`${this.name}(${we}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const et=this.getOrInitializeService({instanceIdentifier:we,options:re});for(const[pt,On]of this.instancesDeferred.entries())we===this.normalizeInstanceIdentifier(pt)&&On.resolve(et);return et}onInit(X,re){var we;const et=this.normalizeInstanceIdentifier(re),pt=null!==(we=this.onInitCallbacks.get(et))&&void 0!==we?we:new Set;pt.add(X),this.onInitCallbacks.set(et,pt);const On=this.instances.get(et);return On&&X(On,et),()=>{pt.delete(X)}}invokeOnInitCallbacks(X,re){const we=this.onInitCallbacks.get(re);if(we)for(const et of we)try{et(X,re)}catch{}}getOrInitializeService({instanceIdentifier:X,options:re={}}){let we=this.instances.get(X);if(!we&&this.component&&(we=this.component.instanceFactory(this.container,{instanceIdentifier:(Tt=X,Tt===Le?void 0:Tt),options:re}),this.instances.set(X,we),this.instancesOptions.set(X,re),this.invokeOnInitCallbacks(we,X),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,X,we)}catch{}var Tt;return we||null}normalizeInstanceIdentifier(X=Le){return this.component?this.component.multipleInstances?X:Le:X}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class rr{constructor(X){this.name=X,this.providers=new Map}addComponent(X){const re=this.getProvider(X.name);if(re.isComponentSet())throw new Error(`Component ${X.name} has already been registered with ${this.name}`);re.setComponent(X)}addOrOverwriteComponent(X){this.getProvider(X.name).isComponentSet()&&this.providers.delete(X.name),this.addComponent(X)}getProvider(X){if(this.providers.has(X))return this.providers.get(X);const re=new on(X,this);return this.providers.set(X,re),re}getProviders(){return Array.from(this.providers.values())}}},879:($s,nr,We)=>{We.d(nr,{Am:()=>Tt,Ub:()=>rr,Yd:()=>Rn,in:()=>Ee});const C=[];var Ee=function(X){return X[X.DEBUG=0]="DEBUG",X[X.VERBOSE=1]="VERBOSE",X[X.INFO=2]="INFO",X[X.WARN=3]="WARN",X[X.ERROR=4]="ERROR",X[X.SILENT=5]="SILENT",X}(Ee||{});const U={debug:Ee.DEBUG,verbose:Ee.VERBOSE,info:Ee.INFO,warn:Ee.WARN,error:Ee.ERROR,silent:Ee.SILENT},Le=Ee.INFO,on={[Ee.DEBUG]:"log",[Ee.VERBOSE]:"log",[Ee.INFO]:"info",[Ee.WARN]:"warn",[Ee.ERROR]:"error"},$e=(X,re,...we)=>{if(re<X.logLevel)return;const et=(new Date).toISOString(),pt=on[re];if(!pt)throw new Error(`Attempted to log a message with an invalid logType (value: ${re})`);console[pt](`[${et}]  ${X.name}:`,...we)};class Rn{constructor(re){this.name=re,this._logLevel=Le,this._logHandler=$e,this._userLogHandler=null,C.push(this)}get logLevel(){return this._logLevel}set logLevel(re){if(!(re in Ee))throw new TypeError(`Invalid value "${re}" assigned to \`logLevel\``);this._logLevel=re}setLogLevel(re){this._logLevel="string"==typeof re?U[re]:re}get logHandler(){return this._logHandler}set logHandler(re){if("function"!=typeof re)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=re}get userLogHandler(){return this._userLogHandler}set userLogHandler(re){this._userLogHandler=re}debug(...re){this._userLogHandler&&this._userLogHandler(this,Ee.DEBUG,...re),this._logHandler(this,Ee.DEBUG,...re)}log(...re){this._userLogHandler&&this._userLogHandler(this,Ee.VERBOSE,...re),this._logHandler(this,Ee.VERBOSE,...re)}info(...re){this._userLogHandler&&this._userLogHandler(this,Ee.INFO,...re),this._logHandler(this,Ee.INFO,...re)}warn(...re){this._userLogHandler&&this._userLogHandler(this,Ee.WARN,...re),this._logHandler(this,Ee.WARN,...re)}error(...re){this._userLogHandler&&this._userLogHandler(this,Ee.ERROR,...re),this._logHandler(this,Ee.ERROR,...re)}}function rr(X){C.forEach(re=>{re.setLogLevel(X)})}function Tt(X,re){for(const we of C){let et=null;re&&re.level&&(et=U[re.level]),we.userLogHandler=null===X?null:(pt,On,...Ct)=>{const Ze=Ct.map(nt=>{if(null==nt)return null;if("string"==typeof nt)return nt;if("number"==typeof nt||"boolean"==typeof nt)return nt.toString();if(nt instanceof Error)return nt.message;try{return JSON.stringify(nt)}catch{return null}}).filter(nt=>nt).join(" ");On>=(et??pt.logLevel)&&X({level:Ee[On].toLowerCase(),message:Ze,args:Ct,type:pt.name})}}}},230:($s,nr,We)=>{We.r(nr);var C=We(861),Ee=We(106),U=We(58),Le=We(534),on=We(879),$e=We(582),Rn=We(537);const Tt={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};const On=function et(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},Ct=function pt(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Ze=new U.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Ln=new on.Yd("@firebase/auth");function zt(f,...c){Ln.logLevel<=on.in.ERROR&&Ln.error(`Auth (${Le.SDK_VERSION}): ${f}`,...c)}function mt(f,...c){throw ir(f,...c)}function St(f,...c){return ir(f,...c)}function br(f,c,d){const g=Object.assign(Object.assign({},Ct()),{[c]:d});return new U.LL("auth","Firebase",g).create(c,{appName:f.name})}function rt(f,c,d){if(!(c instanceof d))throw d.name!==c.constructor.name&&mt(f,"argument-error"),br(f,"argument-error",`Type of ${c.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ir(f,...c){if("string"!=typeof f){const d=c[0],g=[...c.slice(1)];return g[0]&&(g[0].appName=f.name),f._errorFactory.create(d,...g)}return Ze.create(f,...c)}function Y(f,c,...d){if(!f)throw ir(c,...d)}function fn(f){const c="INTERNAL ASSERTION FAILED: "+f;throw zt(c),new Error(c)}function pn(f,c){f||fn(c)}function bi(){var f;return typeof self<"u"&&(null===(f=self.location)||void 0===f?void 0:f.href)||""}function Hs(){return"http:"===gs()||"https:"===gs()}function gs(){var f;return typeof self<"u"&&(null===(f=self.location)||void 0===f?void 0:f.protocol)||null}class Ai{constructor(c,d){this.shortDelay=c,this.longDelay=d,pn(d>c,"Short delay should be less than long delay!"),this.isMobile=(0,U.uI)()||(0,U.b$)()}get(){return function jr(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Hs()||(0,U.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function F(f,c){pn(f.emulator,"Emulator should always be set here");const{url:d}=f.emulator;return c?`${d}${c.startsWith("/")?c.slice(1):c}`:d}class B{static initialize(c,d,g){this.fetchImpl=c,d&&(this.headersImpl=d),g&&(this.responseImpl=g)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void fn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void fn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void fn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Z={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},W=new Ai(3e4,6e4);function J(f,c){return f.tenantId&&!c.tenantId?Object.assign(Object.assign({},c),{tenantId:f.tenantId}):c}function Q(f,c,d,g){return Pe.apply(this,arguments)}function Pe(){return(Pe=(0,C.Z)(function*(f,c,d,g,y={}){return ut(f,y,(0,C.Z)(function*(){let E={},D={};g&&("GET"===c?D=g:E={body:JSON.stringify(g)});const M=(0,U.xO)(Object.assign({key:f.config.apiKey},D)).slice(1),z=yield f._getAdditionalHeaders();return z["Content-Type"]="application/json",f.languageCode&&(z["X-Firebase-Locale"]=f.languageCode),B.fetch()(In(f,f.config.apiHost,d,M),Object.assign({method:c,headers:z,referrerPolicy:"no-referrer"},E))}))})).apply(this,arguments)}function ut(f,c,d){return En.apply(this,arguments)}function En(){return(En=(0,C.Z)(function*(f,c,d){f._canInitEmulator=!1;const g=Object.assign(Object.assign({},Z),c);try{const y=new Wn(f),E=yield Promise.race([d(),y.promise]);y.clearNetworkTimeout();const D=yield E.json();if("needConfirmation"in D)throw Pn(f,"account-exists-with-different-credential",D);if(E.ok&&!("errorMessage"in D))return D;{const M=E.ok?D.errorMessage:D.error.message,[z,ae]=M.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===z)throw Pn(f,"credential-already-in-use",D);if("EMAIL_EXISTS"===z)throw Pn(f,"email-already-in-use",D);if("USER_DISABLED"===z)throw Pn(f,"user-disabled",D);const me=g[z]||z.toLowerCase().replace(/[_\s]+/g,"-");if(ae)throw br(f,me,ae);mt(f,me)}}catch(y){if(y instanceof U.ZR)throw y;mt(f,"network-request-failed",{message:String(y)})}})).apply(this,arguments)}function be(f,c,d,g){return _t.apply(this,arguments)}function _t(){return(_t=(0,C.Z)(function*(f,c,d,g,y={}){const E=yield Q(f,c,d,g,y);return"mfaPendingCredential"in E&&mt(f,"multi-factor-auth-required",{_serverResponse:E}),E})).apply(this,arguments)}function In(f,c,d,g){const y=`${c}${d}?${g}`;return f.config.emulator?F(f.config,y):`${f.config.apiScheme}://${y}`}function xe(f){switch(f){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Wn{constructor(c){this.auth=c,this.timer=null,this.promise=new Promise((d,g)=>{this.timer=setTimeout(()=>g(St(this.auth,"network-request-failed")),W.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Pn(f,c,d){const g={appName:f.name};d.email&&(g.email=d.email),d.phoneNumber&&(g.phoneNumber=d.phoneNumber);const y=St(f,c,g);return y.customData._tokenResponse=d,y}function Gn(f){return void 0!==f&&void 0!==f.getResponse}function Pt(f){return void 0!==f&&void 0!==f.enterprise}class ui{constructor(c){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===c.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=c.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=c.recaptchaEnforcementState}getProviderEnforcementState(c){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const d of this.recaptchaEnforcementState)if(d.provider&&d.provider===c)return xe(d.enforcementState);return null}isProviderEnabled(c){return"ENFORCE"===this.getProviderEnforcementState(c)||"AUDIT"===this.getProviderEnforcementState(c)}}function zs(){return(zs=(0,C.Z)(function*(f){return(yield Q(f,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function li(f,c){return qs.apply(this,arguments)}function qs(){return(qs=(0,C.Z)(function*(f,c){return Q(f,"GET","/v2/recaptchaConfig",J(f,c))})).apply(this,arguments)}function $r(){return($r=(0,C.Z)(function*(f,c){return Q(f,"POST","/v1/accounts:delete",c)})).apply(this,arguments)}function Hr(){return(Hr=(0,C.Z)(function*(f,c){return Q(f,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function ms(){return(ms=(0,C.Z)(function*(f,c){return Q(f,"POST","/v1/accounts:lookup",c)})).apply(this,arguments)}function zr(f){if(f)try{const c=new Date(Number(f));if(!isNaN(c.getTime()))return c.toUTCString()}catch{}}function Gs(){return(Gs=(0,C.Z)(function*(f,c=!1){const d=(0,U.m9)(f),g=yield d.getIdToken(c),y=Ks(g);Y(y&&y.exp&&y.auth_time&&y.iat,d.auth,"internal-error");const E="object"==typeof y.firebase?y.firebase:void 0,D=E?.sign_in_provider;return{claims:y,token:g,authTime:zr(ys(y.auth_time)),issuedAtTime:zr(ys(y.iat)),expirationTime:zr(ys(y.exp)),signInProvider:D||null,signInSecondFactor:E?.sign_in_second_factor||null}})).apply(this,arguments)}function ys(f){return 1e3*Number(f)}function Ks(f){const[c,d,g]=f.split(".");if(void 0===c||void 0===d||void 0===g)return zt("JWT malformed, contained fewer than 3 sections"),null;try{const y=(0,U.tV)(d);return y?JSON.parse(y):(zt("Failed to decode base64 JWT payload"),null)}catch(y){return zt("Caught error parsing JWT payload as JSON",y?.toString()),null}}function sr(f,c){return vs.apply(this,arguments)}function vs(){return(vs=(0,C.Z)(function*(f,c,d=!1){if(d)return c;try{return yield c}catch(g){throw g instanceof U.ZR&&function nu({code:f}){return"auth/user-disabled"===f||"auth/user-token-expired"===f}(g)&&f.auth.currentUser===f&&(yield f.auth.signOut()),g}})).apply(this,arguments)}class ru{constructor(c){this.user=c,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(c){var d;if(c){const g=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),g}{this.errorBackoff=3e4;const y=(null!==(d=this.user.stsTokenManager.expirationTime)&&void 0!==d?d:0)-Date.now()-3e5;return Math.max(0,y)}}schedule(c=!1){var d=this;if(!this.isRunning)return;const g=this.getInterval(c);this.timerId=setTimeout((0,C.Z)(function*(){yield d.iteration()}),g)}iteration(){var c=this;return(0,C.Z)(function*(){try{yield c.user.getIdToken(!0)}catch(d){return void("auth/network-request-failed"===d?.code&&c.schedule(!0))}c.schedule()})()}}class iu{constructor(c,d){this.createdAt=c,this.lastLoginAt=d,this._initializeTime()}_initializeTime(){this.lastSignInTime=zr(this.lastLoginAt),this.creationTime=zr(this.createdAt)}_copy(c){this.createdAt=c.createdAt,this.lastLoginAt=c.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function zi(f){return or.apply(this,arguments)}function or(){return or=(0,C.Z)(function*(f){var c;const d=f.auth,g=yield f.getIdToken(),y=yield sr(f,function Ws(f,c){return ms.apply(this,arguments)}(d,{idToken:g}));Y(y?.users.length,d,"internal-error");const E=y.users[0];f._notifyReloadListener(E);const D=null!==(c=E.providerUserInfo)&&void 0!==c&&c.length?function su(f){return f.map(c=>{var{providerId:d}=c,g=(0,$e._T)(c,["providerId"]);return{providerId:d,uid:g.rawId||"",displayName:g.displayName||null,email:g.email||null,phoneNumber:g.phoneNumber||null,photoURL:g.photoUrl||null}})}(E.providerUserInfo):[],M=function qt(f,c){return[...f.filter(g=>!c.some(y=>y.providerId===g.providerId)),...c]}(f.providerData,D),me=!!f.isAnonymous&&!(f.email&&E.passwordHash||M?.length),ve={uid:E.localId,displayName:E.displayName||null,photoURL:E.photoUrl||null,email:E.email||null,emailVerified:E.emailVerified||!1,phoneNumber:E.phoneNumber||null,tenantId:E.tenantId||null,providerData:M,metadata:new iu(E.createdAt,E.lastLoginAt),isAnonymous:me};Object.assign(f,ve)}),or.apply(this,arguments)}function ca(){return(ca=(0,C.Z)(function*(f){const c=(0,U.m9)(f);yield zi(c),yield c.auth._persistUserIfCurrent(c),c.auth._notifyListenersIfCurrent(c)})).apply(this,arguments)}function A(){return(A=(0,C.Z)(function*(f,c){const d=yield ut(f,{},(0,C.Z)(function*(){const g=(0,U.xO)({grant_type:"refresh_token",refresh_token:c}).slice(1),{tokenApiHost:y,apiKey:E}=f.config,D=In(f,y,"/v1/token",`key=${E}`),M=yield f._getAdditionalHeaders();return M["Content-Type"]="application/x-www-form-urlencoded",B.fetch()(D,{method:"POST",headers:M,body:g})}));return{accessToken:d.access_token,expiresIn:d.expires_in,refreshToken:d.refresh_token}})).apply(this,arguments)}function P(){return(P=(0,C.Z)(function*(f,c){return Q(f,"POST","/v2/accounts:revokeToken",J(f,c))})).apply(this,arguments)}class G{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(c){Y(c.idToken,"internal-error"),Y(typeof c.idToken<"u","internal-error"),Y(typeof c.refreshToken<"u","internal-error");const d="expiresIn"in c&&typeof c.expiresIn<"u"?Number(c.expiresIn):function ci(f){const c=Ks(f);return Y(c,"internal-error"),Y(typeof c.exp<"u","internal-error"),Y(typeof c.iat<"u","internal-error"),Number(c.exp)-Number(c.iat)}(c.idToken);this.updateTokensAndExpiration(c.idToken,c.refreshToken,d)}getToken(c,d=!1){var g=this;return(0,C.Z)(function*(){return Y(!g.accessToken||g.refreshToken,c,"user-token-expired"),d||!g.accessToken||g.isExpired?g.refreshToken?(yield g.refresh(c,g.refreshToken),g.accessToken):null:g.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(c,d){var g=this;return(0,C.Z)(function*(){const{accessToken:y,refreshToken:E,expiresIn:D}=yield function Nl(f,c){return A.apply(this,arguments)}(c,d);g.updateTokensAndExpiration(y,E,Number(D))})()}updateTokensAndExpiration(c,d,g){this.refreshToken=d||null,this.accessToken=c||null,this.expirationTime=Date.now()+1e3*g}static fromJSON(c,d){const{refreshToken:g,accessToken:y,expirationTime:E}=d,D=new G;return g&&(Y("string"==typeof g,"internal-error",{appName:c}),D.refreshToken=g),y&&(Y("string"==typeof y,"internal-error",{appName:c}),D.accessToken=y),E&&(Y("number"==typeof E,"internal-error",{appName:c}),D.expirationTime=E),D}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(c){this.accessToken=c.accessToken,this.refreshToken=c.refreshToken,this.expirationTime=c.expirationTime}_clone(){return Object.assign(new G,this.toJSON())}_performRefresh(){return fn("not implemented")}}function x(f,c){Y("string"==typeof f||typeof f>"u","internal-error",{appName:c})}class he{constructor(c){var{uid:d,auth:g,stsTokenManager:y}=c,E=(0,$e._T)(c,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ru(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=d,this.auth=g,this.stsTokenManager=y,this.accessToken=y.accessToken,this.displayName=E.displayName||null,this.email=E.email||null,this.emailVerified=E.emailVerified||!1,this.phoneNumber=E.phoneNumber||null,this.photoURL=E.photoURL||null,this.isAnonymous=E.isAnonymous||!1,this.tenantId=E.tenantId||null,this.providerData=E.providerData?[...E.providerData]:[],this.metadata=new iu(E.createdAt||void 0,E.lastLoginAt||void 0)}getIdToken(c){var d=this;return(0,C.Z)(function*(){const g=yield sr(d,d.stsTokenManager.getToken(d.auth,c));return Y(g,d.auth,"internal-error"),d.accessToken!==g&&(d.accessToken=g,yield d.auth._persistUserIfCurrent(d),d.auth._notifyListenersIfCurrent(d)),g})()}getIdTokenResult(c){return function Eo(f){return Gs.apply(this,arguments)}(this,c)}reload(){return function Io(f){return ca.apply(this,arguments)}(this)}_assign(c){this!==c&&(Y(this.uid===c.uid,this.auth,"internal-error"),this.displayName=c.displayName,this.photoURL=c.photoURL,this.email=c.email,this.emailVerified=c.emailVerified,this.phoneNumber=c.phoneNumber,this.isAnonymous=c.isAnonymous,this.tenantId=c.tenantId,this.providerData=c.providerData.map(d=>Object.assign({},d)),this.metadata._copy(c.metadata),this.stsTokenManager._assign(c.stsTokenManager))}_clone(c){const d=new he(Object.assign(Object.assign({},this),{auth:c,stsTokenManager:this.stsTokenManager._clone()}));return d.metadata._copy(this.metadata),d}_onReload(c){Y(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=c,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(c){this.reloadListener?this.reloadListener(c):this.reloadUserInfo=c}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(c,d=!1){var g=this;return(0,C.Z)(function*(){let y=!1;c.idToken&&c.idToken!==g.stsTokenManager.accessToken&&(g.stsTokenManager.updateFromServerResponse(c),y=!0),d&&(yield zi(g)),yield g.auth._persistUserIfCurrent(g),y&&g.auth._notifyListenersIfCurrent(g)})()}delete(){var c=this;return(0,C.Z)(function*(){const d=yield c.getIdToken();return yield sr(c,function tu(f,c){return $r.apply(this,arguments)}(c.auth,{idToken:d})),c.stsTokenManager.clearRefreshToken(),c.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(c=>Object.assign({},c)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(c,d){var g,y,E,D,M,z,ae,me;const ve=null!==(g=d.displayName)&&void 0!==g?g:void 0,un=null!==(y=d.email)&&void 0!==y?y:void 0,xi=null!==(E=d.phoneNumber)&&void 0!==E?E:void 0,ih=null!==(D=d.photoURL)&&void 0!==D?D:void 0,vg=null!==(M=d.tenantId)&&void 0!==M?M:void 0,Eg=null!==(z=d._redirectEventId)&&void 0!==z?z:void 0,qv=null!==(ae=d.createdAt)&&void 0!==ae?ae:void 0,y0=null!==(me=d.lastLoginAt)&&void 0!==me?me:void 0,{uid:sh,emailVerified:Ig,isAnonymous:Yr,providerData:cc,stsTokenManager:Js}=d;Y(sh&&Js,c,"internal-error");const oh=G.fromJSON(this.name,Js);Y("string"==typeof sh,c,"internal-error"),x(ve,c.name),x(un,c.name),Y("boolean"==typeof Ig,c,"internal-error"),Y("boolean"==typeof Yr,c,"internal-error"),x(xi,c.name),x(ih,c.name),x(vg,c.name),x(Eg,c.name),x(qv,c.name),x(y0,c.name);const ah=new he({uid:sh,auth:c,email:un,emailVerified:Ig,displayName:ve,isAnonymous:Yr,photoURL:ih,phoneNumber:xi,tenantId:vg,stsTokenManager:oh,createdAt:qv,lastLoginAt:y0});return cc&&Array.isArray(cc)&&(ah.providerData=cc.map(dc=>Object.assign({},dc))),Eg&&(ah._redirectEventId=Eg),ah}static _fromIdTokenResponse(c,d,g=!1){return(0,C.Z)(function*(){const y=new G;y.updateFromServerResponse(d);const E=new he({uid:d.localId,auth:c,stsTokenManager:y,isAnonymous:g});return yield zi(E),E})()}}const ge=new Map;function Te(f){pn(f instanceof Function,"Expected a class definition");let c=ge.get(f);return c?(pn(c instanceof f,"Instance stored in cache mismatched with class"),c):(c=new f,ge.set(f,c),c)}const fe=(()=>{class f{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,C.Z)(function*(){return!0})()}_set(d,g){var y=this;return(0,C.Z)(function*(){y.storage[d]=g})()}_get(d){var g=this;return(0,C.Z)(function*(){const y=g.storage[d];return void 0===y?null:y})()}_remove(d){var g=this;return(0,C.Z)(function*(){delete g.storage[d]})()}_addListener(d,g){}_removeListener(d,g){}}return f.type="NONE",f})();function Ue(f,c,d){return`firebase:${f}:${c}:${d}`}class Qe{constructor(c,d,g){this.persistence=c,this.auth=d,this.userKey=g;const{config:y,name:E}=this.auth;this.fullUserKey=Ue(this.userKey,y.apiKey,E),this.fullPersistenceKey=Ue("persistence",y.apiKey,E),this.boundEventHandler=d._onStorageEvent.bind(d),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(c){return this.persistence._set(this.fullUserKey,c.toJSON())}getCurrentUser(){var c=this;return(0,C.Z)(function*(){const d=yield c.persistence._get(c.fullUserKey);return d?he._fromJSON(c.auth,d):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(c){var d=this;return(0,C.Z)(function*(){if(d.persistence===c)return;const g=yield d.getCurrentUser();return yield d.removeCurrentUser(),d.persistence=c,g?d.setCurrentUser(g):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(c,d,g="authUser"){return(0,C.Z)(function*(){if(!d.length)return new Qe(Te(fe),c,g);const y=(yield Promise.all(d.map(function(){var ae=(0,C.Z)(function*(me){if(yield me._isAvailable())return me});return function(me){return ae.apply(this,arguments)}}()))).filter(ae=>ae);let E=y[0]||Te(fe);const D=Ue(g,c.config.apiKey,c.name);let M=null;for(const ae of d)try{const me=yield ae._get(D);if(me){const ve=he._fromJSON(c,me);ae!==E&&(M=ve),E=ae;break}}catch{}const z=y.filter(ae=>ae._shouldAllowMigration);return E._shouldAllowMigration&&z.length?(E=z[0],M&&(yield E._set(D,M.toJSON())),yield Promise.all(d.map(function(){var ae=(0,C.Z)(function*(me){if(me!==E)try{yield me._remove(D)}catch{}});return function(me){return ae.apply(this,arguments)}}())),new Qe(E,c,g)):new Qe(E,c,g)})()}}function gt(f){const c=f.toLowerCase();if(c.includes("opera/")||c.includes("opr/")||c.includes("opios/"))return"Opera";if(j(c))return"IEMobile";if(c.includes("msie")||c.includes("trident/"))return"IE";if(c.includes("edge/"))return"Edge";if(qi(c))return"Firefox";if(c.includes("silk/"))return"Silk";if(te(c))return"Blackberry";if(ye(c))return"Webos";if(da(c))return"Safari";if((c.includes("chrome/")||pd(c))&&!c.includes("edge/"))return"Chrome";if(R(c))return"Android";{const g=f.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===g?.length)return g[1]}return"Other"}function qi(f=(0,U.z$)()){return/firefox\//i.test(f)}function da(f=(0,U.z$)()){const c=f.toLowerCase();return c.includes("safari/")&&!c.includes("chrome/")&&!c.includes("crios/")&&!c.includes("android")}function pd(f=(0,U.z$)()){return/crios\//i.test(f)}function j(f=(0,U.z$)()){return/iemobile/i.test(f)}function R(f=(0,U.z$)()){return/android/i.test(f)}function te(f=(0,U.z$)()){return/blackberry/i.test(f)}function ye(f=(0,U.z$)()){return/webos/i.test(f)}function He(f=(0,U.z$)()){return/iphone|ipad|ipod/i.test(f)||/macintosh/i.test(f)&&/mobile/i.test(f)}function Vt(f=(0,U.z$)()){return He(f)||R(f)||ye(f)||te(f)||/windows phone/i.test(f)||j(f)}function wo(f,c=[]){let d;switch(f){case"Browser":d=gt((0,U.z$)());break;case"Worker":d=`${gt((0,U.z$)())}-${f}`;break;default:d=f}const g=c.length?c.join(","):"FirebaseCore-web";return`${d}/JsCore/${Le.SDK_VERSION}/${g}`}class My{constructor(c){this.auth=c,this.queue=[]}pushCallback(c,d){const g=E=>new Promise((D,M)=>{try{D(c(E))}catch(z){M(z)}});g.onAbort=d,this.queue.push(g);const y=this.queue.length-1;return()=>{this.queue[y]=()=>Promise.resolve()}}runMiddleware(c){var d=this;return(0,C.Z)(function*(){if(d.auth.currentUser===c)return;const g=[];try{for(const y of d.queue)yield y(c),y.onAbort&&g.push(y.onAbort)}catch(y){g.reverse();for(const E of g)try{E()}catch{}throw d.auth._errorFactory.create("login-blocked",{originalMessage:y?.message})}})()}}function ha(){return(ha=(0,C.Z)(function*(f,c={}){return Q(f,"GET","/v2/passwordPolicy",J(f,c))})).apply(this,arguments)}class Be{constructor(c){var d,g,y,E;const D=c.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(d=D.minPasswordLength)&&void 0!==d?d:6,D.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=D.maxPasswordLength),void 0!==D.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=D.containsLowercaseCharacter),void 0!==D.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=D.containsUppercaseCharacter),void 0!==D.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=D.containsNumericCharacter),void 0!==D.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=D.containsNonAlphanumericCharacter),this.enforcementState=c.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(y=null===(g=c.allowedNonAlphanumericCharacters)||void 0===g?void 0:g.join(""))&&void 0!==y?y:"",this.forceUpgradeOnSignin=null!==(E=c.forceUpgradeOnSignin)&&void 0!==E&&E,this.schemaVersion=c.schemaVersion}validatePassword(c){var d,g,y,E,D,M;const z={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(c,z),this.validatePasswordCharacterOptions(c,z),z.isValid&&(z.isValid=null===(d=z.meetsMinPasswordLength)||void 0===d||d),z.isValid&&(z.isValid=null===(g=z.meetsMaxPasswordLength)||void 0===g||g),z.isValid&&(z.isValid=null===(y=z.containsLowercaseLetter)||void 0===y||y),z.isValid&&(z.isValid=null===(E=z.containsUppercaseLetter)||void 0===E||E),z.isValid&&(z.isValid=null===(D=z.containsNumericCharacter)||void 0===D||D),z.isValid&&(z.isValid=null===(M=z.containsNonAlphanumericCharacter)||void 0===M||M),z}validatePasswordLengthOptions(c,d){const g=this.customStrengthOptions.minPasswordLength,y=this.customStrengthOptions.maxPasswordLength;g&&(d.meetsMinPasswordLength=c.length>=g),y&&(d.meetsMaxPasswordLength=c.length<=y)}validatePasswordCharacterOptions(c,d){let g;this.updatePasswordCharacterOptionsStatuses(d,!1,!1,!1,!1);for(let y=0;y<c.length;y++)g=c.charAt(y),this.updatePasswordCharacterOptionsStatuses(d,g>="a"&&g<="z",g>="A"&&g<="Z",g>="0"&&g<="9",this.allowedNonAlphanumericCharacters.includes(g))}updatePasswordCharacterOptionsStatuses(c,d,g,y,E){this.customStrengthOptions.containsLowercaseLetter&&(c.containsLowercaseLetter||(c.containsLowercaseLetter=d)),this.customStrengthOptions.containsUppercaseLetter&&(c.containsUppercaseLetter||(c.containsUppercaseLetter=g)),this.customStrengthOptions.containsNumericCharacter&&(c.containsNumericCharacter||(c.containsNumericCharacter=y)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(c.containsNonAlphanumericCharacter||(c.containsNonAlphanumericCharacter=E))}}class It{constructor(c,d,g,y){this.app=c,this.heartbeatServiceProvider=d,this.appCheckServiceProvider=g,this.config=y,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ky(this),this.idTokenSubscription=new ky(this),this.beforeStateQueue=new My(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ze,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=c.name,this.clientVersion=y.sdkClientVersion}_initializeWithPersistence(c,d){var g=this;return d&&(this._popupRedirectResolver=Te(d)),this._initializationPromise=this.queue((0,C.Z)(function*(){var y,E;if(!g._deleted&&(g.persistenceManager=yield Qe.create(g,c),!g._deleted)){if(null!==(y=g._popupRedirectResolver)&&void 0!==y&&y._shouldInitProactively)try{yield g._popupRedirectResolver._initialize(g)}catch{}yield g.initializeCurrentUser(d),g.lastNotifiedUid=(null===(E=g.currentUser)||void 0===E?void 0:E.uid)||null,!g._deleted&&(g._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var c=this;return(0,C.Z)(function*(){if(c._deleted)return;const d=yield c.assertedPersistence.getCurrentUser();if(c.currentUser||d){if(c.currentUser&&d&&c.currentUser.uid===d.uid)return c._currentUser._assign(d),void(yield c.currentUser.getIdToken());yield c._updateCurrentUser(d,!0)}})()}initializeCurrentUser(c){var d=this;return(0,C.Z)(function*(){var g;const y=yield d.assertedPersistence.getCurrentUser();let E=y,D=!1;if(c&&d.config.authDomain){yield d.getOrInitRedirectPersistenceManager();const M=null===(g=d.redirectUser)||void 0===g?void 0:g._redirectEventId,z=E?._redirectEventId,ae=yield d.tryRedirectSignIn(c);(!M||M===z)&&ae?.user&&(E=ae.user,D=!0)}if(!E)return d.directlySetCurrentUser(null);if(!E._redirectEventId){if(D)try{yield d.beforeStateQueue.runMiddleware(E)}catch(M){E=y,d._popupRedirectResolver._overrideRedirectResult(d,()=>Promise.reject(M))}return E?d.reloadAndSetCurrentUserOrClear(E):d.directlySetCurrentUser(null)}return Y(d._popupRedirectResolver,d,"argument-error"),yield d.getOrInitRedirectPersistenceManager(),d.redirectUser&&d.redirectUser._redirectEventId===E._redirectEventId?d.directlySetCurrentUser(E):d.reloadAndSetCurrentUserOrClear(E)})()}tryRedirectSignIn(c){var d=this;return(0,C.Z)(function*(){let g=null;try{g=yield d._popupRedirectResolver._completeRedirectFn(d,c,!0)}catch{yield d._setRedirectUser(null)}return g})()}reloadAndSetCurrentUserOrClear(c){var d=this;return(0,C.Z)(function*(){try{yield zi(c)}catch(g){if("auth/network-request-failed"!==g?.code)return d.directlySetCurrentUser(null)}return d.directlySetCurrentUser(c)})()}useDeviceLanguage(){this.languageCode=function la(){if(typeof navigator>"u")return null;const f=navigator;return f.languages&&f.languages[0]||f.language||null}()}_delete(){var c=this;return(0,C.Z)(function*(){c._deleted=!0})()}updateCurrentUser(c){var d=this;return(0,C.Z)(function*(){const g=c?(0,U.m9)(c):null;return g&&Y(g.auth.config.apiKey===d.config.apiKey,d,"invalid-user-token"),d._updateCurrentUser(g&&g._clone(d))})()}_updateCurrentUser(c,d=!1){var g=this;return(0,C.Z)(function*(){if(!g._deleted)return c&&Y(g.tenantId===c.tenantId,g,"tenant-id-mismatch"),d||(yield g.beforeStateQueue.runMiddleware(c)),g.queue((0,C.Z)(function*(){yield g.directlySetCurrentUser(c),g.notifyAuthListeners()}))})()}signOut(){var c=this;return(0,C.Z)(function*(){return yield c.beforeStateQueue.runMiddleware(null),(c.redirectPersistenceManager||c._popupRedirectResolver)&&(yield c._setRedirectUser(null)),c._updateCurrentUser(null,!0)})()}setPersistence(c){var d=this;return this.queue((0,C.Z)(function*(){yield d.assertedPersistence.setPersistence(Te(c))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(c){var d=this;return(0,C.Z)(function*(){d._getPasswordPolicyInternal()||(yield d._updatePasswordPolicy());const g=d._getPasswordPolicyInternal();return g.schemaVersion!==d.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(d._errorFactory.create("unsupported-password-policy-schema-version",{})):g.validatePassword(c)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var c=this;return(0,C.Z)(function*(){const d=yield function Zs(f){return ha.apply(this,arguments)}(c),g=new Be(d);null===c.tenantId?c._projectPasswordPolicy=g:c._tenantPasswordPolicies[c.tenantId]=g})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(c){this._errorFactory=new U.LL("auth","Firebase",c())}onAuthStateChanged(c,d,g){return this.registerStateListener(this.authStateSubscription,c,d,g)}beforeAuthStateChanged(c,d){return this.beforeStateQueue.pushCallback(c,d)}onIdTokenChanged(c,d,g){return this.registerStateListener(this.idTokenSubscription,c,d,g)}authStateReady(){return new Promise((c,d)=>{if(this.currentUser)c();else{const g=this.onAuthStateChanged(()=>{g(),c()},d)}})}revokeAccessToken(c){var d=this;return(0,C.Z)(function*(){if(d.currentUser){const g=yield d.currentUser.getIdToken(),y={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:c,idToken:g};null!=d.tenantId&&(y.tenantId=d.tenantId),yield function S(f,c){return P.apply(this,arguments)}(d,y)}})()}toJSON(){var c;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(c=this._currentUser)||void 0===c?void 0:c.toJSON()}}_setRedirectUser(c,d){var g=this;return(0,C.Z)(function*(){const y=yield g.getOrInitRedirectPersistenceManager(d);return null===c?y.removeCurrentUser():y.setCurrentUser(c)})()}getOrInitRedirectPersistenceManager(c){var d=this;return(0,C.Z)(function*(){if(!d.redirectPersistenceManager){const g=c&&Te(c)||d._popupRedirectResolver;Y(g,d,"argument-error"),d.redirectPersistenceManager=yield Qe.create(d,[Te(g._redirectPersistence)],"redirectUser"),d.redirectUser=yield d.redirectPersistenceManager.getCurrentUser()}return d.redirectPersistenceManager})()}_redirectUserForId(c){var d=this;return(0,C.Z)(function*(){var g,y;return d._isInitialized&&(yield d.queue((0,C.Z)(function*(){}))),(null===(g=d._currentUser)||void 0===g?void 0:g._redirectEventId)===c?d._currentUser:(null===(y=d.redirectUser)||void 0===y?void 0:y._redirectEventId)===c?d.redirectUser:null})()}_persistUserIfCurrent(c){var d=this;return(0,C.Z)(function*(){if(c===d.currentUser)return d.queue((0,C.Z)(function*(){return d.directlySetCurrentUser(c)}))})()}_notifyListenersIfCurrent(c){c===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var c,d;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const g=null!==(d=null===(c=this.currentUser)||void 0===c?void 0:c.uid)&&void 0!==d?d:null;this.lastNotifiedUid!==g&&(this.lastNotifiedUid=g,this.authStateSubscription.next(this.currentUser))}registerStateListener(c,d,g,y){if(this._deleted)return()=>{};const E="function"==typeof d?d:d.next.bind(d);let D=!1;const M=this._isInitialized?Promise.resolve():this._initializationPromise;if(Y(M,this,"internal-error"),M.then(()=>{D||E(this.currentUser)}),"function"==typeof d){const z=c.addObserver(d,g,y);return()=>{D=!0,z()}}{const z=c.addObserver(d);return()=>{D=!0,z()}}}directlySetCurrentUser(c){var d=this;return(0,C.Z)(function*(){d.currentUser&&d.currentUser!==c&&d._currentUser._stopProactiveRefresh(),c&&d.isProactiveRefreshEnabled&&c._startProactiveRefresh(),d.currentUser=c,c?yield d.assertedPersistence.setCurrentUser(c):yield d.assertedPersistence.removeCurrentUser()})()}queue(c){return this.operations=this.operations.then(c,c),this.operations}get assertedPersistence(){return Y(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(c){!c||this.frameworks.includes(c)||(this.frameworks.push(c),this.frameworks.sort(),this.clientVersion=wo(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var c=this;return(0,C.Z)(function*(){var d;const g={"X-Client-Version":c.clientVersion};c.app.options.appId&&(g["X-Firebase-gmpid"]=c.app.options.appId);const y=yield null===(d=c.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===d?void 0:d.getHeartbeatsHeader();y&&(g["X-Firebase-Client"]=y);const E=yield c._getAppCheckToken();return E&&(g["X-Firebase-AppCheck"]=E),g})()}_getAppCheckToken(){var c=this;return(0,C.Z)(function*(){var d;const g=yield null===(d=c.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===d?void 0:d.getToken();return g?.error&&function pr(f,...c){Ln.logLevel<=on.in.WARN&&Ln.warn(`Auth (${Le.SDK_VERSION}): ${f}`,...c)}(`Error while retrieving App Check token: ${g.error}`),g?.token})()}}function Qt(f){return(0,U.m9)(f)}class ky{constructor(c){this.auth=c,this.observer=null,this.addObserver=(0,U.ne)(d=>this.observer=d)}get next(){return Y(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Oy(f){return new Promise((c,d)=>{const g=document.createElement("script");g.setAttribute("src",f),g.onload=c,g.onerror=y=>{const E=St("internal-error");E.customData=y,d(E)},g.type="text/javascript",g.charset="UTF-8",function fC(){var f,c;return null!==(c=null===(f=document.getElementsByTagName("head"))||void 0===f?void 0:f[0])&&void 0!==c?c:document}().appendChild(g)})}function Ly(f){return`__${f}${Math.floor(1e6*Math.random())}`}class Fy{constructor(c){this.type="recaptcha-enterprise",this.auth=Qt(c)}verify(c="verify",d=!1){var g=this;return(0,C.Z)(function*(){function E(){return E=(0,C.Z)(function*(M){if(!d){if(null==M.tenantId&&null!=M._agentRecaptchaConfig)return M._agentRecaptchaConfig.siteKey;if(null!=M.tenantId&&void 0!==M._tenantRecaptchaConfigs[M.tenantId])return M._tenantRecaptchaConfigs[M.tenantId].siteKey}return new Promise(function(){var z=(0,C.Z)(function*(ae,me){li(M,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(ve=>{if(void 0!==ve.recaptchaKey){const un=new ui(ve);return null==M.tenantId?M._agentRecaptchaConfig=un:M._tenantRecaptchaConfigs[M.tenantId]=un,ae(un.siteKey)}me(new Error("recaptcha Enterprise site key undefined"))}).catch(ve=>{me(ve)})});return function(ae,me){return z.apply(this,arguments)}}())}),E.apply(this,arguments)}function D(M,z,ae){const me=window.grecaptcha;Pt(me)?me.enterprise.ready(()=>{me.enterprise.execute(M,{action:c}).then(ve=>{z(ve)}).catch(()=>{z("NO_RECAPTCHA")})}):ae(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((M,z)=>{(function y(M){return E.apply(this,arguments)})(g.auth).then(ae=>{if(!d&&Pt(window.grecaptcha))D(ae,M,z);else{if(typeof window>"u")return void z(new Error("RecaptchaVerifier is only supported in browser"));Oy("https://www.google.com/recaptcha/enterprise.js?render="+ae).then(()=>{D(ae,M,z)}).catch(me=>{z(me)})}}).catch(ae=>{z(ae)})})})()}}function pC(f,c,d){return Es.apply(this,arguments)}function Es(){return(Es=(0,C.Z)(function*(f,c,d,g=!1){const y=new Fy(f);let E;try{E=yield y.verify(d)}catch{E=yield y.verify(d,!0)}const D=Object.assign({},c);return Object.assign(D,g?{captchaResp:E}:{captchaResponse:E}),Object.assign(D,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(D,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),D})).apply(this,arguments)}function gd(f,c,d,g){return Vy.apply(this,arguments)}function Vy(){return Vy=(0,C.Z)(function*(f,c,d,g){var y;if(null!==(y=f._getRecaptchaConfig())&&void 0!==y&&y.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const E=yield pC(f,c,d,"getOobCode"===d);return g(f,E)}return g(f,c).catch(function(){var E=(0,C.Z)(function*(D){if("auth/missing-recaptcha-token"===D.code){console.log(`${d} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const M=yield pC(f,c,d,"getOobCode"===d);return g(f,M)}return Promise.reject(D)});return function(D){return E.apply(this,arguments)}}())}),Vy.apply(this,arguments)}function mC(f){const c=f.indexOf(":");return c<0?"":f.substr(0,c+1)}function Me(f){if(!f)return null;const c=Number(f);return isNaN(c)?null:c}class Ml{constructor(c,d){this.providerId=c,this.signInMethod=d}toJSON(){return fn("not implemented")}_getIdTokenResponse(c){return fn("not implemented")}_linkToIdToken(c,d){return fn("not implemented")}_getReauthenticationResolver(c){return fn("not implemented")}}function _C(f,c){return jy.apply(this,arguments)}function jy(){return(jy=(0,C.Z)(function*(f,c){return Q(f,"POST","/v1/accounts:resetPassword",J(f,c))})).apply(this,arguments)}function $y(){return($y=(0,C.Z)(function*(f,c){return Q(f,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function Ar(f,c){return ou.apply(this,arguments)}function ou(){return(ou=(0,C.Z)(function*(f,c){return Q(f,"POST","/v1/accounts:signUp",c)})).apply(this,arguments)}function md(){return(md=(0,C.Z)(function*(f,c){return Q(f,"POST","/v1/accounts:update",J(f,c))})).apply(this,arguments)}function vC(f,c){return au.apply(this,arguments)}function au(){return(au=(0,C.Z)(function*(f,c){return be(f,"POST","/v1/accounts:signInWithPassword",J(f,c))})).apply(this,arguments)}function fa(f,c){return xl.apply(this,arguments)}function xl(){return(xl=(0,C.Z)(function*(f,c){return Q(f,"POST","/v1/accounts:sendOobCode",J(f,c))})).apply(this,arguments)}function vp(){return(vp=(0,C.Z)(function*(f,c){return fa(f,c)})).apply(this,arguments)}function st(f,c){return kl.apply(this,arguments)}function kl(){return(kl=(0,C.Z)(function*(f,c){return fa(f,c)})).apply(this,arguments)}function zy(f,c){return gr.apply(this,arguments)}function gr(){return(gr=(0,C.Z)(function*(f,c){return fa(f,c)})).apply(this,arguments)}function Wy(){return(Wy=(0,C.Z)(function*(f,c){return fa(f,c)})).apply(this,arguments)}function Gy(){return(Gy=(0,C.Z)(function*(f,c){return be(f,"POST","/v1/accounts:signInWithEmailLink",J(f,c))})).apply(this,arguments)}function ue(){return(ue=(0,C.Z)(function*(f,c){return be(f,"POST","/v1/accounts:signInWithEmailLink",J(f,c))})).apply(this,arguments)}class pa extends Ml{constructor(c,d,g,y=null){super("password",g),this._email=c,this._password=d,this._tenantId=y}static _fromEmailAndPassword(c,d){return new pa(c,d,"password")}static _fromEmailAndCode(c,d,g=null){return new pa(c,d,"emailLink",g)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(c){const d="string"==typeof c?JSON.parse(c):c;if(d?.email&&d?.password){if("password"===d.signInMethod)return this._fromEmailAndPassword(d.email,d.password);if("emailLink"===d.signInMethod)return this._fromEmailAndCode(d.email,d.password,d.tenantId)}return null}_getIdTokenResponse(c){var d=this;return(0,C.Z)(function*(){switch(d.signInMethod){case"password":return gd(c,{returnSecureToken:!0,email:d._email,password:d._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",vC);case"emailLink":return function Ut(f,c){return Gy.apply(this,arguments)}(c,{email:d._email,oobCode:d._password});default:mt(c,"internal-error")}})()}_linkToIdToken(c,d){var g=this;return(0,C.Z)(function*(){switch(g.signInMethod){case"password":return gd(c,{idToken:d,returnSecureToken:!0,email:g._email,password:g._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ar);case"emailLink":return function tx(f,c){return ue.apply(this,arguments)}(c,{idToken:d,email:g._email,oobCode:g._password});default:mt(c,"internal-error")}})()}_getReauthenticationResolver(c){return this._getIdTokenResponse(c)}}function Gi(f,c){return _d.apply(this,arguments)}function _d(){return(_d=(0,C.Z)(function*(f,c){return be(f,"POST","/v1/accounts:signInWithIdp",J(f,c))})).apply(this,arguments)}class Is extends Ml{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(c){const d=new Is(c.providerId,c.signInMethod);return c.idToken||c.accessToken?(c.idToken&&(d.idToken=c.idToken),c.accessToken&&(d.accessToken=c.accessToken),c.nonce&&!c.pendingToken&&(d.nonce=c.nonce),c.pendingToken&&(d.pendingToken=c.pendingToken)):c.oauthToken&&c.oauthTokenSecret?(d.accessToken=c.oauthToken,d.secret=c.oauthTokenSecret):mt("argument-error"),d}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(c){const d="string"==typeof c?JSON.parse(c):c,{providerId:g,signInMethod:y}=d,E=(0,$e._T)(d,["providerId","signInMethod"]);if(!g||!y)return null;const D=new Is(g,y);return D.idToken=E.idToken||void 0,D.accessToken=E.accessToken||void 0,D.secret=E.secret,D.nonce=E.nonce,D.pendingToken=E.pendingToken||null,D}_getIdTokenResponse(c){return Gi(c,this.buildRequest())}_linkToIdToken(c,d){const g=this.buildRequest();return g.idToken=d,Gi(c,g)}_getReauthenticationResolver(c){const d=this.buildRequest();return d.autoCreate=!1,Gi(c,d)}buildRequest(){const c={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)c.pendingToken=this.pendingToken;else{const d={};this.idToken&&(d.id_token=this.idToken),this.accessToken&&(d.access_token=this.accessToken),this.secret&&(d.oauth_token_secret=this.secret),d.providerId=this.providerId,this.nonce&&!this.pendingToken&&(d.nonce=this.nonce),c.postBody=(0,U.xO)(d)}return c}}function Ky(){return(Ky=(0,C.Z)(function*(f,c){return Q(f,"POST","/v1/accounts:sendVerificationCode",J(f,c))})).apply(this,arguments)}function Zy(){return(Zy=(0,C.Z)(function*(f,c){return be(f,"POST","/v1/accounts:signInWithPhoneNumber",J(f,c))})).apply(this,arguments)}function Qy(){return(Qy=(0,C.Z)(function*(f,c){const d=yield be(f,"POST","/v1/accounts:signInWithPhoneNumber",J(f,c));if(d.temporaryProof)throw Pn(f,"account-exists-with-different-credential",d);return d})).apply(this,arguments)}const Ol={USER_NOT_FOUND:"user-not-found"};function uu(){return(uu=(0,C.Z)(function*(f,c){return be(f,"POST","/v1/accounts:signInWithPhoneNumber",J(f,Object.assign(Object.assign({},c),{operation:"REAUTH"})),Ol)})).apply(this,arguments)}class ga extends Ml{constructor(c){super("phone","phone"),this.params=c}static _fromVerification(c,d){return new ga({verificationId:c,verificationCode:d})}static _fromTokenResponse(c,d){return new ga({phoneNumber:c,temporaryProof:d})}_getIdTokenResponse(c){return function nx(f,c){return Zy.apply(this,arguments)}(c,this._makeVerificationRequest())}_linkToIdToken(c,d){return function rx(f,c){return Qy.apply(this,arguments)}(c,Object.assign({idToken:d},this._makeVerificationRequest()))}_getReauthenticationResolver(c){return function wp(f,c){return uu.apply(this,arguments)}(c,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:c,phoneNumber:d,verificationId:g,verificationCode:y}=this.params;return c&&d?{temporaryProof:c,phoneNumber:d}:{sessionInfo:g,code:y}}toJSON(){const c={providerId:this.providerId};return this.params.phoneNumber&&(c.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(c.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(c.verificationCode=this.params.verificationCode),this.params.verificationId&&(c.verificationId=this.params.verificationId),c}static fromJSON(c){"string"==typeof c&&(c=JSON.parse(c));const{verificationId:d,verificationCode:g,phoneNumber:y,temporaryProof:E}=c;return g||d||y||E?new ga({verificationId:d,verificationCode:g,phoneNumber:y,temporaryProof:E}):null}}class lu{constructor(c){var d,g,y,E,D,M;const z=(0,U.zd)((0,U.pd)(c)),ae=null!==(d=z.apiKey)&&void 0!==d?d:null,me=null!==(g=z.oobCode)&&void 0!==g?g:null,ve=function EC(f){switch(f){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(y=z.mode)&&void 0!==y?y:null);Y(ae&&me&&ve,"argument-error"),this.apiKey=ae,this.operation=ve,this.code=me,this.continueUrl=null!==(E=z.continueUrl)&&void 0!==E?E:null,this.languageCode=null!==(D=z.languageCode)&&void 0!==D?D:null,this.tenantId=null!==(M=z.tenantId)&&void 0!==M?M:null}static parseLink(c){const d=function IC(f){const c=(0,U.zd)((0,U.pd)(f)).link,d=c?(0,U.zd)((0,U.pd)(c)).deep_link_id:null,g=(0,U.zd)((0,U.pd)(f)).deep_link_id;return(g?(0,U.zd)((0,U.pd)(g)).link:null)||g||d||c||f}(c);try{return new lu(d)}catch{return null}}}let Tp=(()=>{class f{constructor(){this.providerId=f.PROVIDER_ID}static credential(d,g){return pa._fromEmailAndPassword(d,g)}static credentialWithLink(d,g){const y=lu.parseLink(g);return Y(y,"argument-error"),pa._fromEmailAndCode(d,y.code,y.tenantId)}}return f.PROVIDER_ID="password",f.EMAIL_PASSWORD_SIGN_IN_METHOD="password",f.EMAIL_LINK_SIGN_IN_METHOD="emailLink",f})();class mr{constructor(c){this.providerId=c,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(c){this.defaultLanguageCode=c}setCustomParameters(c){return this.customParameters=c,this}getCustomParameters(){return this.customParameters}}class cu extends mr{constructor(){super(...arguments),this.scopes=[]}addScope(c){return this.scopes.includes(c)||this.scopes.push(c),this}getScopes(){return[...this.scopes]}}class K extends cu{static credentialFromJSON(c){const d="string"==typeof c?JSON.parse(c):c;return Y("providerId"in d&&"signInMethod"in d,"argument-error"),Is._fromParams(d)}credential(c){return this._credential(Object.assign(Object.assign({},c),{nonce:c.rawNonce}))}_credential(c){return Y(c.idToken||c.accessToken,"argument-error"),Is._fromParams(Object.assign(Object.assign({},c),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(c){return K.oauthCredentialFromTaggedObject(c)}static credentialFromError(c){return K.oauthCredentialFromTaggedObject(c.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{oauthIdToken:d,oauthAccessToken:g,oauthTokenSecret:y,pendingToken:E,nonce:D,providerId:M}=c;if(!g&&!y&&!d&&!E||!M)return null;try{return new K(M)._credential({idToken:d,accessToken:g,nonce:D,pendingToken:E})}catch{return null}}}let Cp=(()=>{class f extends cu{constructor(){super("facebook.com")}static credential(d){return Is._fromParams({providerId:f.PROVIDER_ID,signInMethod:f.FACEBOOK_SIGN_IN_METHOD,accessToken:d})}static credentialFromResult(d){return f.credentialFromTaggedObject(d)}static credentialFromError(d){return f.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d||!("oauthAccessToken"in d)||!d.oauthAccessToken)return null;try{return f.credential(d.oauthAccessToken)}catch{return null}}}return f.FACEBOOK_SIGN_IN_METHOD="facebook.com",f.PROVIDER_ID="facebook.com",f})(),oe=(()=>{class f extends cu{constructor(){super("google.com"),this.addScope("profile")}static credential(d,g){return Is._fromParams({providerId:f.PROVIDER_ID,signInMethod:f.GOOGLE_SIGN_IN_METHOD,idToken:d,accessToken:g})}static credentialFromResult(d){return f.credentialFromTaggedObject(d)}static credentialFromError(d){return f.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d)return null;const{oauthIdToken:g,oauthAccessToken:y}=d;if(!g&&!y)return null;try{return f.credential(g,y)}catch{return null}}}return f.GOOGLE_SIGN_IN_METHOD="google.com",f.PROVIDER_ID="google.com",f})(),Fl=(()=>{class f extends cu{constructor(){super("github.com")}static credential(d){return Is._fromParams({providerId:f.PROVIDER_ID,signInMethod:f.GITHUB_SIGN_IN_METHOD,accessToken:d})}static credentialFromResult(d){return f.credentialFromTaggedObject(d)}static credentialFromError(d){return f.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d||!("oauthAccessToken"in d)||!d.oauthAccessToken)return null;try{return f.credential(d.oauthAccessToken)}catch{return null}}}return f.GITHUB_SIGN_IN_METHOD="github.com",f.PROVIDER_ID="github.com",f})();class ws extends Ml{constructor(c,d){super(c,c),this.pendingToken=d}_getIdTokenResponse(c){return Gi(c,this.buildRequest())}_linkToIdToken(c,d){const g=this.buildRequest();return g.idToken=d,Gi(c,g)}_getReauthenticationResolver(c){const d=this.buildRequest();return d.autoCreate=!1,Gi(c,d)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(c){const d="string"==typeof c?JSON.parse(c):c,{providerId:g,signInMethod:y,pendingToken:E}=d;return g&&y&&E&&g===y?new ws(g,E):null}static _create(c,d){return new ws(c,d)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class yd extends mr{constructor(c){Y(c.startsWith("saml."),"argument-error"),super(c)}static credentialFromResult(c){return yd.samlCredentialFromTaggedObject(c)}static credentialFromError(c){return yd.samlCredentialFromTaggedObject(c.customData||{})}static credentialFromJSON(c){const d=ws.fromJSON(c);return Y(d,"argument-error"),d}static samlCredentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{pendingToken:d,providerId:g}=c;if(!d||!g)return null;try{return ws._create(g,d)}catch{return null}}}let Yy=(()=>{class f extends cu{constructor(){super("twitter.com")}static credential(d,g){return Is._fromParams({providerId:f.PROVIDER_ID,signInMethod:f.TWITTER_SIGN_IN_METHOD,oauthToken:d,oauthTokenSecret:g})}static credentialFromResult(d){return f.credentialFromTaggedObject(d)}static credentialFromError(d){return f.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d)return null;const{oauthAccessToken:g,oauthTokenSecret:y}=d;if(!g||!y)return null;try{return f.credential(g,y)}catch{return null}}}return f.TWITTER_SIGN_IN_METHOD="twitter.com",f.PROVIDER_ID="twitter.com",f})();function Ts(f,c){return du.apply(this,arguments)}function du(){return(du=(0,C.Z)(function*(f,c){return be(f,"POST","/v1/accounts:signUp",J(f,c))})).apply(this,arguments)}class gn{constructor(c){this.user=c.user,this.providerId=c.providerId,this._tokenResponse=c._tokenResponse,this.operationType=c.operationType}static _fromIdTokenResponse(c,d,g,y=!1){return(0,C.Z)(function*(){const E=yield he._fromIdTokenResponse(c,g,y),D=Ki(g);return new gn({user:E,providerId:D,_tokenResponse:g,operationType:d})})()}static _forOperation(c,d,g){return(0,C.Z)(function*(){yield c._updateTokensIfNecessary(g,!0);const y=Ki(g);return new gn({user:c,providerId:y,_tokenResponse:g,operationType:d})})()}}function Ki(f){return f.providerId?f.providerId:"phoneNumber"in f?"phone":null}function vd(){return(vd=(0,C.Z)(function*(f){var c;const d=Qt(f);if(yield d._initializationPromise,null!==(c=d.currentUser)&&void 0!==c&&c.isAnonymous)return new gn({user:d.currentUser,providerId:null,operationType:"signIn"});const g=yield Ts(d,{returnSecureToken:!0}),y=yield gn._fromIdTokenResponse(d,"signIn",g,!0);return yield d._updateCurrentUser(y.user),y})).apply(this,arguments)}class hu extends U.ZR{constructor(c,d,g,y){var E;super(d.code,d.message),this.operationType=g,this.user=y,Object.setPrototypeOf(this,hu.prototype),this.customData={appName:c.name,tenantId:null!==(E=c.tenantId)&&void 0!==E?E:void 0,_serverResponse:d.customData._serverResponse,operationType:g}}static _fromErrorAndOperation(c,d,g,y){return new hu(c,d,g,y)}}function Dp(f,c,d,g){return("reauthenticate"===c?d._getReauthenticationResolver(f):d._getIdTokenResponse(f)).catch(E=>{throw"auth/multi-factor-auth-required"===E.code?hu._fromErrorAndOperation(f,E,c,g):E})}function bp(f){return new Set(f.map(({providerId:c})=>c).filter(c=>!!c))}function Ed(){return Ed=(0,C.Z)(function*(f,c){const d=(0,U.m9)(f);yield Ul(!0,d,c);const{providerUserInfo:g}=yield function Pl(f,c){return Hr.apply(this,arguments)}(d.auth,{idToken:yield d.getIdToken(),deleteProvider:[c]}),y=bp(g||[]);return d.providerData=d.providerData.filter(E=>y.has(E.providerId)),y.has("phone")||(d.phoneNumber=null),yield d.auth._persistUserIfCurrent(d),d}),Ed.apply(this,arguments)}function Id(f,c){return Ap.apply(this,arguments)}function Ap(){return(Ap=(0,C.Z)(function*(f,c,d=!1){const g=yield sr(f,c._linkToIdToken(f.auth,yield f.getIdToken()),d);return gn._forOperation(f,"link",g)})).apply(this,arguments)}function Ul(f,c,d){return Rp.apply(this,arguments)}function Rp(){return(Rp=(0,C.Z)(function*(f,c,d){yield zi(c);const y=!1===f?"provider-already-linked":"no-such-provider";Y(bp(c.providerData).has(d)===f,c.auth,y)})).apply(this,arguments)}function Xy(f,c){return hi.apply(this,arguments)}function hi(){return(hi=(0,C.Z)(function*(f,c,d=!1){const{auth:g}=f,y="reauthenticate";try{const E=yield sr(f,Dp(g,y,c,f),d);Y(E.idToken,g,"internal-error");const D=Ks(E.idToken);Y(D,g,"internal-error");const{sub:M}=D;return Y(f.uid===M,g,"user-mismatch"),gn._forOperation(f,y,E)}catch(E){throw"auth/user-not-found"===E?.code&&mt(g,"user-mismatch"),E}})).apply(this,arguments)}function Jy(f,c){return wd.apply(this,arguments)}function wd(){return(wd=(0,C.Z)(function*(f,c,d=!1){const g="signIn",y=yield Dp(f,g,c),E=yield gn._fromIdTokenResponse(f,g,y);return d||(yield f._updateCurrentUser(E.user)),E})).apply(this,arguments)}function Td(f,c){return Pp.apply(this,arguments)}function Pp(){return(Pp=(0,C.Z)(function*(f,c){return Jy(Qt(f),c)})).apply(this,arguments)}function ev(f,c){return Np.apply(this,arguments)}function Np(){return(Np=(0,C.Z)(function*(f,c){const d=(0,U.m9)(f);return yield Ul(!1,d,c.providerId),Id(d,c)})).apply(this,arguments)}function Mp(f,c){return xp.apply(this,arguments)}function xp(){return(xp=(0,C.Z)(function*(f,c){return Xy((0,U.m9)(f),c)})).apply(this,arguments)}function kp(){return(kp=(0,C.Z)(function*(f,c){return be(f,"POST","/v1/accounts:signInWithCustomToken",J(f,c))})).apply(this,arguments)}function Op(){return Op=(0,C.Z)(function*(f,c){const d=Qt(f),g=yield function TC(f,c){return kp.apply(this,arguments)}(d,{token:c,returnSecureToken:!0}),y=yield gn._fromIdTokenResponse(d,"signIn",g);return yield d._updateCurrentUser(y.user),y}),Op.apply(this,arguments)}class Bl{constructor(c,d){this.factorId=c,this.uid=d.mfaEnrollmentId,this.enrollmentTime=new Date(d.enrolledAt).toUTCString(),this.displayName=d.displayName}static _fromServerResponse(c,d){return"phoneInfo"in d?_r._fromServerResponse(c,d):"totpInfo"in d?Cd._fromServerResponse(c,d):mt(c,"internal-error")}}class _r extends Bl{constructor(c){super("phone",c),this.phoneNumber=c.phoneInfo}static _fromServerResponse(c,d){return new _r(d)}}class Cd extends Bl{constructor(c){super("totp",c)}static _fromServerResponse(c,d){return new Cd(d)}}function Kn(f,c,d){var g;Y((null===(g=d.url)||void 0===g?void 0:g.length)>0,f,"invalid-continue-uri"),Y(typeof d.dynamicLinkDomain>"u"||d.dynamicLinkDomain.length>0,f,"invalid-dynamic-link-domain"),c.continueUrl=d.url,c.dynamicLinkDomain=d.dynamicLinkDomain,c.canHandleCodeInApp=d.handleCodeInApp,d.iOS&&(Y(d.iOS.bundleId.length>0,f,"missing-ios-bundle-id"),c.iOSBundleId=d.iOS.bundleId),d.android&&(Y(d.android.packageName.length>0,f,"missing-android-pkg-name"),c.androidInstallApp=d.android.installApp,c.androidMinimumVersionCode=d.android.minimumVersion,c.androidPackageName=d.android.packageName)}function yr(f){return Ye.apply(this,arguments)}function Ye(){return(Ye=(0,C.Z)(function*(f){const c=Qt(f);c._getPasswordPolicyInternal()&&(yield c._updatePasswordPolicy())})).apply(this,arguments)}function Vn(){return(Vn=(0,C.Z)(function*(f,c,d){const g=Qt(f),y={requestType:"PASSWORD_RESET",email:c,clientType:"CLIENT_TYPE_WEB"};d&&Kn(g,y,d),yield gd(g,y,"getOobCode",st)})).apply(this,arguments)}function Zn(){return Zn=(0,C.Z)(function*(f,c,d){yield _C((0,U.m9)(f),{oobCode:c,newPassword:d}).catch(function(){var g=(0,C.Z)(function*(y){throw"auth/password-does-not-meet-requirements"===y.code&&yr(f),y});return function(y){return g.apply(this,arguments)}}())}),Zn.apply(this,arguments)}function Sd(){return Sd=(0,C.Z)(function*(f,c){yield function yC(f,c){return md.apply(this,arguments)}((0,U.m9)(f),{oobCode:c})}),Sd.apply(this,arguments)}function jl(f,c){return Lp.apply(this,arguments)}function Lp(){return(Lp=(0,C.Z)(function*(f,c){const d=(0,U.m9)(f),g=yield _C(d,{oobCode:c}),y=g.requestType;switch(Y(y,d,"internal-error"),y){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Y(g.newEmail,d,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Y(g.mfaInfo,d,"internal-error");default:Y(g.email,d,"internal-error")}let E=null;return g.mfaInfo&&(E=Bl._fromServerResponse(Qt(d),g.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===g.requestType?g.newEmail:g.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===g.requestType?g.email:g.newEmail)||null,multiFactorInfo:E},operation:y}})).apply(this,arguments)}function Yt(){return(Yt=(0,C.Z)(function*(f,c){const{data:d}=yield jl((0,U.m9)(f),c);return d.email})).apply(this,arguments)}function De(){return(De=(0,C.Z)(function*(f,c,d){const g=Qt(f),D=yield gd(g,{returnSecureToken:!0,email:c,password:d,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ts).catch(z=>{throw"auth/password-does-not-meet-requirements"===z.code&&yr(f),z}),M=yield gn._fromIdTokenResponse(g,"signIn",D);return yield g._updateCurrentUser(M.user),M})).apply(this,arguments)}function Qn(){return(Qn=(0,C.Z)(function*(f,c,d){const g=Qt(f),y={requestType:"EMAIL_SIGNIN",email:c,clientType:"CLIENT_TYPE_WEB"};(function E(D,M){Y(M.handleCodeInApp,g,"argument-error"),M&&Kn(g,D,M)})(y,d),yield gd(g,y,"getOobCode",zy)})).apply(this,arguments)}function Nt(){return(Nt=(0,C.Z)(function*(f,c,d){const g=(0,U.m9)(f),y=Tp.credentialWithLink(c,d||bi());return Y(y._tenantId===(g.tenantId||null),g,"tenant-id-mismatch"),Td(g,y)})).apply(this,arguments)}function Yi(){return(Yi=(0,C.Z)(function*(f,c){return Q(f,"POST","/v1/accounts:createAuthUri",J(f,c))})).apply(this,arguments)}function ma(){return ma=(0,C.Z)(function*(f,c){const g={identifier:c,continueUri:Hs()?bi():"http://localhost"},{signinMethods:y}=yield function Rr(f,c){return Yi.apply(this,arguments)}((0,U.m9)(f),g);return y||[]}),ma.apply(this,arguments)}function Co(){return Co=(0,C.Z)(function*(f,c){const d=(0,U.m9)(f),y={requestType:"VERIFY_EMAIL",idToken:yield f.getIdToken()};c&&Kn(d.auth,y,c);const{email:E}=yield function Hy(f,c){return vp.apply(this,arguments)}(d.auth,y);E!==f.email&&(yield f.reload())}),Co.apply(this,arguments)}function _a(){return _a=(0,C.Z)(function*(f,c,d){const g=(0,U.m9)(f),E={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield f.getIdToken(),newEmail:c};d&&Kn(g.auth,E,d);const{email:D}=yield function qy(f,c){return Wy.apply(this,arguments)}(g.auth,E);D!==f.email&&(yield f.reload())}),_a.apply(this,arguments)}function Ri(){return(Ri=(0,C.Z)(function*(f,c){return Q(f,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function Dd(){return Dd=(0,C.Z)(function*(f,{displayName:c,photoURL:d}){if(void 0===c&&void 0===d)return;const g=(0,U.m9)(f),E={idToken:yield g.getIdToken(),displayName:c,photoUrl:d,returnSecureToken:!0},D=yield sr(g,function pu(f,c){return Ri.apply(this,arguments)}(g.auth,E));g.displayName=D.displayName||null,g.photoURL=D.photoUrl||null;const M=g.providerData.find(({providerId:z})=>"password"===z);M&&(M.displayName=g.displayName,M.photoURL=g.photoURL),yield g._updateTokensIfNecessary(D)}),Dd.apply(this,arguments)}function Do(f,c,d){return Fe.apply(this,arguments)}function Fe(){return Fe=(0,C.Z)(function*(f,c,d){const{auth:g}=f,E={idToken:yield f.getIdToken(),returnSecureToken:!0};c&&(E.email=c),d&&(E.password=d);const D=yield sr(f,function Ie(f,c){return $y.apply(this,arguments)}(g,E));yield f._updateTokensIfNecessary(D,!0)}),Fe.apply(this,arguments)}class Cs{constructor(c,d,g={}){this.isNewUser=c,this.providerId=d,this.profile=g}}class Xi extends Cs{constructor(c,d,g,y){super(c,d,g),this.username=y}}class Ad extends Cs{constructor(c,d){super(c,"facebook.com",d)}}class gu extends Xi{constructor(c,d){super(c,"github.com",d,"string"==typeof d?.login?d?.login:null)}}class wn extends Cs{constructor(c,d){super(c,"google.com",d)}}class mu extends Xi{constructor(c,d,g){super(c,"twitter.com",d,g)}}function ar(f){const{user:c,_tokenResponse:d}=f;return c.isAnonymous&&!d?{providerId:null,isNewUser:!1,profile:null}:function Fp(f){var c,d;if(!f)return null;const{providerId:g}=f,y=f.rawUserInfo?JSON.parse(f.rawUserInfo):{},E=f.isNewUser||"identitytoolkit#SignupNewUserResponse"===f.kind;if(!g&&f?.idToken){const D=null===(d=null===(c=Ks(f.idToken))||void 0===c?void 0:c.firebase)||void 0===d?void 0:d.sign_in_provider;if(D)return new Cs(E,"anonymous"!==D&&"custom"!==D?D:null)}if(!g)return null;switch(g){case"facebook.com":return new Ad(E,y);case"github.com":return new gu(E,y);case"google.com":return new wn(E,y);case"twitter.com":return new mu(E,y,f.screenName||null);case"custom":case"anonymous":return new Cs(E,null);default:return new Cs(E,g,y)}}(d)}class vu{constructor(c,d,g){this.type=c,this.credential=d,this.user=g}static _fromIdtoken(c,d){return new vu("enroll",c,d)}static _fromMfaPendingCredential(c){return new vu("signin",c)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(c){var d,g;if(c?.multiFactorSession){if(null!==(d=c.multiFactorSession)&&void 0!==d&&d.pendingCredential)return vu._fromMfaPendingCredential(c.multiFactorSession.pendingCredential);if(null!==(g=c.multiFactorSession)&&void 0!==g&&g.idToken)return vu._fromIdtoken(c.multiFactorSession.idToken)}return null}}class av{constructor(c,d,g){this.session=c,this.hints=d,this.signInResolver=g}static _fromError(c,d){const g=Qt(c),y=d.customData._serverResponse,E=(y.mfaInfo||[]).map(M=>Bl._fromServerResponse(g,M));Y(y.mfaPendingCredential,g,"internal-error");const D=vu._fromMfaPendingCredential(y.mfaPendingCredential);return new av(D,E,function(){var M=(0,C.Z)(function*(z){const ae=yield z._process(g,D);delete y.mfaInfo,delete y.mfaPendingCredential;const me=Object.assign(Object.assign({},y),{idToken:ae.idToken,refreshToken:ae.refreshToken});switch(d.operationType){case"signIn":const ve=yield gn._fromIdTokenResponse(g,d.operationType,me);return yield g._updateCurrentUser(ve.user),ve;case"reauthenticate":return Y(d.user,g,"internal-error"),gn._forOperation(d.user,d.operationType,me);default:mt(g,"internal-error")}});return function(z){return M.apply(this,arguments)}}())}resolveSignIn(c){var d=this;return(0,C.Z)(function*(){return d.signInResolver(c)})()}}class uv{constructor(c){this.user=c,this.enrolledFactors=[],c._onReload(d=>{d.mfaInfo&&(this.enrolledFactors=d.mfaInfo.map(g=>Bl._fromServerResponse(c.auth,g)))})}static _fromUser(c){return new uv(c)}getSession(){var c=this;return(0,C.Z)(function*(){return vu._fromIdtoken(yield c.user.getIdToken(),c.user)})()}enroll(c,d){var g=this;return(0,C.Z)(function*(){const y=c,E=yield g.getSession(),D=yield sr(g.user,y._process(g.user.auth,E,d));return yield g.user._updateTokensIfNecessary(D),g.user.reload()})()}unenroll(c){var d=this;return(0,C.Z)(function*(){const g="string"==typeof c?c:c.uid,y=yield d.user.getIdToken();try{const E=yield sr(d.user,function dx(f,c){return Q(f,"POST","/v2/accounts/mfaEnrollment:withdraw",J(f,c))}(d.user.auth,{idToken:y,mfaEnrollmentId:g}));d.enrolledFactors=d.enrolledFactors.filter(({uid:D})=>D!==g),yield d.user._updateTokensIfNecessary(E),yield d.user.reload()}catch(E){throw E}})()}}const lv=new WeakMap,Hl="__sak";class Up{constructor(c,d){this.storageRetriever=c,this.type=d}_isAvailable(){try{return this.storage?(this.storage.setItem(Hl,"1"),this.storage.removeItem(Hl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(c,d){return this.storage.setItem(c,JSON.stringify(d)),Promise.resolve()}_get(c){const d=this.storage.getItem(c);return Promise.resolve(d?JSON.parse(d):null)}_remove(c){return this.storage.removeItem(c),Promise.resolve()}get storage(){return this.storageRetriever()}}const Ss=(()=>{class f extends Up{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(d,g)=>this.onStorageEvent(d,g),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function fx(){const f=(0,U.z$)();return da(f)||He(f)}()&&function Wi(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=Vt(),this._shouldAllowMigration=!0}forAllChangedKeys(d){for(const g of Object.keys(this.listeners)){const y=this.storage.getItem(g),E=this.localCache[g];y!==E&&d(g,E,y)}}onStorageEvent(d,g=!1){if(!d.key)return void this.forAllChangedKeys((M,z,ae)=>{this.notifyListeners(M,ae)});const y=d.key;if(g?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const M=this.storage.getItem(y);if(d.newValue!==M)null!==d.newValue?this.storage.setItem(y,d.newValue):this.storage.removeItem(y);else if(this.localCache[y]===d.newValue&&!g)return}const E=()=>{const M=this.storage.getItem(y);!g&&this.localCache[y]===M||this.notifyListeners(y,M)},D=this.storage.getItem(y);!function Zt(){return(0,U.w1)()&&10===document.documentMode}()||D===d.newValue||d.newValue===d.oldValue?E():setTimeout(E,10)}notifyListeners(d,g){this.localCache[d]=g;const y=this.listeners[d];if(y)for(const E of Array.from(y))E(g&&JSON.parse(g))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((d,g,y)=>{this.onStorageEvent(new StorageEvent("storage",{key:d,oldValue:g,newValue:y}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(d,g){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[d]||(this.listeners[d]=new Set,this.localCache[d]=this.storage.getItem(d)),this.listeners[d].add(g)}_removeListener(d,g){this.listeners[d]&&(this.listeners[d].delete(g),0===this.listeners[d].size&&delete this.listeners[d]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(d,g){var y=()=>super._set,E=this;return(0,C.Z)(function*(){yield y().call(E,d,g),E.localCache[d]=JSON.stringify(g)})()}_get(d){var g=()=>super._get,y=this;return(0,C.Z)(function*(){const E=yield g().call(y,d);return y.localCache[d]=JSON.stringify(E),E})()}_remove(d){var g=()=>super._remove,y=this;return(0,C.Z)(function*(){yield g().call(y,d),delete y.localCache[d]})()}}return f.type="LOCAL",f})(),Kr=(()=>{class f extends Up{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(d,g){}_removeListener(d,g){}}return f.type="SESSION",f})();let DC=(()=>{class f{constructor(d){this.eventTarget=d,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(d){const g=this.receivers.find(E=>E.isListeningto(d));if(g)return g;const y=new f(d);return this.receivers.push(y),y}isListeningto(d){return this.eventTarget===d}handleEvent(d){var g=this;return(0,C.Z)(function*(){const y=d,{eventId:E,eventType:D,data:M}=y.data,z=g.handlersMap[D];if(!z?.size)return;y.ports[0].postMessage({status:"ack",eventId:E,eventType:D});const ae=Array.from(z).map(function(){var ve=(0,C.Z)(function*(un){return un(y.origin,M)});return function(un){return ve.apply(this,arguments)}}()),me=yield function cv(f){return Promise.all(f.map(function(){var c=(0,C.Z)(function*(d){try{return{fulfilled:!0,value:yield d}}catch(g){return{fulfilled:!1,reason:g}}});return function(d){return c.apply(this,arguments)}}()))}(ae);y.ports[0].postMessage({status:"done",eventId:E,eventType:D,response:me})})()}_subscribe(d,g){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[d]||(this.handlersMap[d]=new Set),this.handlersMap[d].add(g)}_unsubscribe(d,g){this.handlersMap[d]&&g&&this.handlersMap[d].delete(g),(!g||0===this.handlersMap[d].size)&&delete this.handlersMap[d],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return f.receivers=[],f})();function zl(f="",c=10){let d="";for(let g=0;g<c;g++)d+=Math.floor(10*Math.random());return f+d}class dv{constructor(c){this.target=c,this.handlers=new Set}removeMessageHandler(c){c.messageChannel&&(c.messageChannel.port1.removeEventListener("message",c.onMessage),c.messageChannel.port1.close()),this.handlers.delete(c)}_send(c,d,g=50){var y=this;return(0,C.Z)(function*(){const E=typeof MessageChannel<"u"?new MessageChannel:null;if(!E)throw new Error("connection_unavailable");let D,M;return new Promise((z,ae)=>{const me=zl("",20);E.port1.start();const ve=setTimeout(()=>{ae(new Error("unsupported_event"))},g);M={messageChannel:E,onMessage(un){const xi=un;if(xi.data.eventId===me)switch(xi.data.status){case"ack":clearTimeout(ve),D=setTimeout(()=>{ae(new Error("timeout"))},3e3);break;case"done":clearTimeout(D),z(xi.data.response);break;default:clearTimeout(ve),clearTimeout(D),ae(new Error("invalid_response"))}}},y.handlers.add(M),E.port1.addEventListener("message",M.onMessage),y.target.postMessage({eventType:c,eventId:me,data:d},[E.port2])}).finally(()=>{M&&y.removeMessageHandler(M)})})()}}function Tn(){return window}function ql(){return typeof Tn().WorkerGlobalScope<"u"&&"function"==typeof Tn().importScripts}function Pi(){return(Pi=(0,C.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Bp="firebaseLocalStorageDb",jp="firebaseLocalStorage",Ot="fbase_key";class ya{constructor(c){this.request=c}toPromise(){return new Promise((c,d)=>{this.request.addEventListener("success",()=>{c(this.request.result)}),this.request.addEventListener("error",()=>{d(this.request.error)})})}}function bo(f,c){return f.transaction([jp],c?"readwrite":"readonly").objectStore(jp)}function $p(){const f=indexedDB.open(Bp,1);return new Promise((c,d)=>{f.addEventListener("error",()=>{d(f.error)}),f.addEventListener("upgradeneeded",()=>{const g=f.result;try{g.createObjectStore(jp,{keyPath:Ot})}catch(y){d(y)}}),f.addEventListener("success",(0,C.Z)(function*(){const g=f.result;g.objectStoreNames.contains(jp)?c(g):(g.close(),yield function Pr(){const f=indexedDB.deleteDatabase(Bp);return new ya(f).toPromise()}(),c(yield $p()))}))})}function Eu(f,c,d){return Ao.apply(this,arguments)}function Ao(){return(Ao=(0,C.Z)(function*(f,c,d){const g=bo(f,!0).put({[Ot]:c,value:d});return new ya(g).toPromise()})).apply(this,arguments)}function Hp(){return(Hp=(0,C.Z)(function*(f,c){const d=bo(f,!1).get(c),g=yield new ya(d).toPromise();return void 0===g?null:g.value})).apply(this,arguments)}function Rd(f,c){const d=bo(f,!0).delete(c);return new ya(d).toPromise()}const Iu=(()=>{class f{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var d=this;return(0,C.Z)(function*(){return d.db||(d.db=yield $p()),d.db})()}_withRetries(d){var g=this;return(0,C.Z)(function*(){let y=0;for(;;)try{const E=yield g._openDb();return yield d(E)}catch(E){if(y++>3)throw E;g.db&&(g.db.close(),g.db=void 0)}})()}initializeServiceWorkerMessaging(){var d=this;return(0,C.Z)(function*(){return ql()?d.initializeReceiver():d.initializeSender()})()}initializeReceiver(){var d=this;return(0,C.Z)(function*(){d.receiver=DC._getInstance(function fv(){return ql()?self:null}()),d.receiver._subscribe("keyChanged",function(){var g=(0,C.Z)(function*(y,E){return{keyProcessed:(yield d._poll()).includes(E.key)}});return function(y,E){return g.apply(this,arguments)}}()),d.receiver._subscribe("ping",function(){var g=(0,C.Z)(function*(y,E){return["keyChanged"]});return function(y,E){return g.apply(this,arguments)}}())})()}initializeSender(){var d=this;return(0,C.Z)(function*(){var g,y;if(d.activeServiceWorker=yield function AC(){return Pi.apply(this,arguments)}(),!d.activeServiceWorker)return;d.sender=new dv(d.activeServiceWorker);const E=yield d.sender._send("ping",{},800);E&&null!==(g=E[0])&&void 0!==g&&g.fulfilled&&null!==(y=E[0])&&void 0!==y&&y.value.includes("keyChanged")&&(d.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(d){var g=this;return(0,C.Z)(function*(){if(g.sender&&g.activeServiceWorker&&function hv(){var f;return(null===(f=navigator?.serviceWorker)||void 0===f?void 0:f.controller)||null}()===g.activeServiceWorker)try{yield g.sender._send("keyChanged",{key:d},g.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,C.Z)(function*(){try{if(!indexedDB)return!1;const d=yield $p();return yield Eu(d,Hl,"1"),yield Rd(d,Hl),!0}catch{}return!1})()}_withPendingWrite(d){var g=this;return(0,C.Z)(function*(){g.pendingWrites++;try{yield d()}finally{g.pendingWrites--}})()}_set(d,g){var y=this;return(0,C.Z)(function*(){return y._withPendingWrite((0,C.Z)(function*(){return yield y._withRetries(E=>Eu(E,d,g)),y.localCache[d]=g,y.notifyServiceWorker(d)}))})()}_get(d){var g=this;return(0,C.Z)(function*(){const y=yield g._withRetries(E=>function fi(f,c){return Hp.apply(this,arguments)}(E,d));return g.localCache[d]=y,y})()}_remove(d){var g=this;return(0,C.Z)(function*(){return g._withPendingWrite((0,C.Z)(function*(){return yield g._withRetries(y=>Rd(y,d)),delete g.localCache[d],g.notifyServiceWorker(d)}))})()}_poll(){var d=this;return(0,C.Z)(function*(){const g=yield d._withRetries(D=>{const M=bo(D,!1).getAll();return new ya(M).toPromise()});if(!g)return[];if(0!==d.pendingWrites)return[];const y=[],E=new Set;if(0!==g.length)for(const{fbase_key:D,value:M}of g)E.add(D),JSON.stringify(d.localCache[D])!==JSON.stringify(M)&&(d.notifyListeners(D,M),y.push(D));for(const D of Object.keys(d.localCache))d.localCache[D]&&!E.has(D)&&(d.notifyListeners(D,null),y.push(D));return y})()}notifyListeners(d,g){this.localCache[d]=g;const y=this.listeners[d];if(y)for(const E of Array.from(y))E(g)}startPolling(){var d=this;this.stopPolling(),this.pollTimer=setInterval((0,C.Z)(function*(){return d._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(d,g){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[d]||(this.listeners[d]=new Set,this._get(d)),this.listeners[d].add(g)}_removeListener(d,g){this.listeners[d]&&(this.listeners[d].delete(g),0===this.listeners[d].size&&delete this.listeners[d]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return f.type="LOCAL",f})(),wu=1e12;class ke{constructor(c){this.auth=c,this.counter=wu,this._widgets=new Map}render(c,d){const g=this.counter;return this._widgets.set(g,new mv(c,this.auth.name,d||{})),this.counter++,g}reset(c){var d;const g=c||wu;null===(d=this._widgets.get(g))||void 0===d||d.delete(),this._widgets.delete(g)}getResponse(c){var d;return(null===(d=this._widgets.get(c||wu))||void 0===d?void 0:d.getResponse())||""}execute(c){var d=this;return(0,C.Z)(function*(){var g;return null===(g=d._widgets.get(c||wu))||void 0===g||g.execute(),""})()}}class mv{constructor(c,d,g){this.params=g,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const y="string"==typeof c?document.getElementById(c):c;Y(y,"argument-error",{appName:d}),this.container=y,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function _x(f){const c=[],d="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let g=0;g<f;g++)c.push(d.charAt(Math.floor(62*Math.random())));return c.join("")}(50);const{callback:c,"expired-callback":d}=this.params;if(c)try{c(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,d)try{d()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const qp=Ly("rcb"),MC=new Ai(3e4,6e4);class _v{constructor(){var c;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(c=Tn().grecaptcha)||void 0===c||!c.render)}load(c,d=""){return Y(function Tu(f){return f.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(f)}(d),c,"argument-error"),this.shouldResolveImmediately(d)&&Gn(Tn().grecaptcha)?Promise.resolve(Tn().grecaptcha):new Promise((g,y)=>{const E=Tn().setTimeout(()=>{y(St(c,"network-request-failed"))},MC.get());Tn()[qp]=()=>{Tn().clearTimeout(E),delete Tn()[qp];const M=Tn().grecaptcha;if(!M||!Gn(M))return void y(St(c,"internal-error"));const z=M.render;M.render=(ae,me)=>{const ve=z(ae,me);return this.counter++,ve},this.hostLanguage=d,g(M)},Oy(`https://www.google.com/recaptcha/api.js??${(0,U.xO)({onload:qp,render:"explicit",hl:d})}`).catch(()=>{clearTimeout(E),y(St(c,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(c){var d;return!(null===(d=Tn().grecaptcha)||void 0===d||!d.render)&&(c===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class kC{load(c){return(0,C.Z)(function*(){return new ke(c)})()}clearedOneInstance(){}}const yv="recaptcha",OC={theme:"light",type:"image"};class LC{constructor(c,d,g=Object.assign({},OC)){this.parameters=g,this.type=yv,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Qt(c),this.isInvisible="invisible"===this.parameters.size,Y(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const y="string"==typeof d?document.getElementById(d):d;Y(y,this.auth,"argument-error"),this.container=y,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new kC:new _v,this.validateStartingState()}verify(){var c=this;return(0,C.Z)(function*(){c.assertNotDestroyed();const d=yield c.render(),g=c.getAssertedRecaptcha();return g.getResponse(d)||new Promise(E=>{const D=M=>{M&&(c.tokenChangeListeners.delete(D),E(M))};c.tokenChangeListeners.add(D),c.isInvisible&&g.execute(d)})})()}render(){try{this.assertNotDestroyed()}catch(c){return Promise.reject(c)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(c=>{throw this.renderPromise=null,c})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(c=>{this.container.removeChild(c)})}validateStartingState(){Y(!this.parameters.sitekey,this.auth,"argument-error"),Y(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Y(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(c){return d=>{if(this.tokenChangeListeners.forEach(g=>g(d)),"function"==typeof c)c(d);else if("string"==typeof c){const g=Tn()[c];"function"==typeof g&&g(d)}}}assertNotDestroyed(){Y(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var c=this;return(0,C.Z)(function*(){if(yield c.init(),!c.widgetId){let d=c.container;if(!c.isInvisible){const g=document.createElement("div");d.appendChild(g),d=g}c.widgetId=c.getAssertedRecaptcha().render(d,c.parameters)}return c.widgetId})()}init(){var c=this;return(0,C.Z)(function*(){Y(Hs()&&!ql(),c.auth,"internal-error"),yield function FC(){let f=null;return new Promise(c=>{"complete"!==document.readyState?(f=()=>c(),window.addEventListener("load",f)):c()}).catch(c=>{throw f&&window.removeEventListener("load",f),c})}(),c.recaptcha=yield c._recaptchaLoader.load(c.auth,c.auth.languageCode||void 0);const d=yield function eu(f){return zs.apply(this,arguments)}(c.auth);Y(d,c.auth,"internal-error"),c.parameters.sitekey=d})()}getAssertedRecaptcha(){return Y(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class H{constructor(c,d){this.verificationId=c,this.onConfirmation=d}confirm(c){const d=ga._fromVerification(this.verificationId,c);return this.onConfirmation(d)}}function Wp(){return(Wp=(0,C.Z)(function*(f,c,d){const g=Qt(f),y=yield pi(g,c,(0,U.m9)(d));return new H(y,E=>Td(g,E))})).apply(this,arguments)}function Dt(){return(Dt=(0,C.Z)(function*(f,c,d){const g=(0,U.m9)(f);yield Ul(!1,g,"phone");const y=yield pi(g.auth,c,(0,U.m9)(d));return new H(y,E=>ev(g,E))})).apply(this,arguments)}function va(){return(va=(0,C.Z)(function*(f,c,d){const g=(0,U.m9)(f),y=yield pi(g.auth,c,(0,U.m9)(d));return new H(y,E=>Mp(g,E))})).apply(this,arguments)}function pi(f,c,d){return Gl.apply(this,arguments)}function Gl(){return Gl=(0,C.Z)(function*(f,c,d){var g;const y=yield d.verify();try{let E;if(Y("string"==typeof y,f,"argument-error"),Y(d.type===yv,f,"argument-error"),E="string"==typeof c?{phoneNumber:c}:c,"session"in E){const D=E.session;if("phoneNumber"in E)return Y("enroll"===D.type,f,"internal-error"),(yield function ux(f,c){return Q(f,"POST","/v2/accounts/mfaEnrollment:start",J(f,c))}(f,{idToken:D.credential,phoneEnrollmentInfo:{phoneNumber:E.phoneNumber,recaptchaToken:y}})).phoneSessionInfo.sessionInfo;{Y("signin"===D.type,f,"internal-error");const M=(null===(g=E.multiFactorHint)||void 0===g?void 0:g.uid)||E.multiFactorUid;return Y(M,f,"missing-multi-factor-info"),(yield function pv(f,c){return Q(f,"POST","/v2/accounts/mfaSignIn:start",J(f,c))}(f,{mfaPendingCredential:D.credential,mfaEnrollmentId:M,phoneSignInInfo:{recaptchaToken:y}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:D}=yield function Ip(f,c){return Ky.apply(this,arguments)}(f,{phoneNumber:E.phoneNumber,recaptchaToken:y});return D}}finally{d._reset()}}),Gl.apply(this,arguments)}function Kp(){return(Kp=(0,C.Z)(function*(f,c){yield Id((0,U.m9)(f),c)})).apply(this,arguments)}let Nd=(()=>{class f{constructor(d){this.providerId=f.PROVIDER_ID,this.auth=Qt(d)}verifyPhoneNumber(d,g){return pi(this.auth,d,(0,U.m9)(g))}static credential(d,g){return ga._fromVerification(d,g)}static credentialFromResult(d){return f.credentialFromTaggedObject(d)}static credentialFromError(d){return f.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d)return null;const{phoneNumber:g,temporaryProof:y}=d;return g&&y?ga._fromTokenResponse(g,y):null}}return f.PROVIDER_ID="phone",f.PHONE_SIGN_IN_METHOD="phone",f})();function Ro(f,c){return c?Te(c):(Y(f._popupRedirectResolver,f,"argument-error"),f._popupRedirectResolver)}class lr extends Ml{constructor(c){super("custom","custom"),this.params=c}_getIdTokenResponse(c){return Gi(c,this._buildIdpRequest())}_linkToIdToken(c,d){return Gi(c,this._buildIdpRequest(d))}_getReauthenticationResolver(c){return Gi(c,this._buildIdpRequest())}_buildIdpRequest(c){const d={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return c&&(d.idToken=c),d}}function Qs(f){return Jy(f.auth,new lr(f),f.bypassAuthState)}function Ev(f){const{auth:c,user:d}=f;return Y(d,c,"internal-error"),Xy(d,new lr(f),f.bypassAuthState)}function bs(f){return es.apply(this,arguments)}function es(){return(es=(0,C.Z)(function*(f){const{auth:c,user:d}=f;return Y(d,c,"internal-error"),Id(d,new lr(f),f.bypassAuthState)})).apply(this,arguments)}class Iv{constructor(c,d,g,y,E=!1){this.auth=c,this.resolver=g,this.user=y,this.bypassAuthState=E,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(d)?d:[d]}execute(){var c=this;return new Promise(function(){var d=(0,C.Z)(function*(g,y){c.pendingPromise={resolve:g,reject:y};try{c.eventManager=yield c.resolver._initialize(c.auth),yield c.onExecution(),c.eventManager.registerConsumer(c)}catch(E){c.reject(E)}});return function(g,y){return d.apply(this,arguments)}}())}onAuthEvent(c){var d=this;return(0,C.Z)(function*(){const{urlResponse:g,sessionId:y,postBody:E,tenantId:D,error:M,type:z}=c;if(M)return void d.reject(M);const ae={auth:d.auth,requestUri:g,sessionId:y,tenantId:D||void 0,postBody:E||void 0,user:d.user,bypassAuthState:d.bypassAuthState};try{d.resolve(yield d.getIdpTask(z)(ae))}catch(me){d.reject(me)}})()}onError(c){this.reject(c)}getIdpTask(c){switch(c){case"signInViaPopup":case"signInViaRedirect":return Qs;case"linkViaPopup":case"linkViaRedirect":return bs;case"reauthViaPopup":case"reauthViaRedirect":return Ev;default:mt(this.auth,"internal-error")}}resolve(c){pn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(c),this.unregisterAndCleanUp()}reject(c){pn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(c),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const wv=new Ai(2e3,1e4);function Zp(){return(Zp=(0,C.Z)(function*(f,c,d){const g=Qt(f);rt(f,c,mr);const y=Ro(g,d);return new Yp(g,"signInViaPopup",c,y).executeNotNull()})).apply(this,arguments)}function Kl(){return(Kl=(0,C.Z)(function*(f,c,d){const g=(0,U.m9)(f);rt(g.auth,c,mr);const y=Ro(g.auth,d);return new Yp(g.auth,"reauthViaPopup",c,y,g).executeNotNull()})).apply(this,arguments)}function Zl(){return(Zl=(0,C.Z)(function*(f,c,d){const g=(0,U.m9)(f);rt(g.auth,c,mr);const y=Ro(g.auth,d);return new Yp(g.auth,"linkViaPopup",c,y,g).executeNotNull()})).apply(this,arguments)}let Yp=(()=>{class f extends Iv{constructor(d,g,y,E,D){super(d,g,E,D),this.provider=y,this.authWindow=null,this.pollId=null,f.currentPopupAction&&f.currentPopupAction.cancel(),f.currentPopupAction=this}executeNotNull(){var d=this;return(0,C.Z)(function*(){const g=yield d.execute();return Y(g,d.auth,"internal-error"),g})()}onExecution(){var d=this;return(0,C.Z)(function*(){pn(1===d.filter.length,"Popup operations only handle one event");const g=zl();d.authWindow=yield d.resolver._openPopup(d.auth,d.provider,d.filter[0],g),d.authWindow.associatedEvent=g,d.resolver._originValidation(d.auth).catch(y=>{d.reject(y)}),d.resolver._isIframeWebStorageSupported(d.auth,y=>{y||d.reject(St(d.auth,"web-storage-unsupported"))}),d.pollUserCancellation()})()}get eventId(){var d;return(null===(d=this.authWindow)||void 0===d?void 0:d.associatedEvent)||null}cancel(){this.reject(St(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,f.currentPopupAction=null}pollUserCancellation(){const d=()=>{var g,y;this.pollId=null!==(y=null===(g=this.authWindow)||void 0===g?void 0:g.window)&&void 0!==y&&y.closed?window.setTimeout(()=>{this.pollId=null,this.reject(St(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(d,wv.get())};d()}}return f.currentPopupAction=null,f})();const Cv="pendingRedirect",Ea=new Map;class Sv extends Iv{constructor(c,d,g=!1){super(c,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],d,void 0,g),this.eventId=null}execute(){var c=()=>super.execute,d=this;return(0,C.Z)(function*(){let g=Ea.get(d.auth._key());if(!g){try{const E=(yield function Dv(f,c){return Md.apply(this,arguments)}(d.resolver,d.auth))?yield c().call(d):null;g=()=>Promise.resolve(E)}catch(y){g=()=>Promise.reject(y)}Ea.set(d.auth._key(),g)}return d.bypassAuthState||Ea.set(d.auth._key(),()=>Promise.resolve(null)),g()})()}onAuthEvent(c){var d=()=>super.onAuthEvent,g=this;return(0,C.Z)(function*(){if("signInViaRedirect"===c.type)return d().call(g,c);if("unknown"!==c.type){if(c.eventId){const y=yield g.auth._redirectUserForId(c.eventId);if(y)return g.user=y,d().call(g,c);g.resolve(null)}}else g.resolve(null)})()}onExecution(){return(0,C.Z)(function*(){})()}cleanUp(){}}function Md(){return(Md=(0,C.Z)(function*(f,c){const d=Bt(c),g=Po(f);if(!(yield g._isAvailable()))return!1;const y="true"===(yield g._get(d));return yield g._remove(d),y})).apply(this,arguments)}function xd(f,c){return Ql.apply(this,arguments)}function Ql(){return(Ql=(0,C.Z)(function*(f,c){return Po(f)._set(Bt(c),"true")})).apply(this,arguments)}function Yn(f,c){Ea.set(f._key(),c)}function Po(f){return Te(f._redirectPersistence)}function Bt(f){return Ue(Cv,f.config.apiKey,f.name)}function jC(f,c,d){return function $C(f,c,d){return Xp.apply(this,arguments)}(f,c,d)}function Xp(){return(Xp=(0,C.Z)(function*(f,c,d){const g=Qt(f);rt(f,c,mr),yield g._initializationPromise;const y=Ro(g,d);return yield xd(y,g),y._openRedirect(g,c,"signInViaRedirect")})).apply(this,arguments)}function HC(f,c,d){return function bv(f,c,d){return kd.apply(this,arguments)}(f,c,d)}function kd(){return(kd=(0,C.Z)(function*(f,c,d){const g=(0,U.m9)(f);rt(g.auth,c,mr),yield g.auth._initializationPromise;const y=Ro(g.auth,d);yield xd(y,g.auth);const E=yield eg(g);return y._openRedirect(g.auth,c,"reauthViaRedirect",E)})).apply(this,arguments)}function Od(f,c,d){return function No(f,c,d){return Jp.apply(this,arguments)}(f,c,d)}function Jp(){return(Jp=(0,C.Z)(function*(f,c,d){const g=(0,U.m9)(f);rt(g.auth,c,mr),yield g.auth._initializationPromise;const y=Ro(g.auth,d);yield Ul(!1,g,c.providerId),yield xd(y,g.auth);const E=yield eg(g);return y._openRedirect(g.auth,c,"linkViaRedirect",E)})).apply(this,arguments)}function Cu(){return(Cu=(0,C.Z)(function*(f,c){return yield Qt(f)._initializationPromise,Ia(f,c,!1)})).apply(this,arguments)}function Ia(f,c){return Yl.apply(this,arguments)}function Yl(){return(Yl=(0,C.Z)(function*(f,c,d=!1){const g=Qt(f),y=Ro(g,c),D=yield new Sv(g,y,d).execute();return D&&!d&&(delete D.user._redirectEventId,yield g._persistUserIfCurrent(D.user),yield g._setRedirectUser(null,c)),D})).apply(this,arguments)}function eg(f){return Fd.apply(this,arguments)}function Fd(){return(Fd=(0,C.Z)(function*(f){const c=zl(`${f.uid}:::`);return f._redirectEventId=c,yield f.auth._setRedirectUser(f),yield f.auth._persistUserIfCurrent(f),c})).apply(this,arguments)}class wa{constructor(c){this.auth=c,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(c){this.consumers.add(c),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,c)&&(this.sendToConsumer(this.queuedRedirectEvent,c),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(c){this.consumers.delete(c)}onEvent(c){if(this.hasEventBeenHandled(c))return!1;let d=!1;return this.consumers.forEach(g=>{this.isEventForConsumer(c,g)&&(d=!0,this.sendToConsumer(c,g),this.saveEventToCache(c))}),this.hasHandledPotentialRedirect||!function tg(f){switch(f.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Av(f);default:return!1}}(c)||(this.hasHandledPotentialRedirect=!0,d||(this.queuedRedirectEvent=c,d=!0)),d}sendToConsumer(c,d){var g;if(c.error&&!Av(c)){const y=(null===(g=c.error.code)||void 0===g?void 0:g.split("auth/")[1])||"internal-error";d.onError(St(this.auth,y))}else d.onAuthEvent(c)}isEventForConsumer(c,d){const g=null===d.eventId||!!c.eventId&&c.eventId===d.eventId;return d.filter.includes(c.type)&&g}hasEventBeenHandled(c){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Su(c))}saveEventToCache(c){this.cachedEventUids.add(Su(c)),this.lastProcessedEventTime=Date.now()}}function Su(f){return[f.type,f.eventId,f.sessionId,f.tenantId].filter(c=>c).join("-")}function Av({type:f,error:c}){return"unknown"===f&&"auth/no-auth-event"===c?.code}function Rv(f){return ng.apply(this,arguments)}function ng(){return(ng=(0,C.Z)(function*(f,c={}){return Q(f,"GET","/v1/projects",c)})).apply(this,arguments)}const qC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,yx=/^https?/;function Xl(){return(Xl=(0,C.Z)(function*(f){if(f.config.emulator)return;const{authorizedDomains:c}=yield Rv(f);for(const d of c)try{if(Jl(d))return}catch{}mt(f,"unauthorized-domain")})).apply(this,arguments)}function Jl(f){const c=bi(),{protocol:d,hostname:g}=new URL(c);if(f.startsWith("chrome-extension://")){const D=new URL(f);return""===D.hostname&&""===g?"chrome-extension:"===d&&f.replace("chrome-extension://","")===c.replace("chrome-extension://",""):"chrome-extension:"===d&&D.hostname===g}if(!yx.test(d))return!1;if(qC.test(f))return g===f;const y=f.replace(/\./g,"\\.");return new RegExp("^(.+\\."+y+"|"+y+")$","i").test(g)}const WC=new Ai(3e4,6e4);function Du(){const f=Tn().___jsl;if(f?.H)for(const c of Object.keys(f.H))if(f.H[c].r=f.H[c].r||[],f.H[c].L=f.H[c].L||[],f.H[c].r=[...f.H[c].L],f.CP)for(let d=0;d<f.CP.length;d++)f.CP[d]=null}let Ta=null;const Pv=new Ai(5e3,15e3),Nv="__/auth/iframe",GC="emulator/auth/iframe",As={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},KC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Vd(f){const c=f.config;Y(c.authDomain,f,"auth-domain-config-required");const d=c.emulator?F(c,GC):`https://${f.config.authDomain}/${Nv}`,g={apiKey:c.apiKey,appName:f.name,v:Le.SDK_VERSION},y=KC.get(f.config.apiHost);y&&(g.eid=y);const E=f._getFrameworks();return E.length&&(g.fw=E.join(",")),`${d}?${(0,U.xO)(g).slice(1)}`}function Ud(){return Ud=(0,C.Z)(function*(f){const c=yield function Ex(f){return Ta=Ta||function rg(f){return new Promise((c,d)=>{var g,y,E;function D(){Du(),gapi.load("gapi.iframes",{callback:()=>{c(gapi.iframes.getContext())},ontimeout:()=>{Du(),d(St(f,"network-request-failed"))},timeout:WC.get()})}if(null!==(y=null===(g=Tn().gapi)||void 0===g?void 0:g.iframes)&&void 0!==y&&y.Iframe)c(gapi.iframes.getContext());else{if(null===(E=Tn().gapi)||void 0===E||!E.load){const M=Ly("iframefcb");return Tn()[M]=()=>{gapi.load?D():d(St(f,"network-request-failed"))},Oy(`https://apis.google.com/js/api.js?onload=${M}`).catch(z=>d(z))}D()}}).catch(c=>{throw Ta=null,c})}(f),Ta}(f),d=Tn().gapi;return Y(d,f,"internal-error"),c.open({where:document.body,url:Vd(f),messageHandlersFilter:d.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:As,dontclear:!0},g=>new Promise(function(){var y=(0,C.Z)(function*(E,D){yield g.restyle({setHideOnLeave:!1});const M=St(f,"network-request-failed"),z=Tn().setTimeout(()=>{D(M)},Pv.get());function ae(){Tn().clearTimeout(z),E(g)}g.ping(ae).then(ae,()=>{D(M)})});return function(E,D){return y.apply(this,arguments)}}()))}),Ud.apply(this,arguments)}const Bd={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class og{constructor(c){this.window=c,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const jd="__/auth/handler",Ca="emulator/auth/handler",YC=encodeURIComponent("fac");function $d(f,c,d,g,y,E){return Hd.apply(this,arguments)}function Hd(){return(Hd=(0,C.Z)(function*(f,c,d,g,y,E){Y(f.config.authDomain,f,"auth-domain-config-required"),Y(f.config.apiKey,f,"invalid-api-key");const D={apiKey:f.config.apiKey,appName:f.name,authType:d,redirectUrl:g,v:Le.SDK_VERSION,eventId:y};if(c instanceof mr){c.setDefaultLanguage(f.languageCode),D.providerId=c.providerId||"",(0,U.xb)(c.getCustomParameters())||(D.customParameters=JSON.stringify(c.getCustomParameters()));for(const[me,ve]of Object.entries(E||{}))D[me]=ve}if(c instanceof cu){const me=c.getScopes().filter(ve=>""!==ve);me.length>0&&(D.scopes=me.join(","))}f.tenantId&&(D.tid=f.tenantId);const M=D;for(const me of Object.keys(M))void 0===M[me]&&delete M[me];const z=yield f._getAppCheckToken(),ae=z?`#${YC}=${encodeURIComponent(z)}`:"";return`${function bu({config:f}){return f.emulator?F(f,Ca):`https://${f.authDomain}/${jd}`}(f)}?${(0,U.xO)(M).slice(1)}${ae}`})).apply(this,arguments)}const Mo="webStorageSupport",Ov=class Un{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Kr,this._completeRedirectFn=Ia,this._overrideRedirectResult=Yn}_openPopup(c,d,g,y){var E=this;return(0,C.Z)(function*(){var D;pn(null===(D=E.eventManagers[c._key()])||void 0===D?void 0:D.manager,"_initialize() not called before _openPopup()");const M=yield $d(c,d,g,bi(),y);return function kv(f,c,d,g=500,y=600){const E=Math.max((window.screen.availHeight-y)/2,0).toString(),D=Math.max((window.screen.availWidth-g)/2,0).toString();let M="";const z=Object.assign(Object.assign({},Bd),{width:g.toString(),height:y.toString(),top:E,left:D}),ae=(0,U.z$)().toLowerCase();d&&(M=pd(ae)?"_blank":d),qi(ae)&&(c=c||"http://localhost",z.scrollbars="yes");const me=Object.entries(z).reduce((un,[xi,ih])=>`${un}${xi}=${ih},`,"");if(function L(f=(0,U.z$)()){var c;return He(f)&&!(null===(c=window.navigator)||void 0===c||!c.standalone)}(ae)&&"_self"!==M)return function QC(f,c){const d=document.createElement("a");d.href=f,d.target=c;const g=document.createEvent("MouseEvent");g.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),d.dispatchEvent(g)}(c||"",M),new og(null);const ve=window.open(c||"",M,me);Y(ve,f,"popup-blocked");try{ve.focus()}catch{}return new og(ve)}(c,M,zl())})()}_openRedirect(c,d,g,y){var E=this;return(0,C.Z)(function*(){return yield E._originValidation(c),function bC(f){Tn().location.href=f}(yield $d(c,d,g,bi(),y)),new Promise(()=>{})})()}_initialize(c){const d=c._key();if(this.eventManagers[d]){const{manager:y,promise:E}=this.eventManagers[d];return y?Promise.resolve(y):(pn(E,"If manager is not set, promise should be"),E)}const g=this.initAndGetManager(c);return this.eventManagers[d]={promise:g},g.catch(()=>{delete this.eventManagers[d]}),g}initAndGetManager(c){var d=this;return(0,C.Z)(function*(){const g=yield function ig(f){return Ud.apply(this,arguments)}(c),y=new wa(c);return g.register("authEvent",E=>(Y(E?.authEvent,c,"invalid-auth-event"),{status:y.onEvent(E.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),d.eventManagers[c._key()]={manager:y},d.iframes[c._key()]=g,y})()}_isIframeWebStorageSupported(c,d){this.iframes[c._key()].send(Mo,{type:Mo},y=>{var E;const D=null===(E=y?.[0])||void 0===E?void 0:E[Mo];void 0!==D&&d(!!D),mt(c,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(c){const d=c._key();return this.originValidationPromises[d]||(this.originValidationPromises[d]=function vx(f){return Xl.apply(this,arguments)}(c)),this.originValidationPromises[d]}get _shouldInitProactively(){return Vt()||da()||He()}};class ag{constructor(c){this.factorId=c}_process(c,d,g){switch(d.type){case"enroll":return this._finalizeEnroll(c,d.credential,g);case"signin":return this._finalizeSignIn(c,d.credential);default:return fn("unexpected MultiFactorSessionType")}}}class ec extends ag{constructor(c){super("phone"),this.credential=c}static _fromCredential(c){return new ec(c)}_finalizeEnroll(c,d,g){return function lx(f,c){return Q(f,"POST","/v2/accounts/mfaEnrollment:finalize",J(f,c))}(c,{idToken:d,displayName:g,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(c,d){return function gv(f,c){return Q(f,"POST","/v2/accounts/mfaSignIn:finalize",J(f,c))}(c,{mfaPendingCredential:d,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let XC=(()=>{class f{constructor(){}static assertion(d){return ec._fromCredential(d)}}return f.FACTOR_ID="phone",f})();var Da="@firebase/auth";class lg{constructor(c){this.auth=c,this.internalListeners=new Map}getUid(){var c;return this.assertAuthConfigured(),(null===(c=this.auth.currentUser)||void 0===c?void 0:c.uid)||null}getToken(c){var d=this;return(0,C.Z)(function*(){return d.assertAuthConfigured(),yield d.auth._initializationPromise,d.auth.currentUser?{accessToken:yield d.auth.currentUser.getIdToken(c)}:null})()}addAuthTokenListener(c){if(this.assertAuthConfigured(),this.internalListeners.has(c))return;const d=this.auth.onIdTokenChanged(g=>{c(g?.stsTokenManager.accessToken||null)});this.internalListeners.set(c,d),this.updateProactiveRefresh()}removeAuthTokenListener(c){this.assertAuthConfigured();const d=this.internalListeners.get(c);d&&(this.internalListeners.delete(c),d(),this.updateProactiveRefresh())}assertAuthConfigured(){Y(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Pu(){return window}(0,U.Pz)("authIdTokenMaxAge"),function Ix(f){(0,Le._registerComponent)(new Rn.wA("auth",(c,{options:d})=>{const g=c.getProvider("app").getImmediate(),y=c.getProvider("heartbeat"),E=c.getProvider("app-check-internal"),{apiKey:D,authDomain:M}=g.options;Y(D&&!D.includes(":"),"invalid-api-key",{appName:g.name});const z={apiKey:D,authDomain:M,clientPlatform:f,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wo(f)},ae=new It(g,y,E,z);return function JM(f,c){const d=c?.persistence||[],g=(Array.isArray(d)?d:[d]).map(Te);c?.errorMap&&f._updateErrorMap(c.errorMap),f._initializeWithPersistence(g,c?.popupRedirectResolver)}(ae,d),ae},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((c,d,g)=>{c.getProvider("auth-internal").initialize()})),(0,Le._registerComponent)(new Rn.wA("auth-internal",c=>{const d=Qt(c.getProvider("auth").getImmediate());return new lg(d)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,Le.registerVersion)(Da,"1.5.1",function Ru(f){switch(f){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(f)),(0,Le.registerVersion)(Da,"1.5.1","esm2017")}("Browser");function cg(){return cg=(0,C.Z)(function*(f,c,d){var g;const{BuildInfo:y}=Pu();pn(c.sessionId,"AuthEvent did not contain a session ID");const E=yield function Mu(f){return zd.apply(this,arguments)}(c.sessionId),D={};return He()?D.ibi=y.packageName:R()?D.apn=y.packageName:mt(f,"operation-not-supported-in-this-environment"),y.displayName&&(D.appDisplayName=y.displayName),D.sessionId=E,$d(f,d,c.type,void 0,null!==(g=c.eventId)&&void 0!==g?g:void 0,D)}),cg.apply(this,arguments)}function Cn(){return(Cn=(0,C.Z)(function*(f){const{BuildInfo:c}=Pu(),d={};He()?d.iosBundleId=c.packageName:R()?d.androidPackageName=c.packageName:mt(f,"operation-not-supported-in-this-environment"),yield Rv(f,d)})).apply(this,arguments)}function dg(){return(dg=(0,C.Z)(function*(f,c,d){const{cordova:g}=Pu();let y=()=>{};try{yield new Promise((E,D)=>{let M=null;function z(){var ve;E();const un=null===(ve=g.plugins.browsertab)||void 0===ve?void 0:ve.close;"function"==typeof un&&un(),"function"==typeof d?.close&&d.close()}function ae(){M||(M=window.setTimeout(()=>{D(St(f,"redirect-cancelled-by-user"))},2e3))}function me(){"visible"===document?.visibilityState&&ae()}c.addPassiveListener(z),document.addEventListener("resume",ae,!1),R()&&document.addEventListener("visibilitychange",me,!1),y=()=>{c.removePassiveListener(z),document.removeEventListener("resume",ae,!1),document.removeEventListener("visibilitychange",me,!1),M&&window.clearTimeout(M)}})}finally{y()}})).apply(this,arguments)}function zd(){return(zd=(0,C.Z)(function*(f){const c=function qd(f){if(pn(/[0-9a-zA-Z]+/.test(f),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(f);const c=new ArrayBuffer(f.length),d=new Uint8Array(c);for(let g=0;g<f.length;g++)d[g]=f.charCodeAt(g);return d}(f),d=yield crypto.subtle.digest("SHA-256",c);return Array.from(new Uint8Array(d)).map(y=>y.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class hg extends wa{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(c=>{this.resolveInialized=c})}addPassiveListener(c){this.passiveListeners.add(c)}removePassiveListener(c){this.passiveListeners.delete(c)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(c){return this.resolveInialized(),this.passiveListeners.forEach(d=>d(c)),super.onEvent(c)}initialized(){var c=this;return(0,C.Z)(function*(){yield c.initPromise})()}}function s0(f){return Nr.apply(this,arguments)}function Nr(){return(Nr=(0,C.Z)(function*(f){const c=yield Fv()._get(Wd(f));return c&&(yield Fv()._remove(Wd(f))),c})).apply(this,arguments)}function xu(){const f=[];for(let d=0;d<20;d++){const g=Math.floor(62*Math.random());f.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(g))}return f.join("")}function Fv(){return Te(Ss)}function Wd(f){return Ue("authEvent",f.config.apiKey,f.name)}function Gd(f){if(!f?.includes("?"))return{};const[c,...d]=f.split("?");return(0,U.zd)(d.join("?"))}const c0=class l0{constructor(){this._redirectPersistence=Kr,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Ia,this._overrideRedirectResult=Yn}_initialize(c){var d=this;return(0,C.Z)(function*(){const g=c._key();let y=d.eventManagers.get(g);return y||(y=new hg(c),d.eventManagers.set(g,y),d.attachCallbackListeners(c,y)),y})()}_openPopup(c){mt(c,"operation-not-supported-in-this-environment")}_openRedirect(c,d,g,y){var E=this;return(0,C.Z)(function*(){!function Zr(f){var c,d,g,y,E,D,M,z,ae,me;const ve=Pu();Y("function"==typeof(null===(c=ve?.universalLinks)||void 0===c?void 0:c.subscribe),f,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),Y(typeof(null===(d=ve?.BuildInfo)||void 0===d?void 0:d.packageName)<"u",f,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),Y("function"==typeof(null===(E=null===(y=null===(g=ve?.cordova)||void 0===g?void 0:g.plugins)||void 0===y?void 0:y.browsertab)||void 0===E?void 0:E.openUrl),f,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Y("function"==typeof(null===(z=null===(M=null===(D=ve?.cordova)||void 0===D?void 0:D.plugins)||void 0===M?void 0:M.browsertab)||void 0===z?void 0:z.isAvailable),f,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Y("function"==typeof(null===(me=null===(ae=ve?.cordova)||void 0===ae?void 0:ae.InAppBrowser)||void 0===me?void 0:me.open),f,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(c);const D=yield E._initialize(c);yield D.initialized(),D.resetRedirect(),function BC(){Ea.clear()}(),yield E._originValidation(c);const M=function Sx(f,c,d=null){return{type:c,eventId:d,urlResponse:null,sessionId:xu(),postBody:null,tenantId:f.tenantId,error:St(f,"no-auth-event")}}(c,g,y);yield function Lv(f,c){return Fv()._set(Wd(f),c)}(c,M);const z=yield function Nu(f,c,d){return cg.apply(this,arguments)}(c,M,d),ae=yield function r0(f){const{cordova:c}=Pu();return new Promise(d=>{c.plugins.browsertab.isAvailable(g=>{let y=null;g?c.plugins.browsertab.openUrl(f):y=c.InAppBrowser.open(f,function it(f=(0,U.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(f)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(f)}()?"_blank":"_system","location=yes"),d(y)})})}(z);return function tc(f,c,d){return dg.apply(this,arguments)}(c,D,ae)})()}_isIframeWebStorageSupported(c,d){throw new Error("Method not implemented.")}_originValidation(c){const d=c._key();return this.originValidationPromises[d]||(this.originValidationPromises[d]=function n0(f){return Cn.apply(this,arguments)}(c)),this.originValidationPromises[d]}attachCallbackListeners(c,d){const{universalLinks:g,handleOpenURL:y,BuildInfo:E}=Pu(),D=setTimeout((0,C.Z)(function*(){yield s0(c),d.onEvent(Kd())}),500),M=function(){var me=(0,C.Z)(function*(ve){clearTimeout(D);const un=yield s0(c);let xi=null;un&&ve?.url&&(xi=function fg(f,c){var d,g;const y=function a0(f){const c=Gd(f),d=c.link?decodeURIComponent(c.link):void 0,g=Gd(d).link,y=c.deep_link_id?decodeURIComponent(c.deep_link_id):void 0;return Gd(y).link||y||g||d||f}(c);if(y.includes("/__/auth/callback")){const E=Gd(y),D=E.firebaseError?function o0(f){try{return JSON.parse(f)}catch{return null}}(decodeURIComponent(E.firebaseError)):null,M=null===(g=null===(d=D?.code)||void 0===d?void 0:d.split("auth/"))||void 0===g?void 0:g[1],z=M?St(M):null;return z?{type:f.type,eventId:f.eventId,tenantId:f.tenantId,error:z,urlResponse:null,sessionId:null,postBody:null}:{type:f.type,eventId:f.eventId,tenantId:f.tenantId,sessionId:f.sessionId,urlResponse:y,postBody:null}}return null}(un,ve.url)),d.onEvent(xi||Kd())});return function(un){return me.apply(this,arguments)}}();typeof g<"u"&&"function"==typeof g.subscribe&&g.subscribe(null,M);const z=y,ae=`${E.packageName.toLowerCase()}://`;Pu().handleOpenURL=function(){var me=(0,C.Z)(function*(ve){if(ve.toLowerCase().startsWith(ae)&&M({url:ve}),"function"==typeof z)try{z(ve)}catch(un){console.error(un)}});return function(ve){return me.apply(this,arguments)}}()}};function Kd(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:St("no-auth-event")}}function xo(){var f;return(null===(f=self?.location)||void 0===f?void 0:f.protocol)||null}function pg(f=(0,U.z$)()){return!("file:"!==xo()&&"ionic:"!==xo()&&"capacitor:"!==xo()||!f.toLowerCase().match(/iphone|ipad|ipod|android/))}function Uv(){try{const f=self.localStorage,c=zl();if(f)return f.setItem(c,"1"),f.removeItem(c),!function p0(f=(0,U.z$)()){return function Qd(){return(0,U.w1)()&&11===document?.documentMode}()||function Vv(f=(0,U.z$)()){return/Edge\/\d+/.test(f)}(f)}()||(0,U.hl)()}catch{return ko()&&(0,U.hl)()}return!1}function ko(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function ba(){return(function f0(){return"http:"===xo()||"https:"===xo()}()||(0,U.ru)()||pg())&&!function gg(){return(0,U.b$)()||(0,U.UG)()}()&&Uv()&&!ko()}function Bv(){return pg()&&typeof document<"u"}function Yd(){return(Yd=(0,C.Z)(function*(){return!!Bv()&&new Promise(f=>{const c=setTimeout(()=>{f(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(c),f(!0)})})})).apply(this,arguments)}const Ni={LOCAL:"local",NONE:"none",SESSION:"session"},ic=Y,jv="persistence";function Xs(f){return Xd.apply(this,arguments)}function Xd(){return(Xd=(0,C.Z)(function*(f){yield f._initializationPromise;const c=sc(),d=Ue(jv,f.config.apiKey,f.name);c&&c.setItem(d,f._getPersistence())})).apply(this,arguments)}function sc(){var f;try{return(null===(f=function g0(){return typeof window<"u"?window:null}())||void 0===f?void 0:f.sessionStorage)||null}catch{return null}}const $v=Y;class Oo{constructor(){this.browserResolver=Te(Ov),this.cordovaResolver=Te(c0),this.underlyingResolver=null,this._redirectPersistence=Kr,this._completeRedirectFn=Ia,this._overrideRedirectResult=Yn}_initialize(c){var d=this;return(0,C.Z)(function*(){return yield d.selectUnderlyingResolver(),d.assertedUnderlyingResolver._initialize(c)})()}_openPopup(c,d,g,y){var E=this;return(0,C.Z)(function*(){return yield E.selectUnderlyingResolver(),E.assertedUnderlyingResolver._openPopup(c,d,g,y)})()}_openRedirect(c,d,g,y){var E=this;return(0,C.Z)(function*(){return yield E.selectUnderlyingResolver(),E.assertedUnderlyingResolver._openRedirect(c,d,g,y)})()}_isIframeWebStorageSupported(c,d){this.assertedUnderlyingResolver._isIframeWebStorageSupported(c,d)}_originValidation(c){return this.assertedUnderlyingResolver._originValidation(c)}get _shouldInitProactively(){return Bv()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return $v(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var c=this;return(0,C.Z)(function*(){if(c.underlyingResolver)return;const d=yield function Dx(){return Yd.apply(this,arguments)}();c.underlyingResolver=d?c.cordovaResolver:c.browserResolver})()}}function _g(f){return f.unwrap()}function Jd(f){return eh(f)}function eh(f){const{_tokenResponse:c}=f instanceof U.ZR?f.customData:f;if(!c)return null;if(!(f instanceof U.ZR)&&"temporaryProof"in c&&"phoneNumber"in c)return Nd.credentialFromResult(f);const d=c.providerId;if(!d||d===Tt.PASSWORD)return null;let g;switch(d){case Tt.GOOGLE:g=oe;break;case Tt.FACEBOOK:g=Cp;break;case Tt.GITHUB:g=Fl;break;case Tt.TWITTER:g=Yy;break;default:const{oauthIdToken:y,oauthAccessToken:E,oauthTokenSecret:D,pendingToken:M,nonce:z}=c;return E||D||y||M?M?d.startsWith("saml.")?ws._create(d,M):Is._fromParams({providerId:d,signInMethod:d,pendingToken:M,idToken:y,accessToken:E}):new K(d).credential({idToken:y,accessToken:E,rawNonce:z}):null}return f instanceof U.ZR?g.credentialFromError(f):g.credentialFromResult(f)}function Qr(f,c){return c.catch(d=>{throw d instanceof U.ZR&&function bx(f,c){var d;const g=null===(d=c.customData)||void 0===d?void 0:d._tokenResponse;if("auth/multi-factor-auth-required"===c?.code)c.resolver=new zv(f,function ax(f,c){var d;const g=(0,U.m9)(f),y=c;return Y(c.customData.operationType,g,"argument-error"),Y(null===(d=y.customData._serverResponse)||void 0===d?void 0:d.mfaPendingCredential,g,"argument-error"),av._fromError(g,y)}(f,c));else if(g){const y=eh(c),E=c;y&&(E.credential=y,E.tenantId=g.tenantId||void 0,E.email=g.email||void 0,E.phoneNumber=g.phoneNumber||void 0)}}(f,d),d}).then(d=>{const y=d.user;return{operationType:d.operationType,credential:Jd(d),additionalUserInfo:ar(d),user:Mr.getOrCreate(y)}})}function oc(f,c){return th.apply(this,arguments)}function th(){return(th=(0,C.Z)(function*(f,c){const d=yield c;return{verificationId:d.verificationId,confirm:g=>Qr(f,d.confirm(g))}})).apply(this,arguments)}class zv{constructor(c,d){this.resolver=d,this.auth=function Hv(f){return f.wrapped()}(c)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(c){return Qr(_g(this.auth),this.resolver.resolveSignIn(c))}}class Mr{constructor(c){this._delegate=c,this.multiFactor=function hx(f){const c=(0,U.m9)(f);return lv.has(c)||lv.set(c,uv._fromUser(c)),lv.get(c)}(c)}static getOrCreate(c){return Mr.USER_MAP.has(c)||Mr.USER_MAP.set(c,new Mr(c)),Mr.USER_MAP.get(c)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(c){return this._delegate.getIdTokenResult(c)}getIdToken(c){return this._delegate.getIdToken(c)}linkAndRetrieveDataWithCredential(c){return this.linkWithCredential(c)}linkWithCredential(c){var d=this;return(0,C.Z)(function*(){return Qr(d.auth,ev(d._delegate,c))})()}linkWithPhoneNumber(c,d){var g=this;return(0,C.Z)(function*(){return oc(g.auth,function VC(f,c,d){return Dt.apply(this,arguments)}(g._delegate,c,d))})()}linkWithPopup(c){var d=this;return(0,C.Z)(function*(){return Qr(d.auth,function Tv(f,c,d){return Zl.apply(this,arguments)}(d._delegate,c,Oo))})()}linkWithRedirect(c){var d=this;return(0,C.Z)(function*(){return yield Xs(Qt(d.auth)),Od(d._delegate,c,Oo)})()}reauthenticateAndRetrieveDataWithCredential(c){return this.reauthenticateWithCredential(c)}reauthenticateWithCredential(c){var d=this;return(0,C.Z)(function*(){return Qr(d.auth,Mp(d._delegate,c))})()}reauthenticateWithPhoneNumber(c,d){return oc(this.auth,function vv(f,c,d){return va.apply(this,arguments)}(this._delegate,c,d))}reauthenticateWithPopup(c){return Qr(this.auth,function Qp(f,c,d){return Kl.apply(this,arguments)}(this._delegate,c,Oo))}reauthenticateWithRedirect(c){var d=this;return(0,C.Z)(function*(){return yield Xs(Qt(d.auth)),HC(d._delegate,c,Oo)})()}sendEmailVerification(c){return function nv(f,c){return Co.apply(this,arguments)}(this._delegate,c)}unlink(c){var d=this;return(0,C.Z)(function*(){return yield function Vl(f,c){return Ed.apply(this,arguments)}(d._delegate,c),d})()}updateEmail(c){return function So(f,c){return Do((0,U.m9)(f),c,null)}(this._delegate,c)}updatePassword(c){return function bd(f,c){return Do((0,U.m9)(f),null,c)}(this._delegate,c)}updatePhoneNumber(c){return function Gp(f,c){return Kp.apply(this,arguments)}(this._delegate,c)}updateProfile(c){return function $l(f,c){return Dd.apply(this,arguments)}(this._delegate,c)}verifyBeforeUpdateEmail(c,d){return function an(f,c,d){return _a.apply(this,arguments)}(this._delegate,c,d)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Mr.USER_MAP=new WeakMap;const ac=Y;let nh=(()=>{class f{constructor(d,g){if(this.app=d,g.isInitialized())return this._delegate=g.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:y}=d.options;ac(y,"invalid-api-key",{appName:d.name}),ac(y,"invalid-api-key",{appName:d.name});const E=typeof window<"u"?Oo:void 0;this._delegate=g.initialize({options:{persistence:_0(y,d.name),popupRedirectResolver:E}}),this._delegate._updateErrorMap(On),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Mr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(d){this._delegate.languageCode=d}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(d){this._delegate.tenantId=d}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(d,g){!function By(f,c,d){const g=Qt(f);Y(g._canInitEmulator,g,"emulator-config-failed"),Y(/^https?:\/\//.test(c),g,"invalid-emulator-scheme");const y=!!d?.disableWarnings,E=mC(c),{host:D,port:M}=function Wr(f){const c=mC(f),d=/(\/\/)?([^?#/]+)/.exec(f.substr(c.length));if(!d)return{host:"",port:null};const g=d[2].split("@").pop()||"",y=/^(\[[^\]]+\])(:|$)/.exec(g);if(y){const E=y[1];return{host:E,port:Me(g.substr(E.length+1))}}{const[E,D]=g.split(":");return{host:E,port:Me(D)}}}(c);g.config.emulator={url:`${E}//${D}${null===M?"":`:${M}`}/`},g.settings.appVerificationDisabledForTesting=!0,g.emulatorConfig=Object.freeze({host:D,port:M,protocol:E.replace(":",""),options:Object.freeze({disableWarnings:y})}),y||function ex(){function f(){const c=document.createElement("p"),d=c.style;c.innerText="Running in emulator mode. Do not use with production credentials.",d.position="fixed",d.width="100%",d.backgroundColor="#ffffff",d.border=".1em solid #000000",d.color="#b50000",d.bottom="0px",d.left="0px",d.margin="0px",d.zIndex="10000",d.textAlign="center",c.classList.add("firebase-emulator-warning"),document.body.appendChild(c)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",f):f())}()}(this._delegate,d,g)}applyActionCode(d){return function tv(f,c){return Sd.apply(this,arguments)}(this._delegate,d)}checkActionCode(d){return jl(this._delegate,d)}confirmPasswordReset(d,g){return function To(f,c,d){return Zn.apply(this,arguments)}(this._delegate,d,g)}createUserWithEmailAndPassword(d,g){var y=this;return(0,C.Z)(function*(){return Qr(y._delegate,function se(f,c,d){return De.apply(this,arguments)}(y._delegate,d,g))})()}fetchProvidersForEmail(d){return this.fetchSignInMethodsForEmail(d)}fetchSignInMethodsForEmail(d){return function je(f,c){return ma.apply(this,arguments)}(this._delegate,d)}isSignInWithEmailLink(d){return function Qi(f,c){const d=lu.parseLink(c);return"EMAIL_SIGNIN"===d?.operation}(0,d)}getRedirectResult(){var d=this;return(0,C.Z)(function*(){ac(ba(),d._delegate,"operation-not-supported-in-this-environment");const g=yield function Ld(f,c){return Cu.apply(this,arguments)}(d._delegate,Oo);return g?Qr(d._delegate,Promise.resolve(g)):{credential:null,user:null}})()}addFrameworkForLogging(d){!function Zd(f,c){Qt(f)._logFramework(c)}(this._delegate,d)}onAuthStateChanged(d,g,y){const{next:E,error:D,complete:M}=uc(d,g,y);return this._delegate.onAuthStateChanged(E,D,M)}onIdTokenChanged(d,g,y){const{next:E,error:D,complete:M}=uc(d,g,y);return this._delegate.onIdTokenChanged(E,D,M)}sendSignInLinkToEmail(d,g){return function Zi(f,c,d){return Qn.apply(this,arguments)}(this._delegate,d,g)}sendPasswordResetEmail(d,g){return function Fn(f,c,d){return Vn.apply(this,arguments)}(this._delegate,d,g||void 0)}setPersistence(d){var g=this;return(0,C.Z)(function*(){let y;switch(function m0(f,c){ic(Object.values(Ni).includes(c),f,"invalid-persistence-type"),(0,U.b$)()?ic(c!==Ni.SESSION,f,"unsupported-persistence-type"):(0,U.UG)()?ic(c===Ni.NONE,f,"unsupported-persistence-type"):ko()?ic(c===Ni.NONE||c===Ni.LOCAL&&(0,U.hl)(),f,"unsupported-persistence-type"):ic(c===Ni.NONE||Uv(),f,"unsupported-persistence-type")}(g._delegate,d),d){case Ni.SESSION:y=Kr;break;case Ni.LOCAL:y=(yield Te(Iu)._isAvailable())?Iu:Ss;break;case Ni.NONE:y=fe;break;default:return mt("argument-error",{appName:g._delegate.name})}return g._delegate.setPersistence(y)})()}signInAndRetrieveDataWithCredential(d){return this.signInWithCredential(d)}signInAnonymously(){return Qr(this._delegate,function yt(f){return vd.apply(this,arguments)}(this._delegate))}signInWithCredential(d){return Qr(this._delegate,Td(this._delegate,d))}signInWithCustomToken(d){return Qr(this._delegate,function Gr(f,c){return Op.apply(this,arguments)}(this._delegate,d))}signInWithEmailAndPassword(d,g){return Qr(this._delegate,function Xt(f,c,d){return Td((0,U.m9)(f),Tp.credential(c,d)).catch(function(){var g=(0,C.Z)(function*(y){throw"auth/password-does-not-meet-requirements"===y.code&&yr(f),y});return function(y){return g.apply(this,arguments)}}())}(this._delegate,d,g))}signInWithEmailLink(d,g){return Qr(this._delegate,function fu(f,c,d){return Nt.apply(this,arguments)}(this._delegate,d,g))}signInWithPhoneNumber(d,g){return oc(this._delegate,function ct(f,c,d){return Wp.apply(this,arguments)}(this._delegate,d,g))}signInWithPopup(d){var g=this;return(0,C.Z)(function*(){return ac(ba(),g._delegate,"operation-not-supported-in-this-environment"),Qr(g._delegate,function UC(f,c,d){return Zp.apply(this,arguments)}(g._delegate,d,Oo))})()}signInWithRedirect(d){var g=this;return(0,C.Z)(function*(){return ac(ba(),g._delegate,"operation-not-supported-in-this-environment"),yield Xs(g._delegate),jC(g._delegate,d,Oo)})()}updateCurrentUser(d){return this._delegate.updateCurrentUser(d)}verifyPasswordResetCode(d){return function CC(f,c){return Yt.apply(this,arguments)}(this._delegate,d)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return f.Persistence=Ni,f})();function uc(f,c,d){let g=f;"function"!=typeof f&&({next:g,error:c,complete:d}=f);const y=g;return{next:D=>y(D&&Mr.getOrCreate(D)),error:c,complete:d}}function _0(f,c){const d=function mg(f,c){const d=sc();if(!d)return[];const g=Ue(jv,f,c);switch(d.getItem(g)){case Ni.NONE:return[fe];case Ni.LOCAL:return[Iu,Kr];case Ni.SESSION:return[Kr];default:return[]}}(f,c);if(typeof self<"u"&&!d.includes(Iu)&&d.push(Iu),typeof window<"u")for(const g of[Ss,Kr])d.includes(g)||d.push(g);return d.includes(fe)||d.push(fe),d}class lc{constructor(){this.providerId="phone",this._delegate=new Nd(_g(Ee.Z.auth()))}static credential(c,d){return Nd.credential(c,d)}verifyPhoneNumber(c,d){return this._delegate.verifyPhoneNumber(c,d)}unwrap(){return this._delegate}}lc.PHONE_SIGN_IN_METHOD=Nd.PHONE_SIGN_IN_METHOD,lc.PROVIDER_ID=Nd.PROVIDER_ID;const rh=Y;class Mi{constructor(c,d,g=Ee.Z.app()){var y;rh(null===(y=g.options)||void 0===y?void 0:y.apiKey,"invalid-api-key",{appName:g.name}),this._delegate=new LC(g.auth(),c,d),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function yg(f){f.INTERNAL.registerComponent(new Rn.wA("auth-compat",c=>{const d=c.getProvider("app-compat").getImmediate(),g=c.getProvider("auth");return new nh(d,g)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:Tp,FacebookAuthProvider:Cp,GithubAuthProvider:Fl,GoogleAuthProvider:oe,OAuthProvider:K,SAMLAuthProvider:yd,PhoneAuthProvider:lc,PhoneMultiFactorGenerator:XC,RecaptchaVerifier:Mi,TwitterAuthProvider:Yy,Auth:nh,AuthCredential:Ml,Error:U.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),f.registerVersion("@firebase/auth-compat","0.5.1")}(Ee.Z)},861:($s,nr,We)=>{function C(U,Le,on,$e,Rn,rr,Tt){try{var X=U[rr](Tt),re=X.value}catch(we){return void on(we)}X.done?Le(re):Promise.resolve(re).then($e,Rn)}function Ee(U){return function(){var Le=this,on=arguments;return new Promise(function($e,Rn){var rr=U.apply(Le,on);function Tt(re){C(rr,$e,Rn,Tt,X,"next",re)}function X(re){C(rr,$e,Rn,Tt,X,"throw",re)}Tt(void 0)})}}We.d(nr,{Z:()=>Ee})},582:($s,nr,We)=>{function Le(F,B){var Z={};for(var W in F)Object.prototype.hasOwnProperty.call(F,W)&&B.indexOf(W)<0&&(Z[W]=F[W]);if(null!=F&&"function"==typeof Object.getOwnPropertySymbols){var J=0;for(W=Object.getOwnPropertySymbols(F);J<W.length;J++)B.indexOf(W[J])<0&&Object.prototype.propertyIsEnumerable.call(F,W[J])&&(Z[W[J]]=F[W[J]])}return Z}function we(F,B,Z,W){return new(Z||(Z=Promise))(function(Q,Pe){function ut(_t){try{be(W.next(_t))}catch(In){Pe(In)}}function En(_t){try{be(W.throw(_t))}catch(In){Pe(In)}}function be(_t){_t.done?Q(_t.value):function J(Q){return Q instanceof Z?Q:new Z(function(Pe){Pe(Q)})}(_t.value).then(ut,En)}be((W=W.apply(F,B||[])).next())})}function zt(F){return this instanceof zt?(this.v=F,this):new zt(F)}function mt(F,B,Z){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var J,W=Z.apply(F,B||[]),Q=[];return J={},Pe("next"),Pe("throw"),Pe("return"),J[Symbol.asyncIterator]=function(){return this},J;function Pe(xe){W[xe]&&(J[xe]=function(Wn){return new Promise(function(Pn,Gn){Q.push([xe,Wn,Pn,Gn])>1||ut(xe,Wn)})})}function ut(xe,Wn){try{!function En(xe){xe.value instanceof zt?Promise.resolve(xe.value.v).then(be,_t):In(Q[0][2],xe)}(W[xe](Wn))}catch(Pn){In(Q[0][3],Pn)}}function be(xe){ut("next",xe)}function _t(xe){ut("throw",xe)}function In(xe,Wn){xe(Wn),Q.shift(),Q.length&&ut(Q[0][0],Q[0][1])}}function br(F){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Z,B=F[Symbol.asyncIterator];return B?B.call(F):(F=function Ct(F){var B="function"==typeof Symbol&&Symbol.iterator,Z=B&&F[B],W=0;if(Z)return Z.call(F);if(F&&"number"==typeof F.length)return{next:function(){return F&&W>=F.length&&(F=void 0),{value:F&&F[W++],done:!F}}};throw new TypeError(B?"Object is not iterable.":"Symbol.iterator is not defined.")}(F),Z={},W("next"),W("throw"),W("return"),Z[Symbol.asyncIterator]=function(){return this},Z);function W(Q){Z[Q]=F[Q]&&function(Pe){return new Promise(function(ut,En){!function J(Q,Pe,ut,En){Promise.resolve(En).then(function(be){Q({value:be,done:ut})},Pe)}(ut,En,(Pe=F[Q](Pe)).done,Pe.value)})}}}We.d(nr,{FC:()=>mt,KL:()=>br,_T:()=>Le,mG:()=>we,qq:()=>zt}),"function"==typeof SuppressedError&&SuppressedError}},$s=>{$s($s.s=421)}]);